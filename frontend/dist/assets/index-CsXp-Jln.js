function uj(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();var dj=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function J0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ew={exports:{}},Mh={},tw={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xc=Symbol.for("react.element"),hj=Symbol.for("react.portal"),fj=Symbol.for("react.fragment"),mj=Symbol.for("react.strict_mode"),pj=Symbol.for("react.profiler"),gj=Symbol.for("react.provider"),yj=Symbol.for("react.context"),_j=Symbol.for("react.forward_ref"),vj=Symbol.for("react.suspense"),xj=Symbol.for("react.memo"),wj=Symbol.for("react.lazy"),W_=Symbol.iterator;function bj(t){return t===null||typeof t!="object"?null:(t=W_&&t[W_]||t["@@iterator"],typeof t=="function"?t:null)}var nw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rw=Object.assign,sw={};function rl(t,e,n){this.props=t,this.context=e,this.refs=sw,this.updater=n||nw}rl.prototype.isReactComponent={};rl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};rl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function iw(){}iw.prototype=rl.prototype;function fg(t,e,n){this.props=t,this.context=e,this.refs=sw,this.updater=n||nw}var mg=fg.prototype=new iw;mg.constructor=fg;rw(mg,rl.prototype);mg.isPureReactComponent=!0;var H_=Array.isArray,ow=Object.prototype.hasOwnProperty,pg={current:null},aw={key:!0,ref:!0,__self:!0,__source:!0};function lw(t,e,n){var r,s={},o=null,l=null;if(e!=null)for(r in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(o=""+e.key),e)ow.call(e,r)&&!aw.hasOwnProperty(r)&&(s[r]=e[r]);var h=arguments.length-2;if(h===1)s.children=n;else if(1<h){for(var f=Array(h),m=0;m<h;m++)f[m]=arguments[m+2];s.children=f}if(t&&t.defaultProps)for(r in h=t.defaultProps,h)s[r]===void 0&&(s[r]=h[r]);return{$$typeof:Xc,type:t,key:o,ref:l,props:s,_owner:pg.current}}function Nj(t,e){return{$$typeof:Xc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function gg(t){return typeof t=="object"&&t!==null&&t.$$typeof===Xc}function Ej(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var q_=/\/+/g;function $f(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Ej(""+t.key):e.toString(36)}function Nd(t,e,n,r,s){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var l=!1;if(t===null)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case Xc:case hj:l=!0}}if(l)return l=t,s=s(l),t=r===""?"."+$f(l,0):r,H_(s)?(n="",t!=null&&(n=t.replace(q_,"$&/")+"/"),Nd(s,e,n,"",function(m){return m})):s!=null&&(gg(s)&&(s=Nj(s,n+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(q_,"$&/")+"/")+t)),e.push(s)),1;if(l=0,r=r===""?".":r+":",H_(t))for(var h=0;h<t.length;h++){o=t[h];var f=r+$f(o,h);l+=Nd(o,e,n,f,s)}else if(f=bj(t),typeof f=="function")for(t=f.call(t),h=0;!(o=t.next()).done;)o=o.value,f=r+$f(o,h++),l+=Nd(o,e,n,f,s);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function Qu(t,e,n){if(t==null)return t;var r=[],s=0;return Nd(t,r,"","",function(o){return e.call(n,o,s++)}),r}function Tj(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var hn={current:null},Ed={transition:null},jj={ReactCurrentDispatcher:hn,ReactCurrentBatchConfig:Ed,ReactCurrentOwner:pg};function cw(){throw Error("act(...) is not supported in production builds of React.")}Le.Children={map:Qu,forEach:function(t,e,n){Qu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Qu(t,function(){e++}),e},toArray:function(t){return Qu(t,function(e){return e})||[]},only:function(t){if(!gg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Le.Component=rl;Le.Fragment=fj;Le.Profiler=pj;Le.PureComponent=fg;Le.StrictMode=mj;Le.Suspense=vj;Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jj;Le.act=cw;Le.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=rw({},t.props),s=t.key,o=t.ref,l=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,l=pg.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var h=t.type.defaultProps;for(f in e)ow.call(e,f)&&!aw.hasOwnProperty(f)&&(r[f]=e[f]===void 0&&h!==void 0?h[f]:e[f])}var f=arguments.length-2;if(f===1)r.children=n;else if(1<f){h=Array(f);for(var m=0;m<f;m++)h[m]=arguments[m+2];r.children=h}return{$$typeof:Xc,type:t.type,key:s,ref:o,props:r,_owner:l}};Le.createContext=function(t){return t={$$typeof:yj,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:gj,_context:t},t.Consumer=t};Le.createElement=lw;Le.createFactory=function(t){var e=lw.bind(null,t);return e.type=t,e};Le.createRef=function(){return{current:null}};Le.forwardRef=function(t){return{$$typeof:_j,render:t}};Le.isValidElement=gg;Le.lazy=function(t){return{$$typeof:wj,_payload:{_status:-1,_result:t},_init:Tj}};Le.memo=function(t,e){return{$$typeof:xj,type:t,compare:e===void 0?null:e}};Le.startTransition=function(t){var e=Ed.transition;Ed.transition={};try{t()}finally{Ed.transition=e}};Le.unstable_act=cw;Le.useCallback=function(t,e){return hn.current.useCallback(t,e)};Le.useContext=function(t){return hn.current.useContext(t)};Le.useDebugValue=function(){};Le.useDeferredValue=function(t){return hn.current.useDeferredValue(t)};Le.useEffect=function(t,e){return hn.current.useEffect(t,e)};Le.useId=function(){return hn.current.useId()};Le.useImperativeHandle=function(t,e,n){return hn.current.useImperativeHandle(t,e,n)};Le.useInsertionEffect=function(t,e){return hn.current.useInsertionEffect(t,e)};Le.useLayoutEffect=function(t,e){return hn.current.useLayoutEffect(t,e)};Le.useMemo=function(t,e){return hn.current.useMemo(t,e)};Le.useReducer=function(t,e,n){return hn.current.useReducer(t,e,n)};Le.useRef=function(t){return hn.current.useRef(t)};Le.useState=function(t){return hn.current.useState(t)};Le.useSyncExternalStore=function(t,e,n){return hn.current.useSyncExternalStore(t,e,n)};Le.useTransition=function(){return hn.current.useTransition()};Le.version="18.3.1";tw.exports=Le;var O=tw.exports;const xc=J0(O),kj=uj({__proto__:null,default:xc},[O]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sj=O,Pj=Symbol.for("react.element"),Ij=Symbol.for("react.fragment"),Cj=Object.prototype.hasOwnProperty,Aj=Sj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Rj={key:!0,ref:!0,__self:!0,__source:!0};function uw(t,e,n){var r,s={},o=null,l=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(l=e.ref);for(r in e)Cj.call(e,r)&&!Rj.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Pj,type:t,key:o,ref:l,props:s,_owner:Aj.current}}Mh.Fragment=Ij;Mh.jsx=uw;Mh.jsxs=uw;ew.exports=Mh;var a=ew.exports,Cm={},dw={exports:{}},Vn={},hw={exports:{}},fw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,re){var X=H.length;H.push(re);e:for(;0<X;){var Q=X-1>>>1,G=H[Q];if(0<s(G,re))H[Q]=re,H[X]=G,X=Q;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var re=H[0],X=H.pop();if(X!==re){H[0]=X;e:for(var Q=0,G=H.length,le=G>>>1;Q<le;){var _e=2*(Q+1)-1,ge=H[_e],ye=_e+1,rt=H[ye];if(0>s(ge,X))ye<G&&0>s(rt,ge)?(H[Q]=rt,H[ye]=X,Q=ye):(H[Q]=ge,H[_e]=X,Q=_e);else if(ye<G&&0>s(rt,X))H[Q]=rt,H[ye]=X,Q=ye;else break e}}return re}function s(H,re){var X=H.sortIndex-re.sortIndex;return X!==0?X:H.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var l=Date,h=l.now();t.unstable_now=function(){return l.now()-h}}var f=[],m=[],g=1,_=null,w=3,T=!1,j=!1,D=!1,M=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(H){for(var re=n(m);re!==null;){if(re.callback===null)r(m);else if(re.startTime<=H)r(m),re.sortIndex=re.expirationTime,e(f,re);else break;re=n(m)}}function U(H){if(D=!1,C(H),!j)if(n(f)!==null)j=!0,ue(F);else{var re=n(m);re!==null&&ne(U,re.startTime-H)}}function F(H,re){j=!1,D&&(D=!1,k(N),N=-1),T=!0;var X=w;try{for(C(re),_=n(f);_!==null&&(!(_.expirationTime>re)||H&&!A());){var Q=_.callback;if(typeof Q=="function"){_.callback=null,w=_.priorityLevel;var G=Q(_.expirationTime<=re);re=t.unstable_now(),typeof G=="function"?_.callback=G:_===n(f)&&r(f),C(re)}else r(f);_=n(f)}if(_!==null)var le=!0;else{var _e=n(m);_e!==null&&ne(U,_e.startTime-re),le=!1}return le}finally{_=null,w=X,T=!1}}var V=!1,E=null,N=-1,R=5,P=-1;function A(){return!(t.unstable_now()-P<R)}function $(){if(E!==null){var H=t.unstable_now();P=H;var re=!0;try{re=E(!0,H)}finally{re?z():(V=!1,E=null)}}else V=!1}var z;if(typeof S=="function")z=function(){S($)};else if(typeof MessageChannel<"u"){var xe=new MessageChannel,oe=xe.port2;xe.port1.onmessage=$,z=function(){oe.postMessage(null)}}else z=function(){M($,0)};function ue(H){E=H,V||(V=!0,z())}function ne(H,re){N=M(function(){H(t.unstable_now())},re)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){j||T||(j=!0,ue(F))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return w},t.unstable_getFirstCallbackNode=function(){return n(f)},t.unstable_next=function(H){switch(w){case 1:case 2:case 3:var re=3;break;default:re=w}var X=w;w=re;try{return H()}finally{w=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,re){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var X=w;w=H;try{return re()}finally{w=X}},t.unstable_scheduleCallback=function(H,re,X){var Q=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?Q+X:Q):X=Q,H){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=X+G,H={id:g++,callback:re,priorityLevel:H,startTime:X,expirationTime:G,sortIndex:-1},X>Q?(H.sortIndex=X,e(m,H),n(f)===null&&H===n(m)&&(D?(k(N),N=-1):D=!0,ne(U,X-Q))):(H.sortIndex=G,e(f,H),j||T||(j=!0,ue(F))),H},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(H){var re=w;return function(){var X=w;w=re;try{return H.apply(this,arguments)}finally{w=X}}}})(fw);hw.exports=fw;var Lj=hw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dj=O,On=Lj;function se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var mw=new Set,wc={};function Io(t,e){Ba(t,e),Ba(t+"Capture",e)}function Ba(t,e){for(wc[t]=e,t=0;t<e.length;t++)mw.add(e[t])}var Ns=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Am=Object.prototype.hasOwnProperty,zj=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Z_={},G_={};function Mj(t){return Am.call(G_,t)?!0:Am.call(Z_,t)?!1:zj.test(t)?G_[t]=!0:(Z_[t]=!0,!1)}function Oj(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Vj(t,e,n,r){if(e===null||typeof e>"u"||Oj(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function fn(t,e,n,r,s,o,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=l}var qt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){qt[t]=new fn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];qt[e]=new fn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){qt[t]=new fn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){qt[t]=new fn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){qt[t]=new fn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){qt[t]=new fn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){qt[t]=new fn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){qt[t]=new fn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){qt[t]=new fn(t,5,!1,t.toLowerCase(),null,!1,!1)});var yg=/[\-:]([a-z])/g;function _g(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(yg,_g);qt[e]=new fn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(yg,_g);qt[e]=new fn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(yg,_g);qt[e]=new fn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){qt[t]=new fn(t,1,!1,t.toLowerCase(),null,!1,!1)});qt.xlinkHref=new fn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){qt[t]=new fn(t,1,!1,t.toLowerCase(),null,!0,!0)});function vg(t,e,n,r){var s=qt.hasOwnProperty(e)?qt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Vj(e,n,s,r)&&(n=null),r||s===null?Mj(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var As=Dj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Yu=Symbol.for("react.element"),_a=Symbol.for("react.portal"),va=Symbol.for("react.fragment"),xg=Symbol.for("react.strict_mode"),Rm=Symbol.for("react.profiler"),pw=Symbol.for("react.provider"),gw=Symbol.for("react.context"),wg=Symbol.for("react.forward_ref"),Lm=Symbol.for("react.suspense"),Dm=Symbol.for("react.suspense_list"),bg=Symbol.for("react.memo"),qs=Symbol.for("react.lazy"),yw=Symbol.for("react.offscreen"),K_=Symbol.iterator;function Ol(t){return t===null||typeof t!="object"?null:(t=K_&&t[K_]||t["@@iterator"],typeof t=="function"?t:null)}var ct=Object.assign,Wf;function Zl(t){if(Wf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Wf=e&&e[1]||""}return`
`+Wf+t}var Hf=!1;function qf(t,e){if(!t||Hf)return"";Hf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(m){var r=m}Reflect.construct(t,[],e)}else{try{e.call()}catch(m){r=m}t.call(e.prototype)}else{try{throw Error()}catch(m){r=m}t()}}catch(m){if(m&&r&&typeof m.stack=="string"){for(var s=m.stack.split(`
`),o=r.stack.split(`
`),l=s.length-1,h=o.length-1;1<=l&&0<=h&&s[l]!==o[h];)h--;for(;1<=l&&0<=h;l--,h--)if(s[l]!==o[h]){if(l!==1||h!==1)do if(l--,h--,0>h||s[l]!==o[h]){var f=`
`+s[l].replace(" at new "," at ");return t.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",t.displayName)),f}while(1<=l&&0<=h);break}}}finally{Hf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Zl(t):""}function Uj(t){switch(t.tag){case 5:return Zl(t.type);case 16:return Zl("Lazy");case 13:return Zl("Suspense");case 19:return Zl("SuspenseList");case 0:case 2:case 15:return t=qf(t.type,!1),t;case 11:return t=qf(t.type.render,!1),t;case 1:return t=qf(t.type,!0),t;default:return""}}function zm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case va:return"Fragment";case _a:return"Portal";case Rm:return"Profiler";case xg:return"StrictMode";case Lm:return"Suspense";case Dm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case gw:return(t.displayName||"Context")+".Consumer";case pw:return(t._context.displayName||"Context")+".Provider";case wg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case bg:return e=t.displayName||null,e!==null?e:zm(t.type)||"Memo";case qs:e=t._payload,t=t._init;try{return zm(t(e))}catch{}}return null}function Fj(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return zm(e);case 8:return e===xg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function vi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function _w(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Bj(t){var e=_w(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(l){r=""+l,o.call(this,l)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Xu(t){t._valueTracker||(t._valueTracker=Bj(t))}function vw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=_w(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Hd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Mm(t,e){var n=e.checked;return ct({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Q_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=vi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function xw(t,e){e=e.checked,e!=null&&vg(t,"checked",e,!1)}function Om(t,e){xw(t,e);var n=vi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Vm(t,e.type,n):e.hasOwnProperty("defaultValue")&&Vm(t,e.type,vi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Y_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Vm(t,e,n){(e!=="number"||Hd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Gl=Array.isArray;function Ca(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+vi(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Um(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(se(91));return ct({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function X_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(se(92));if(Gl(n)){if(1<n.length)throw Error(se(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:vi(n)}}function ww(t,e){var n=vi(e.value),r=vi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function J_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function bw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?bw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ju,Nw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ju=Ju||document.createElement("div"),Ju.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ju.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function bc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var rc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$j=["Webkit","ms","Moz","O"];Object.keys(rc).forEach(function(t){$j.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),rc[e]=rc[t]})});function Ew(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||rc.hasOwnProperty(t)&&rc[t]?(""+e).trim():e+"px"}function Tw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Ew(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Wj=ct({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bm(t,e){if(e){if(Wj[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(se(62))}}function $m(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wm=null;function Ng(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Hm=null,Aa=null,Ra=null;function ev(t){if(t=tu(t)){if(typeof Hm!="function")throw Error(se(280));var e=t.stateNode;e&&(e=Bh(e),Hm(t.stateNode,t.type,e))}}function jw(t){Aa?Ra?Ra.push(t):Ra=[t]:Aa=t}function kw(){if(Aa){var t=Aa,e=Ra;if(Ra=Aa=null,ev(t),e)for(t=0;t<e.length;t++)ev(e[t])}}function Sw(t,e){return t(e)}function Pw(){}var Zf=!1;function Iw(t,e,n){if(Zf)return t(e,n);Zf=!0;try{return Sw(t,e,n)}finally{Zf=!1,(Aa!==null||Ra!==null)&&(Pw(),kw())}}function Nc(t,e){var n=t.stateNode;if(n===null)return null;var r=Bh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(se(231,e,typeof n));return n}var qm=!1;if(Ns)try{var Vl={};Object.defineProperty(Vl,"passive",{get:function(){qm=!0}}),window.addEventListener("test",Vl,Vl),window.removeEventListener("test",Vl,Vl)}catch{qm=!1}function Hj(t,e,n,r,s,o,l,h,f){var m=Array.prototype.slice.call(arguments,3);try{e.apply(n,m)}catch(g){this.onError(g)}}var sc=!1,qd=null,Zd=!1,Zm=null,qj={onError:function(t){sc=!0,qd=t}};function Zj(t,e,n,r,s,o,l,h,f){sc=!1,qd=null,Hj.apply(qj,arguments)}function Gj(t,e,n,r,s,o,l,h,f){if(Zj.apply(this,arguments),sc){if(sc){var m=qd;sc=!1,qd=null}else throw Error(se(198));Zd||(Zd=!0,Zm=m)}}function Co(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Cw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function tv(t){if(Co(t)!==t)throw Error(se(188))}function Kj(t){var e=t.alternate;if(!e){if(e=Co(t),e===null)throw Error(se(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return tv(s),t;if(o===r)return tv(s),e;o=o.sibling}throw Error(se(188))}if(n.return!==r.return)n=s,r=o;else{for(var l=!1,h=s.child;h;){if(h===n){l=!0,n=s,r=o;break}if(h===r){l=!0,r=s,n=o;break}h=h.sibling}if(!l){for(h=o.child;h;){if(h===n){l=!0,n=o,r=s;break}if(h===r){l=!0,r=o,n=s;break}h=h.sibling}if(!l)throw Error(se(189))}}if(n.alternate!==r)throw Error(se(190))}if(n.tag!==3)throw Error(se(188));return n.stateNode.current===n?t:e}function Aw(t){return t=Kj(t),t!==null?Rw(t):null}function Rw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Rw(t);if(e!==null)return e;t=t.sibling}return null}var Lw=On.unstable_scheduleCallback,nv=On.unstable_cancelCallback,Qj=On.unstable_shouldYield,Yj=On.unstable_requestPaint,_t=On.unstable_now,Xj=On.unstable_getCurrentPriorityLevel,Eg=On.unstable_ImmediatePriority,Dw=On.unstable_UserBlockingPriority,Gd=On.unstable_NormalPriority,Jj=On.unstable_LowPriority,zw=On.unstable_IdlePriority,Oh=null,Vr=null;function ek(t){if(Vr&&typeof Vr.onCommitFiberRoot=="function")try{Vr.onCommitFiberRoot(Oh,t,void 0,(t.current.flags&128)===128)}catch{}}var mr=Math.clz32?Math.clz32:rk,tk=Math.log,nk=Math.LN2;function rk(t){return t>>>=0,t===0?32:31-(tk(t)/nk|0)|0}var ed=64,td=4194304;function Kl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Kd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,o=t.pingedLanes,l=n&268435455;if(l!==0){var h=l&~s;h!==0?r=Kl(h):(o&=l,o!==0&&(r=Kl(o)))}else l=n&~s,l!==0?r=Kl(l):o!==0&&(r=Kl(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-mr(e),s=1<<n,r|=t[n],e&=~s;return r}function sk(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ik(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var l=31-mr(o),h=1<<l,f=s[l];f===-1?(!(h&n)||h&r)&&(s[l]=sk(h,e)):f<=e&&(t.expiredLanes|=h),o&=~h}}function Gm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Mw(){var t=ed;return ed<<=1,!(ed&4194240)&&(ed=64),t}function Gf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Jc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-mr(e),t[e]=n}function ok(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-mr(n),o=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~o}}function Tg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-mr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ge=0;function Ow(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Vw,jg,Uw,Fw,Bw,Km=!1,nd=[],ii=null,oi=null,ai=null,Ec=new Map,Tc=new Map,Gs=[],ak="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rv(t,e){switch(t){case"focusin":case"focusout":ii=null;break;case"dragenter":case"dragleave":oi=null;break;case"mouseover":case"mouseout":ai=null;break;case"pointerover":case"pointerout":Ec.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tc.delete(e.pointerId)}}function Ul(t,e,n,r,s,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=tu(e),e!==null&&jg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function lk(t,e,n,r,s){switch(e){case"focusin":return ii=Ul(ii,t,e,n,r,s),!0;case"dragenter":return oi=Ul(oi,t,e,n,r,s),!0;case"mouseover":return ai=Ul(ai,t,e,n,r,s),!0;case"pointerover":var o=s.pointerId;return Ec.set(o,Ul(Ec.get(o)||null,t,e,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,Tc.set(o,Ul(Tc.get(o)||null,t,e,n,r,s)),!0}return!1}function $w(t){var e=io(t.target);if(e!==null){var n=Co(e);if(n!==null){if(e=n.tag,e===13){if(e=Cw(n),e!==null){t.blockedOn=e,Bw(t.priority,function(){Uw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Td(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Qm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Wm=r,n.target.dispatchEvent(r),Wm=null}else return e=tu(n),e!==null&&jg(e),t.blockedOn=n,!1;e.shift()}return!0}function sv(t,e,n){Td(t)&&n.delete(e)}function ck(){Km=!1,ii!==null&&Td(ii)&&(ii=null),oi!==null&&Td(oi)&&(oi=null),ai!==null&&Td(ai)&&(ai=null),Ec.forEach(sv),Tc.forEach(sv)}function Fl(t,e){t.blockedOn===e&&(t.blockedOn=null,Km||(Km=!0,On.unstable_scheduleCallback(On.unstable_NormalPriority,ck)))}function jc(t){function e(s){return Fl(s,t)}if(0<nd.length){Fl(nd[0],t);for(var n=1;n<nd.length;n++){var r=nd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ii!==null&&Fl(ii,t),oi!==null&&Fl(oi,t),ai!==null&&Fl(ai,t),Ec.forEach(e),Tc.forEach(e),n=0;n<Gs.length;n++)r=Gs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Gs.length&&(n=Gs[0],n.blockedOn===null);)$w(n),n.blockedOn===null&&Gs.shift()}var La=As.ReactCurrentBatchConfig,Qd=!0;function uk(t,e,n,r){var s=Ge,o=La.transition;La.transition=null;try{Ge=1,kg(t,e,n,r)}finally{Ge=s,La.transition=o}}function dk(t,e,n,r){var s=Ge,o=La.transition;La.transition=null;try{Ge=4,kg(t,e,n,r)}finally{Ge=s,La.transition=o}}function kg(t,e,n,r){if(Qd){var s=Qm(t,e,n,r);if(s===null)sm(t,e,r,Yd,n),rv(t,r);else if(lk(s,t,e,n,r))r.stopPropagation();else if(rv(t,r),e&4&&-1<ak.indexOf(t)){for(;s!==null;){var o=tu(s);if(o!==null&&Vw(o),o=Qm(t,e,n,r),o===null&&sm(t,e,r,Yd,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else sm(t,e,r,null,n)}}var Yd=null;function Qm(t,e,n,r){if(Yd=null,t=Ng(r),t=io(t),t!==null)if(e=Co(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Cw(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Yd=t,null}function Ww(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xj()){case Eg:return 1;case Dw:return 4;case Gd:case Jj:return 16;case zw:return 536870912;default:return 16}default:return 16}}var ti=null,Sg=null,jd=null;function Hw(){if(jd)return jd;var t,e=Sg,n=e.length,r,s="value"in ti?ti.value:ti.textContent,o=s.length;for(t=0;t<n&&e[t]===s[t];t++);var l=n-t;for(r=1;r<=l&&e[n-r]===s[o-r];r++);return jd=s.slice(t,1<r?1-r:void 0)}function kd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function rd(){return!0}function iv(){return!1}function Un(t){function e(n,r,s,o,l){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=l,this.currentTarget=null;for(var h in t)t.hasOwnProperty(h)&&(n=t[h],this[h]=n?n(o):o[h]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?rd:iv,this.isPropagationStopped=iv,this}return ct(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=rd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=rd)},persist:function(){},isPersistent:rd}),e}var sl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pg=Un(sl),eu=ct({},sl,{view:0,detail:0}),hk=Un(eu),Kf,Qf,Bl,Vh=ct({},eu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ig,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Bl&&(Bl&&t.type==="mousemove"?(Kf=t.screenX-Bl.screenX,Qf=t.screenY-Bl.screenY):Qf=Kf=0,Bl=t),Kf)},movementY:function(t){return"movementY"in t?t.movementY:Qf}}),ov=Un(Vh),fk=ct({},Vh,{dataTransfer:0}),mk=Un(fk),pk=ct({},eu,{relatedTarget:0}),Yf=Un(pk),gk=ct({},sl,{animationName:0,elapsedTime:0,pseudoElement:0}),yk=Un(gk),_k=ct({},sl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),vk=Un(_k),xk=ct({},sl,{data:0}),av=Un(xk),wk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ek(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Nk[t])?!!e[t]:!1}function Ig(){return Ek}var Tk=ct({},eu,{key:function(t){if(t.key){var e=wk[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=kd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?bk[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ig,charCode:function(t){return t.type==="keypress"?kd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?kd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),jk=Un(Tk),kk=ct({},Vh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lv=Un(kk),Sk=ct({},eu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ig}),Pk=Un(Sk),Ik=ct({},sl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ck=Un(Ik),Ak=ct({},Vh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Rk=Un(Ak),Lk=[9,13,27,32],Cg=Ns&&"CompositionEvent"in window,ic=null;Ns&&"documentMode"in document&&(ic=document.documentMode);var Dk=Ns&&"TextEvent"in window&&!ic,qw=Ns&&(!Cg||ic&&8<ic&&11>=ic),cv=" ",uv=!1;function Zw(t,e){switch(t){case"keyup":return Lk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var xa=!1;function zk(t,e){switch(t){case"compositionend":return Gw(e);case"keypress":return e.which!==32?null:(uv=!0,cv);case"textInput":return t=e.data,t===cv&&uv?null:t;default:return null}}function Mk(t,e){if(xa)return t==="compositionend"||!Cg&&Zw(t,e)?(t=Hw(),jd=Sg=ti=null,xa=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return qw&&e.locale!=="ko"?null:e.data;default:return null}}var Ok={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Ok[t.type]:e==="textarea"}function Kw(t,e,n,r){jw(r),e=Xd(e,"onChange"),0<e.length&&(n=new Pg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var oc=null,kc=null;function Vk(t){ob(t,0)}function Uh(t){var e=Na(t);if(vw(e))return t}function Uk(t,e){if(t==="change")return e}var Qw=!1;if(Ns){var Xf;if(Ns){var Jf="oninput"in document;if(!Jf){var hv=document.createElement("div");hv.setAttribute("oninput","return;"),Jf=typeof hv.oninput=="function"}Xf=Jf}else Xf=!1;Qw=Xf&&(!document.documentMode||9<document.documentMode)}function fv(){oc&&(oc.detachEvent("onpropertychange",Yw),kc=oc=null)}function Yw(t){if(t.propertyName==="value"&&Uh(kc)){var e=[];Kw(e,kc,t,Ng(t)),Iw(Vk,e)}}function Fk(t,e,n){t==="focusin"?(fv(),oc=e,kc=n,oc.attachEvent("onpropertychange",Yw)):t==="focusout"&&fv()}function Bk(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Uh(kc)}function $k(t,e){if(t==="click")return Uh(e)}function Wk(t,e){if(t==="input"||t==="change")return Uh(e)}function Hk(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var gr=typeof Object.is=="function"?Object.is:Hk;function Sc(t,e){if(gr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Am.call(e,s)||!gr(t[s],e[s]))return!1}return!0}function mv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function pv(t,e){var n=mv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=mv(n)}}function Xw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Xw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Jw(){for(var t=window,e=Hd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Hd(t.document)}return e}function Ag(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function qk(t){var e=Jw(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Xw(n.ownerDocument.documentElement,n)){if(r!==null&&Ag(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!t.extend&&o>r&&(s=r,r=o,o=s),s=pv(n,o);var l=pv(n,r);s&&l&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==l.node||t.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Zk=Ns&&"documentMode"in document&&11>=document.documentMode,wa=null,Ym=null,ac=null,Xm=!1;function gv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Xm||wa==null||wa!==Hd(r)||(r=wa,"selectionStart"in r&&Ag(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ac&&Sc(ac,r)||(ac=r,r=Xd(Ym,"onSelect"),0<r.length&&(e=new Pg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=wa)))}function sd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ba={animationend:sd("Animation","AnimationEnd"),animationiteration:sd("Animation","AnimationIteration"),animationstart:sd("Animation","AnimationStart"),transitionend:sd("Transition","TransitionEnd")},em={},eb={};Ns&&(eb=document.createElement("div").style,"AnimationEvent"in window||(delete ba.animationend.animation,delete ba.animationiteration.animation,delete ba.animationstart.animation),"TransitionEvent"in window||delete ba.transitionend.transition);function Fh(t){if(em[t])return em[t];if(!ba[t])return t;var e=ba[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in eb)return em[t]=e[n];return t}var tb=Fh("animationend"),nb=Fh("animationiteration"),rb=Fh("animationstart"),sb=Fh("transitionend"),ib=new Map,yv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ii(t,e){ib.set(t,e),Io(e,[t])}for(var tm=0;tm<yv.length;tm++){var nm=yv[tm],Gk=nm.toLowerCase(),Kk=nm[0].toUpperCase()+nm.slice(1);Ii(Gk,"on"+Kk)}Ii(tb,"onAnimationEnd");Ii(nb,"onAnimationIteration");Ii(rb,"onAnimationStart");Ii("dblclick","onDoubleClick");Ii("focusin","onFocus");Ii("focusout","onBlur");Ii(sb,"onTransitionEnd");Ba("onMouseEnter",["mouseout","mouseover"]);Ba("onMouseLeave",["mouseout","mouseover"]);Ba("onPointerEnter",["pointerout","pointerover"]);Ba("onPointerLeave",["pointerout","pointerover"]);Io("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Io("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Io("onBeforeInput",["compositionend","keypress","textInput","paste"]);Io("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Io("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Io("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ql="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ql));function _v(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Gj(r,e,void 0,t),t.currentTarget=null}function ob(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var l=r.length-1;0<=l;l--){var h=r[l],f=h.instance,m=h.currentTarget;if(h=h.listener,f!==o&&s.isPropagationStopped())break e;_v(s,h,m),o=f}else for(l=0;l<r.length;l++){if(h=r[l],f=h.instance,m=h.currentTarget,h=h.listener,f!==o&&s.isPropagationStopped())break e;_v(s,h,m),o=f}}}if(Zd)throw t=Zm,Zd=!1,Zm=null,t}function et(t,e){var n=e[rp];n===void 0&&(n=e[rp]=new Set);var r=t+"__bubble";n.has(r)||(ab(e,t,2,!1),n.add(r))}function rm(t,e,n){var r=0;e&&(r|=4),ab(n,t,r,e)}var id="_reactListening"+Math.random().toString(36).slice(2);function Pc(t){if(!t[id]){t[id]=!0,mw.forEach(function(n){n!=="selectionchange"&&(Qk.has(n)||rm(n,!1,t),rm(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[id]||(e[id]=!0,rm("selectionchange",!1,e))}}function ab(t,e,n,r){switch(Ww(e)){case 1:var s=uk;break;case 4:s=dk;break;default:s=kg}n=s.bind(null,e,n,t),s=void 0,!qm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function sm(t,e,n,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var h=r.stateNode.containerInfo;if(h===s||h.nodeType===8&&h.parentNode===s)break;if(l===4)for(l=r.return;l!==null;){var f=l.tag;if((f===3||f===4)&&(f=l.stateNode.containerInfo,f===s||f.nodeType===8&&f.parentNode===s))return;l=l.return}for(;h!==null;){if(l=io(h),l===null)return;if(f=l.tag,f===5||f===6){r=o=l;continue e}h=h.parentNode}}r=r.return}Iw(function(){var m=o,g=Ng(n),_=[];e:{var w=ib.get(t);if(w!==void 0){var T=Pg,j=t;switch(t){case"keypress":if(kd(n)===0)break e;case"keydown":case"keyup":T=jk;break;case"focusin":j="focus",T=Yf;break;case"focusout":j="blur",T=Yf;break;case"beforeblur":case"afterblur":T=Yf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":T=ov;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":T=mk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":T=Pk;break;case tb:case nb:case rb:T=yk;break;case sb:T=Ck;break;case"scroll":T=hk;break;case"wheel":T=Rk;break;case"copy":case"cut":case"paste":T=vk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":T=lv}var D=(e&4)!==0,M=!D&&t==="scroll",k=D?w!==null?w+"Capture":null:w;D=[];for(var S=m,C;S!==null;){C=S;var U=C.stateNode;if(C.tag===5&&U!==null&&(C=U,k!==null&&(U=Nc(S,k),U!=null&&D.push(Ic(S,U,C)))),M)break;S=S.return}0<D.length&&(w=new T(w,j,null,n,g),_.push({event:w,listeners:D}))}}if(!(e&7)){e:{if(w=t==="mouseover"||t==="pointerover",T=t==="mouseout"||t==="pointerout",w&&n!==Wm&&(j=n.relatedTarget||n.fromElement)&&(io(j)||j[Es]))break e;if((T||w)&&(w=g.window===g?g:(w=g.ownerDocument)?w.defaultView||w.parentWindow:window,T?(j=n.relatedTarget||n.toElement,T=m,j=j?io(j):null,j!==null&&(M=Co(j),j!==M||j.tag!==5&&j.tag!==6)&&(j=null)):(T=null,j=m),T!==j)){if(D=ov,U="onMouseLeave",k="onMouseEnter",S="mouse",(t==="pointerout"||t==="pointerover")&&(D=lv,U="onPointerLeave",k="onPointerEnter",S="pointer"),M=T==null?w:Na(T),C=j==null?w:Na(j),w=new D(U,S+"leave",T,n,g),w.target=M,w.relatedTarget=C,U=null,io(g)===m&&(D=new D(k,S+"enter",j,n,g),D.target=C,D.relatedTarget=M,U=D),M=U,T&&j)t:{for(D=T,k=j,S=0,C=D;C;C=ua(C))S++;for(C=0,U=k;U;U=ua(U))C++;for(;0<S-C;)D=ua(D),S--;for(;0<C-S;)k=ua(k),C--;for(;S--;){if(D===k||k!==null&&D===k.alternate)break t;D=ua(D),k=ua(k)}D=null}else D=null;T!==null&&vv(_,w,T,D,!1),j!==null&&M!==null&&vv(_,M,j,D,!0)}}e:{if(w=m?Na(m):window,T=w.nodeName&&w.nodeName.toLowerCase(),T==="select"||T==="input"&&w.type==="file")var F=Uk;else if(dv(w))if(Qw)F=Wk;else{F=Bk;var V=Fk}else(T=w.nodeName)&&T.toLowerCase()==="input"&&(w.type==="checkbox"||w.type==="radio")&&(F=$k);if(F&&(F=F(t,m))){Kw(_,F,n,g);break e}V&&V(t,w,m),t==="focusout"&&(V=w._wrapperState)&&V.controlled&&w.type==="number"&&Vm(w,"number",w.value)}switch(V=m?Na(m):window,t){case"focusin":(dv(V)||V.contentEditable==="true")&&(wa=V,Ym=m,ac=null);break;case"focusout":ac=Ym=wa=null;break;case"mousedown":Xm=!0;break;case"contextmenu":case"mouseup":case"dragend":Xm=!1,gv(_,n,g);break;case"selectionchange":if(Zk)break;case"keydown":case"keyup":gv(_,n,g)}var E;if(Cg)e:{switch(t){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else xa?Zw(t,n)&&(N="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(qw&&n.locale!=="ko"&&(xa||N!=="onCompositionStart"?N==="onCompositionEnd"&&xa&&(E=Hw()):(ti=g,Sg="value"in ti?ti.value:ti.textContent,xa=!0)),V=Xd(m,N),0<V.length&&(N=new av(N,t,null,n,g),_.push({event:N,listeners:V}),E?N.data=E:(E=Gw(n),E!==null&&(N.data=E)))),(E=Dk?zk(t,n):Mk(t,n))&&(m=Xd(m,"onBeforeInput"),0<m.length&&(g=new av("onBeforeInput","beforeinput",null,n,g),_.push({event:g,listeners:m}),g.data=E))}ob(_,e)})}function Ic(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Xd(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=Nc(t,n),o!=null&&r.unshift(Ic(t,o,s)),o=Nc(t,e),o!=null&&r.push(Ic(t,o,s))),t=t.return}return r}function ua(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function vv(t,e,n,r,s){for(var o=e._reactName,l=[];n!==null&&n!==r;){var h=n,f=h.alternate,m=h.stateNode;if(f!==null&&f===r)break;h.tag===5&&m!==null&&(h=m,s?(f=Nc(n,o),f!=null&&l.unshift(Ic(n,f,h))):s||(f=Nc(n,o),f!=null&&l.push(Ic(n,f,h)))),n=n.return}l.length!==0&&t.push({event:e,listeners:l})}var Yk=/\r\n?/g,Xk=/\u0000|\uFFFD/g;function xv(t){return(typeof t=="string"?t:""+t).replace(Yk,`
`).replace(Xk,"")}function od(t,e,n){if(e=xv(e),xv(t)!==e&&n)throw Error(se(425))}function Jd(){}var Jm=null,ep=null;function tp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var np=typeof setTimeout=="function"?setTimeout:void 0,Jk=typeof clearTimeout=="function"?clearTimeout:void 0,wv=typeof Promise=="function"?Promise:void 0,e2=typeof queueMicrotask=="function"?queueMicrotask:typeof wv<"u"?function(t){return wv.resolve(null).then(t).catch(t2)}:np;function t2(t){setTimeout(function(){throw t})}function im(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),jc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);jc(e)}function li(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function bv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var il=Math.random().toString(36).slice(2),Rr="__reactFiber$"+il,Cc="__reactProps$"+il,Es="__reactContainer$"+il,rp="__reactEvents$"+il,n2="__reactListeners$"+il,r2="__reactHandles$"+il;function io(t){var e=t[Rr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Es]||n[Rr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=bv(t);t!==null;){if(n=t[Rr])return n;t=bv(t)}return e}t=n,n=t.parentNode}return null}function tu(t){return t=t[Rr]||t[Es],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Na(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(se(33))}function Bh(t){return t[Cc]||null}var sp=[],Ea=-1;function Ci(t){return{current:t}}function nt(t){0>Ea||(t.current=sp[Ea],sp[Ea]=null,Ea--)}function Xe(t,e){Ea++,sp[Ea]=t.current,t.current=e}var xi={},nn=Ci(xi),En=Ci(!1),go=xi;function $a(t,e){var n=t.type.contextTypes;if(!n)return xi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Tn(t){return t=t.childContextTypes,t!=null}function eh(){nt(En),nt(nn)}function Nv(t,e,n){if(nn.current!==xi)throw Error(se(168));Xe(nn,e),Xe(En,n)}function lb(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(se(108,Fj(t)||"Unknown",s));return ct({},n,r)}function th(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||xi,go=nn.current,Xe(nn,t),Xe(En,En.current),!0}function Ev(t,e,n){var r=t.stateNode;if(!r)throw Error(se(169));n?(t=lb(t,e,go),r.__reactInternalMemoizedMergedChildContext=t,nt(En),nt(nn),Xe(nn,t)):nt(En),Xe(En,n)}var hs=null,$h=!1,om=!1;function cb(t){hs===null?hs=[t]:hs.push(t)}function s2(t){$h=!0,cb(t)}function Ai(){if(!om&&hs!==null){om=!0;var t=0,e=Ge;try{var n=hs;for(Ge=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}hs=null,$h=!1}catch(s){throw hs!==null&&(hs=hs.slice(t+1)),Lw(Eg,Ai),s}finally{Ge=e,om=!1}}return null}var Ta=[],ja=0,nh=null,rh=0,Gn=[],Kn=0,yo=null,fs=1,ms="";function no(t,e){Ta[ja++]=rh,Ta[ja++]=nh,nh=t,rh=e}function ub(t,e,n){Gn[Kn++]=fs,Gn[Kn++]=ms,Gn[Kn++]=yo,yo=t;var r=fs;t=ms;var s=32-mr(r)-1;r&=~(1<<s),n+=1;var o=32-mr(e)+s;if(30<o){var l=s-s%5;o=(r&(1<<l)-1).toString(32),r>>=l,s-=l,fs=1<<32-mr(e)+s|n<<s|r,ms=o+t}else fs=1<<o|n<<s|r,ms=t}function Rg(t){t.return!==null&&(no(t,1),ub(t,1,0))}function Lg(t){for(;t===nh;)nh=Ta[--ja],Ta[ja]=null,rh=Ta[--ja],Ta[ja]=null;for(;t===yo;)yo=Gn[--Kn],Gn[Kn]=null,ms=Gn[--Kn],Gn[Kn]=null,fs=Gn[--Kn],Gn[Kn]=null}var Mn=null,Ln=null,it=!1,hr=null;function db(t,e){var n=Yn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Tv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Mn=t,Ln=li(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Mn=t,Ln=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=yo!==null?{id:fs,overflow:ms}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Yn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Mn=t,Ln=null,!0):!1;default:return!1}}function ip(t){return(t.mode&1)!==0&&(t.flags&128)===0}function op(t){if(it){var e=Ln;if(e){var n=e;if(!Tv(t,e)){if(ip(t))throw Error(se(418));e=li(n.nextSibling);var r=Mn;e&&Tv(t,e)?db(r,n):(t.flags=t.flags&-4097|2,it=!1,Mn=t)}}else{if(ip(t))throw Error(se(418));t.flags=t.flags&-4097|2,it=!1,Mn=t}}}function jv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Mn=t}function ad(t){if(t!==Mn)return!1;if(!it)return jv(t),it=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!tp(t.type,t.memoizedProps)),e&&(e=Ln)){if(ip(t))throw hb(),Error(se(418));for(;e;)db(t,e),e=li(e.nextSibling)}if(jv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ln=li(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ln=null}}else Ln=Mn?li(t.stateNode.nextSibling):null;return!0}function hb(){for(var t=Ln;t;)t=li(t.nextSibling)}function Wa(){Ln=Mn=null,it=!1}function Dg(t){hr===null?hr=[t]:hr.push(t)}var i2=As.ReactCurrentBatchConfig;function $l(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(se(309));var r=n.stateNode}if(!r)throw Error(se(147,t));var s=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(l){var h=s.refs;l===null?delete h[o]:h[o]=l},e._stringRef=o,e)}if(typeof t!="string")throw Error(se(284));if(!n._owner)throw Error(se(290,t))}return t}function ld(t,e){throw t=Object.prototype.toString.call(e),Error(se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function kv(t){var e=t._init;return e(t._payload)}function fb(t){function e(k,S){if(t){var C=k.deletions;C===null?(k.deletions=[S],k.flags|=16):C.push(S)}}function n(k,S){if(!t)return null;for(;S!==null;)e(k,S),S=S.sibling;return null}function r(k,S){for(k=new Map;S!==null;)S.key!==null?k.set(S.key,S):k.set(S.index,S),S=S.sibling;return k}function s(k,S){return k=hi(k,S),k.index=0,k.sibling=null,k}function o(k,S,C){return k.index=C,t?(C=k.alternate,C!==null?(C=C.index,C<S?(k.flags|=2,S):C):(k.flags|=2,S)):(k.flags|=1048576,S)}function l(k){return t&&k.alternate===null&&(k.flags|=2),k}function h(k,S,C,U){return S===null||S.tag!==6?(S=fm(C,k.mode,U),S.return=k,S):(S=s(S,C),S.return=k,S)}function f(k,S,C,U){var F=C.type;return F===va?g(k,S,C.props.children,U,C.key):S!==null&&(S.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===qs&&kv(F)===S.type)?(U=s(S,C.props),U.ref=$l(k,S,C),U.return=k,U):(U=Ld(C.type,C.key,C.props,null,k.mode,U),U.ref=$l(k,S,C),U.return=k,U)}function m(k,S,C,U){return S===null||S.tag!==4||S.stateNode.containerInfo!==C.containerInfo||S.stateNode.implementation!==C.implementation?(S=mm(C,k.mode,U),S.return=k,S):(S=s(S,C.children||[]),S.return=k,S)}function g(k,S,C,U,F){return S===null||S.tag!==7?(S=uo(C,k.mode,U,F),S.return=k,S):(S=s(S,C),S.return=k,S)}function _(k,S,C){if(typeof S=="string"&&S!==""||typeof S=="number")return S=fm(""+S,k.mode,C),S.return=k,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Yu:return C=Ld(S.type,S.key,S.props,null,k.mode,C),C.ref=$l(k,null,S),C.return=k,C;case _a:return S=mm(S,k.mode,C),S.return=k,S;case qs:var U=S._init;return _(k,U(S._payload),C)}if(Gl(S)||Ol(S))return S=uo(S,k.mode,C,null),S.return=k,S;ld(k,S)}return null}function w(k,S,C,U){var F=S!==null?S.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return F!==null?null:h(k,S,""+C,U);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Yu:return C.key===F?f(k,S,C,U):null;case _a:return C.key===F?m(k,S,C,U):null;case qs:return F=C._init,w(k,S,F(C._payload),U)}if(Gl(C)||Ol(C))return F!==null?null:g(k,S,C,U,null);ld(k,C)}return null}function T(k,S,C,U,F){if(typeof U=="string"&&U!==""||typeof U=="number")return k=k.get(C)||null,h(S,k,""+U,F);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case Yu:return k=k.get(U.key===null?C:U.key)||null,f(S,k,U,F);case _a:return k=k.get(U.key===null?C:U.key)||null,m(S,k,U,F);case qs:var V=U._init;return T(k,S,C,V(U._payload),F)}if(Gl(U)||Ol(U))return k=k.get(C)||null,g(S,k,U,F,null);ld(S,U)}return null}function j(k,S,C,U){for(var F=null,V=null,E=S,N=S=0,R=null;E!==null&&N<C.length;N++){E.index>N?(R=E,E=null):R=E.sibling;var P=w(k,E,C[N],U);if(P===null){E===null&&(E=R);break}t&&E&&P.alternate===null&&e(k,E),S=o(P,S,N),V===null?F=P:V.sibling=P,V=P,E=R}if(N===C.length)return n(k,E),it&&no(k,N),F;if(E===null){for(;N<C.length;N++)E=_(k,C[N],U),E!==null&&(S=o(E,S,N),V===null?F=E:V.sibling=E,V=E);return it&&no(k,N),F}for(E=r(k,E);N<C.length;N++)R=T(E,k,N,C[N],U),R!==null&&(t&&R.alternate!==null&&E.delete(R.key===null?N:R.key),S=o(R,S,N),V===null?F=R:V.sibling=R,V=R);return t&&E.forEach(function(A){return e(k,A)}),it&&no(k,N),F}function D(k,S,C,U){var F=Ol(C);if(typeof F!="function")throw Error(se(150));if(C=F.call(C),C==null)throw Error(se(151));for(var V=F=null,E=S,N=S=0,R=null,P=C.next();E!==null&&!P.done;N++,P=C.next()){E.index>N?(R=E,E=null):R=E.sibling;var A=w(k,E,P.value,U);if(A===null){E===null&&(E=R);break}t&&E&&A.alternate===null&&e(k,E),S=o(A,S,N),V===null?F=A:V.sibling=A,V=A,E=R}if(P.done)return n(k,E),it&&no(k,N),F;if(E===null){for(;!P.done;N++,P=C.next())P=_(k,P.value,U),P!==null&&(S=o(P,S,N),V===null?F=P:V.sibling=P,V=P);return it&&no(k,N),F}for(E=r(k,E);!P.done;N++,P=C.next())P=T(E,k,N,P.value,U),P!==null&&(t&&P.alternate!==null&&E.delete(P.key===null?N:P.key),S=o(P,S,N),V===null?F=P:V.sibling=P,V=P);return t&&E.forEach(function($){return e(k,$)}),it&&no(k,N),F}function M(k,S,C,U){if(typeof C=="object"&&C!==null&&C.type===va&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case Yu:e:{for(var F=C.key,V=S;V!==null;){if(V.key===F){if(F=C.type,F===va){if(V.tag===7){n(k,V.sibling),S=s(V,C.props.children),S.return=k,k=S;break e}}else if(V.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===qs&&kv(F)===V.type){n(k,V.sibling),S=s(V,C.props),S.ref=$l(k,V,C),S.return=k,k=S;break e}n(k,V);break}else e(k,V);V=V.sibling}C.type===va?(S=uo(C.props.children,k.mode,U,C.key),S.return=k,k=S):(U=Ld(C.type,C.key,C.props,null,k.mode,U),U.ref=$l(k,S,C),U.return=k,k=U)}return l(k);case _a:e:{for(V=C.key;S!==null;){if(S.key===V)if(S.tag===4&&S.stateNode.containerInfo===C.containerInfo&&S.stateNode.implementation===C.implementation){n(k,S.sibling),S=s(S,C.children||[]),S.return=k,k=S;break e}else{n(k,S);break}else e(k,S);S=S.sibling}S=mm(C,k.mode,U),S.return=k,k=S}return l(k);case qs:return V=C._init,M(k,S,V(C._payload),U)}if(Gl(C))return j(k,S,C,U);if(Ol(C))return D(k,S,C,U);ld(k,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,S!==null&&S.tag===6?(n(k,S.sibling),S=s(S,C),S.return=k,k=S):(n(k,S),S=fm(C,k.mode,U),S.return=k,k=S),l(k)):n(k,S)}return M}var Ha=fb(!0),mb=fb(!1),sh=Ci(null),ih=null,ka=null,zg=null;function Mg(){zg=ka=ih=null}function Og(t){var e=sh.current;nt(sh),t._currentValue=e}function ap(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Da(t,e){ih=t,zg=ka=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Nn=!0),t.firstContext=null)}function nr(t){var e=t._currentValue;if(zg!==t)if(t={context:t,memoizedValue:e,next:null},ka===null){if(ih===null)throw Error(se(308));ka=t,ih.dependencies={lanes:0,firstContext:t}}else ka=ka.next=t;return e}var oo=null;function Vg(t){oo===null?oo=[t]:oo.push(t)}function pb(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Vg(e)):(n.next=s.next,s.next=n),e.interleaved=n,Ts(t,r)}function Ts(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Zs=!1;function Ug(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gb(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function _s(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ci(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ue&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Ts(t,n)}return s=r.interleaved,s===null?(e.next=e,Vg(r)):(e.next=s.next,s.next=e),r.interleaved=e,Ts(t,n)}function Sd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Tg(t,n)}}function Sv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=l:o=o.next=l,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function oh(t,e,n,r){var s=t.updateQueue;Zs=!1;var o=s.firstBaseUpdate,l=s.lastBaseUpdate,h=s.shared.pending;if(h!==null){s.shared.pending=null;var f=h,m=f.next;f.next=null,l===null?o=m:l.next=m,l=f;var g=t.alternate;g!==null&&(g=g.updateQueue,h=g.lastBaseUpdate,h!==l&&(h===null?g.firstBaseUpdate=m:h.next=m,g.lastBaseUpdate=f))}if(o!==null){var _=s.baseState;l=0,g=m=f=null,h=o;do{var w=h.lane,T=h.eventTime;if((r&w)===w){g!==null&&(g=g.next={eventTime:T,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,next:null});e:{var j=t,D=h;switch(w=e,T=n,D.tag){case 1:if(j=D.payload,typeof j=="function"){_=j.call(T,_,w);break e}_=j;break e;case 3:j.flags=j.flags&-65537|128;case 0:if(j=D.payload,w=typeof j=="function"?j.call(T,_,w):j,w==null)break e;_=ct({},_,w);break e;case 2:Zs=!0}}h.callback!==null&&h.lane!==0&&(t.flags|=64,w=s.effects,w===null?s.effects=[h]:w.push(h))}else T={eventTime:T,lane:w,tag:h.tag,payload:h.payload,callback:h.callback,next:null},g===null?(m=g=T,f=_):g=g.next=T,l|=w;if(h=h.next,h===null){if(h=s.shared.pending,h===null)break;w=h,h=w.next,w.next=null,s.lastBaseUpdate=w,s.shared.pending=null}}while(!0);if(g===null&&(f=_),s.baseState=f,s.firstBaseUpdate=m,s.lastBaseUpdate=g,e=s.shared.interleaved,e!==null){s=e;do l|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);vo|=l,t.lanes=l,t.memoizedState=_}}function Pv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(se(191,s));s.call(r)}}}var nu={},Ur=Ci(nu),Ac=Ci(nu),Rc=Ci(nu);function ao(t){if(t===nu)throw Error(se(174));return t}function Fg(t,e){switch(Xe(Rc,e),Xe(Ac,t),Xe(Ur,nu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Fm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Fm(e,t)}nt(Ur),Xe(Ur,e)}function qa(){nt(Ur),nt(Ac),nt(Rc)}function yb(t){ao(Rc.current);var e=ao(Ur.current),n=Fm(e,t.type);e!==n&&(Xe(Ac,t),Xe(Ur,n))}function Bg(t){Ac.current===t&&(nt(Ur),nt(Ac))}var ot=Ci(0);function ah(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var am=[];function $g(){for(var t=0;t<am.length;t++)am[t]._workInProgressVersionPrimary=null;am.length=0}var Pd=As.ReactCurrentDispatcher,lm=As.ReactCurrentBatchConfig,_o=0,lt=null,Pt=null,Ot=null,lh=!1,lc=!1,Lc=0,o2=0;function Kt(){throw Error(se(321))}function Wg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!gr(t[n],e[n]))return!1;return!0}function Hg(t,e,n,r,s,o){if(_o=o,lt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Pd.current=t===null||t.memoizedState===null?u2:d2,t=n(r,s),lc){o=0;do{if(lc=!1,Lc=0,25<=o)throw Error(se(301));o+=1,Ot=Pt=null,e.updateQueue=null,Pd.current=h2,t=n(r,s)}while(lc)}if(Pd.current=ch,e=Pt!==null&&Pt.next!==null,_o=0,Ot=Pt=lt=null,lh=!1,e)throw Error(se(300));return t}function qg(){var t=Lc!==0;return Lc=0,t}function Cr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ot===null?lt.memoizedState=Ot=t:Ot=Ot.next=t,Ot}function rr(){if(Pt===null){var t=lt.alternate;t=t!==null?t.memoizedState:null}else t=Pt.next;var e=Ot===null?lt.memoizedState:Ot.next;if(e!==null)Ot=e,Pt=t;else{if(t===null)throw Error(se(310));Pt=t,t={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},Ot===null?lt.memoizedState=Ot=t:Ot=Ot.next=t}return Ot}function Dc(t,e){return typeof e=="function"?e(t):e}function cm(t){var e=rr(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var r=Pt,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var l=s.next;s.next=o.next,o.next=l}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var h=l=null,f=null,m=o;do{var g=m.lane;if((_o&g)===g)f!==null&&(f=f.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),r=m.hasEagerState?m.eagerState:t(r,m.action);else{var _={lane:g,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};f===null?(h=f=_,l=r):f=f.next=_,lt.lanes|=g,vo|=g}m=m.next}while(m!==null&&m!==o);f===null?l=r:f.next=h,gr(r,e.memoizedState)||(Nn=!0),e.memoizedState=r,e.baseState=l,e.baseQueue=f,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do o=s.lane,lt.lanes|=o,vo|=o,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function um(t){var e=rr(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var l=s=s.next;do o=t(o,l.action),l=l.next;while(l!==s);gr(o,e.memoizedState)||(Nn=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function _b(){}function vb(t,e){var n=lt,r=rr(),s=e(),o=!gr(r.memoizedState,s);if(o&&(r.memoizedState=s,Nn=!0),r=r.queue,Zg(bb.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Ot!==null&&Ot.memoizedState.tag&1){if(n.flags|=2048,zc(9,wb.bind(null,n,r,s,e),void 0,null),Vt===null)throw Error(se(349));_o&30||xb(n,e,s)}return s}function xb(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=lt.updateQueue,e===null?(e={lastEffect:null,stores:null},lt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function wb(t,e,n,r){e.value=n,e.getSnapshot=r,Nb(e)&&Eb(t)}function bb(t,e,n){return n(function(){Nb(e)&&Eb(t)})}function Nb(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!gr(t,n)}catch{return!0}}function Eb(t){var e=Ts(t,1);e!==null&&pr(e,t,1,-1)}function Iv(t){var e=Cr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Dc,lastRenderedState:t},e.queue=t,t=t.dispatch=c2.bind(null,lt,t),[e.memoizedState,t]}function zc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=lt.updateQueue,e===null?(e={lastEffect:null,stores:null},lt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Tb(){return rr().memoizedState}function Id(t,e,n,r){var s=Cr();lt.flags|=t,s.memoizedState=zc(1|e,n,void 0,r===void 0?null:r)}function Wh(t,e,n,r){var s=rr();r=r===void 0?null:r;var o=void 0;if(Pt!==null){var l=Pt.memoizedState;if(o=l.destroy,r!==null&&Wg(r,l.deps)){s.memoizedState=zc(e,n,o,r);return}}lt.flags|=t,s.memoizedState=zc(1|e,n,o,r)}function Cv(t,e){return Id(8390656,8,t,e)}function Zg(t,e){return Wh(2048,8,t,e)}function jb(t,e){return Wh(4,2,t,e)}function kb(t,e){return Wh(4,4,t,e)}function Sb(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Pb(t,e,n){return n=n!=null?n.concat([t]):null,Wh(4,4,Sb.bind(null,e,t),n)}function Gg(){}function Ib(t,e){var n=rr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Cb(t,e){var n=rr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Ab(t,e,n){return _o&21?(gr(n,e)||(n=Mw(),lt.lanes|=n,vo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Nn=!0),t.memoizedState=n)}function a2(t,e){var n=Ge;Ge=n!==0&&4>n?n:4,t(!0);var r=lm.transition;lm.transition={};try{t(!1),e()}finally{Ge=n,lm.transition=r}}function Rb(){return rr().memoizedState}function l2(t,e,n){var r=di(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Lb(t))Db(e,n);else if(n=pb(t,e,n,r),n!==null){var s=dn();pr(n,t,r,s),zb(n,e,r)}}function c2(t,e,n){var r=di(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Lb(t))Db(e,s);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var l=e.lastRenderedState,h=o(l,n);if(s.hasEagerState=!0,s.eagerState=h,gr(h,l)){var f=e.interleaved;f===null?(s.next=s,Vg(e)):(s.next=f.next,f.next=s),e.interleaved=s;return}}catch{}finally{}n=pb(t,e,s,r),n!==null&&(s=dn(),pr(n,t,r,s),zb(n,e,r))}}function Lb(t){var e=t.alternate;return t===lt||e!==null&&e===lt}function Db(t,e){lc=lh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function zb(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Tg(t,n)}}var ch={readContext:nr,useCallback:Kt,useContext:Kt,useEffect:Kt,useImperativeHandle:Kt,useInsertionEffect:Kt,useLayoutEffect:Kt,useMemo:Kt,useReducer:Kt,useRef:Kt,useState:Kt,useDebugValue:Kt,useDeferredValue:Kt,useTransition:Kt,useMutableSource:Kt,useSyncExternalStore:Kt,useId:Kt,unstable_isNewReconciler:!1},u2={readContext:nr,useCallback:function(t,e){return Cr().memoizedState=[t,e===void 0?null:e],t},useContext:nr,useEffect:Cv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Id(4194308,4,Sb.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Id(4194308,4,t,e)},useInsertionEffect:function(t,e){return Id(4,2,t,e)},useMemo:function(t,e){var n=Cr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Cr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=l2.bind(null,lt,t),[r.memoizedState,t]},useRef:function(t){var e=Cr();return t={current:t},e.memoizedState=t},useState:Iv,useDebugValue:Gg,useDeferredValue:function(t){return Cr().memoizedState=t},useTransition:function(){var t=Iv(!1),e=t[0];return t=a2.bind(null,t[1]),Cr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=lt,s=Cr();if(it){if(n===void 0)throw Error(se(407));n=n()}else{if(n=e(),Vt===null)throw Error(se(349));_o&30||xb(r,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,Cv(bb.bind(null,r,o,t),[t]),r.flags|=2048,zc(9,wb.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=Cr(),e=Vt.identifierPrefix;if(it){var n=ms,r=fs;n=(r&~(1<<32-mr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Lc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=o2++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},d2={readContext:nr,useCallback:Ib,useContext:nr,useEffect:Zg,useImperativeHandle:Pb,useInsertionEffect:jb,useLayoutEffect:kb,useMemo:Cb,useReducer:cm,useRef:Tb,useState:function(){return cm(Dc)},useDebugValue:Gg,useDeferredValue:function(t){var e=rr();return Ab(e,Pt.memoizedState,t)},useTransition:function(){var t=cm(Dc)[0],e=rr().memoizedState;return[t,e]},useMutableSource:_b,useSyncExternalStore:vb,useId:Rb,unstable_isNewReconciler:!1},h2={readContext:nr,useCallback:Ib,useContext:nr,useEffect:Zg,useImperativeHandle:Pb,useInsertionEffect:jb,useLayoutEffect:kb,useMemo:Cb,useReducer:um,useRef:Tb,useState:function(){return um(Dc)},useDebugValue:Gg,useDeferredValue:function(t){var e=rr();return Pt===null?e.memoizedState=t:Ab(e,Pt.memoizedState,t)},useTransition:function(){var t=um(Dc)[0],e=rr().memoizedState;return[t,e]},useMutableSource:_b,useSyncExternalStore:vb,useId:Rb,unstable_isNewReconciler:!1};function ur(t,e){if(t&&t.defaultProps){e=ct({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function lp(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ct({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Hh={isMounted:function(t){return(t=t._reactInternals)?Co(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=dn(),s=di(t),o=_s(r,s);o.payload=e,n!=null&&(o.callback=n),e=ci(t,o,s),e!==null&&(pr(e,t,s,r),Sd(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=dn(),s=di(t),o=_s(r,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=ci(t,o,s),e!==null&&(pr(e,t,s,r),Sd(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=dn(),r=di(t),s=_s(n,r);s.tag=2,e!=null&&(s.callback=e),e=ci(t,s,r),e!==null&&(pr(e,t,r,n),Sd(e,t,r))}};function Av(t,e,n,r,s,o,l){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,l):e.prototype&&e.prototype.isPureReactComponent?!Sc(n,r)||!Sc(s,o):!0}function Mb(t,e,n){var r=!1,s=xi,o=e.contextType;return typeof o=="object"&&o!==null?o=nr(o):(s=Tn(e)?go:nn.current,r=e.contextTypes,o=(r=r!=null)?$a(t,s):xi),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Hh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function Rv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Hh.enqueueReplaceState(e,e.state,null)}function cp(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Ug(t);var o=e.contextType;typeof o=="object"&&o!==null?s.context=nr(o):(o=Tn(e)?go:nn.current,s.context=$a(t,o)),s.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(lp(t,e,o,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Hh.enqueueReplaceState(s,s.state,null),oh(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Za(t,e){try{var n="",r=e;do n+=Uj(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:s,digest:null}}function dm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function up(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var f2=typeof WeakMap=="function"?WeakMap:Map;function Ob(t,e,n){n=_s(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){dh||(dh=!0,xp=r),up(t,e)},n}function Vb(t,e,n){n=_s(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){up(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){up(t,e),typeof r!="function"&&(ui===null?ui=new Set([this]):ui.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),n}function Lv(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new f2;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=k2.bind(null,t,e,n),e.then(t,t))}function Dv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function zv(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=_s(-1,1),e.tag=2,ci(n,e,1))),n.lanes|=1),t)}var m2=As.ReactCurrentOwner,Nn=!1;function un(t,e,n,r){e.child=t===null?mb(e,null,n,r):Ha(e,t.child,n,r)}function Mv(t,e,n,r,s){n=n.render;var o=e.ref;return Da(e,s),r=Hg(t,e,n,r,o,s),n=qg(),t!==null&&!Nn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,js(t,e,s)):(it&&n&&Rg(e),e.flags|=1,un(t,e,r,s),e.child)}function Ov(t,e,n,r,s){if(t===null){var o=n.type;return typeof o=="function"&&!ny(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,Ub(t,e,o,r,s)):(t=Ld(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&s)){var l=o.memoizedProps;if(n=n.compare,n=n!==null?n:Sc,n(l,r)&&t.ref===e.ref)return js(t,e,s)}return e.flags|=1,t=hi(o,r),t.ref=e.ref,t.return=e,e.child=t}function Ub(t,e,n,r,s){if(t!==null){var o=t.memoizedProps;if(Sc(o,r)&&t.ref===e.ref)if(Nn=!1,e.pendingProps=r=o,(t.lanes&s)!==0)t.flags&131072&&(Nn=!0);else return e.lanes=t.lanes,js(t,e,s)}return dp(t,e,n,r,s)}function Fb(t,e,n){var r=e.pendingProps,s=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xe(Pa,An),An|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Xe(Pa,An),An|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Xe(Pa,An),An|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,Xe(Pa,An),An|=r;return un(t,e,s,n),e.child}function Bb(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function dp(t,e,n,r,s){var o=Tn(n)?go:nn.current;return o=$a(e,o),Da(e,s),n=Hg(t,e,n,r,o,s),r=qg(),t!==null&&!Nn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,js(t,e,s)):(it&&r&&Rg(e),e.flags|=1,un(t,e,n,s),e.child)}function Vv(t,e,n,r,s){if(Tn(n)){var o=!0;th(e)}else o=!1;if(Da(e,s),e.stateNode===null)Cd(t,e),Mb(e,n,r),cp(e,n,r,s),r=!0;else if(t===null){var l=e.stateNode,h=e.memoizedProps;l.props=h;var f=l.context,m=n.contextType;typeof m=="object"&&m!==null?m=nr(m):(m=Tn(n)?go:nn.current,m=$a(e,m));var g=n.getDerivedStateFromProps,_=typeof g=="function"||typeof l.getSnapshotBeforeUpdate=="function";_||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(h!==r||f!==m)&&Rv(e,l,r,m),Zs=!1;var w=e.memoizedState;l.state=w,oh(e,r,l,s),f=e.memoizedState,h!==r||w!==f||En.current||Zs?(typeof g=="function"&&(lp(e,n,g,r),f=e.memoizedState),(h=Zs||Av(e,n,h,r,w,f,m))?(_||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=f),l.props=r,l.state=f,l.context=m,r=h):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{l=e.stateNode,gb(t,e),h=e.memoizedProps,m=e.type===e.elementType?h:ur(e.type,h),l.props=m,_=e.pendingProps,w=l.context,f=n.contextType,typeof f=="object"&&f!==null?f=nr(f):(f=Tn(n)?go:nn.current,f=$a(e,f));var T=n.getDerivedStateFromProps;(g=typeof T=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(h!==_||w!==f)&&Rv(e,l,r,f),Zs=!1,w=e.memoizedState,l.state=w,oh(e,r,l,s);var j=e.memoizedState;h!==_||w!==j||En.current||Zs?(typeof T=="function"&&(lp(e,n,T,r),j=e.memoizedState),(m=Zs||Av(e,n,m,r,w,j,f)||!1)?(g||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,j,f),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,j,f)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||h===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||h===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=j),l.props=r,l.state=j,l.context=f,r=m):(typeof l.componentDidUpdate!="function"||h===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||h===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),r=!1)}return hp(t,e,n,r,o,s)}function hp(t,e,n,r,s,o){Bb(t,e);var l=(e.flags&128)!==0;if(!r&&!l)return s&&Ev(e,n,!1),js(t,e,o);r=e.stateNode,m2.current=e;var h=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&l?(e.child=Ha(e,t.child,null,o),e.child=Ha(e,null,h,o)):un(t,e,h,o),e.memoizedState=r.state,s&&Ev(e,n,!0),e.child}function $b(t){var e=t.stateNode;e.pendingContext?Nv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Nv(t,e.context,!1),Fg(t,e.containerInfo)}function Uv(t,e,n,r,s){return Wa(),Dg(s),e.flags|=256,un(t,e,n,r),e.child}var fp={dehydrated:null,treeContext:null,retryLane:0};function mp(t){return{baseLanes:t,cachePool:null,transitions:null}}function Wb(t,e,n){var r=e.pendingProps,s=ot.current,o=!1,l=(e.flags&128)!==0,h;if((h=l)||(h=t!==null&&t.memoizedState===null?!1:(s&2)!==0),h?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Xe(ot,s&1),t===null)return op(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=r.children,t=r.fallback,o?(r=e.mode,o=e.child,l={mode:"hidden",children:l},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=l):o=Gh(l,r,0,null),t=uo(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=mp(n),e.memoizedState=fp,t):Kg(e,l));if(s=t.memoizedState,s!==null&&(h=s.dehydrated,h!==null))return p2(t,e,l,r,h,s,n);if(o){o=r.fallback,l=e.mode,s=t.child,h=s.sibling;var f={mode:"hidden",children:r.children};return!(l&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=f,e.deletions=null):(r=hi(s,f),r.subtreeFlags=s.subtreeFlags&14680064),h!==null?o=hi(h,o):(o=uo(o,l,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,l=t.child.memoizedState,l=l===null?mp(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=t.childLanes&~n,e.memoizedState=fp,r}return o=t.child,t=o.sibling,r=hi(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Kg(t,e){return e=Gh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function cd(t,e,n,r){return r!==null&&Dg(r),Ha(e,t.child,null,n),t=Kg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function p2(t,e,n,r,s,o,l){if(n)return e.flags&256?(e.flags&=-257,r=dm(Error(se(422))),cd(t,e,l,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=Gh({mode:"visible",children:r.children},s,0,null),o=uo(o,s,l,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&Ha(e,t.child,null,l),e.child.memoizedState=mp(l),e.memoizedState=fp,o);if(!(e.mode&1))return cd(t,e,l,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var h=r.dgst;return r=h,o=Error(se(419)),r=dm(o,r,void 0),cd(t,e,l,r)}if(h=(l&t.childLanes)!==0,Nn||h){if(r=Vt,r!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|l)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,Ts(t,s),pr(r,t,s,-1))}return ty(),r=dm(Error(se(421))),cd(t,e,l,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=S2.bind(null,t),s._reactRetry=e,null):(t=o.treeContext,Ln=li(s.nextSibling),Mn=e,it=!0,hr=null,t!==null&&(Gn[Kn++]=fs,Gn[Kn++]=ms,Gn[Kn++]=yo,fs=t.id,ms=t.overflow,yo=e),e=Kg(e,r.children),e.flags|=4096,e)}function Fv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),ap(t.return,e,n)}function hm(t,e,n,r,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function Hb(t,e,n){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(un(t,e,r.children,n),r=ot.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Fv(t,n,e);else if(t.tag===19)Fv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Xe(ot,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&ah(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),hm(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&ah(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}hm(e,!0,n,null,o);break;case"together":hm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Cd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function js(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),vo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(se(153));if(e.child!==null){for(t=e.child,n=hi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=hi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function g2(t,e,n){switch(e.tag){case 3:$b(e),Wa();break;case 5:yb(e);break;case 1:Tn(e.type)&&th(e);break;case 4:Fg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Xe(sh,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Xe(ot,ot.current&1),e.flags|=128,null):n&e.child.childLanes?Wb(t,e,n):(Xe(ot,ot.current&1),t=js(t,e,n),t!==null?t.sibling:null);Xe(ot,ot.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Hb(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Xe(ot,ot.current),r)break;return null;case 22:case 23:return e.lanes=0,Fb(t,e,n)}return js(t,e,n)}var qb,pp,Zb,Gb;qb=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};pp=function(){};Zb=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ao(Ur.current);var o=null;switch(n){case"input":s=Mm(t,s),r=Mm(t,r),o=[];break;case"select":s=ct({},s,{value:void 0}),r=ct({},r,{value:void 0}),o=[];break;case"textarea":s=Um(t,s),r=Um(t,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Jd)}Bm(n,r);var l;n=null;for(m in s)if(!r.hasOwnProperty(m)&&s.hasOwnProperty(m)&&s[m]!=null)if(m==="style"){var h=s[m];for(l in h)h.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(wc.hasOwnProperty(m)?o||(o=[]):(o=o||[]).push(m,null));for(m in r){var f=r[m];if(h=s!=null?s[m]:void 0,r.hasOwnProperty(m)&&f!==h&&(f!=null||h!=null))if(m==="style")if(h){for(l in h)!h.hasOwnProperty(l)||f&&f.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in f)f.hasOwnProperty(l)&&h[l]!==f[l]&&(n||(n={}),n[l]=f[l])}else n||(o||(o=[]),o.push(m,n)),n=f;else m==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,h=h?h.__html:void 0,f!=null&&h!==f&&(o=o||[]).push(m,f)):m==="children"?typeof f!="string"&&typeof f!="number"||(o=o||[]).push(m,""+f):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(wc.hasOwnProperty(m)?(f!=null&&m==="onScroll"&&et("scroll",t),o||h===f||(o=[])):(o=o||[]).push(m,f))}n&&(o=o||[]).push("style",n);var m=o;(e.updateQueue=m)&&(e.flags|=4)}};Gb=function(t,e,n,r){n!==r&&(e.flags|=4)};function Wl(t,e){if(!it)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Qt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function y2(t,e,n){var r=e.pendingProps;switch(Lg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(e),null;case 1:return Tn(e.type)&&eh(),Qt(e),null;case 3:return r=e.stateNode,qa(),nt(En),nt(nn),$g(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ad(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,hr!==null&&(Np(hr),hr=null))),pp(t,e),Qt(e),null;case 5:Bg(e);var s=ao(Rc.current);if(n=e.type,t!==null&&e.stateNode!=null)Zb(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(se(166));return Qt(e),null}if(t=ao(Ur.current),ad(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Rr]=e,r[Cc]=o,t=(e.mode&1)!==0,n){case"dialog":et("cancel",r),et("close",r);break;case"iframe":case"object":case"embed":et("load",r);break;case"video":case"audio":for(s=0;s<Ql.length;s++)et(Ql[s],r);break;case"source":et("error",r);break;case"img":case"image":case"link":et("error",r),et("load",r);break;case"details":et("toggle",r);break;case"input":Q_(r,o),et("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},et("invalid",r);break;case"textarea":X_(r,o),et("invalid",r)}Bm(n,o),s=null;for(var l in o)if(o.hasOwnProperty(l)){var h=o[l];l==="children"?typeof h=="string"?r.textContent!==h&&(o.suppressHydrationWarning!==!0&&od(r.textContent,h,t),s=["children",h]):typeof h=="number"&&r.textContent!==""+h&&(o.suppressHydrationWarning!==!0&&od(r.textContent,h,t),s=["children",""+h]):wc.hasOwnProperty(l)&&h!=null&&l==="onScroll"&&et("scroll",r)}switch(n){case"input":Xu(r),Y_(r,o,!0);break;case"textarea":Xu(r),J_(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Jd)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=bw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=l.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=l.createElement(n,{is:r.is}):(t=l.createElement(n),n==="select"&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,n),t[Rr]=e,t[Cc]=r,qb(t,e,!1,!1),e.stateNode=t;e:{switch(l=$m(n,r),n){case"dialog":et("cancel",t),et("close",t),s=r;break;case"iframe":case"object":case"embed":et("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ql.length;s++)et(Ql[s],t);s=r;break;case"source":et("error",t),s=r;break;case"img":case"image":case"link":et("error",t),et("load",t),s=r;break;case"details":et("toggle",t),s=r;break;case"input":Q_(t,r),s=Mm(t,r),et("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=ct({},r,{value:void 0}),et("invalid",t);break;case"textarea":X_(t,r),s=Um(t,r),et("invalid",t);break;default:s=r}Bm(n,s),h=s;for(o in h)if(h.hasOwnProperty(o)){var f=h[o];o==="style"?Tw(t,f):o==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,f!=null&&Nw(t,f)):o==="children"?typeof f=="string"?(n!=="textarea"||f!=="")&&bc(t,f):typeof f=="number"&&bc(t,""+f):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(wc.hasOwnProperty(o)?f!=null&&o==="onScroll"&&et("scroll",t):f!=null&&vg(t,o,f,l))}switch(n){case"input":Xu(t),Y_(t,r,!1);break;case"textarea":Xu(t),J_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+vi(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?Ca(t,!!r.multiple,o,!1):r.defaultValue!=null&&Ca(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Jd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Qt(e),null;case 6:if(t&&e.stateNode!=null)Gb(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(se(166));if(n=ao(Rc.current),ao(Ur.current),ad(e)){if(r=e.stateNode,n=e.memoizedProps,r[Rr]=e,(o=r.nodeValue!==n)&&(t=Mn,t!==null))switch(t.tag){case 3:od(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&od(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Rr]=e,e.stateNode=r}return Qt(e),null;case 13:if(nt(ot),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(it&&Ln!==null&&e.mode&1&&!(e.flags&128))hb(),Wa(),e.flags|=98560,o=!1;else if(o=ad(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(se(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(se(317));o[Rr]=e}else Wa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Qt(e),o=!1}else hr!==null&&(Np(hr),hr=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ot.current&1?It===0&&(It=3):ty())),e.updateQueue!==null&&(e.flags|=4),Qt(e),null);case 4:return qa(),pp(t,e),t===null&&Pc(e.stateNode.containerInfo),Qt(e),null;case 10:return Og(e.type._context),Qt(e),null;case 17:return Tn(e.type)&&eh(),Qt(e),null;case 19:if(nt(ot),o=e.memoizedState,o===null)return Qt(e),null;if(r=(e.flags&128)!==0,l=o.rendering,l===null)if(r)Wl(o,!1);else{if(It!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(l=ah(t),l!==null){for(e.flags|=128,Wl(o,!1),r=l.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,l=o.alternate,l===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,t=l.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Xe(ot,ot.current&1|2),e.child}t=t.sibling}o.tail!==null&&_t()>Ga&&(e.flags|=128,r=!0,Wl(o,!1),e.lanes=4194304)}else{if(!r)if(t=ah(l),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Wl(o,!0),o.tail===null&&o.tailMode==="hidden"&&!l.alternate&&!it)return Qt(e),null}else 2*_t()-o.renderingStartTime>Ga&&n!==1073741824&&(e.flags|=128,r=!0,Wl(o,!1),e.lanes=4194304);o.isBackwards?(l.sibling=e.child,e.child=l):(n=o.last,n!==null?n.sibling=l:e.child=l,o.last=l)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=_t(),e.sibling=null,n=ot.current,Xe(ot,r?n&1|2:n&1),e):(Qt(e),null);case 22:case 23:return ey(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?An&1073741824&&(Qt(e),e.subtreeFlags&6&&(e.flags|=8192)):Qt(e),null;case 24:return null;case 25:return null}throw Error(se(156,e.tag))}function _2(t,e){switch(Lg(e),e.tag){case 1:return Tn(e.type)&&eh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return qa(),nt(En),nt(nn),$g(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Bg(e),null;case 13:if(nt(ot),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(se(340));Wa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return nt(ot),null;case 4:return qa(),null;case 10:return Og(e.type._context),null;case 22:case 23:return ey(),null;case 24:return null;default:return null}}var ud=!1,Jt=!1,v2=typeof WeakSet=="function"?WeakSet:Set,fe=null;function Sa(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ht(t,e,r)}else n.current=null}function gp(t,e,n){try{n()}catch(r){ht(t,e,r)}}var Bv=!1;function x2(t,e){if(Jm=Qd,t=Jw(),Ag(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var l=0,h=-1,f=-1,m=0,g=0,_=t,w=null;t:for(;;){for(var T;_!==n||s!==0&&_.nodeType!==3||(h=l+s),_!==o||r!==0&&_.nodeType!==3||(f=l+r),_.nodeType===3&&(l+=_.nodeValue.length),(T=_.firstChild)!==null;)w=_,_=T;for(;;){if(_===t)break t;if(w===n&&++m===s&&(h=l),w===o&&++g===r&&(f=l),(T=_.nextSibling)!==null)break;_=w,w=_.parentNode}_=T}n=h===-1||f===-1?null:{start:h,end:f}}else n=null}n=n||{start:0,end:0}}else n=null;for(ep={focusedElem:t,selectionRange:n},Qd=!1,fe=e;fe!==null;)if(e=fe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,fe=t;else for(;fe!==null;){e=fe;try{var j=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var D=j.memoizedProps,M=j.memoizedState,k=e.stateNode,S=k.getSnapshotBeforeUpdate(e.elementType===e.type?D:ur(e.type,D),M);k.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(se(163))}}catch(U){ht(e,e.return,U)}if(t=e.sibling,t!==null){t.return=e.return,fe=t;break}fe=e.return}return j=Bv,Bv=!1,j}function cc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,o!==void 0&&gp(e,n,o)}s=s.next}while(s!==r)}}function qh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function yp(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Kb(t){var e=t.alternate;e!==null&&(t.alternate=null,Kb(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Rr],delete e[Cc],delete e[rp],delete e[n2],delete e[r2])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Qb(t){return t.tag===5||t.tag===3||t.tag===4}function $v(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Qb(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function _p(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Jd));else if(r!==4&&(t=t.child,t!==null))for(_p(t,e,n),t=t.sibling;t!==null;)_p(t,e,n),t=t.sibling}function vp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(vp(t,e,n),t=t.sibling;t!==null;)vp(t,e,n),t=t.sibling}var Ut=null,dr=!1;function $s(t,e,n){for(n=n.child;n!==null;)Yb(t,e,n),n=n.sibling}function Yb(t,e,n){if(Vr&&typeof Vr.onCommitFiberUnmount=="function")try{Vr.onCommitFiberUnmount(Oh,n)}catch{}switch(n.tag){case 5:Jt||Sa(n,e);case 6:var r=Ut,s=dr;Ut=null,$s(t,e,n),Ut=r,dr=s,Ut!==null&&(dr?(t=Ut,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ut.removeChild(n.stateNode));break;case 18:Ut!==null&&(dr?(t=Ut,n=n.stateNode,t.nodeType===8?im(t.parentNode,n):t.nodeType===1&&im(t,n),jc(t)):im(Ut,n.stateNode));break;case 4:r=Ut,s=dr,Ut=n.stateNode.containerInfo,dr=!0,$s(t,e,n),Ut=r,dr=s;break;case 0:case 11:case 14:case 15:if(!Jt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,l=o.destroy;o=o.tag,l!==void 0&&(o&2||o&4)&&gp(n,e,l),s=s.next}while(s!==r)}$s(t,e,n);break;case 1:if(!Jt&&(Sa(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(h){ht(n,e,h)}$s(t,e,n);break;case 21:$s(t,e,n);break;case 22:n.mode&1?(Jt=(r=Jt)||n.memoizedState!==null,$s(t,e,n),Jt=r):$s(t,e,n);break;default:$s(t,e,n)}}function Wv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new v2),e.forEach(function(r){var s=P2.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function cr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=t,l=e,h=l;e:for(;h!==null;){switch(h.tag){case 5:Ut=h.stateNode,dr=!1;break e;case 3:Ut=h.stateNode.containerInfo,dr=!0;break e;case 4:Ut=h.stateNode.containerInfo,dr=!0;break e}h=h.return}if(Ut===null)throw Error(se(160));Yb(o,l,s),Ut=null,dr=!1;var f=s.alternate;f!==null&&(f.return=null),s.return=null}catch(m){ht(s,e,m)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Xb(e,t),e=e.sibling}function Xb(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(cr(e,t),Pr(t),r&4){try{cc(3,t,t.return),qh(3,t)}catch(D){ht(t,t.return,D)}try{cc(5,t,t.return)}catch(D){ht(t,t.return,D)}}break;case 1:cr(e,t),Pr(t),r&512&&n!==null&&Sa(n,n.return);break;case 5:if(cr(e,t),Pr(t),r&512&&n!==null&&Sa(n,n.return),t.flags&32){var s=t.stateNode;try{bc(s,"")}catch(D){ht(t,t.return,D)}}if(r&4&&(s=t.stateNode,s!=null)){var o=t.memoizedProps,l=n!==null?n.memoizedProps:o,h=t.type,f=t.updateQueue;if(t.updateQueue=null,f!==null)try{h==="input"&&o.type==="radio"&&o.name!=null&&xw(s,o),$m(h,l);var m=$m(h,o);for(l=0;l<f.length;l+=2){var g=f[l],_=f[l+1];g==="style"?Tw(s,_):g==="dangerouslySetInnerHTML"?Nw(s,_):g==="children"?bc(s,_):vg(s,g,_,m)}switch(h){case"input":Om(s,o);break;case"textarea":ww(s,o);break;case"select":var w=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var T=o.value;T!=null?Ca(s,!!o.multiple,T,!1):w!==!!o.multiple&&(o.defaultValue!=null?Ca(s,!!o.multiple,o.defaultValue,!0):Ca(s,!!o.multiple,o.multiple?[]:"",!1))}s[Cc]=o}catch(D){ht(t,t.return,D)}}break;case 6:if(cr(e,t),Pr(t),r&4){if(t.stateNode===null)throw Error(se(162));s=t.stateNode,o=t.memoizedProps;try{s.nodeValue=o}catch(D){ht(t,t.return,D)}}break;case 3:if(cr(e,t),Pr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{jc(e.containerInfo)}catch(D){ht(t,t.return,D)}break;case 4:cr(e,t),Pr(t);break;case 13:cr(e,t),Pr(t),s=t.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(Xg=_t())),r&4&&Wv(t);break;case 22:if(g=n!==null&&n.memoizedState!==null,t.mode&1?(Jt=(m=Jt)||g,cr(e,t),Jt=m):cr(e,t),Pr(t),r&8192){if(m=t.memoizedState!==null,(t.stateNode.isHidden=m)&&!g&&t.mode&1)for(fe=t,g=t.child;g!==null;){for(_=fe=g;fe!==null;){switch(w=fe,T=w.child,w.tag){case 0:case 11:case 14:case 15:cc(4,w,w.return);break;case 1:Sa(w,w.return);var j=w.stateNode;if(typeof j.componentWillUnmount=="function"){r=w,n=w.return;try{e=r,j.props=e.memoizedProps,j.state=e.memoizedState,j.componentWillUnmount()}catch(D){ht(r,n,D)}}break;case 5:Sa(w,w.return);break;case 22:if(w.memoizedState!==null){qv(_);continue}}T!==null?(T.return=w,fe=T):qv(_)}g=g.sibling}e:for(g=null,_=t;;){if(_.tag===5){if(g===null){g=_;try{s=_.stateNode,m?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(h=_.stateNode,f=_.memoizedProps.style,l=f!=null&&f.hasOwnProperty("display")?f.display:null,h.style.display=Ew("display",l))}catch(D){ht(t,t.return,D)}}}else if(_.tag===6){if(g===null)try{_.stateNode.nodeValue=m?"":_.memoizedProps}catch(D){ht(t,t.return,D)}}else if((_.tag!==22&&_.tag!==23||_.memoizedState===null||_===t)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===t)break e;for(;_.sibling===null;){if(_.return===null||_.return===t)break e;g===_&&(g=null),_=_.return}g===_&&(g=null),_.sibling.return=_.return,_=_.sibling}}break;case 19:cr(e,t),Pr(t),r&4&&Wv(t);break;case 21:break;default:cr(e,t),Pr(t)}}function Pr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Qb(n)){var r=n;break e}n=n.return}throw Error(se(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(bc(s,""),r.flags&=-33);var o=$v(t);vp(t,o,s);break;case 3:case 4:var l=r.stateNode.containerInfo,h=$v(t);_p(t,h,l);break;default:throw Error(se(161))}}catch(f){ht(t,t.return,f)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function w2(t,e,n){fe=t,Jb(t)}function Jb(t,e,n){for(var r=(t.mode&1)!==0;fe!==null;){var s=fe,o=s.child;if(s.tag===22&&r){var l=s.memoizedState!==null||ud;if(!l){var h=s.alternate,f=h!==null&&h.memoizedState!==null||Jt;h=ud;var m=Jt;if(ud=l,(Jt=f)&&!m)for(fe=s;fe!==null;)l=fe,f=l.child,l.tag===22&&l.memoizedState!==null?Zv(s):f!==null?(f.return=l,fe=f):Zv(s);for(;o!==null;)fe=o,Jb(o),o=o.sibling;fe=s,ud=h,Jt=m}Hv(t)}else s.subtreeFlags&8772&&o!==null?(o.return=s,fe=o):Hv(t)}}function Hv(t){for(;fe!==null;){var e=fe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Jt||qh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Jt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:ur(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Pv(e,o,r);break;case 3:var l=e.updateQueue;if(l!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Pv(e,l,n)}break;case 5:var h=e.stateNode;if(n===null&&e.flags&4){n=h;var f=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":f.autoFocus&&n.focus();break;case"img":f.src&&(n.src=f.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var m=e.alternate;if(m!==null){var g=m.memoizedState;if(g!==null){var _=g.dehydrated;_!==null&&jc(_)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(se(163))}Jt||e.flags&512&&yp(e)}catch(w){ht(e,e.return,w)}}if(e===t){fe=null;break}if(n=e.sibling,n!==null){n.return=e.return,fe=n;break}fe=e.return}}function qv(t){for(;fe!==null;){var e=fe;if(e===t){fe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,fe=n;break}fe=e.return}}function Zv(t){for(;fe!==null;){var e=fe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{qh(4,e)}catch(f){ht(e,n,f)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(f){ht(e,s,f)}}var o=e.return;try{yp(e)}catch(f){ht(e,o,f)}break;case 5:var l=e.return;try{yp(e)}catch(f){ht(e,l,f)}}}catch(f){ht(e,e.return,f)}if(e===t){fe=null;break}var h=e.sibling;if(h!==null){h.return=e.return,fe=h;break}fe=e.return}}var b2=Math.ceil,uh=As.ReactCurrentDispatcher,Qg=As.ReactCurrentOwner,er=As.ReactCurrentBatchConfig,Ue=0,Vt=null,jt=null,Ht=0,An=0,Pa=Ci(0),It=0,Mc=null,vo=0,Zh=0,Yg=0,uc=null,xn=null,Xg=0,Ga=1/0,ds=null,dh=!1,xp=null,ui=null,dd=!1,ni=null,hh=0,dc=0,wp=null,Ad=-1,Rd=0;function dn(){return Ue&6?_t():Ad!==-1?Ad:Ad=_t()}function di(t){return t.mode&1?Ue&2&&Ht!==0?Ht&-Ht:i2.transition!==null?(Rd===0&&(Rd=Mw()),Rd):(t=Ge,t!==0||(t=window.event,t=t===void 0?16:Ww(t.type)),t):1}function pr(t,e,n,r){if(50<dc)throw dc=0,wp=null,Error(se(185));Jc(t,n,r),(!(Ue&2)||t!==Vt)&&(t===Vt&&(!(Ue&2)&&(Zh|=n),It===4&&Ks(t,Ht)),jn(t,r),n===1&&Ue===0&&!(e.mode&1)&&(Ga=_t()+500,$h&&Ai()))}function jn(t,e){var n=t.callbackNode;ik(t,e);var r=Kd(t,t===Vt?Ht:0);if(r===0)n!==null&&nv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&nv(n),e===1)t.tag===0?s2(Gv.bind(null,t)):cb(Gv.bind(null,t)),e2(function(){!(Ue&6)&&Ai()}),n=null;else{switch(Ow(r)){case 1:n=Eg;break;case 4:n=Dw;break;case 16:n=Gd;break;case 536870912:n=zw;break;default:n=Gd}n=a1(n,e1.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function e1(t,e){if(Ad=-1,Rd=0,Ue&6)throw Error(se(327));var n=t.callbackNode;if(za()&&t.callbackNode!==n)return null;var r=Kd(t,t===Vt?Ht:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=fh(t,r);else{e=r;var s=Ue;Ue|=2;var o=n1();(Vt!==t||Ht!==e)&&(ds=null,Ga=_t()+500,co(t,e));do try{T2();break}catch(h){t1(t,h)}while(!0);Mg(),uh.current=o,Ue=s,jt!==null?e=0:(Vt=null,Ht=0,e=It)}if(e!==0){if(e===2&&(s=Gm(t),s!==0&&(r=s,e=bp(t,s))),e===1)throw n=Mc,co(t,0),Ks(t,r),jn(t,_t()),n;if(e===6)Ks(t,r);else{if(s=t.current.alternate,!(r&30)&&!N2(s)&&(e=fh(t,r),e===2&&(o=Gm(t),o!==0&&(r=o,e=bp(t,o))),e===1))throw n=Mc,co(t,0),Ks(t,r),jn(t,_t()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(se(345));case 2:ro(t,xn,ds);break;case 3:if(Ks(t,r),(r&130023424)===r&&(e=Xg+500-_t(),10<e)){if(Kd(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){dn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=np(ro.bind(null,t,xn,ds),e);break}ro(t,xn,ds);break;case 4:if(Ks(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var l=31-mr(r);o=1<<l,l=e[l],l>s&&(s=l),r&=~o}if(r=s,r=_t()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*b2(r/1960))-r,10<r){t.timeoutHandle=np(ro.bind(null,t,xn,ds),r);break}ro(t,xn,ds);break;case 5:ro(t,xn,ds);break;default:throw Error(se(329))}}}return jn(t,_t()),t.callbackNode===n?e1.bind(null,t):null}function bp(t,e){var n=uc;return t.current.memoizedState.isDehydrated&&(co(t,e).flags|=256),t=fh(t,e),t!==2&&(e=xn,xn=n,e!==null&&Np(e)),t}function Np(t){xn===null?xn=t:xn.push.apply(xn,t)}function N2(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!gr(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ks(t,e){for(e&=~Yg,e&=~Zh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-mr(e),r=1<<n;t[n]=-1,e&=~r}}function Gv(t){if(Ue&6)throw Error(se(327));za();var e=Kd(t,0);if(!(e&1))return jn(t,_t()),null;var n=fh(t,e);if(t.tag!==0&&n===2){var r=Gm(t);r!==0&&(e=r,n=bp(t,r))}if(n===1)throw n=Mc,co(t,0),Ks(t,e),jn(t,_t()),n;if(n===6)throw Error(se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ro(t,xn,ds),jn(t,_t()),null}function Jg(t,e){var n=Ue;Ue|=1;try{return t(e)}finally{Ue=n,Ue===0&&(Ga=_t()+500,$h&&Ai())}}function xo(t){ni!==null&&ni.tag===0&&!(Ue&6)&&za();var e=Ue;Ue|=1;var n=er.transition,r=Ge;try{if(er.transition=null,Ge=1,t)return t()}finally{Ge=r,er.transition=n,Ue=e,!(Ue&6)&&Ai()}}function ey(){An=Pa.current,nt(Pa)}function co(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Jk(n)),jt!==null)for(n=jt.return;n!==null;){var r=n;switch(Lg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&eh();break;case 3:qa(),nt(En),nt(nn),$g();break;case 5:Bg(r);break;case 4:qa();break;case 13:nt(ot);break;case 19:nt(ot);break;case 10:Og(r.type._context);break;case 22:case 23:ey()}n=n.return}if(Vt=t,jt=t=hi(t.current,null),Ht=An=e,It=0,Mc=null,Yg=Zh=vo=0,xn=uc=null,oo!==null){for(e=0;e<oo.length;e++)if(n=oo[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var l=o.next;o.next=s,r.next=l}n.pending=r}oo=null}return t}function t1(t,e){do{var n=jt;try{if(Mg(),Pd.current=ch,lh){for(var r=lt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}lh=!1}if(_o=0,Ot=Pt=lt=null,lc=!1,Lc=0,Qg.current=null,n===null||n.return===null){It=1,Mc=e,jt=null;break}e:{var o=t,l=n.return,h=n,f=e;if(e=Ht,h.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){var m=f,g=h,_=g.tag;if(!(g.mode&1)&&(_===0||_===11||_===15)){var w=g.alternate;w?(g.updateQueue=w.updateQueue,g.memoizedState=w.memoizedState,g.lanes=w.lanes):(g.updateQueue=null,g.memoizedState=null)}var T=Dv(l);if(T!==null){T.flags&=-257,zv(T,l,h,o,e),T.mode&1&&Lv(o,m,e),e=T,f=m;var j=e.updateQueue;if(j===null){var D=new Set;D.add(f),e.updateQueue=D}else j.add(f);break e}else{if(!(e&1)){Lv(o,m,e),ty();break e}f=Error(se(426))}}else if(it&&h.mode&1){var M=Dv(l);if(M!==null){!(M.flags&65536)&&(M.flags|=256),zv(M,l,h,o,e),Dg(Za(f,h));break e}}o=f=Za(f,h),It!==4&&(It=2),uc===null?uc=[o]:uc.push(o),o=l;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var k=Ob(o,f,e);Sv(o,k);break e;case 1:h=f;var S=o.type,C=o.stateNode;if(!(o.flags&128)&&(typeof S.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(ui===null||!ui.has(C)))){o.flags|=65536,e&=-e,o.lanes|=e;var U=Vb(o,h,e);Sv(o,U);break e}}o=o.return}while(o!==null)}s1(n)}catch(F){e=F,jt===n&&n!==null&&(jt=n=n.return);continue}break}while(!0)}function n1(){var t=uh.current;return uh.current=ch,t===null?ch:t}function ty(){(It===0||It===3||It===2)&&(It=4),Vt===null||!(vo&268435455)&&!(Zh&268435455)||Ks(Vt,Ht)}function fh(t,e){var n=Ue;Ue|=2;var r=n1();(Vt!==t||Ht!==e)&&(ds=null,co(t,e));do try{E2();break}catch(s){t1(t,s)}while(!0);if(Mg(),Ue=n,uh.current=r,jt!==null)throw Error(se(261));return Vt=null,Ht=0,It}function E2(){for(;jt!==null;)r1(jt)}function T2(){for(;jt!==null&&!Qj();)r1(jt)}function r1(t){var e=o1(t.alternate,t,An);t.memoizedProps=t.pendingProps,e===null?s1(t):jt=e,Qg.current=null}function s1(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=_2(n,e),n!==null){n.flags&=32767,jt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{It=6,jt=null;return}}else if(n=y2(n,e,An),n!==null){jt=n;return}if(e=e.sibling,e!==null){jt=e;return}jt=e=t}while(e!==null);It===0&&(It=5)}function ro(t,e,n){var r=Ge,s=er.transition;try{er.transition=null,Ge=1,j2(t,e,n,r)}finally{er.transition=s,Ge=r}return null}function j2(t,e,n,r){do za();while(ni!==null);if(Ue&6)throw Error(se(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(se(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(ok(t,o),t===Vt&&(jt=Vt=null,Ht=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||dd||(dd=!0,a1(Gd,function(){return za(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=er.transition,er.transition=null;var l=Ge;Ge=1;var h=Ue;Ue|=4,Qg.current=null,x2(t,n),Xb(n,t),qk(ep),Qd=!!Jm,ep=Jm=null,t.current=n,w2(n),Yj(),Ue=h,Ge=l,er.transition=o}else t.current=n;if(dd&&(dd=!1,ni=t,hh=s),o=t.pendingLanes,o===0&&(ui=null),ek(n.stateNode),jn(t,_t()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(dh)throw dh=!1,t=xp,xp=null,t;return hh&1&&t.tag!==0&&za(),o=t.pendingLanes,o&1?t===wp?dc++:(dc=0,wp=t):dc=0,Ai(),null}function za(){if(ni!==null){var t=Ow(hh),e=er.transition,n=Ge;try{if(er.transition=null,Ge=16>t?16:t,ni===null)var r=!1;else{if(t=ni,ni=null,hh=0,Ue&6)throw Error(se(331));var s=Ue;for(Ue|=4,fe=t.current;fe!==null;){var o=fe,l=o.child;if(fe.flags&16){var h=o.deletions;if(h!==null){for(var f=0;f<h.length;f++){var m=h[f];for(fe=m;fe!==null;){var g=fe;switch(g.tag){case 0:case 11:case 15:cc(8,g,o)}var _=g.child;if(_!==null)_.return=g,fe=_;else for(;fe!==null;){g=fe;var w=g.sibling,T=g.return;if(Kb(g),g===m){fe=null;break}if(w!==null){w.return=T,fe=w;break}fe=T}}}var j=o.alternate;if(j!==null){var D=j.child;if(D!==null){j.child=null;do{var M=D.sibling;D.sibling=null,D=M}while(D!==null)}}fe=o}}if(o.subtreeFlags&2064&&l!==null)l.return=o,fe=l;else e:for(;fe!==null;){if(o=fe,o.flags&2048)switch(o.tag){case 0:case 11:case 15:cc(9,o,o.return)}var k=o.sibling;if(k!==null){k.return=o.return,fe=k;break e}fe=o.return}}var S=t.current;for(fe=S;fe!==null;){l=fe;var C=l.child;if(l.subtreeFlags&2064&&C!==null)C.return=l,fe=C;else e:for(l=S;fe!==null;){if(h=fe,h.flags&2048)try{switch(h.tag){case 0:case 11:case 15:qh(9,h)}}catch(F){ht(h,h.return,F)}if(h===l){fe=null;break e}var U=h.sibling;if(U!==null){U.return=h.return,fe=U;break e}fe=h.return}}if(Ue=s,Ai(),Vr&&typeof Vr.onPostCommitFiberRoot=="function")try{Vr.onPostCommitFiberRoot(Oh,t)}catch{}r=!0}return r}finally{Ge=n,er.transition=e}}return!1}function Kv(t,e,n){e=Za(n,e),e=Ob(t,e,1),t=ci(t,e,1),e=dn(),t!==null&&(Jc(t,1,e),jn(t,e))}function ht(t,e,n){if(t.tag===3)Kv(t,t,n);else for(;e!==null;){if(e.tag===3){Kv(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ui===null||!ui.has(r))){t=Za(n,t),t=Vb(e,t,1),e=ci(e,t,1),t=dn(),e!==null&&(Jc(e,1,t),jn(e,t));break}}e=e.return}}function k2(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=dn(),t.pingedLanes|=t.suspendedLanes&n,Vt===t&&(Ht&n)===n&&(It===4||It===3&&(Ht&130023424)===Ht&&500>_t()-Xg?co(t,0):Yg|=n),jn(t,e)}function i1(t,e){e===0&&(t.mode&1?(e=td,td<<=1,!(td&130023424)&&(td=4194304)):e=1);var n=dn();t=Ts(t,e),t!==null&&(Jc(t,e,n),jn(t,n))}function S2(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),i1(t,n)}function P2(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(se(314))}r!==null&&r.delete(e),i1(t,n)}var o1;o1=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||En.current)Nn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Nn=!1,g2(t,e,n);Nn=!!(t.flags&131072)}else Nn=!1,it&&e.flags&1048576&&ub(e,rh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Cd(t,e),t=e.pendingProps;var s=$a(e,nn.current);Da(e,n),s=Hg(null,e,r,t,s,n);var o=qg();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Tn(r)?(o=!0,th(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ug(e),s.updater=Hh,e.stateNode=s,s._reactInternals=e,cp(e,r,t,n),e=hp(null,e,r,!0,o,n)):(e.tag=0,it&&o&&Rg(e),un(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Cd(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=C2(r),t=ur(r,t),s){case 0:e=dp(null,e,r,t,n);break e;case 1:e=Vv(null,e,r,t,n);break e;case 11:e=Mv(null,e,r,t,n);break e;case 14:e=Ov(null,e,r,ur(r.type,t),n);break e}throw Error(se(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ur(r,s),dp(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ur(r,s),Vv(t,e,r,s,n);case 3:e:{if($b(e),t===null)throw Error(se(387));r=e.pendingProps,o=e.memoizedState,s=o.element,gb(t,e),oh(e,r,null,n);var l=e.memoizedState;if(r=l.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=Za(Error(se(423)),e),e=Uv(t,e,r,n,s);break e}else if(r!==s){s=Za(Error(se(424)),e),e=Uv(t,e,r,n,s);break e}else for(Ln=li(e.stateNode.containerInfo.firstChild),Mn=e,it=!0,hr=null,n=mb(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Wa(),r===s){e=js(t,e,n);break e}un(t,e,r,n)}e=e.child}return e;case 5:return yb(e),t===null&&op(e),r=e.type,s=e.pendingProps,o=t!==null?t.memoizedProps:null,l=s.children,tp(r,s)?l=null:o!==null&&tp(r,o)&&(e.flags|=32),Bb(t,e),un(t,e,l,n),e.child;case 6:return t===null&&op(e),null;case 13:return Wb(t,e,n);case 4:return Fg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ha(e,null,r,n):un(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ur(r,s),Mv(t,e,r,s,n);case 7:return un(t,e,e.pendingProps,n),e.child;case 8:return un(t,e,e.pendingProps.children,n),e.child;case 12:return un(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,l=s.value,Xe(sh,r._currentValue),r._currentValue=l,o!==null)if(gr(o.value,l)){if(o.children===s.children&&!En.current){e=js(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var h=o.dependencies;if(h!==null){l=o.child;for(var f=h.firstContext;f!==null;){if(f.context===r){if(o.tag===1){f=_s(-1,n&-n),f.tag=2;var m=o.updateQueue;if(m!==null){m=m.shared;var g=m.pending;g===null?f.next=f:(f.next=g.next,g.next=f),m.pending=f}}o.lanes|=n,f=o.alternate,f!==null&&(f.lanes|=n),ap(o.return,n,e),h.lanes|=n;break}f=f.next}}else if(o.tag===10)l=o.type===e.type?null:o.child;else if(o.tag===18){if(l=o.return,l===null)throw Error(se(341));l.lanes|=n,h=l.alternate,h!==null&&(h.lanes|=n),ap(l,n,e),l=o.sibling}else l=o.child;if(l!==null)l.return=o;else for(l=o;l!==null;){if(l===e){l=null;break}if(o=l.sibling,o!==null){o.return=l.return,l=o;break}l=l.return}o=l}un(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Da(e,n),s=nr(s),r=r(s),e.flags|=1,un(t,e,r,n),e.child;case 14:return r=e.type,s=ur(r,e.pendingProps),s=ur(r.type,s),Ov(t,e,r,s,n);case 15:return Ub(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ur(r,s),Cd(t,e),e.tag=1,Tn(r)?(t=!0,th(e)):t=!1,Da(e,n),Mb(e,r,s),cp(e,r,s,n),hp(null,e,r,!0,t,n);case 19:return Hb(t,e,n);case 22:return Fb(t,e,n)}throw Error(se(156,e.tag))};function a1(t,e){return Lw(t,e)}function I2(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yn(t,e,n,r){return new I2(t,e,n,r)}function ny(t){return t=t.prototype,!(!t||!t.isReactComponent)}function C2(t){if(typeof t=="function")return ny(t)?1:0;if(t!=null){if(t=t.$$typeof,t===wg)return 11;if(t===bg)return 14}return 2}function hi(t,e){var n=t.alternate;return n===null?(n=Yn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ld(t,e,n,r,s,o){var l=2;if(r=t,typeof t=="function")ny(t)&&(l=1);else if(typeof t=="string")l=5;else e:switch(t){case va:return uo(n.children,s,o,e);case xg:l=8,s|=8;break;case Rm:return t=Yn(12,n,e,s|2),t.elementType=Rm,t.lanes=o,t;case Lm:return t=Yn(13,n,e,s),t.elementType=Lm,t.lanes=o,t;case Dm:return t=Yn(19,n,e,s),t.elementType=Dm,t.lanes=o,t;case yw:return Gh(n,s,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case pw:l=10;break e;case gw:l=9;break e;case wg:l=11;break e;case bg:l=14;break e;case qs:l=16,r=null;break e}throw Error(se(130,t==null?t:typeof t,""))}return e=Yn(l,n,e,s),e.elementType=t,e.type=r,e.lanes=o,e}function uo(t,e,n,r){return t=Yn(7,t,r,e),t.lanes=n,t}function Gh(t,e,n,r){return t=Yn(22,t,r,e),t.elementType=yw,t.lanes=n,t.stateNode={isHidden:!1},t}function fm(t,e,n){return t=Yn(6,t,null,e),t.lanes=n,t}function mm(t,e,n){return e=Yn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function A2(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gf(0),this.expirationTimes=Gf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gf(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ry(t,e,n,r,s,o,l,h,f){return t=new A2(t,e,n,h,f),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Yn(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ug(o),t}function R2(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_a,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function l1(t){if(!t)return xi;t=t._reactInternals;e:{if(Co(t)!==t||t.tag!==1)throw Error(se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Tn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(se(171))}if(t.tag===1){var n=t.type;if(Tn(n))return lb(t,n,e)}return e}function c1(t,e,n,r,s,o,l,h,f){return t=ry(n,r,!0,t,s,o,l,h,f),t.context=l1(null),n=t.current,r=dn(),s=di(n),o=_s(r,s),o.callback=e??null,ci(n,o,s),t.current.lanes=s,Jc(t,s,r),jn(t,r),t}function Kh(t,e,n,r){var s=e.current,o=dn(),l=di(s);return n=l1(n),e.context===null?e.context=n:e.pendingContext=n,e=_s(o,l),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ci(s,e,l),t!==null&&(pr(t,s,l,o),Sd(t,s,l)),l}function mh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Qv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function sy(t,e){Qv(t,e),(t=t.alternate)&&Qv(t,e)}function L2(){return null}var u1=typeof reportError=="function"?reportError:function(t){console.error(t)};function iy(t){this._internalRoot=t}Qh.prototype.render=iy.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(se(409));Kh(t,e,null,null)};Qh.prototype.unmount=iy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;xo(function(){Kh(null,t,null,null)}),e[Es]=null}};function Qh(t){this._internalRoot=t}Qh.prototype.unstable_scheduleHydration=function(t){if(t){var e=Fw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Gs.length&&e!==0&&e<Gs[n].priority;n++);Gs.splice(n,0,t),n===0&&$w(t)}};function oy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Yh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Yv(){}function D2(t,e,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var m=mh(l);o.call(m)}}var l=c1(e,r,t,0,null,!1,!1,"",Yv);return t._reactRootContainer=l,t[Es]=l.current,Pc(t.nodeType===8?t.parentNode:t),xo(),l}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var h=r;r=function(){var m=mh(f);h.call(m)}}var f=ry(t,0,!1,null,null,!1,!1,"",Yv);return t._reactRootContainer=f,t[Es]=f.current,Pc(t.nodeType===8?t.parentNode:t),xo(function(){Kh(e,f,n,r)}),f}function Xh(t,e,n,r,s){var o=n._reactRootContainer;if(o){var l=o;if(typeof s=="function"){var h=s;s=function(){var f=mh(l);h.call(f)}}Kh(e,l,t,s)}else l=D2(n,e,t,s,r);return mh(l)}Vw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Kl(e.pendingLanes);n!==0&&(Tg(e,n|1),jn(e,_t()),!(Ue&6)&&(Ga=_t()+500,Ai()))}break;case 13:xo(function(){var r=Ts(t,1);if(r!==null){var s=dn();pr(r,t,1,s)}}),sy(t,1)}};jg=function(t){if(t.tag===13){var e=Ts(t,134217728);if(e!==null){var n=dn();pr(e,t,134217728,n)}sy(t,134217728)}};Uw=function(t){if(t.tag===13){var e=di(t),n=Ts(t,e);if(n!==null){var r=dn();pr(n,t,e,r)}sy(t,e)}};Fw=function(){return Ge};Bw=function(t,e){var n=Ge;try{return Ge=t,e()}finally{Ge=n}};Hm=function(t,e,n){switch(e){case"input":if(Om(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Bh(r);if(!s)throw Error(se(90));vw(r),Om(r,s)}}}break;case"textarea":ww(t,n);break;case"select":e=n.value,e!=null&&Ca(t,!!n.multiple,e,!1)}};Sw=Jg;Pw=xo;var z2={usingClientEntryPoint:!1,Events:[tu,Na,Bh,jw,kw,Jg]},Hl={findFiberByHostInstance:io,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},M2={bundleType:Hl.bundleType,version:Hl.version,rendererPackageName:Hl.rendererPackageName,rendererConfig:Hl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:As.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Aw(t),t===null?null:t.stateNode},findFiberByHostInstance:Hl.findFiberByHostInstance||L2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hd.isDisabled&&hd.supportsFiber)try{Oh=hd.inject(M2),Vr=hd}catch{}}Vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z2;Vn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!oy(e))throw Error(se(200));return R2(t,e,null,n)};Vn.createRoot=function(t,e){if(!oy(t))throw Error(se(299));var n=!1,r="",s=u1;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=ry(t,1,!1,null,null,n,!1,r,s),t[Es]=e.current,Pc(t.nodeType===8?t.parentNode:t),new iy(e)};Vn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(se(188)):(t=Object.keys(t).join(","),Error(se(268,t)));return t=Aw(e),t=t===null?null:t.stateNode,t};Vn.flushSync=function(t){return xo(t)};Vn.hydrate=function(t,e,n){if(!Yh(e))throw Error(se(200));return Xh(null,t,e,!0,n)};Vn.hydrateRoot=function(t,e,n){if(!oy(t))throw Error(se(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",l=u1;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),e=c1(e,null,t,1,n??null,s,!1,o,l),t[Es]=e.current,Pc(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Qh(e)};Vn.render=function(t,e,n){if(!Yh(e))throw Error(se(200));return Xh(null,t,e,!1,n)};Vn.unmountComponentAtNode=function(t){if(!Yh(t))throw Error(se(40));return t._reactRootContainer?(xo(function(){Xh(null,null,t,!1,function(){t._reactRootContainer=null,t[Es]=null})}),!0):!1};Vn.unstable_batchedUpdates=Jg;Vn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Yh(n))throw Error(se(200));if(t==null||t._reactInternals===void 0)throw Error(se(38));return Xh(t,e,n,!1,r)};Vn.version="18.3.1-next-f1338f8080-20240426";function d1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(d1)}catch(t){console.error(t)}}d1(),dw.exports=Vn;var O2=dw.exports,Xv=O2;Cm.createRoot=Xv.createRoot,Cm.hydrateRoot=Xv.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oc(){return Oc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Oc.apply(this,arguments)}var ri;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ri||(ri={}));const Jv="popstate";function V2(t){t===void 0&&(t={});function e(r,s){let{pathname:o,search:l,hash:h}=r.location;return Ep("",{pathname:o,search:l,hash:h},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:ph(s)}return F2(e,n,null,t)}function vt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function ay(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function U2(){return Math.random().toString(36).substr(2,8)}function ex(t,e){return{usr:t.state,key:t.key,idx:e}}function Ep(t,e,n,r){return n===void 0&&(n=null),Oc({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ol(e):e,{state:n,key:e&&e.key||r||U2()})}function ph(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ol(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function F2(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:o=!1}=r,l=s.history,h=ri.Pop,f=null,m=g();m==null&&(m=0,l.replaceState(Oc({},l.state,{idx:m}),""));function g(){return(l.state||{idx:null}).idx}function _(){h=ri.Pop;let M=g(),k=M==null?null:M-m;m=M,f&&f({action:h,location:D.location,delta:k})}function w(M,k){h=ri.Push;let S=Ep(D.location,M,k);m=g()+1;let C=ex(S,m),U=D.createHref(S);try{l.pushState(C,"",U)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;s.location.assign(U)}o&&f&&f({action:h,location:D.location,delta:1})}function T(M,k){h=ri.Replace;let S=Ep(D.location,M,k);m=g();let C=ex(S,m),U=D.createHref(S);l.replaceState(C,"",U),o&&f&&f({action:h,location:D.location,delta:0})}function j(M){let k=s.location.origin!=="null"?s.location.origin:s.location.href,S=typeof M=="string"?M:ph(M);return S=S.replace(/ $/,"%20"),vt(k,"No window.location.(origin|href) available to create URL for href: "+S),new URL(S,k)}let D={get action(){return h},get location(){return t(s,l)},listen(M){if(f)throw new Error("A history only accepts one active listener");return s.addEventListener(Jv,_),f=M,()=>{s.removeEventListener(Jv,_),f=null}},createHref(M){return e(s,M)},createURL:j,encodeLocation(M){let k=j(M);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:w,replace:T,go(M){return l.go(M)}};return D}var tx;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(tx||(tx={}));function B2(t,e,n){return n===void 0&&(n="/"),$2(t,e,n)}function $2(t,e,n,r){let s=typeof e=="string"?ol(e):e,o=ly(s.pathname||"/",n);if(o==null)return null;let l=h1(t);W2(l);let h=null;for(let f=0;h==null&&f<l.length;++f){let m=nS(o);h=J2(l[f],m)}return h}function h1(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(o,l,h)=>{let f={relativePath:h===void 0?o.path||"":h,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};f.relativePath.startsWith("/")&&(vt(f.relativePath.startsWith(r),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(r.length));let m=fi([r,f.relativePath]),g=n.concat(f);o.children&&o.children.length>0&&(vt(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),h1(o.children,e,g,m)),!(o.path==null&&!o.index)&&e.push({path:m,score:Y2(m,o.index),routesMeta:g})};return t.forEach((o,l)=>{var h;if(o.path===""||!((h=o.path)!=null&&h.includes("?")))s(o,l);else for(let f of f1(o.path))s(o,l,f)}),e}function f1(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return s?[o,""]:[o];let l=f1(r.join("/")),h=[];return h.push(...l.map(f=>f===""?o:[o,f].join("/"))),s&&h.push(...l),h.map(f=>t.startsWith("/")&&f===""?"/":f)}function W2(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:X2(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const H2=/^:[\w-]+$/,q2=3,Z2=2,G2=1,K2=10,Q2=-2,nx=t=>t==="*";function Y2(t,e){let n=t.split("/"),r=n.length;return n.some(nx)&&(r+=Q2),e&&(r+=Z2),n.filter(s=>!nx(s)).reduce((s,o)=>s+(H2.test(o)?q2:o===""?G2:K2),r)}function X2(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function J2(t,e,n){let{routesMeta:r}=t,s={},o="/",l=[];for(let h=0;h<r.length;++h){let f=r[h],m=h===r.length-1,g=o==="/"?e:e.slice(o.length)||"/",_=eS({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},g),w=f.route;if(!_)return null;Object.assign(s,_.params),l.push({params:s,pathname:fi([o,_.pathname]),pathnameBase:aS(fi([o,_.pathnameBase])),route:w}),_.pathnameBase!=="/"&&(o=fi([o,_.pathnameBase]))}return l}function eS(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=tS(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let o=s[0],l=o.replace(/(.)\/+$/,"$1"),h=s.slice(1);return{params:r.reduce((m,g,_)=>{let{paramName:w,isOptional:T}=g;if(w==="*"){let D=h[_]||"";l=o.slice(0,o.length-D.length).replace(/(.)\/+$/,"$1")}const j=h[_];return T&&!j?m[w]=void 0:m[w]=(j||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:l,pattern:t}}function tS(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),ay(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,h,f)=>(r.push({paramName:h,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function nS(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ay(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function ly(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}const rS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,sS=t=>rS.test(t);function iS(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?ol(t):t,o;if(n)if(sS(n))o=n;else{if(n.includes("//")){let l=n;n=n.replace(/\/\/+/g,"/"),ay(!1,"Pathnames cannot have embedded double slashes - normalizing "+(l+" -> "+n))}n.startsWith("/")?o=rx(n.substring(1),"/"):o=rx(n,e)}else o=e;return{pathname:o,search:lS(r),hash:cS(s)}}function rx(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function pm(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function oS(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function cy(t,e){let n=oS(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function uy(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=ol(t):(s=Oc({},t),vt(!s.pathname||!s.pathname.includes("?"),pm("?","pathname","search",s)),vt(!s.pathname||!s.pathname.includes("#"),pm("#","pathname","hash",s)),vt(!s.search||!s.search.includes("#"),pm("#","search","hash",s)));let o=t===""||s.pathname==="",l=o?"/":s.pathname,h;if(l==null)h=n;else{let _=e.length-1;if(!r&&l.startsWith("..")){let w=l.split("/");for(;w[0]==="..";)w.shift(),_-=1;s.pathname=w.join("/")}h=_>=0?e[_]:"/"}let f=iS(s,h),m=l&&l!=="/"&&l.endsWith("/"),g=(o||l===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(m||g)&&(f.pathname+="/"),f}const fi=t=>t.join("/").replace(/\/\/+/g,"/"),aS=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),lS=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,cS=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function uS(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const m1=["post","put","patch","delete"];new Set(m1);const dS=["get",...m1];new Set(dS);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Vc(){return Vc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Vc.apply(this,arguments)}const dy=O.createContext(null),hS=O.createContext(null),Ri=O.createContext(null),Jh=O.createContext(null),Qr=O.createContext({outlet:null,matches:[],isDataRoute:!1}),p1=O.createContext(null);function fS(t,e){let{relative:n}=e===void 0?{}:e;al()||vt(!1);let{basename:r,navigator:s}=O.useContext(Ri),{hash:o,pathname:l,search:h}=_1(t,{relative:n}),f=l;return r!=="/"&&(f=l==="/"?r:fi([r,l])),s.createHref({pathname:f,search:h,hash:o})}function al(){return O.useContext(Jh)!=null}function Li(){return al()||vt(!1),O.useContext(Jh).location}function g1(t){O.useContext(Ri).static||O.useLayoutEffect(t)}function vr(){let{isDataRoute:t}=O.useContext(Qr);return t?SS():mS()}function mS(){al()||vt(!1);let t=O.useContext(dy),{basename:e,future:n,navigator:r}=O.useContext(Ri),{matches:s}=O.useContext(Qr),{pathname:o}=Li(),l=JSON.stringify(cy(s,n.v7_relativeSplatPath)),h=O.useRef(!1);return g1(()=>{h.current=!0}),O.useCallback(function(m,g){if(g===void 0&&(g={}),!h.current)return;if(typeof m=="number"){r.go(m);return}let _=uy(m,JSON.parse(l),o,g.relative==="path");t==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:fi([e,_.pathname])),(g.replace?r.replace:r.push)(_,g.state,g)},[e,r,l,o,t])}const pS=O.createContext(null);function gS(t){let e=O.useContext(Qr).outlet;return e&&O.createElement(pS.Provider,{value:t},e)}function y1(){let{matches:t}=O.useContext(Qr),e=t[t.length-1];return e?e.params:{}}function _1(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=O.useContext(Ri),{matches:s}=O.useContext(Qr),{pathname:o}=Li(),l=JSON.stringify(cy(s,r.v7_relativeSplatPath));return O.useMemo(()=>uy(t,JSON.parse(l),o,n==="path"),[t,l,o,n])}function yS(t,e){return _S(t,e)}function _S(t,e,n,r){al()||vt(!1);let{navigator:s}=O.useContext(Ri),{matches:o}=O.useContext(Qr),l=o[o.length-1],h=l?l.params:{};l&&l.pathname;let f=l?l.pathnameBase:"/";l&&l.route;let m=Li(),g;if(e){var _;let M=typeof e=="string"?ol(e):e;f==="/"||(_=M.pathname)!=null&&_.startsWith(f)||vt(!1),g=M}else g=m;let w=g.pathname||"/",T=w;if(f!=="/"){let M=f.replace(/^\//,"").split("/");T="/"+w.replace(/^\//,"").split("/").slice(M.length).join("/")}let j=B2(t,{pathname:T}),D=NS(j&&j.map(M=>Object.assign({},M,{params:Object.assign({},h,M.params),pathname:fi([f,s.encodeLocation?s.encodeLocation(M.pathname).pathname:M.pathname]),pathnameBase:M.pathnameBase==="/"?f:fi([f,s.encodeLocation?s.encodeLocation(M.pathnameBase).pathname:M.pathnameBase])})),o,n,r);return e&&D?O.createElement(Jh.Provider,{value:{location:Vc({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:ri.Pop}},D):D}function vS(){let t=kS(),e=uS(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return O.createElement(O.Fragment,null,O.createElement("h2",null,"Unexpected Application Error!"),O.createElement("h3",{style:{fontStyle:"italic"}},e),n?O.createElement("pre",{style:s},n):null,null)}const xS=O.createElement(vS,null);class wS extends O.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?O.createElement(Qr.Provider,{value:this.props.routeContext},O.createElement(p1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function bS(t){let{routeContext:e,match:n,children:r}=t,s=O.useContext(dy);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),O.createElement(Qr.Provider,{value:e},r)}function NS(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var o;if(!n)return null;if(n.errors)t=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,h=(s=n)==null?void 0:s.errors;if(h!=null){let g=l.findIndex(_=>_.route.id&&(h==null?void 0:h[_.route.id])!==void 0);g>=0||vt(!1),l=l.slice(0,Math.min(l.length,g+1))}let f=!1,m=-1;if(n&&r&&r.v7_partialHydration)for(let g=0;g<l.length;g++){let _=l[g];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(m=g),_.route.id){let{loaderData:w,errors:T}=n,j=_.route.loader&&w[_.route.id]===void 0&&(!T||T[_.route.id]===void 0);if(_.route.lazy||j){f=!0,m>=0?l=l.slice(0,m+1):l=[l[0]];break}}}return l.reduceRight((g,_,w)=>{let T,j=!1,D=null,M=null;n&&(T=h&&_.route.id?h[_.route.id]:void 0,D=_.route.errorElement||xS,f&&(m<0&&w===0?(PS("route-fallback"),j=!0,M=null):m===w&&(j=!0,M=_.route.hydrateFallbackElement||null)));let k=e.concat(l.slice(0,w+1)),S=()=>{let C;return T?C=D:j?C=M:_.route.Component?C=O.createElement(_.route.Component,null):_.route.element?C=_.route.element:C=g,O.createElement(bS,{match:_,routeContext:{outlet:g,matches:k,isDataRoute:n!=null},children:C})};return n&&(_.route.ErrorBoundary||_.route.errorElement||w===0)?O.createElement(wS,{location:n.location,revalidation:n.revalidation,component:D,error:T,children:S(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):S()},null)}var v1=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(v1||{}),x1=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(x1||{});function ES(t){let e=O.useContext(dy);return e||vt(!1),e}function TS(t){let e=O.useContext(hS);return e||vt(!1),e}function jS(t){let e=O.useContext(Qr);return e||vt(!1),e}function w1(t){let e=jS(),n=e.matches[e.matches.length-1];return n.route.id||vt(!1),n.route.id}function kS(){var t;let e=O.useContext(p1),n=TS(),r=w1();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function SS(){let{router:t}=ES(v1.UseNavigateStable),e=w1(x1.UseNavigateStable),n=O.useRef(!1);return g1(()=>{n.current=!0}),O.useCallback(function(s,o){o===void 0&&(o={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Vc({fromRouteId:e},o)))},[t,e])}const sx={};function PS(t,e,n){sx[t]||(sx[t]=!0)}function IS(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function ix(t){let{to:e,replace:n,state:r,relative:s}=t;al()||vt(!1);let{future:o,static:l}=O.useContext(Ri),{matches:h}=O.useContext(Qr),{pathname:f}=Li(),m=vr(),g=uy(e,cy(h,o.v7_relativeSplatPath),f,s==="path"),_=JSON.stringify(g);return O.useEffect(()=>m(JSON.parse(_),{replace:n,state:r,relative:s}),[m,_,s,n,r]),null}function CS(t){return gS(t.context)}function Et(t){vt(!1)}function AS(t){let{basename:e="/",children:n=null,location:r,navigationType:s=ri.Pop,navigator:o,static:l=!1,future:h}=t;al()&&vt(!1);let f=e.replace(/^\/*/,"/"),m=O.useMemo(()=>({basename:f,navigator:o,static:l,future:Vc({v7_relativeSplatPath:!1},h)}),[f,h,o,l]);typeof r=="string"&&(r=ol(r));let{pathname:g="/",search:_="",hash:w="",state:T=null,key:j="default"}=r,D=O.useMemo(()=>{let M=ly(g,f);return M==null?null:{location:{pathname:M,search:_,hash:w,state:T,key:j},navigationType:s}},[f,g,_,w,T,j,s]);return D==null?null:O.createElement(Ri.Provider,{value:m},O.createElement(Jh.Provider,{children:n,value:D}))}function b1(t){let{children:e,location:n}=t;return yS(Tp(e),n)}new Promise(()=>{});function Tp(t,e){e===void 0&&(e=[]);let n=[];return O.Children.forEach(t,(r,s)=>{if(!O.isValidElement(r))return;let o=[...e,s];if(r.type===O.Fragment){n.push.apply(n,Tp(r.props.children,o));return}r.type!==Et&&vt(!1),!r.props.index||!r.props.children||vt(!1);let l={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=Tp(r.props.children,o)),n.push(l)}),n}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function jp(){return jp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},jp.apply(this,arguments)}function RS(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function LS(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function DS(t,e){return t.button===0&&(!e||e==="_self")&&!LS(t)}function kp(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function zS(t,e){let n=kp(t);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(o=>{n.append(s,o)})}),n}const MS=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],OS="6";try{window.__reactRouterVersion=OS}catch{}const VS="startTransition",ox=kj[VS];function US(t){let{basename:e,children:n,future:r,window:s}=t,o=O.useRef();o.current==null&&(o.current=V2({window:s,v5Compat:!0}));let l=o.current,[h,f]=O.useState({action:l.action,location:l.location}),{v7_startTransition:m}=r||{},g=O.useCallback(_=>{m&&ox?ox(()=>f(_)):f(_)},[f,m]);return O.useLayoutEffect(()=>l.listen(g),[l,g]),O.useEffect(()=>IS(r),[r]),O.createElement(AS,{basename:e,children:n,location:h.location,navigationType:h.action,navigator:l,future:r})}const FS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",BS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ke=O.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:o,replace:l,state:h,target:f,to:m,preventScrollReset:g,viewTransition:_}=e,w=RS(e,MS),{basename:T}=O.useContext(Ri),j,D=!1;if(typeof m=="string"&&BS.test(m)&&(j=m,FS))try{let C=new URL(window.location.href),U=m.startsWith("//")?new URL(C.protocol+m):new URL(m),F=ly(U.pathname,T);U.origin===C.origin&&F!=null?m=F+U.search+U.hash:D=!0}catch{}let M=fS(m,{relative:s}),k=$S(m,{replace:l,state:h,target:f,preventScrollReset:g,relative:s,viewTransition:_});function S(C){r&&r(C),C.defaultPrevented||k(C)}return O.createElement("a",jp({},w,{href:j||M,onClick:D||o?r:S,ref:n,target:f}))});var ax;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(ax||(ax={}));var lx;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(lx||(lx={}));function $S(t,e){let{target:n,replace:r,state:s,preventScrollReset:o,relative:l,viewTransition:h}=e===void 0?{}:e,f=vr(),m=Li(),g=_1(t,{relative:l});return O.useCallback(_=>{if(DS(_,n)){_.preventDefault();let w=r!==void 0?r:ph(m)===ph(g);f(t,{replace:w,state:s,preventScrollReset:o,relative:l,viewTransition:h})}},[m,f,g,r,s,n,t,o,l,h])}function N1(t){let e=O.useRef(kp(t)),n=O.useRef(!1),r=Li(),s=O.useMemo(()=>zS(r.search,n.current?null:e.current),[r.search]),o=vr(),l=O.useCallback((h,f)=>{const m=kp(typeof h=="function"?h(s):h);n.current=!0,o("?"+m,f)},[o,s]);return[s,l]}const WS=()=>{};var cx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},HS=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const o=t[n++];e[r++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=t[n++],l=t[n++],h=t[n++],f=((s&7)<<18|(o&63)<<12|(l&63)<<6|h&63)-65536;e[r++]=String.fromCharCode(55296+(f>>10)),e[r++]=String.fromCharCode(56320+(f&1023))}else{const o=t[n++],l=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(o&63)<<6|l&63)}}return e.join("")},T1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const o=t[s],l=s+1<t.length,h=l?t[s+1]:0,f=s+2<t.length,m=f?t[s+2]:0,g=o>>2,_=(o&3)<<4|h>>4;let w=(h&15)<<2|m>>6,T=m&63;f||(T=64,l||(w=64)),r.push(n[g],n[_],n[w],n[T])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(E1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):HS(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const o=n[t.charAt(s++)],h=s<t.length?n[t.charAt(s)]:0;++s;const m=s<t.length?n[t.charAt(s)]:64;++s;const _=s<t.length?n[t.charAt(s)]:64;if(++s,o==null||h==null||m==null||_==null)throw new qS;const w=o<<2|h>>4;if(r.push(w),m!==64){const T=h<<4&240|m>>2;if(r.push(T),_!==64){const j=m<<6&192|_;r.push(j)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class qS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ZS=function(t){const e=E1(t);return T1.encodeByteArray(e,!0)},gh=function(t){return ZS(t).replace(/\./g,"")},j1=function(t){try{return T1.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KS=()=>GS().__FIREBASE_DEFAULTS__,QS=()=>{if(typeof process>"u"||typeof cx>"u")return;const t=cx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},YS=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&j1(t[1]);return e&&JSON.parse(e)},ef=()=>{try{return WS()||KS()||QS()||YS()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},k1=t=>{var e,n;return(n=(e=ef())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},S1=t=>{const e=k1(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},P1=()=>{var t;return(t=ef())==null?void 0:t.config},I1=t=>{var e;return(e=ef())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Di(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function hy(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C1(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[gh(JSON.stringify(n)),gh(JSON.stringify(l)),""].join(".")}const hc={};function JS(){const t={prod:[],emulator:[]};for(const e of Object.keys(hc))hc[e]?t.emulator.push(e):t.prod.push(e);return t}function eP(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let ux=!1;function fy(t,e){if(typeof window>"u"||typeof document>"u"||!Di(window.location.host)||hc[t]===e||hc[t]||ux)return;hc[t]=e;function n(w){return`__firebase__banner__${w}`}const r="__firebase__banner",o=JS().prod.length>0;function l(){const w=document.getElementById(r);w&&w.remove()}function h(w){w.style.display="flex",w.style.background="#7faaf0",w.style.position="fixed",w.style.bottom="5px",w.style.left="5px",w.style.padding=".5em",w.style.borderRadius="5px",w.style.alignItems="center"}function f(w,T){w.setAttribute("width","24"),w.setAttribute("id",T),w.setAttribute("height","24"),w.setAttribute("viewBox","0 0 24 24"),w.setAttribute("fill","none"),w.style.marginLeft="-6px"}function m(){const w=document.createElement("span");return w.style.cursor="pointer",w.style.marginLeft="16px",w.style.fontSize="24px",w.innerHTML=" &times;",w.onclick=()=>{ux=!0,l()},w}function g(w,T){w.setAttribute("id",T),w.innerText="Learn more",w.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",w.setAttribute("target","__blank"),w.style.paddingLeft="5px",w.style.textDecoration="underline"}function _(){const w=eP(r),T=n("text"),j=document.getElementById(T)||document.createElement("span"),D=n("learnmore"),M=document.getElementById(D)||document.createElement("a"),k=n("preprendIcon"),S=document.getElementById(k)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(w.created){const C=w.element;h(C),g(M,D);const U=m();f(S,k),C.append(S,j,M,U),document.body.appendChild(C)}o?(j.innerText="Preview backend disconnected.",S.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(S.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,j.innerText="Preview backend running in this workspace."),j.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(rn())}function nP(){var e;const t=(e=ef())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function rP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function sP(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function iP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function oP(){const t=rn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function aP(){return!nP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function lP(){try{return typeof indexedDB=="object"}catch{return!1}}function cP(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var o;e(((o=s.error)==null?void 0:o.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uP="FirebaseError";class Yr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=uP,Object.setPrototypeOf(this,Yr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ru.prototype.create)}}class ru{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,o=this.errors[e],l=o?dP(o,r):"Error",h=`${this.serviceName}: ${l} (${s}).`;return new Yr(s,h,r)}}function dP(t,e){return t.replace(hP,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const hP=/\{\$([^}]+)}/g;function fP(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function wo(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const o=t[s],l=e[s];if(dx(o)&&dx(l)){if(!wo(o,l))return!1}else if(o!==l)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function dx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function su(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Yl(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,o]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function Xl(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function mP(t,e){const n=new pP(t,e);return n.subscribe.bind(n)}class pP{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");gP(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=gm),s.error===void 0&&(s.error=gm),s.complete===void 0&&(s.complete=gm);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function gP(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function gm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qe(t){return t&&t._delegate?t._delegate:t}class wi{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new XS;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(vP(e))try{this.getOrInitializeService({instanceIdentifier:so})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:s});r.resolve(o)}catch{}}}}clearInstance(e=so){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=so){return this.instances.has(e)}getOptions(e=so){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,l]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(o);r===h&&l.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:_P(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=so){return this.component?this.component.multipleInstances?e:so:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function _P(t){return t===so?void 0:t}function vP(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new yP(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var De;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(De||(De={}));const wP={debug:De.DEBUG,verbose:De.VERBOSE,info:De.INFO,warn:De.WARN,error:De.ERROR,silent:De.SILENT},bP=De.INFO,NP={[De.DEBUG]:"log",[De.VERBOSE]:"log",[De.INFO]:"info",[De.WARN]:"warn",[De.ERROR]:"error"},EP=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=NP[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class my{constructor(e){this.name=e,this._logLevel=bP,this._logHandler=EP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in De))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?wP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,De.DEBUG,...e),this._logHandler(this,De.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,De.VERBOSE,...e),this._logHandler(this,De.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,De.INFO,...e),this._logHandler(this,De.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,De.WARN,...e),this._logHandler(this,De.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,De.ERROR,...e),this._logHandler(this,De.ERROR,...e)}}const TP=(t,e)=>e.some(n=>t instanceof n);let hx,fx;function jP(){return hx||(hx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function kP(){return fx||(fx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const A1=new WeakMap,Sp=new WeakMap,R1=new WeakMap,ym=new WeakMap,py=new WeakMap;function SP(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",o),t.removeEventListener("error",l)},o=()=>{n(mi(t.result)),s()},l=()=>{r(t.error),s()};t.addEventListener("success",o),t.addEventListener("error",l)});return e.then(n=>{n instanceof IDBCursor&&A1.set(n,t)}).catch(()=>{}),py.set(e,t),e}function PP(t){if(Sp.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",l),t.removeEventListener("abort",l)},o=()=>{n(),s()},l=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",o),t.addEventListener("error",l),t.addEventListener("abort",l)});Sp.set(t,e)}let Pp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Sp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||R1.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return mi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function IP(t){Pp=t(Pp)}function CP(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(_m(this),e,...n);return R1.set(r,e.sort?e.sort():[e]),mi(r)}:kP().includes(t)?function(...e){return t.apply(_m(this),e),mi(A1.get(this))}:function(...e){return mi(t.apply(_m(this),e))}}function AP(t){return typeof t=="function"?CP(t):(t instanceof IDBTransaction&&PP(t),TP(t,jP())?new Proxy(t,Pp):t)}function mi(t){if(t instanceof IDBRequest)return SP(t);if(ym.has(t))return ym.get(t);const e=AP(t);return e!==t&&(ym.set(t,e),py.set(e,t)),e}const _m=t=>py.get(t);function RP(t,e,{blocked:n,upgrade:r,blocking:s,terminated:o}={}){const l=indexedDB.open(t,e),h=mi(l);return r&&l.addEventListener("upgradeneeded",f=>{r(mi(l.result),f.oldVersion,f.newVersion,mi(l.transaction),f)}),n&&l.addEventListener("blocked",f=>n(f.oldVersion,f.newVersion,f)),h.then(f=>{o&&f.addEventListener("close",()=>o()),s&&f.addEventListener("versionchange",m=>s(m.oldVersion,m.newVersion,m))}).catch(()=>{}),h}const LP=["get","getKey","getAll","getAllKeys","count"],DP=["put","add","delete","clear"],vm=new Map;function mx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(vm.get(e))return vm.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=DP.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||LP.includes(n)))return;const o=async function(l,...h){const f=this.transaction(l,s?"readwrite":"readonly");let m=f.store;return r&&(m=m.index(h.shift())),(await Promise.all([m[n](...h),s&&f.done]))[0]};return vm.set(e,o),o}IP(t=>({...t,get:(e,n,r)=>mx(e,n)||t.get(e,n,r),has:(e,n)=>!!mx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(MP(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function MP(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ip="@firebase/app",px="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ks=new my("@firebase/app"),OP="@firebase/app-compat",VP="@firebase/analytics-compat",UP="@firebase/analytics",FP="@firebase/app-check-compat",BP="@firebase/app-check",$P="@firebase/auth",WP="@firebase/auth-compat",HP="@firebase/database",qP="@firebase/data-connect",ZP="@firebase/database-compat",GP="@firebase/functions",KP="@firebase/functions-compat",QP="@firebase/installations",YP="@firebase/installations-compat",XP="@firebase/messaging",JP="@firebase/messaging-compat",eI="@firebase/performance",tI="@firebase/performance-compat",nI="@firebase/remote-config",rI="@firebase/remote-config-compat",sI="@firebase/storage",iI="@firebase/storage-compat",oI="@firebase/firestore",aI="@firebase/ai",lI="@firebase/firestore-compat",cI="firebase",uI="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cp="[DEFAULT]",dI={[Ip]:"fire-core",[OP]:"fire-core-compat",[UP]:"fire-analytics",[VP]:"fire-analytics-compat",[BP]:"fire-app-check",[FP]:"fire-app-check-compat",[$P]:"fire-auth",[WP]:"fire-auth-compat",[HP]:"fire-rtdb",[qP]:"fire-data-connect",[ZP]:"fire-rtdb-compat",[GP]:"fire-fn",[KP]:"fire-fn-compat",[QP]:"fire-iid",[YP]:"fire-iid-compat",[XP]:"fire-fcm",[JP]:"fire-fcm-compat",[eI]:"fire-perf",[tI]:"fire-perf-compat",[nI]:"fire-rc",[rI]:"fire-rc-compat",[sI]:"fire-gcs",[iI]:"fire-gcs-compat",[oI]:"fire-fst",[lI]:"fire-fst-compat",[aI]:"fire-vertex","fire-js":"fire-js",[cI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yh=new Map,hI=new Map,Ap=new Map;function gx(t,e){try{t.container.addComponent(e)}catch(n){ks.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function bo(t){const e=t.name;if(Ap.has(e))return ks.debug(`There were multiple attempts to register component ${e}.`),!1;Ap.set(e,t);for(const n of yh.values())gx(n,t);for(const n of hI.values())gx(n,t);return!0}function tf(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Rn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},pi=new ru("app","Firebase",fI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new wi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw pi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ao=uI;function L1(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Cp,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw pi.create("bad-app-name",{appName:String(s)});if(n||(n=P1()),!n)throw pi.create("no-options");const o=yh.get(s);if(o){if(wo(n,o.options)&&wo(r,o.config))return o;throw pi.create("duplicate-app",{appName:s})}const l=new xP(s);for(const f of Ap.values())l.addComponent(f);const h=new mI(n,r,l);return yh.set(s,h),h}function gy(t=Cp){const e=yh.get(t);if(!e&&t===Cp&&P1())return L1();if(!e)throw pi.create("no-app",{appName:t});return e}function Fr(t,e,n){let r=dI[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${r}" with version "${e}":`];s&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ks.warn(l.join(" "));return}bo(new wi(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pI="firebase-heartbeat-database",gI=1,Uc="firebase-heartbeat-store";let xm=null;function D1(){return xm||(xm=RP(pI,gI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Uc)}catch(n){console.warn(n)}}}}).catch(t=>{throw pi.create("idb-open",{originalErrorMessage:t.message})})),xm}async function yI(t){try{const n=(await D1()).transaction(Uc),r=await n.objectStore(Uc).get(z1(t));return await n.done,r}catch(e){if(e instanceof Yr)ks.warn(e.message);else{const n=pi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ks.warn(n.message)}}}async function yx(t,e){try{const r=(await D1()).transaction(Uc,"readwrite");await r.objectStore(Uc).put(e,z1(t)),await r.done}catch(n){if(n instanceof Yr)ks.warn(n.message);else{const r=pi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ks.warn(r.message)}}}function z1(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I=1024,vI=30;class xI{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new bI(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=_x();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(l=>l.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>vI){const l=NI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ks.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=_x(),{heartbeatsToSend:r,unsentEntries:s}=wI(this._heartbeatsCache.heartbeats),o=gh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return ks.warn(n),""}}}function _x(){return new Date().toISOString().substring(0,10)}function wI(t,e=_I){const n=[];let r=t.slice();for(const s of t){const o=n.find(l=>l.agent===s.agent);if(o){if(o.dates.push(s.date),vx(n)>e){o.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),vx(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class bI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return lP()?cP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await yI(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return yx(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return yx(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function vx(t){return gh(JSON.stringify({version:2,heartbeats:t})).length}function NI(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EI(t){bo(new wi("platform-logger",e=>new zP(e),"PRIVATE")),bo(new wi("heartbeat",e=>new xI(e),"PRIVATE")),Fr(Ip,px,t),Fr(Ip,px,"esm2020"),Fr("fire-js","")}EI("");function M1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const TI=M1,O1=new ru("auth","Firebase",M1());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _h=new my("@firebase/auth");function jI(t,...e){_h.logLevel<=De.WARN&&_h.warn(`Auth (${Ao}): ${t}`,...e)}function Dd(t,...e){_h.logLevel<=De.ERROR&&_h.error(`Auth (${Ao}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yr(t,...e){throw yy(t,...e)}function Br(t,...e){return yy(t,...e)}function V1(t,e,n){const r={...TI(),[e]:n};return new ru("auth","Firebase",r).create(e,{appName:t.name})}function vs(t){return V1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function yy(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return O1.create(t,...e)}function Ne(t,e,...n){if(!t)throw yy(e,...n)}function ps(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Dd(e),new Error(e)}function Ss(t,e){t||ps(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rp(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function kI(){return xx()==="http:"||xx()==="https:"}function xx(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(kI()||sP()||"connection"in navigator)?navigator.onLine:!0}function PI(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ss(n>e,"Short delay should be less than long delay!"),this.isMobile=tP()||iP()}get(){return SI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _y(t,e){Ss(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ps("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ps("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ps("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const II={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],AI=new iu(3e4,6e4);function zi(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Xr(t,e,n,r,s={}){return F1(t,s,async()=>{let o={},l={};r&&(e==="GET"?l=r:o={body:JSON.stringify(r)});const h=su({key:t.config.apiKey,...l}).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const m={method:e,headers:f,...o};return rP()||(m.referrerPolicy="no-referrer"),t.emulatorConfig&&Di(t.emulatorConfig.host)&&(m.credentials="include"),U1.fetch()(await B1(t,t.config.apiHost,n,h),m)})}async function F1(t,e,n){t._canInitEmulator=!1;const r={...II,...e};try{const s=new LI(t),o=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw fd(t,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const h=o.ok?l.errorMessage:l.error.message,[f,m]=h.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw fd(t,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw fd(t,"email-already-in-use",l);if(f==="USER_DISABLED")throw fd(t,"user-disabled",l);const g=r[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw V1(t,g,m);yr(t,g)}}catch(s){if(s instanceof Yr)throw s;yr(t,"network-request-failed",{message:String(s)})}}async function ou(t,e,n,r,s={}){const o=await Xr(t,e,n,r,s);return"mfaPendingCredential"in o&&yr(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function B1(t,e,n,r){const s=`${e}${n}?${r}`,o=t,l=o.config.emulator?_y(t.config,s):`${t.config.apiScheme}://${s}`;return CI.includes(n)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}function RI(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class LI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Br(this.auth,"network-request-failed")),AI.get())})}}function fd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Br(t,e,r);return s.customData._tokenResponse=n,s}function wx(t){return t!==void 0&&t.enterprise!==void 0}class DI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return RI(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function zI(t,e){return Xr(t,"GET","/v2/recaptchaConfig",zi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MI(t,e){return Xr(t,"POST","/v1/accounts:delete",e)}async function vh(t,e){return Xr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function OI(t,e=!1){const n=qe(t),r=await n.getIdToken(e),s=vy(r);Ne(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,l=o==null?void 0:o.sign_in_provider;return{claims:s,token:r,authTime:fc(wm(s.auth_time)),issuedAtTime:fc(wm(s.iat)),expirationTime:fc(wm(s.exp)),signInProvider:l||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function wm(t){return Number(t)*1e3}function vy(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Dd("JWT malformed, contained fewer than 3 sections"),null;try{const s=j1(n);return s?JSON.parse(s):(Dd("Failed to decode base64 JWT payload"),null)}catch(s){return Dd("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function bx(t){const e=vy(t);return Ne(e,"internal-error"),Ne(typeof e.exp<"u","internal-error"),Ne(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function No(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Yr&&VI(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function VI({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=fc(this.lastLoginAt),this.creationTime=fc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xh(t){var _;const e=t.auth,n=await t.getIdToken(),r=await No(t,vh(e,{idToken:n}));Ne(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const o=(_=s.providerUserInfo)!=null&&_.length?$1(s.providerUserInfo):[],l=BI(t.providerData,o),h=t.isAnonymous,f=!(t.email&&s.passwordHash)&&!(l!=null&&l.length),m=h?f:!1,g={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new Lp(s.createdAt,s.lastLoginAt),isAnonymous:m};Object.assign(t,g)}async function FI(t){const e=qe(t);await xh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function BI(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function $1(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $I(t,e){const n=await F1(t,{},async()=>{const r=su({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=t.config,l=await B1(t,s,"/v1/token",`key=${o}`),h=await t._getAdditionalHeaders();h["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:h,body:r};return t.emulatorConfig&&Di(t.emulatorConfig.host)&&(f.credentials="include"),U1.fetch()(l,f)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function WI(t,e){return Xr(t,"POST","/v2/accounts:revokeToken",zi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ne(e.idToken,"internal-error"),Ne(typeof e.idToken<"u","internal-error"),Ne(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):bx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ne(e.length!==0,"internal-error");const n=bx(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ne(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:o}=await $I(e,n);this.updateTokensAndExpiration(r,s,Number(o))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:o}=n,l=new Ma;return r&&(Ne(typeof r=="string","internal-error",{appName:e}),l.refreshToken=r),s&&(Ne(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),o&&(Ne(typeof o=="number","internal-error",{appName:e}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ma,this.toJSON())}_performRefresh(){return ps("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ws(t,e){Ne(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class fr{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new UI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Lp(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await No(this,this.stsTokenManager.getToken(this.auth,e));return Ne(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return OI(this,e)}reload(){return FI(this)}_assign(e){this!==e&&(Ne(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new fr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Ne(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await xh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Rn(this.auth.app))return Promise.reject(vs(this.auth));const e=await this.getIdToken();return await No(this,MI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,o=n.phoneNumber??void 0,l=n.photoURL??void 0,h=n.tenantId??void 0,f=n._redirectEventId??void 0,m=n.createdAt??void 0,g=n.lastLoginAt??void 0,{uid:_,emailVerified:w,isAnonymous:T,providerData:j,stsTokenManager:D}=n;Ne(_&&D,e,"internal-error");const M=Ma.fromJSON(this.name,D);Ne(typeof _=="string",e,"internal-error"),Ws(r,e.name),Ws(s,e.name),Ne(typeof w=="boolean",e,"internal-error"),Ne(typeof T=="boolean",e,"internal-error"),Ws(o,e.name),Ws(l,e.name),Ws(h,e.name),Ws(f,e.name),Ws(m,e.name),Ws(g,e.name);const k=new fr({uid:_,auth:e,email:s,emailVerified:w,displayName:r,isAnonymous:T,photoURL:l,phoneNumber:o,tenantId:h,stsTokenManager:M,createdAt:m,lastLoginAt:g});return j&&Array.isArray(j)&&(k.providerData=j.map(S=>({...S}))),f&&(k._redirectEventId=f),k}static async _fromIdTokenResponse(e,n,r=!1){const s=new Ma;s.updateFromServerResponse(n);const o=new fr({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await xh(o),o}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];Ne(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?$1(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!(o!=null&&o.length),h=new Ma;h.updateFromIdToken(r);const f=new fr({uid:s.localId,auth:e,stsTokenManager:h,isAnonymous:l}),m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Lp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(o!=null&&o.length)};return Object.assign(f,m),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nx=new Map;function gs(t){Ss(t instanceof Function,"Expected a class definition");let e=Nx.get(t);return e?(Ss(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Nx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}W1.type="NONE";const Ex=W1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zd(t,e,n){return`firebase:${t}:${e}:${n}`}class Oa{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:o}=this.auth;this.fullUserKey=zd(this.userKey,s.apiKey,o),this.fullPersistenceKey=zd("persistence",s.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await vh(this.auth,{idToken:e}).catch(()=>{});return n?fr._fromGetAccountInfoResponse(this.auth,n,e):null}return fr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Oa(gs(Ex),e,r);const s=(await Promise.all(n.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let o=s[0]||gs(Ex);const l=zd(r,e.config.apiKey,e.name);let h=null;for(const m of n)try{const g=await m._get(l);if(g){let _;if(typeof g=="string"){const w=await vh(e,{idToken:g}).catch(()=>{});if(!w)break;_=await fr._fromGetAccountInfoResponse(e,w,g)}else _=fr._fromJSON(e,g);m!==o&&(h=_),o=m;break}}catch{}const f=s.filter(m=>m._shouldAllowMigration);return!o._shouldAllowMigration||!f.length?new Oa(o,e,r):(o=f[0],h&&await o._set(l,h.toJSON()),await Promise.all(n.map(async m=>{if(m!==o)try{await m._remove(l)}catch{}})),new Oa(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tx(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(G1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(H1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Q1(e))return"Blackberry";if(Y1(e))return"Webos";if(q1(e))return"Safari";if((e.includes("chrome/")||Z1(e))&&!e.includes("edge/"))return"Chrome";if(K1(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function H1(t=rn()){return/firefox\//i.test(t)}function q1(t=rn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Z1(t=rn()){return/crios\//i.test(t)}function G1(t=rn()){return/iemobile/i.test(t)}function K1(t=rn()){return/android/i.test(t)}function Q1(t=rn()){return/blackberry/i.test(t)}function Y1(t=rn()){return/webos/i.test(t)}function xy(t=rn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function HI(t=rn()){var e;return xy(t)&&!!((e=window.navigator)!=null&&e.standalone)}function qI(){return oP()&&document.documentMode===10}function X1(t=rn()){return xy(t)||K1(t)||Y1(t)||Q1(t)||/windows phone/i.test(t)||G1(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J1(t,e=[]){let n;switch(t){case"Browser":n=Tx(rn());break;case"Worker":n=`${Tx(rn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ao}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=o=>new Promise((l,h)=>{try{const f=e(o);l(f)}catch(f){h(f)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GI(t,e={}){return Xr(t,"GET","/v2/passwordPolicy",zi(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KI=6;class QI{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??KI,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jx(this),this.idTokenSubscription=new jx(this),this.beforeStateQueue=new ZI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=O1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=gs(n)),this._initializationPromise=this.queue(async()=>{var r,s,o;if(!this._deleted&&(this.persistenceManager=await Oa.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((o=this.currentUser)==null?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await vh(this,{idToken:e}),r=await fr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var o;if(Rn(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(h,h))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(o=this.redirectUser)==null?void 0:o._redirectEventId,h=r==null?void 0:r._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===h)&&(f!=null&&f.user)&&(r=f.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(l){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ne(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await xh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=PI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Rn(this.app))return Promise.reject(vs(this));const n=e?qe(e):null;return n&&Ne(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ne(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Rn(this.app)?Promise.reject(vs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Rn(this.app)?Promise.reject(vs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(gs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await GI(this),n=new QI(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ru("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await WI(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&gs(e)||this._popupRedirectResolver;Ne(n,this,"argument-error"),this.redirectPersistenceManager=await Oa.create(this,[gs(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const o=typeof n=="function"?n:n.next.bind(n);let l=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ne(h,this,"internal-error"),h.then(()=>{l||o(this.currentUser)}),typeof n=="function"){const f=e.addObserver(n,r,s);return()=>{l=!0,f()}}else{const f=e.addObserver(n);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ne(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=J1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Rn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&jI(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ro(t){return qe(t)}class jx{constructor(e){this.auth=e,this.observer=null,this.addObserver=mP(n=>this.observer=n)}get next(){return Ne(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function XI(t){nf=t}function eN(t){return nf.loadJS(t)}function JI(){return nf.recaptchaEnterpriseScript}function eC(){return nf.gapiScript}function tC(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class nC{constructor(){this.enterprise=new rC}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class rC{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const sC="recaptcha-enterprise",tN="NO_RECAPTCHA";class iC{constructor(e){this.type=sC,this.auth=Ro(e)}async verify(e="verify",n=!1){async function r(o){if(!n){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(l,h)=>{zI(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const m=new DI(f);return o.tenantId==null?o._agentRecaptchaConfig=m:o._tenantRecaptchaConfigs[o.tenantId]=m,l(m.siteKey)}}).catch(f=>{h(f)})})}function s(o,l,h){const f=window.grecaptcha;wx(f)?f.enterprise.ready(()=>{f.enterprise.execute(o,{action:e}).then(m=>{l(m)}).catch(()=>{l(tN)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new nC().execute("siteKey",{action:"verify"}):new Promise((o,l)=>{r(this.auth).then(h=>{if(!n&&wx(window.grecaptcha))s(h,o,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let f=JI();f.length!==0&&(f+=h),eN(f).then(()=>{s(h,o,l)}).catch(m=>{l(m)})}}).catch(h=>{l(h)})})}}async function kx(t,e,n,r=!1,s=!1){const o=new iC(t);let l;if(s)l=tN;else try{l=await o.verify(n)}catch{l=await o.verify(n,!0)}const h={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in h){const f=h.phoneEnrollmentInfo.phoneNumber,m=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:m,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){const f=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return r?Object.assign(h,{captchaResp:l}):Object.assign(h,{captchaResponse:l}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function Dp(t,e,n,r,s){var o;if((o=t._getRecaptchaConfig())!=null&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await kx(t,e,n,n==="getOobCode");return r(t,l)}else return r(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const h=await kx(t,e,n,n==="getOobCode");return r(t,h)}else return Promise.reject(l)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oC(t,e){const n=tf(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),o=n.getOptions();if(wo(o,e??{}))return s;yr(s,"already-initialized")}return n.initialize({options:e})}function aC(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(gs);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function lC(t,e,n){const r=Ro(t);Ne(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,o=nN(e),{host:l,port:h}=cC(e),f=h===null?"":`:${h}`,m={url:`${o}//${l}${f}/`},g=Object.freeze({host:l,port:h,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){Ne(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ne(wo(m,r.config.emulator)&&wo(g,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=m,r.emulatorConfig=g,r.settings.appVerificationDisabledForTesting=!0,Di(l)?(hy(`${o}//${l}${f}`),fy("Auth",!0)):uC()}function nN(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function cC(t){const e=nN(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const o=s[1];return{host:o,port:Sx(r.substr(o.length+1))}}else{const[o,l]=r.split(":");return{host:o,port:Sx(l)}}}function Sx(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function uC(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ps("not implemented")}_getIdTokenResponse(e){return ps("not implemented")}_linkToIdToken(e,n){return ps("not implemented")}_getReauthenticationResolver(e){return ps("not implemented")}}async function dC(t,e){return Xr(t,"POST","/v1/accounts:update",e)}async function hC(t,e){return Xr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fC(t,e){return ou(t,"POST","/v1/accounts:signInWithPassword",zi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mC(t,e){return ou(t,"POST","/v1/accounts:signInWithEmailLink",zi(t,e))}async function pC(t,e){return ou(t,"POST","/v1/accounts:signInWithEmailLink",zi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc extends wy{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Fc(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Fc(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Dp(e,n,"signInWithPassword",fC);case"emailLink":return mC(e,{email:this._email,oobCode:this._password});default:yr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Dp(e,r,"signUpPassword",hC);case"emailLink":return pC(e,{idToken:n,email:this._email,oobCode:this._password});default:yr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Va(t,e){return ou(t,"POST","/v1/accounts:signInWithIdp",zi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gC="http://localhost";class Eo extends wy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Eo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):yr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...o}=n;if(!r||!s)return null;const l=new Eo(r,s);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(e){const n=this.buildRequest();return Va(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Va(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Va(e,n)}buildRequest(){const e={requestUri:gC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=su(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yC(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function _C(t){const e=Yl(Xl(t)).link,n=e?Yl(Xl(e)).deep_link_id:null,r=Yl(Xl(t)).deep_link_id;return(r?Yl(Xl(r)).link:null)||r||n||e||t}class by{constructor(e){const n=Yl(Xl(e)),r=n.apiKey??null,s=n.oobCode??null,o=yC(n.mode??null);Ne(r&&s&&o,"argument-error"),this.apiKey=r,this.operation=o,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=_C(e);try{return new by(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(){this.providerId=Mi.PROVIDER_ID}static credential(e,n){return Fc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=by.parseLink(n);return Ne(r,"argument-error"),Fc._fromEmailAndCode(e,r.code,r.tenantId)}}Mi.PROVIDER_ID="password";Mi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Mi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rN{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au extends rN{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs extends au{constructor(){super("facebook.com")}static credential(e){return Eo._fromParams({providerId:Qs.PROVIDER_ID,signInMethod:Qs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qs.credentialFromTaggedObject(e)}static credentialFromError(e){return Qs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qs.credential(e.oauthAccessToken)}catch{return null}}}Qs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Qs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys extends au{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Eo._fromParams({providerId:Ys.PROVIDER_ID,signInMethod:Ys.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ys.credentialFromTaggedObject(e)}static credentialFromError(e){return Ys.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Ys.credential(n,r)}catch{return null}}}Ys.GOOGLE_SIGN_IN_METHOD="google.com";Ys.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs extends au{constructor(){super("github.com")}static credential(e){return Eo._fromParams({providerId:Xs.PROVIDER_ID,signInMethod:Xs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xs.credentialFromTaggedObject(e)}static credentialFromError(e){return Xs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xs.credential(e.oauthAccessToken)}catch{return null}}}Xs.GITHUB_SIGN_IN_METHOD="github.com";Xs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js extends au{constructor(){super("twitter.com")}static credential(e,n){return Eo._fromParams({providerId:Js.PROVIDER_ID,signInMethod:Js.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Js.credentialFromTaggedObject(e)}static credentialFromError(e){return Js.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Js.credential(n,r)}catch{return null}}}Js.TWITTER_SIGN_IN_METHOD="twitter.com";Js.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vC(t,e){return ou(t,"POST","/v1/accounts:signUp",zi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const o=await fr._fromIdTokenResponse(e,r,s),l=Px(r);return new To({user:o,providerId:l,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Px(r);return new To({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Px(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wh extends Yr{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,wh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new wh(e,n,r,s)}}function sN(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?wh._fromErrorAndOperation(t,o,e,r):o})}async function xC(t,e,n=!1){const r=await No(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return To._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iN(t,e,n=!1){const{auth:r}=t;if(Rn(r.app))return Promise.reject(vs(r));const s="reauthenticate";try{const o=await No(t,sN(r,s,e,t),n);Ne(o.idToken,r,"internal-error");const l=vy(o.idToken);Ne(l,r,"internal-error");const{sub:h}=l;return Ne(t.uid===h,r,"user-mismatch"),To._forOperation(t,s,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&yr(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oN(t,e,n=!1){if(Rn(t.app))return Promise.reject(vs(t));const r="signIn",s=await sN(t,r,e),o=await To._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(o.user),o}async function wC(t,e){return oN(Ro(t),e)}async function aN(t,e){return iN(qe(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lN(t){const e=Ro(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function bC(t,e,n){if(Rn(t.app))return Promise.reject(vs(t));const r=Ro(t),l=await Dp(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",vC).catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&lN(t),f}),h=await To._fromIdTokenResponse(r,"signIn",l);return await r._updateCurrentUser(h.user),h}function NC(t,e,n){return Rn(t.app)?Promise.reject(vs(t)):wC(qe(t),Mi.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&lN(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EC(t,e){return Xr(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zp(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=qe(t),o={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},l=await No(r,EC(r.auth,o));r.displayName=l.displayName||null,r.photoURL=l.photoUrl||null;const h=r.providerData.find(({providerId:f})=>f==="password");h&&(h.displayName=r.displayName,h.photoURL=r.photoURL),await r._updateTokensIfNecessary(l)}function TC(t,e){return jC(qe(t),null,e)}async function jC(t,e,n){const{auth:r}=t,o={idToken:await t.getIdToken(),returnSecureToken:!0};n&&(o.password=n);const l=await No(t,dC(r,o));await t._updateTokensIfNecessary(l,!0)}function kC(t,e,n,r){return qe(t).onIdTokenChanged(e,n,r)}function SC(t,e,n){return qe(t).beforeAuthStateChanged(e,n)}function PC(t,e,n,r){return qe(t).onAuthStateChanged(e,n,r)}function IC(t){return qe(t).signOut()}async function CC(t){return qe(t).delete()}const bh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(bh,"1"),this.storage.removeItem(bh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC=1e3,RC=10;class uN extends cN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=X1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((l,h,f)=>{this.notifyListeners(l,f)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(r);!n&&this.localCache[r]===l||this.notifyListeners(r,l)},o=this.storage.getItem(r);qI()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,RC):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},AC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}uN.type="LOCAL";const LC=uN;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN extends cN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}dN.type="SESSION";const hN=dN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DC(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new rf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:o}=n.data,l=this.handlersMap[s];if(!(l!=null&&l.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const h=Array.from(l).map(async m=>m(n.origin,o)),f=await DC(h);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:f})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}rf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ny(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,l;return new Promise((h,f)=>{const m=Ny("",20);s.port1.start();const g=setTimeout(()=>{f(new Error("unsupported_event"))},r);l={messageChannel:s,onMessage(_){const w=_;if(w.data.eventId===m)switch(w.data.status){case"ack":clearTimeout(g),o=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),h(w.data.response);break;default:clearTimeout(g),clearTimeout(o),f(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:m,data:n},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $r(){return window}function MC(t){$r().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fN(){return typeof $r().WorkerGlobalScope<"u"&&typeof $r().importScripts=="function"}async function OC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function VC(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function UC(){return fN()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mN="firebaseLocalStorageDb",FC=1,Nh="firebaseLocalStorage",pN="fbase_key";class lu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function sf(t,e){return t.transaction([Nh],e?"readwrite":"readonly").objectStore(Nh)}function BC(){const t=indexedDB.deleteDatabase(mN);return new lu(t).toPromise()}function Mp(){const t=indexedDB.open(mN,FC);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Nh,{keyPath:pN})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Nh)?e(r):(r.close(),await BC(),e(await Mp()))})})}async function Ix(t,e,n){const r=sf(t,!0).put({[pN]:e,value:n});return new lu(r).toPromise()}async function $C(t,e){const n=sf(t,!1).get(e),r=await new lu(n).toPromise();return r===void 0?null:r.value}function Cx(t,e){const n=sf(t,!0).delete(e);return new lu(n).toPromise()}const WC=800,HC=3;class gN{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Mp(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>HC)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return fN()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=rf._getInstance(UC()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await OC(),!this.activeServiceWorker)return;this.sender=new zC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||VC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Mp();return await Ix(e,bh,"1"),await Cx(e,bh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Ix(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>$C(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Cx(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=sf(s,!1).getAll();return new lu(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),WC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}gN.type="LOCAL";const qC=gN;new iu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZC(t,e){return e?gs(e):(Ne(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey extends wy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Va(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Va(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Va(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function GC(t){return oN(t.auth,new Ey(t),t.bypassAuthState)}function KC(t){const{auth:e,user:n}=t;return Ne(n,e,"internal-error"),iN(n,new Ey(t),t.bypassAuthState)}async function QC(t){const{auth:e,user:n}=t;return Ne(n,e,"internal-error"),xC(n,new Ey(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN{constructor(e,n,r,s,o=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:o,error:l,type:h}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:n,sessionId:r,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(f))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return GC;case"linkViaPopup":case"linkViaRedirect":return QC;case"reauthViaPopup":case"reauthViaRedirect":return KC;default:yr(this.auth,"internal-error")}}resolve(e){Ss(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ss(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YC=new iu(2e3,1e4);class Ia extends yN{constructor(e,n,r,s,o){super(e,n,s,o),this.provider=r,this.authWindow=null,this.pollId=null,Ia.currentPopupAction&&Ia.currentPopupAction.cancel(),Ia.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ne(e,this.auth,"internal-error"),e}async onExecution(){Ss(this.filter.length===1,"Popup operations only handle one event");const e=Ny();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Br(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Br(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ia.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Br(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,YC.get())};e()}}Ia.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XC="pendingRedirect",Md=new Map;class JC extends yN{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Md.get(this.auth._key());if(!e){try{const r=await eA(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Md.set(this.auth._key(),e)}return this.bypassAuthState||Md.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function eA(t,e){const n=rA(e),r=nA(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function tA(t,e){Md.set(t._key(),e)}function nA(t){return gs(t._redirectPersistence)}function rA(t){return zd(XC,t.config.apiKey,t.name)}async function sA(t,e,n=!1){if(Rn(t.app))return Promise.reject(vs(t));const r=Ro(t),s=ZC(r,e),l=await new JC(r,s,n).execute();return l&&!n&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iA=10*60*1e3;class oA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!aA(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!_N(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Br(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=iA&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ax(e))}saveEventToCache(e){this.cachedEventUids.add(Ax(e)),this.lastProcessedEventTime=Date.now()}}function Ax(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function _N({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function aA(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return _N(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lA(t,e={}){return Xr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,uA=/^https?/;async function dA(t){if(t.config.emulator)return;const{authorizedDomains:e}=await lA(t);for(const n of e)try{if(hA(n))return}catch{}yr(t,"unauthorized-domain")}function hA(t){const e=Rp(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const l=new URL(t);return l.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&l.hostname===r}if(!uA.test(n))return!1;if(cA.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fA=new iu(3e4,6e4);function Rx(){const t=$r().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function mA(t){return new Promise((e,n)=>{var s,o,l;function r(){Rx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Rx(),n(Br(t,"network-request-failed"))},timeout:fA.get()})}if((o=(s=$r().gapi)==null?void 0:s.iframes)!=null&&o.Iframe)e(gapi.iframes.getContext());else if((l=$r().gapi)!=null&&l.load)r();else{const h=tC("iframefcb");return $r()[h]=()=>{gapi.load?r():n(Br(t,"network-request-failed"))},eN(`${eC()}?onload=${h}`).catch(f=>n(f))}}).catch(e=>{throw Od=null,e})}let Od=null;function pA(t){return Od=Od||mA(t),Od}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gA=new iu(5e3,15e3),yA="__/auth/iframe",_A="emulator/auth/iframe",vA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},xA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function wA(t){const e=t.config;Ne(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?_y(e,_A):`https://${t.config.authDomain}/${yA}`,r={apiKey:e.apiKey,appName:t.name,v:Ao},s=xA.get(t.config.apiHost);s&&(r.eid=s);const o=t._getFrameworks();return o.length&&(r.fw=o.join(",")),`${n}?${su(r).slice(1)}`}async function bA(t){const e=await pA(t),n=$r().gapi;return Ne(n,t,"internal-error"),e.open({where:document.body,url:wA(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:vA,dontclear:!0},r=>new Promise(async(s,o)=>{await r.restyle({setHideOnLeave:!1});const l=Br(t,"network-request-failed"),h=$r().setTimeout(()=>{o(l)},gA.get());function f(){$r().clearTimeout(h),s(r)}r.ping(f).then(f,()=>{o(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},EA=500,TA=600,jA="_blank",kA="http://localhost";class Lx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function SA(t,e,n,r=EA,s=TA){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let h="";const f={...NA,width:r.toString(),height:s.toString(),top:o,left:l},m=rn().toLowerCase();n&&(h=Z1(m)?jA:n),H1(m)&&(e=e||kA,f.scrollbars="yes");const g=Object.entries(f).reduce((w,[T,j])=>`${w}${T}=${j},`,"");if(HI(m)&&h!=="_self")return PA(e||"",h),new Lx(null);const _=window.open(e||"",h,g);Ne(_,t,"popup-blocked");try{_.focus()}catch{}return new Lx(_)}function PA(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IA="__/auth/handler",CA="emulator/auth/handler",AA=encodeURIComponent("fac");async function Dx(t,e,n,r,s,o){Ne(t.config.authDomain,t,"auth-domain-config-required"),Ne(t.config.apiKey,t,"invalid-api-key");const l={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ao,eventId:s};if(e instanceof rN){e.setDefaultLanguage(t.languageCode),l.providerId=e.providerId||"",fP(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,_]of Object.entries({}))l[g]=_}if(e instanceof au){const g=e.getScopes().filter(_=>_!=="");g.length>0&&(l.scopes=g.join(","))}t.tenantId&&(l.tid=t.tenantId);const h=l;for(const g of Object.keys(h))h[g]===void 0&&delete h[g];const f=await t._getAppCheckToken(),m=f?`#${AA}=${encodeURIComponent(f)}`:"";return`${RA(t)}?${su(h).slice(1)}${m}`}function RA({config:t}){return t.emulator?_y(t,CA):`https://${t.authDomain}/${IA}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bm="webStorageSupport";class LA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=hN,this._completeRedirectFn=sA,this._overrideRedirectResult=tA}async _openPopup(e,n,r,s){var l;Ss((l=this.eventManagers[e._key()])==null?void 0:l.manager,"_initialize() not called before _openPopup()");const o=await Dx(e,n,r,Rp(),s);return SA(e,o,Ny())}async _openRedirect(e,n,r,s){await this._originValidation(e);const o=await Dx(e,n,r,Rp(),s);return MC(o),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:o}=this.eventManagers[n];return s?Promise.resolve(s):(Ss(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await bA(e),r=new oA(e);return n.register("authEvent",s=>(Ne(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(bm,{type:bm},s=>{var l;const o=(l=s==null?void 0:s[0])==null?void 0:l[bm];o!==void 0&&n(!!o),yr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=dA(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return X1()||q1()||xy()}}const DA=LA;var zx="@firebase/auth",Mx="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ne(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MA(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function OA(t){bo(new wi("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:h}=r.options;Ne(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const f={apiKey:l,authDomain:h,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:J1(t)},m=new YI(r,s,o,f);return aC(m,n),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),bo(new wi("auth-internal",e=>{const n=Ro(e.getProvider("auth").getImmediate());return(r=>new zA(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fr(zx,Mx,MA(t)),Fr(zx,Mx,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VA=5*60,UA=I1("authIdTokenMaxAge")||VA;let Ox=null;const FA=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>UA)return;const s=n==null?void 0:n.token;Ox!==s&&(Ox=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function BA(t=gy()){const e=tf(t,"auth");if(e.isInitialized())return e.getImmediate();const n=oC(t,{popupRedirectResolver:DA,persistence:[qC,LC,hN]}),r=I1("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const l=FA(o.toString());SC(n,l,()=>l(n.currentUser)),kC(n,h=>l(h))}}const s=k1("auth");return s&&lC(n,`http://${s}`),n}function $A(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}XI({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const o=Br("internal-error");o.customData=s,n(o)},r.type="text/javascript",r.charset="UTF-8",$A().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});OA("Browser");var Vx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var gi,vN;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,N){function R(){}R.prototype=N.prototype,E.F=N.prototype,E.prototype=new R,E.prototype.constructor=E,E.D=function(P,A,$){for(var z=Array(arguments.length-2),xe=2;xe<arguments.length;xe++)z[xe-2]=arguments[xe];return N.prototype[A].apply(P,z)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,N,R){R||(R=0);const P=Array(16);if(typeof N=="string")for(var A=0;A<16;++A)P[A]=N.charCodeAt(R++)|N.charCodeAt(R++)<<8|N.charCodeAt(R++)<<16|N.charCodeAt(R++)<<24;else for(A=0;A<16;++A)P[A]=N[R++]|N[R++]<<8|N[R++]<<16|N[R++]<<24;N=E.g[0],R=E.g[1],A=E.g[2];let $=E.g[3],z;z=N+($^R&(A^$))+P[0]+3614090360&4294967295,N=R+(z<<7&4294967295|z>>>25),z=$+(A^N&(R^A))+P[1]+3905402710&4294967295,$=N+(z<<12&4294967295|z>>>20),z=A+(R^$&(N^R))+P[2]+606105819&4294967295,A=$+(z<<17&4294967295|z>>>15),z=R+(N^A&($^N))+P[3]+3250441966&4294967295,R=A+(z<<22&4294967295|z>>>10),z=N+($^R&(A^$))+P[4]+4118548399&4294967295,N=R+(z<<7&4294967295|z>>>25),z=$+(A^N&(R^A))+P[5]+1200080426&4294967295,$=N+(z<<12&4294967295|z>>>20),z=A+(R^$&(N^R))+P[6]+2821735955&4294967295,A=$+(z<<17&4294967295|z>>>15),z=R+(N^A&($^N))+P[7]+4249261313&4294967295,R=A+(z<<22&4294967295|z>>>10),z=N+($^R&(A^$))+P[8]+1770035416&4294967295,N=R+(z<<7&4294967295|z>>>25),z=$+(A^N&(R^A))+P[9]+2336552879&4294967295,$=N+(z<<12&4294967295|z>>>20),z=A+(R^$&(N^R))+P[10]+4294925233&4294967295,A=$+(z<<17&4294967295|z>>>15),z=R+(N^A&($^N))+P[11]+2304563134&4294967295,R=A+(z<<22&4294967295|z>>>10),z=N+($^R&(A^$))+P[12]+1804603682&4294967295,N=R+(z<<7&4294967295|z>>>25),z=$+(A^N&(R^A))+P[13]+4254626195&4294967295,$=N+(z<<12&4294967295|z>>>20),z=A+(R^$&(N^R))+P[14]+2792965006&4294967295,A=$+(z<<17&4294967295|z>>>15),z=R+(N^A&($^N))+P[15]+1236535329&4294967295,R=A+(z<<22&4294967295|z>>>10),z=N+(A^$&(R^A))+P[1]+4129170786&4294967295,N=R+(z<<5&4294967295|z>>>27),z=$+(R^A&(N^R))+P[6]+3225465664&4294967295,$=N+(z<<9&4294967295|z>>>23),z=A+(N^R&($^N))+P[11]+643717713&4294967295,A=$+(z<<14&4294967295|z>>>18),z=R+($^N&(A^$))+P[0]+3921069994&4294967295,R=A+(z<<20&4294967295|z>>>12),z=N+(A^$&(R^A))+P[5]+3593408605&4294967295,N=R+(z<<5&4294967295|z>>>27),z=$+(R^A&(N^R))+P[10]+38016083&4294967295,$=N+(z<<9&4294967295|z>>>23),z=A+(N^R&($^N))+P[15]+3634488961&4294967295,A=$+(z<<14&4294967295|z>>>18),z=R+($^N&(A^$))+P[4]+3889429448&4294967295,R=A+(z<<20&4294967295|z>>>12),z=N+(A^$&(R^A))+P[9]+568446438&4294967295,N=R+(z<<5&4294967295|z>>>27),z=$+(R^A&(N^R))+P[14]+3275163606&4294967295,$=N+(z<<9&4294967295|z>>>23),z=A+(N^R&($^N))+P[3]+4107603335&4294967295,A=$+(z<<14&4294967295|z>>>18),z=R+($^N&(A^$))+P[8]+1163531501&4294967295,R=A+(z<<20&4294967295|z>>>12),z=N+(A^$&(R^A))+P[13]+2850285829&4294967295,N=R+(z<<5&4294967295|z>>>27),z=$+(R^A&(N^R))+P[2]+4243563512&4294967295,$=N+(z<<9&4294967295|z>>>23),z=A+(N^R&($^N))+P[7]+1735328473&4294967295,A=$+(z<<14&4294967295|z>>>18),z=R+($^N&(A^$))+P[12]+2368359562&4294967295,R=A+(z<<20&4294967295|z>>>12),z=N+(R^A^$)+P[5]+4294588738&4294967295,N=R+(z<<4&4294967295|z>>>28),z=$+(N^R^A)+P[8]+2272392833&4294967295,$=N+(z<<11&4294967295|z>>>21),z=A+($^N^R)+P[11]+1839030562&4294967295,A=$+(z<<16&4294967295|z>>>16),z=R+(A^$^N)+P[14]+4259657740&4294967295,R=A+(z<<23&4294967295|z>>>9),z=N+(R^A^$)+P[1]+2763975236&4294967295,N=R+(z<<4&4294967295|z>>>28),z=$+(N^R^A)+P[4]+1272893353&4294967295,$=N+(z<<11&4294967295|z>>>21),z=A+($^N^R)+P[7]+4139469664&4294967295,A=$+(z<<16&4294967295|z>>>16),z=R+(A^$^N)+P[10]+3200236656&4294967295,R=A+(z<<23&4294967295|z>>>9),z=N+(R^A^$)+P[13]+681279174&4294967295,N=R+(z<<4&4294967295|z>>>28),z=$+(N^R^A)+P[0]+3936430074&4294967295,$=N+(z<<11&4294967295|z>>>21),z=A+($^N^R)+P[3]+3572445317&4294967295,A=$+(z<<16&4294967295|z>>>16),z=R+(A^$^N)+P[6]+76029189&4294967295,R=A+(z<<23&4294967295|z>>>9),z=N+(R^A^$)+P[9]+3654602809&4294967295,N=R+(z<<4&4294967295|z>>>28),z=$+(N^R^A)+P[12]+3873151461&4294967295,$=N+(z<<11&4294967295|z>>>21),z=A+($^N^R)+P[15]+530742520&4294967295,A=$+(z<<16&4294967295|z>>>16),z=R+(A^$^N)+P[2]+3299628645&4294967295,R=A+(z<<23&4294967295|z>>>9),z=N+(A^(R|~$))+P[0]+4096336452&4294967295,N=R+(z<<6&4294967295|z>>>26),z=$+(R^(N|~A))+P[7]+1126891415&4294967295,$=N+(z<<10&4294967295|z>>>22),z=A+(N^($|~R))+P[14]+2878612391&4294967295,A=$+(z<<15&4294967295|z>>>17),z=R+($^(A|~N))+P[5]+4237533241&4294967295,R=A+(z<<21&4294967295|z>>>11),z=N+(A^(R|~$))+P[12]+1700485571&4294967295,N=R+(z<<6&4294967295|z>>>26),z=$+(R^(N|~A))+P[3]+2399980690&4294967295,$=N+(z<<10&4294967295|z>>>22),z=A+(N^($|~R))+P[10]+4293915773&4294967295,A=$+(z<<15&4294967295|z>>>17),z=R+($^(A|~N))+P[1]+2240044497&4294967295,R=A+(z<<21&4294967295|z>>>11),z=N+(A^(R|~$))+P[8]+1873313359&4294967295,N=R+(z<<6&4294967295|z>>>26),z=$+(R^(N|~A))+P[15]+4264355552&4294967295,$=N+(z<<10&4294967295|z>>>22),z=A+(N^($|~R))+P[6]+2734768916&4294967295,A=$+(z<<15&4294967295|z>>>17),z=R+($^(A|~N))+P[13]+1309151649&4294967295,R=A+(z<<21&4294967295|z>>>11),z=N+(A^(R|~$))+P[4]+4149444226&4294967295,N=R+(z<<6&4294967295|z>>>26),z=$+(R^(N|~A))+P[11]+3174756917&4294967295,$=N+(z<<10&4294967295|z>>>22),z=A+(N^($|~R))+P[2]+718787259&4294967295,A=$+(z<<15&4294967295|z>>>17),z=R+($^(A|~N))+P[9]+3951481745&4294967295,E.g[0]=E.g[0]+N&4294967295,E.g[1]=E.g[1]+(A+(z<<21&4294967295|z>>>11))&4294967295,E.g[2]=E.g[2]+A&4294967295,E.g[3]=E.g[3]+$&4294967295}r.prototype.v=function(E,N){N===void 0&&(N=E.length);const R=N-this.blockSize,P=this.C;let A=this.h,$=0;for(;$<N;){if(A==0)for(;$<=R;)s(this,E,$),$+=this.blockSize;if(typeof E=="string"){for(;$<N;)if(P[A++]=E.charCodeAt($++),A==this.blockSize){s(this,P),A=0;break}}else for(;$<N;)if(P[A++]=E[$++],A==this.blockSize){s(this,P),A=0;break}}this.h=A,this.o+=N},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var N=1;N<E.length-8;++N)E[N]=0;N=this.o*8;for(var R=E.length-8;R<E.length;++R)E[R]=N&255,N/=256;for(this.v(E),E=Array(16),N=0,R=0;R<4;++R)for(let P=0;P<32;P+=8)E[N++]=this.g[R]>>>P&255;return E};function o(E,N){var R=h;return Object.prototype.hasOwnProperty.call(R,E)?R[E]:R[E]=N(E)}function l(E,N){this.h=N;const R=[];let P=!0;for(let A=E.length-1;A>=0;A--){const $=E[A]|0;P&&$==N||(R[A]=$,P=!1)}this.g=R}var h={};function f(E){return-128<=E&&E<128?o(E,function(N){return new l([N|0],N<0?-1:0)}):new l([E|0],E<0?-1:0)}function m(E){if(isNaN(E)||!isFinite(E))return _;if(E<0)return M(m(-E));const N=[];let R=1;for(let P=0;E>=R;P++)N[P]=E/R|0,R*=4294967296;return new l(N,0)}function g(E,N){if(E.length==0)throw Error("number format error: empty string");if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(E.charAt(0)=="-")return M(g(E.substring(1),N));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=m(Math.pow(N,8));let P=_;for(let $=0;$<E.length;$+=8){var A=Math.min(8,E.length-$);const z=parseInt(E.substring($,$+A),N);A<8?(A=m(Math.pow(N,A)),P=P.j(A).add(m(z))):(P=P.j(R),P=P.add(m(z)))}return P}var _=f(0),w=f(1),T=f(16777216);t=l.prototype,t.m=function(){if(D(this))return-M(this).m();let E=0,N=1;for(let R=0;R<this.g.length;R++){const P=this.i(R);E+=(P>=0?P:4294967296+P)*N,N*=4294967296}return E},t.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(j(this))return"0";if(D(this))return"-"+M(this).toString(E);const N=m(Math.pow(E,6));var R=this;let P="";for(;;){const A=U(R,N).g;R=k(R,A.j(N));let $=((R.g.length>0?R.g[0]:R.h)>>>0).toString(E);if(R=A,j(R))return $+P;for(;$.length<6;)$="0"+$;P=$+P}},t.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function j(E){if(E.h!=0)return!1;for(let N=0;N<E.g.length;N++)if(E.g[N]!=0)return!1;return!0}function D(E){return E.h==-1}t.l=function(E){return E=k(this,E),D(E)?-1:j(E)?0:1};function M(E){const N=E.g.length,R=[];for(let P=0;P<N;P++)R[P]=~E.g[P];return new l(R,~E.h).add(w)}t.abs=function(){return D(this)?M(this):this},t.add=function(E){const N=Math.max(this.g.length,E.g.length),R=[];let P=0;for(let A=0;A<=N;A++){let $=P+(this.i(A)&65535)+(E.i(A)&65535),z=($>>>16)+(this.i(A)>>>16)+(E.i(A)>>>16);P=z>>>16,$&=65535,z&=65535,R[A]=z<<16|$}return new l(R,R[R.length-1]&-2147483648?-1:0)};function k(E,N){return E.add(M(N))}t.j=function(E){if(j(this)||j(E))return _;if(D(this))return D(E)?M(this).j(M(E)):M(M(this).j(E));if(D(E))return M(this.j(M(E)));if(this.l(T)<0&&E.l(T)<0)return m(this.m()*E.m());const N=this.g.length+E.g.length,R=[];for(var P=0;P<2*N;P++)R[P]=0;for(P=0;P<this.g.length;P++)for(let A=0;A<E.g.length;A++){const $=this.i(P)>>>16,z=this.i(P)&65535,xe=E.i(A)>>>16,oe=E.i(A)&65535;R[2*P+2*A]+=z*oe,S(R,2*P+2*A),R[2*P+2*A+1]+=$*oe,S(R,2*P+2*A+1),R[2*P+2*A+1]+=z*xe,S(R,2*P+2*A+1),R[2*P+2*A+2]+=$*xe,S(R,2*P+2*A+2)}for(E=0;E<N;E++)R[E]=R[2*E+1]<<16|R[2*E];for(E=N;E<2*N;E++)R[E]=0;return new l(R,0)};function S(E,N){for(;(E[N]&65535)!=E[N];)E[N+1]+=E[N]>>>16,E[N]&=65535,N++}function C(E,N){this.g=E,this.h=N}function U(E,N){if(j(N))throw Error("division by zero");if(j(E))return new C(_,_);if(D(E))return N=U(M(E),N),new C(M(N.g),M(N.h));if(D(N))return N=U(E,M(N)),new C(M(N.g),N.h);if(E.g.length>30){if(D(E)||D(N))throw Error("slowDivide_ only works with positive integers.");for(var R=w,P=N;P.l(E)<=0;)R=F(R),P=F(P);var A=V(R,1),$=V(P,1);for(P=V(P,2),R=V(R,2);!j(P);){var z=$.add(P);z.l(E)<=0&&(A=A.add(R),$=z),P=V(P,1),R=V(R,1)}return N=k(E,A.j(N)),new C(A,N)}for(A=_;E.l(N)>=0;){for(R=Math.max(1,Math.floor(E.m()/N.m())),P=Math.ceil(Math.log(R)/Math.LN2),P=P<=48?1:Math.pow(2,P-48),$=m(R),z=$.j(N);D(z)||z.l(E)>0;)R-=P,$=m(R),z=$.j(N);j($)&&($=w),A=A.add($),E=k(E,z)}return new C(A,E)}t.B=function(E){return U(this,E).h},t.and=function(E){const N=Math.max(this.g.length,E.g.length),R=[];for(let P=0;P<N;P++)R[P]=this.i(P)&E.i(P);return new l(R,this.h&E.h)},t.or=function(E){const N=Math.max(this.g.length,E.g.length),R=[];for(let P=0;P<N;P++)R[P]=this.i(P)|E.i(P);return new l(R,this.h|E.h)},t.xor=function(E){const N=Math.max(this.g.length,E.g.length),R=[];for(let P=0;P<N;P++)R[P]=this.i(P)^E.i(P);return new l(R,this.h^E.h)};function F(E){const N=E.g.length+1,R=[];for(let P=0;P<N;P++)R[P]=E.i(P)<<1|E.i(P-1)>>>31;return new l(R,E.h)}function V(E,N){const R=N>>5;N%=32;const P=E.g.length-R,A=[];for(let $=0;$<P;$++)A[$]=N>0?E.i($+R)>>>N|E.i($+R+1)<<32-N:E.i($+R);return new l(A,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,vN=r,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=m,l.fromString=g,gi=l}).apply(typeof Vx<"u"?Vx:typeof self<"u"?self:typeof window<"u"?window:{});var md=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xN,Jl,wN,Vd,Op,bN,NN,EN;(function(){var t,e=Object.defineProperty;function n(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof md=="object"&&md];for(var y=0;y<u.length;++y){var x=u[y];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var r=n(this);function s(u,y){if(y)e:{var x=r;u=u.split(".");for(var I=0;I<u.length-1;I++){var W=u[I];if(!(W in x))break e;x=x[W]}u=u[u.length-1],I=x[u],y=y(I),y!=I&&y!=null&&e(x,u,{configurable:!0,writable:!0,value:y})}}s("Symbol.dispose",function(u){return u||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(u){return u||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(u){return u||function(y){var x=[],I;for(I in y)Object.prototype.hasOwnProperty.call(y,I)&&x.push([I,y[I]]);return x}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function h(u){var y=typeof u;return y=="object"&&u!=null||y=="function"}function f(u,y,x){return u.call.apply(u.bind,arguments)}function m(u,y,x){return m=f,m.apply(null,arguments)}function g(u,y){var x=Array.prototype.slice.call(arguments,1);return function(){var I=x.slice();return I.push.apply(I,arguments),u.apply(this,I)}}function _(u,y){function x(){}x.prototype=y.prototype,u.Z=y.prototype,u.prototype=new x,u.prototype.constructor=u,u.Ob=function(I,W,Z){for(var ie=Array(arguments.length-2),je=2;je<arguments.length;je++)ie[je-2]=arguments[je];return y.prototype[W].apply(I,ie)}}var w=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?u=>u&&AsyncContext.Snapshot.wrap(u):u=>u;function T(u){const y=u.length;if(y>0){const x=Array(y);for(let I=0;I<y;I++)x[I]=u[I];return x}return[]}function j(u,y){for(let I=1;I<arguments.length;I++){const W=arguments[I];var x=typeof W;if(x=x!="object"?x:W?Array.isArray(W)?"array":x:"null",x=="array"||x=="object"&&typeof W.length=="number"){x=u.length||0;const Z=W.length||0;u.length=x+Z;for(let ie=0;ie<Z;ie++)u[x+ie]=W[ie]}else u.push(W)}}class D{constructor(y,x){this.i=y,this.j=x,this.h=0,this.g=null}get(){let y;return this.h>0?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function M(u){l.setTimeout(()=>{throw u},0)}function k(){var u=E;let y=null;return u.g&&(y=u.g,u.g=u.g.next,u.g||(u.h=null),y.next=null),y}class S{constructor(){this.h=this.g=null}add(y,x){const I=C.get();I.set(y,x),this.h?this.h.next=I:this.g=I,this.h=I}}var C=new D(()=>new U,u=>u.reset());class U{constructor(){this.next=this.g=this.h=null}set(y,x){this.h=y,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let F,V=!1,E=new S,N=()=>{const u=Promise.resolve(void 0);F=()=>{u.then(R)}};function R(){for(var u;u=k();){try{u.h.call(u.g)}catch(x){M(x)}var y=C;y.j(u),y.h<100&&(y.h++,u.next=y.g,y.g=u)}V=!1}function P(){this.u=this.u,this.C=this.C}P.prototype.u=!1,P.prototype.dispose=function(){this.u||(this.u=!0,this.N())},P.prototype[Symbol.dispose]=function(){this.dispose()},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function A(u,y){this.type=u,this.g=this.target=y,this.defaultPrevented=!1}A.prototype.h=function(){this.defaultPrevented=!0};var $=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var u=!1,y=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const x=()=>{};l.addEventListener("test",x,y),l.removeEventListener("test",x,y)}catch{}return u}();function z(u){return/^[\s\xa0]*$/.test(u)}function xe(u,y){A.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u&&this.init(u,y)}_(xe,A),xe.prototype.init=function(u,y){const x=this.type=u.type,I=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;this.target=u.target||u.srcElement,this.g=y,y=u.relatedTarget,y||(x=="mouseover"?y=u.fromElement:x=="mouseout"&&(y=u.toElement)),this.relatedTarget=y,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=u.pointerType,this.state=u.state,this.i=u,u.defaultPrevented&&xe.Z.h.call(this)},xe.prototype.h=function(){xe.Z.h.call(this);const u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var oe="closure_listenable_"+(Math.random()*1e6|0),ue=0;function ne(u,y,x,I,W){this.listener=u,this.proxy=null,this.src=y,this.type=x,this.capture=!!I,this.ha=W,this.key=++ue,this.da=this.fa=!1}function H(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function re(u,y,x){for(const I in u)y.call(x,u[I],I,u)}function X(u,y){for(const x in u)y.call(void 0,u[x],x,u)}function Q(u){const y={};for(const x in u)y[x]=u[x];return y}const G="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function le(u,y){let x,I;for(let W=1;W<arguments.length;W++){I=arguments[W];for(x in I)u[x]=I[x];for(let Z=0;Z<G.length;Z++)x=G[Z],Object.prototype.hasOwnProperty.call(I,x)&&(u[x]=I[x])}}function _e(u){this.src=u,this.g={},this.h=0}_e.prototype.add=function(u,y,x,I,W){const Z=u.toString();u=this.g[Z],u||(u=this.g[Z]=[],this.h++);const ie=ye(u,y,I,W);return ie>-1?(y=u[ie],x||(y.fa=!1)):(y=new ne(y,this.src,Z,!!I,W),y.fa=x,u.push(y)),y};function ge(u,y){const x=y.type;if(x in u.g){var I=u.g[x],W=Array.prototype.indexOf.call(I,y,void 0),Z;(Z=W>=0)&&Array.prototype.splice.call(I,W,1),Z&&(H(y),u.g[x].length==0&&(delete u.g[x],u.h--))}}function ye(u,y,x,I){for(let W=0;W<u.length;++W){const Z=u[W];if(!Z.da&&Z.listener==y&&Z.capture==!!x&&Z.ha==I)return W}return-1}var rt="closure_lm_"+(Math.random()*1e6|0),Pe={};function st(u,y,x,I,W){if(Array.isArray(y)){for(let Z=0;Z<y.length;Z++)st(u,y[Z],x,I,W);return null}return x=Fi(x),u&&u[oe]?u.J(y,x,h(I)?!!I.capture:!1,W):mn(u,y,x,!1,I,W)}function mn(u,y,x,I,W,Z){if(!y)throw Error("Invalid event type");const ie=h(W)?!!W.capture:!!W;let je=Pn(u);if(je||(u[rt]=je=new _e(u)),x=je.add(y,x,I,ie,Z),x.proxy)return x;if(I=Y(),x.proxy=I,I.src=u,I.listener=x,u.addEventListener)$||(W=ie),W===void 0&&(W=!1),u.addEventListener(y.toString(),I,W);else if(u.attachEvent)u.attachEvent(Ke(y.toString()),I);else if(u.addListener&&u.removeListener)u.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return x}function Y(){function u(x){return y.call(u.src,u.listener,x)}const y=xt;return u}function we(u,y,x,I,W){if(Array.isArray(y))for(var Z=0;Z<y.length;Z++)we(u,y[Z],x,I,W);else I=h(I)?!!I.capture:!!I,x=Fi(x),u&&u[oe]?(u=u.i,Z=String(y).toString(),Z in u.g&&(y=u.g[Z],x=ye(y,x,I,W),x>-1&&(H(y[x]),Array.prototype.splice.call(y,x,1),y.length==0&&(delete u.g[Z],u.h--)))):u&&(u=Pn(u))&&(y=u.g[y.toString()],u=-1,y&&(u=ye(y,x,I,W)),(x=u>-1?y[u]:null)&&Je(x))}function Je(u){if(typeof u!="number"&&u&&!u.da){var y=u.src;if(y&&y[oe])ge(y.i,u);else{var x=u.type,I=u.proxy;y.removeEventListener?y.removeEventListener(x,I,u.capture):y.detachEvent?y.detachEvent(Ke(x),I):y.addListener&&y.removeListener&&y.removeListener(I),(x=Pn(y))?(ge(x,u),x.h==0&&(x.src=null,y[rt]=null)):H(u)}}}function Ke(u){return u in Pe?Pe[u]:Pe[u]="on"+u}function xt(u,y){if(u.da)u=!0;else{y=new xe(y,this);const x=u.listener,I=u.ha||u.src;u.fa&&Je(u),u=x.call(I,y)}return u}function Pn(u){return u=u[rt],u instanceof _e?u:null}var Ui="__closure_events_fn_"+(Math.random()*1e9>>>0);function Fi(u){return typeof u=="function"?u:(u[Ui]||(u[Ui]=function(y){return u.handleEvent(y)}),u[Ui])}function Rt(){P.call(this),this.i=new _e(this),this.M=this,this.G=null}_(Rt,P),Rt.prototype[oe]=!0,Rt.prototype.removeEventListener=function(u,y,x,I){we(this,u,y,x,I)};function Lt(u,y){var x,I=u.G;if(I)for(x=[];I;I=I.G)x.push(I);if(u=u.M,I=y.type||y,typeof y=="string")y=new A(y,u);else if(y instanceof A)y.target=y.target||u;else{var W=y;y=new A(I,u),le(y,W)}W=!0;let Z,ie;if(x)for(ie=x.length-1;ie>=0;ie--)Z=y.g=x[ie],W=Rs(Z,I,!0,y)&&W;if(Z=y.g=u,W=Rs(Z,I,!0,y)&&W,W=Rs(Z,I,!1,y)&&W,x)for(ie=0;ie<x.length;ie++)Z=y.g=x[ie],W=Rs(Z,I,!1,y)&&W}Rt.prototype.N=function(){if(Rt.Z.N.call(this),this.i){var u=this.i;for(const y in u.g){const x=u.g[y];for(let I=0;I<x.length;I++)H(x[I]);delete u.g[y],u.h--}}this.G=null},Rt.prototype.J=function(u,y,x,I){return this.i.add(String(u),y,!1,x,I)},Rt.prototype.K=function(u,y,x,I){return this.i.add(String(u),y,!0,x,I)};function Rs(u,y,x,I){if(y=u.i.g[String(y)],!y)return!0;y=y.concat();let W=!0;for(let Z=0;Z<y.length;++Z){const ie=y[Z];if(ie&&!ie.da&&ie.capture==x){const je=ie.listener,Be=ie.ha||ie.src;ie.fa&&ge(u.i,ie),W=je.call(Be,I)!==!1&&W}}return W&&!I.defaultPrevented}function _u(u,y){if(typeof u!="function")if(u&&typeof u.handleEvent=="function")u=m(u.handleEvent,u);else throw Error("Invalid listener argument");return Number(y)>2147483647?-1:l.setTimeout(u,y||0)}function hl(u){u.g=_u(()=>{u.g=null,u.i&&(u.i=!1,hl(u))},u.l);const y=u.h;u.h=null,u.m.apply(null,y)}class If extends P{constructor(y,x){super(),this.m=y,this.l=x,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:hl(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bi(u){P.call(this),this.h=u,this.g={}}_(Bi,P);var Mo=[];function fl(u){re(u.g,function(y,x){this.g.hasOwnProperty(x)&&Je(y)},u),u.g={}}Bi.prototype.N=function(){Bi.Z.N.call(this),fl(this)},Bi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Oo=l.JSON.stringify,Cf=l.JSON.parse,vu=class{stringify(u){return l.JSON.stringify(u,void 0)}parse(u){return l.JSON.parse(u,void 0)}};function ml(){}function xu(){}var Ls={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function $i(){A.call(this,"d")}_($i,A);function Vo(){A.call(this,"c")}_(Vo,A);var Jr={},Ds=null;function Uo(){return Ds=Ds||new Rt}Jr.Ia="serverreachability";function wu(u){A.call(this,Jr.Ia,u)}_(wu,A);function zs(u){const y=Uo();Lt(y,new wu(y))}Jr.STAT_EVENT="statevent";function pl(u,y){A.call(this,Jr.STAT_EVENT,u),this.stat=y}_(pl,A);function Dt(u){const y=Uo();Lt(y,new pl(y,u))}Jr.Ja="timingevent";function bu(u,y){A.call(this,Jr.Ja,u),this.size=y}_(bu,A);function Wi(u,y){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){u()},y)}function Hi(){this.g=!0}Hi.prototype.ua=function(){this.g=!1};function Af(u,y,x,I,W,Z){u.info(function(){if(u.g)if(Z){var ie="",je=Z.split("&");for(let We=0;We<je.length;We++){var Be=je[We].split("=");if(Be.length>1){const gt=Be[0];Be=Be[1];const Hn=gt.split("_");ie=Hn.length>=2&&Hn[1]=="type"?ie+(gt+"="+Be+"&"):ie+(gt+"=redacted&")}}}else ie=null;else ie=Z;return"XMLHTTP REQ ("+I+") [attempt "+W+"]: "+y+`
`+x+`
`+ie})}function Rf(u,y,x,I,W,Z,ie){u.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+W+"]: "+y+`
`+x+`
`+Z+" "+ie})}function Ms(u,y,x,I){u.info(function(){return"XMLHTTP TEXT ("+y+"): "+Lf(u,x)+(I?" "+I:"")})}function gl(u,y){u.info(function(){return"TIMEOUT: "+y})}Hi.prototype.info=function(){};function Lf(u,y){if(!u.g)return y;if(!y)return null;try{const Z=JSON.parse(y);if(Z){for(u=0;u<Z.length;u++)if(Array.isArray(Z[u])){var x=Z[u];if(!(x.length<2)){var I=x[1];if(Array.isArray(I)&&!(I.length<1)){var W=I[0];if(W!="noop"&&W!="stop"&&W!="close")for(let ie=1;ie<I.length;ie++)I[ie]=""}}}}return Oo(Z)}catch{return y}}var Fo={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Nu={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Eu;function pn(){}_(pn,ml),pn.prototype.g=function(){return new XMLHttpRequest},Eu=new pn;function me(u){return encodeURIComponent(String(u))}function Tu(u){var y=1;u=u.split(":");const x=[];for(;y>0&&u.length;)x.push(u.shift()),y--;return u.length&&x.push(u.join(":")),x}function sr(u,y,x,I){this.j=u,this.i=y,this.l=x,this.S=I||1,this.V=new Bi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new yl}function yl(){this.i=null,this.g="",this.h=!1}var _l={},qi={};function Bo(u,y,x){u.M=1,u.A=Qe(on(y)),u.u=x,u.R=!0,es(u,null)}function es(u,y){u.F=Date.now(),$o(u),u.B=on(u.A);var x=u.B,I=u.S;Array.isArray(I)||(I=[String(I)]),Go(x.i,"t",I),u.C=0,x=u.j.L,u.h=new yl,u.g=Al(u.j,x?y:null,!u.u),u.P>0&&(u.O=new If(m(u.Y,u,u.g),u.P)),y=u.V,x=u.g,I=u.ba;var W="readystatechange";Array.isArray(W)||(W&&(Mo[0]=W.toString()),W=Mo);for(let Z=0;Z<W.length;Z++){const ie=st(x,W[Z],I||y.handleEvent,!1,y.h||y);if(!ie)break;y.g[ie.key]=ie}y=u.J?Q(u.J):{},u.u?(u.v||(u.v="POST"),y["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.B,u.v,u.u,y)):(u.v="GET",u.g.ea(u.B,u.v,null,y)),zs(),Af(u.i,u.v,u.B,u.l,u.S,u.u)}sr.prototype.ba=function(u){u=u.target;const y=this.O;y&&Er(u)==3?y.j():this.Y(u)},sr.prototype.Y=function(u){try{if(u==this.g)e:{const je=Er(this.g),Be=this.g.ya(),We=this.g.ca();if(!(je<3)&&(je!=3||this.g&&(this.h.h||this.g.la()||Tl(this.g)))){this.K||je!=4||Be==7||(Be==8||We<=0?zs(3):zs(2)),Wo(this);var y=this.g.ca();this.X=y;var x=ju(this);if(this.o=y==200,Rf(this.i,this.v,this.B,this.l,this.S,je,y),this.o){if(this.U&&!this.L){t:{if(this.g){var I,W=this.g;if((I=W.g?W.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(I)){var Z=I;break t}}Z=null}if(u=Z)Ms(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,vl(this,u);else{this.o=!1,this.m=3,Dt(12),Fn(this),Zi(this);break e}}if(this.R){u=!0;let gt;for(;!this.K&&this.C<x.length;)if(gt=Df(this,x),gt==qi){je==4&&(this.m=4,Dt(14),u=!1),Ms(this.i,this.l,null,"[Incomplete Response]");break}else if(gt==_l){this.m=4,Dt(15),Ms(this.i,this.l,x,"[Invalid Chunk]"),u=!1;break}else Ms(this.i,this.l,gt,null),vl(this,gt);if(ku(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),je!=4||x.length!=0||this.h.h||(this.m=1,Dt(16),u=!1),this.o=this.o&&u,!u)Ms(this.i,this.l,x,"[Invalid Chunked Response]"),Fn(this),Zi(this);else if(x.length>0&&!this.W){this.W=!0;var ie=this.j;ie.g==this&&ie.aa&&!ie.P&&(ie.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),Il(ie),ie.P=!0,Dt(11))}}else Ms(this.i,this.l,x,null),vl(this,x);je==4&&Fn(this),this.o&&!this.K&&(je==4?Cn(this.j,this):(this.o=!1,$o(this)))}else jl(this.g),y==400&&x.indexOf("Unknown SID")>0?(this.m=3,Dt(12)):(this.m=0,Dt(13)),Fn(this),Zi(this)}}}catch{}finally{}};function ju(u){if(!ku(u))return u.g.la();const y=Tl(u.g);if(y==="")return"";let x="";const I=y.length,W=Er(u.g)==4;if(!u.h.i){if(typeof TextDecoder>"u")return Fn(u),Zi(u),"";u.h.i=new l.TextDecoder}for(let Z=0;Z<I;Z++)u.h.h=!0,x+=u.h.i.decode(y[Z],{stream:!(W&&Z==I-1)});return y.length=0,u.h.g+=x,u.C=0,u.h.g}function ku(u){return u.g?u.v=="GET"&&u.M!=2&&u.j.Aa:!1}function Df(u,y){var x=u.C,I=y.indexOf(`
`,x);return I==-1?qi:(x=Number(y.substring(x,I)),isNaN(x)?_l:(I+=1,I+x>y.length?qi:(y=y.slice(I,I+x),u.C=I+x,y)))}sr.prototype.cancel=function(){this.K=!0,Fn(this)};function $o(u){u.T=Date.now()+u.H,Su(u,u.H)}function Su(u,y){if(u.D!=null)throw Error("WatchDog timer not null");u.D=Wi(m(u.aa,u),y)}function Wo(u){u.D&&(l.clearTimeout(u.D),u.D=null)}sr.prototype.aa=function(){this.D=null;const u=Date.now();u-this.T>=0?(gl(this.i,this.B),this.M!=2&&(zs(),Dt(17)),Fn(this),this.m=2,Zi(this)):Su(this,this.T-u)};function Zi(u){u.j.I==0||u.K||Cn(u.j,u)}function Fn(u){Wo(u);var y=u.O;y&&typeof y.dispose=="function"&&y.dispose(),u.O=null,fl(u.V),u.g&&(y=u.g,u.g=null,y.abort(),y.dispose())}function vl(u,y){try{var x=u.j;if(x.I!=0&&(x.g==u||Gi(x.h,u))){if(!u.L&&Gi(x.h,u)&&x.I==3){try{var I=x.Ba.g.parse(y)}catch{I=null}if(Array.isArray(I)&&I.length==3){var W=I;if(W[0]==0){e:if(!x.v){if(x.g)if(x.g.F+3e3<u.F)Jo(x),Yo(x);else break e;Pl(x),Dt(18)}}else x.xa=W[1],0<x.xa-x.K&&W[2]<37500&&x.F&&x.A==0&&!x.C&&(x.C=Wi(m(x.Va,x),6e3));Cu(x.h)<=1&&x.ta&&(x.ta=void 0)}else jr(x,11)}else if((u.L||x.g==u)&&Jo(x),!z(y))for(W=x.Ba.g.parse(y),y=0;y<W.length;y++){let We=W[y];const gt=We[0];if(!(gt<=x.K))if(x.K=gt,We=We[1],x.I==2)if(We[0]=="c"){x.M=We[1],x.ba=We[2];const Hn=We[3];Hn!=null&&(x.ka=Hn,x.j.info("VER="+x.ka));const ar=We[4];ar!=null&&(x.za=ar,x.j.info("SVER="+x.za));const qn=We[5];qn!=null&&typeof qn=="number"&&qn>0&&(I=1.5*qn,x.O=I,x.j.info("backChannelRequestTimeoutMs_="+I)),I=x;const kr=u.g;if(kr){const na=kr.g?kr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(na){var Z=I.h;Z.g||na.indexOf("spdy")==-1&&na.indexOf("quic")==-1&&na.indexOf("h2")==-1||(Z.j=Z.l,Z.g=new Set,Z.h&&(ts(Z,Z.h),Z.h=null))}if(I.G){const ra=kr.g?kr.g.getResponseHeader("X-HTTP-Session-Id"):null;ra&&(I.wa=ra,he(I.J,I.G,ra))}}x.I=3,x.l&&x.l.ra(),x.aa&&(x.T=Date.now()-u.F,x.j.info("Handshake RTT: "+x.T+"ms")),I=x;var ie=u;if(I.na=Cl(I,I.L?I.ba:null,I.W),ie.L){xl(I.h,ie);var je=ie,Be=I.O;Be&&(je.H=Be),je.D&&(Wo(je),$o(je)),I.g=ie}else Sl(I);x.i.length>0&&Tr(x)}else We[0]!="stop"&&We[0]!="close"||jr(x,7);else x.I==3&&(We[0]=="stop"||We[0]=="close"?We[0]=="stop"?jr(x,7):Ae(x):We[0]!="noop"&&x.l&&x.l.qa(We),x.A=0)}}zs(4)}catch{}}var zf=class{constructor(u,y){this.g=u,this.map=y}};function Pu(u){this.l=u||10,l.PerformanceNavigationTiming?(u=l.performance.getEntriesByType("navigation"),u=u.length>0&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Iu(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Cu(u){return u.h?1:u.g?u.g.size:0}function Gi(u,y){return u.h?u.h==y:u.g?u.g.has(y):!1}function ts(u,y){u.g?u.g.add(y):u.h=y}function xl(u,y){u.h&&u.h==y?u.h=null:u.g&&u.g.has(y)&&u.g.delete(y)}Pu.prototype.cancel=function(){if(this.i=wl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function wl(u){if(u.h!=null)return u.i.concat(u.h.G);if(u.g!=null&&u.g.size!==0){let y=u.i;for(const x of u.g.values())y=y.concat(x.G);return y}return T(u.i)}var Os=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Oe(u,y){if(u){u=u.split("&");for(let x=0;x<u.length;x++){const I=u[x].indexOf("=");let W,Z=null;I>=0?(W=u[x].substring(0,I),Z=u[x].substring(I+1)):W=u[x],y(W,Z?decodeURIComponent(Z.replace(/\+/g," ")):"")}}}function Fe(u){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let y;u instanceof Fe?(this.l=u.l,Bn(this,u.j),this.o=u.o,this.g=u.g,$n(this,u.u),this.h=u.h,Ki(this,Qi(u.i)),this.m=u.m):u&&(y=String(u).match(Os))?(this.l=!1,Bn(this,y[1]||"",!0),this.o=ns(y[2]||""),this.g=ns(y[3]||"",!0),$n(this,y[4]),this.h=ns(y[5]||"",!0),Ki(this,y[6]||"",!0),this.m=ns(y[7]||"")):(this.l=!1,this.i=new ir(null,this.l))}Fe.prototype.toString=function(){const u=[];var y=this.j;y&&u.push(wr(y,Au,!0),":");var x=this.g;return(x||y=="file")&&(u.push("//"),(y=this.o)&&u.push(wr(y,Au,!0),"@"),u.push(me(x).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.u,x!=null&&u.push(":",String(x))),(x=this.h)&&(this.g&&x.charAt(0)!="/"&&u.push("/"),u.push(wr(x,x.charAt(0)=="/"?rs:Ho,!0))),(x=this.i.toString())&&u.push("?",x),(x=this.m)&&u.push("#",wr(x,ss)),u.join("")},Fe.prototype.resolve=function(u){const y=on(this);let x=!!u.j;x?Bn(y,u.j):x=!!u.o,x?y.o=u.o:x=!!u.g,x?y.g=u.g:x=u.u!=null;var I=u.h;if(x)$n(y,u.u);else if(x=!!u.h){if(I.charAt(0)!="/")if(this.g&&!this.h)I="/"+I;else{var W=y.h.lastIndexOf("/");W!=-1&&(I=y.h.slice(0,W+1)+I)}if(W=I,W==".."||W==".")I="";else if(W.indexOf("./")!=-1||W.indexOf("/.")!=-1){I=W.lastIndexOf("/",0)==0,W=W.split("/");const Z=[];for(let ie=0;ie<W.length;){const je=W[ie++];je=="."?I&&ie==W.length&&Z.push(""):je==".."?((Z.length>1||Z.length==1&&Z[0]!="")&&Z.pop(),I&&ie==W.length&&Z.push("")):(Z.push(je),I=!0)}I=Z.join("/")}else I=W}return x?y.h=I:x=u.i.toString()!=="",x?Ki(y,Qi(u.i)):x=!!u.m,x&&(y.m=u.m),y};function on(u){return new Fe(u)}function Bn(u,y,x){u.j=x?ns(y,!0):y,u.j&&(u.j=u.j.replace(/:$/,""))}function $n(u,y){if(y){if(y=Number(y),isNaN(y)||y<0)throw Error("Bad port number "+y);u.u=y}else u.u=null}function Ki(u,y,x){y instanceof ir?(u.i=y,bl(u.i,u.l)):(x||(y=wr(y,dt)),u.i=new ir(y,u.l))}function he(u,y,x){u.i.set(y,x)}function Qe(u){return he(u,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),u}function ns(u,y){return u?y?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function wr(u,y,x){return typeof u=="string"?(u=encodeURI(u).replace(y,gn),x&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function gn(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Au=/[#\/\?@]/g,Ho=/[#\?:]/g,rs=/[#\?]/g,dt=/[#\?@]/g,ss=/#/g;function ir(u,y){this.h=this.g=null,this.i=u||null,this.j=!!y}function In(u){u.g||(u.g=new Map,u.h=0,u.i&&Oe(u.i,function(y,x){u.add(decodeURIComponent(y.replace(/\+/g," ")),x)}))}t=ir.prototype,t.add=function(u,y){In(this),this.i=null,u=br(this,u);let x=this.g.get(u);return x||this.g.set(u,x=[]),x.push(y),this.h+=1,this};function qo(u,y){In(u),y=br(u,y),u.g.has(y)&&(u.i=null,u.h-=u.g.get(y).length,u.g.delete(y))}function Vs(u,y){return In(u),y=br(u,y),u.g.has(y)}t.forEach=function(u,y){In(this),this.g.forEach(function(x,I){x.forEach(function(W){u.call(y,W,I,this)},this)},this)};function Zo(u,y){In(u);let x=[];if(typeof y=="string")Vs(u,y)&&(x=x.concat(u.g.get(br(u,y))));else for(u=Array.from(u.g.values()),y=0;y<u.length;y++)x=x.concat(u[y]);return x}t.set=function(u,y){return In(this),this.i=null,u=br(this,u),Vs(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[y]),this.h+=1,this},t.get=function(u,y){return u?(u=Zo(this,u),u.length>0?String(u[0]):y):y};function Go(u,y,x){qo(u,y),x.length>0&&(u.i=null,u.g.set(br(u,y),T(x)),u.h+=x.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],y=Array.from(this.g.keys());for(let I=0;I<y.length;I++){var x=y[I];const W=me(x);x=Zo(this,x);for(let Z=0;Z<x.length;Z++){let ie=W;x[Z]!==""&&(ie+="="+me(x[Z])),u.push(ie)}}return this.i=u.join("&")};function Qi(u){const y=new ir;return y.i=u.i,u.g&&(y.g=new Map(u.g),y.h=u.h),y}function br(u,y){return y=String(y),u.j&&(y=y.toLowerCase()),y}function bl(u,y){y&&!u.j&&(In(u),u.i=null,u.g.forEach(function(x,I){const W=I.toLowerCase();I!=W&&(qo(this,I),Go(this,W,x))},u)),u.j=y}function Ko(u,y){const x=new Hi;if(l.Image){const I=new Image;I.onload=g(Wn,x,"TestLoadImage: loaded",!0,y,I),I.onerror=g(Wn,x,"TestLoadImage: error",!1,y,I),I.onabort=g(Wn,x,"TestLoadImage: abort",!1,y,I),I.ontimeout=g(Wn,x,"TestLoadImage: timeout",!1,y,I),l.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=u}else y(!1)}function Ru(u,y){const x=new Hi,I=new AbortController,W=setTimeout(()=>{I.abort(),Wn(x,"TestPingServer: timeout",!1,y)},1e4);fetch(u,{signal:I.signal}).then(Z=>{clearTimeout(W),Z.ok?Wn(x,"TestPingServer: ok",!0,y):Wn(x,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(W),Wn(x,"TestPingServer: error",!1,y)})}function Wn(u,y,x,I,W){try{W&&(W.onload=null,W.onerror=null,W.onabort=null,W.ontimeout=null),I(x)}catch{}}function Mf(){this.g=new vu}function Te(u){this.i=u.Sb||null,this.h=u.ab||!1}_(Te,ml),Te.prototype.g=function(){return new an(this.i,this.h)};function an(u,y){Rt.call(this),this.H=u,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}_(an,Rt),t=an.prototype,t.open=function(u,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=u,this.D=y,this.readyState=1,is(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const y={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};u&&(y.body=u),(this.H||l).fetch(new Request(this.D,y)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Us(this)),this.readyState=0},t.Pa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,is(this)),this.g&&(this.readyState=3,is(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ze(this)}else u.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ze(u){u.j.read().then(u.Ma.bind(u)).catch(u.ga.bind(u))}t.Ma=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var y=u.value?u.value:new Uint8Array(0);(y=this.B.decode(y,{stream:!u.done}))&&(this.response=this.responseText+=y)}u.done?Us(this):is(this),this.readyState==3&&Ze(this)}},t.Oa=function(u){this.g&&(this.response=this.responseText=u,Us(this))},t.Na=function(u){this.g&&(this.response=u,Us(this))},t.ga=function(){this.g&&Us(this)};function Us(u){u.readyState=4,u.l=null,u.j=null,u.B=null,is(u)}t.setRequestHeader=function(u,y){this.A.append(u,y)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],y=this.h.entries();for(var x=y.next();!x.done;)x=x.value,u.push(x[0]+": "+x[1]),x=y.next();return u.join(`\r
`)};function is(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(an.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Qo(u){let y="";return re(u,function(x,I){y+=I,y+=":",y+=x,y+=`\r
`}),y}function Yi(u,y,x){e:{for(I in x){var I=!1;break e}I=!0}I||(x=Qo(x),typeof u=="string"?x!=null&&me(x):he(u,y,x))}function $e(u){Rt.call(this),this.headers=new Map,this.L=u||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}_($e,Rt);var Nl=/^https?$/i,Xi=["POST","PUT"];t=$e.prototype,t.Fa=function(u){this.H=u},t.ea=function(u,y,x,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);y=y?y.toUpperCase():"GET",this.D=u,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Eu.g(),this.g.onreadystatechange=w(m(this.Ca,this));try{this.B=!0,this.g.open(y,String(u),!0),this.B=!1}catch(Z){wt(this,Z);return}if(u=x||"",x=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var W in I)x.set(W,I[W]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const Z of I.keys())x.set(Z,I.get(Z));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(x.keys()).find(Z=>Z.toLowerCase()=="content-type"),W=l.FormData&&u instanceof l.FormData,!(Array.prototype.indexOf.call(Xi,y,void 0)>=0)||I||W||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Z,ie]of x)this.g.setRequestHeader(Z,ie);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(u),this.v=!1}catch(Z){wt(this,Z)}};function wt(u,y){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=y,u.o=5,Nr(u),Ji(u)}function Nr(u){u.A||(u.A=!0,Lt(u,"complete"),Lt(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=u||7,Lt(this,"complete"),Lt(this,"abort"),Ji(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ji(this,!0)),$e.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?El(this):this.Xa())},t.Xa=function(){El(this)};function El(u){if(u.h&&typeof o<"u"){if(u.v&&Er(u)==4)setTimeout(u.Ca.bind(u),0);else if(Lt(u,"readystatechange"),Er(u)==4){u.h=!1;try{const Z=u.ca();e:switch(Z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var x;if(!(x=y)){var I;if(I=Z===0){let ie=String(u.D).match(Os)[1]||null;!ie&&l.self&&l.self.location&&(ie=l.self.location.protocol.slice(0,-1)),I=!Nl.test(ie?ie.toLowerCase():"")}x=I}if(x)Lt(u,"complete"),Lt(u,"success");else{u.o=6;try{var W=Er(u)>2?u.g.statusText:""}catch{W=""}u.l=W+" ["+u.ca()+"]",Nr(u)}}finally{Ji(u)}}}}function Ji(u,y){if(u.g){u.m&&(clearTimeout(u.m),u.m=null);const x=u.g;u.g=null,y||Lt(u,"ready");try{x.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Er(u){return u.g?u.g.readyState:0}t.ca=function(){try{return Er(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(u){if(this.g){var y=this.g.responseText;return u&&y.indexOf(u)==0&&(y=y.substring(u.length)),Cf(y)}};function Tl(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.F){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function jl(u){const y={};u=(u.g&&Er(u)>=2&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<u.length;I++){if(z(u[I]))continue;var x=Tu(u[I]);const W=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const Z=y[W]||[];y[W]=Z,Z.push(x)}X(y,function(I){return I.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function eo(u,y,x){return x&&x.internalChannelParams&&x.internalChannelParams[u]||y}function kl(u){this.za=0,this.i=[],this.j=new Hi,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=eo("failFast",!1,u),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=eo("baseRetryDelayMs",5e3,u),this.Za=eo("retryDelaySeedMs",1e4,u),this.Ta=eo("forwardChannelMaxRetries",2,u),this.va=eo("forwardChannelRequestTimeoutMs",2e4,u),this.ma=u&&u.xmlHttpFactory||void 0,this.Ua=u&&u.Rb||void 0,this.Aa=u&&u.useFetchStreams||!1,this.O=void 0,this.L=u&&u.supportsCrossDomainXhr||!1,this.M="",this.h=new Pu(u&&u.concurrentRequestLimit),this.Ba=new Mf,this.S=u&&u.fastHandshake||!1,this.R=u&&u.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=u&&u.Pb||!1,u&&u.ua&&this.j.ua(),u&&u.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&u&&u.detectBufferingProxy||!1,this.ia=void 0,u&&u.longPollingTimeout&&u.longPollingTimeout>0&&(this.ia=u.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=kl.prototype,t.ka=8,t.I=1,t.connect=function(u,y,x,I){Dt(0),this.W=u,this.H=y||{},x&&I!==void 0&&(this.H.OSID=x,this.H.OAID=I),this.F=this.X,this.J=Cl(this,null,this.W),Tr(this)};function Ae(u){if(yn(u),u.I==3){var y=u.V++,x=on(u.J);if(he(x,"SID",u.M),he(x,"RID",y),he(x,"TYPE","terminate"),os(u,x),y=new sr(u,u.j,y),y.M=2,y.A=Qe(on(x)),x=!1,l.navigator&&l.navigator.sendBeacon)try{x=l.navigator.sendBeacon(y.A.toString(),"")}catch{}!x&&l.Image&&(new Image().src=y.A,x=!0),x||(y.g=Al(y.j,null),y.g.ea(y.A)),y.F=Date.now(),$o(y)}or(u)}function Yo(u){u.g&&(Il(u),u.g.cancel(),u.g=null)}function yn(u){Yo(u),u.v&&(l.clearTimeout(u.v),u.v=null),Jo(u),u.h.cancel(),u.m&&(typeof u.m=="number"&&l.clearTimeout(u.m),u.m=null)}function Tr(u){if(!Iu(u.h)&&!u.m){u.m=!0;var y=u.Ea;F||N(),V||(F(),V=!0),E.add(y,u),u.D=0}}function Lu(u,y){return Cu(u.h)>=u.h.j-(u.m?1:0)?!1:u.m?(u.i=y.G.concat(u.i),!0):u.I==1||u.I==2||u.D>=(u.Sa?0:u.Ta)?!1:(u.m=Wi(m(u.Ea,u,y),Mu(u,u.D)),u.D++,!0)}t.Ea=function(u){if(this.m)if(this.m=null,this.I==1){if(!u){this.V=Math.floor(Math.random()*1e5),u=this.V++;const W=new sr(this,this.j,u);let Z=this.o;if(this.U&&(Z?(Z=Q(Z),le(Z,this.U)):Z=this.U),this.u!==null||this.R||(W.J=Z,Z=null),this.S)e:{for(var y=0,x=0;x<this.i.length;x++){t:{var I=this.i[x];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(y+=I,y>4096){y=x;break e}if(y===4096||x===this.i.length-1){y=x+1;break e}}y=1e3}else y=1e3;y=zu(this,W,y),x=on(this.J),he(x,"RID",u),he(x,"CVER",22),this.G&&he(x,"X-HTTP-Session-Id",this.G),os(this,x),Z&&(this.R?y="headers="+me(Qo(Z))+"&"+y:this.u&&Yi(x,this.u,Z)),ts(this.h,W),this.Ra&&he(x,"TYPE","init"),this.S?(he(x,"$req",y),he(x,"SID","null"),W.U=!0,Bo(W,x,null)):Bo(W,x,y),this.I=2}}else this.I==3&&(u?Du(this,u):this.i.length==0||Iu(this.h)||Du(this))};function Du(u,y){var x;y?x=y.l:x=u.V++;const I=on(u.J);he(I,"SID",u.M),he(I,"RID",x),he(I,"AID",u.K),os(u,I),u.u&&u.o&&Yi(I,u.u,u.o),x=new sr(u,u.j,x,u.D+1),u.u===null&&(x.J=u.o),y&&(u.i=y.G.concat(u.i)),y=zu(u,x,1e3),x.H=Math.round(u.va*.5)+Math.round(u.va*.5*Math.random()),ts(u.h,x),Bo(x,I,y)}function os(u,y){u.H&&re(u.H,function(x,I){he(y,I,x)}),u.l&&re({},function(x,I){he(y,I,x)})}function zu(u,y,x){x=Math.min(u.i.length,x);const I=u.l?m(u.l.Ka,u.l,u):null;e:{var W=u.i;let je=-1;for(;;){const Be=["count="+x];je==-1?x>0?(je=W[0].g,Be.push("ofs="+je)):je=0:Be.push("ofs="+je);let We=!0;for(let gt=0;gt<x;gt++){var Z=W[gt].g;const Hn=W[gt].map;if(Z-=je,Z<0)je=Math.max(0,W[gt].g-100),We=!1;else try{Z="req"+Z+"_"||"";try{var ie=Hn instanceof Map?Hn:Object.entries(Hn);for(const[ar,qn]of ie){let kr=qn;h(qn)&&(kr=Oo(qn)),Be.push(Z+ar+"="+encodeURIComponent(kr))}}catch(ar){throw Be.push(Z+"type="+encodeURIComponent("_badmap")),ar}}catch{I&&I(Hn)}}if(We){ie=Be.join("&");break e}}ie=void 0}return u=u.i.splice(0,x),y.G=u,ie}function Sl(u){if(!u.g&&!u.v){u.Y=1;var y=u.Da;F||N(),V||(F(),V=!0),E.add(y,u),u.A=0}}function Pl(u){return u.g||u.v||u.A>=3?!1:(u.Y++,u.v=Wi(m(u.Da,u),Mu(u,u.A)),u.A++,!0)}t.Da=function(){if(this.v=null,Xo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var u=4*this.T;this.j.info("BP detection timer enabled: "+u),this.B=Wi(m(this.Wa,this),u)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Dt(10),Yo(this),Xo(this))};function Il(u){u.B!=null&&(l.clearTimeout(u.B),u.B=null)}function Xo(u){u.g=new sr(u,u.j,"rpc",u.Y),u.u===null&&(u.g.J=u.o),u.g.P=0;var y=on(u.na);he(y,"RID","rpc"),he(y,"SID",u.M),he(y,"AID",u.K),he(y,"CI",u.F?"0":"1"),!u.F&&u.ia&&he(y,"TO",u.ia),he(y,"TYPE","xmlhttp"),os(u,y),u.u&&u.o&&Yi(y,u.u,u.o),u.O&&(u.g.H=u.O);var x=u.g;u=u.ba,x.M=1,x.A=Qe(on(y)),x.u=null,x.R=!0,es(x,u)}t.Va=function(){this.C!=null&&(this.C=null,Yo(this),Pl(this),Dt(19))};function Jo(u){u.C!=null&&(l.clearTimeout(u.C),u.C=null)}function Cn(u,y){var x=null;if(u.g==y){Jo(u),Il(u),u.g=null;var I=2}else if(Gi(u.h,y))x=y.G,xl(u.h,y),I=1;else return;if(u.I!=0){if(y.o)if(I==1){x=y.u?y.u.length:0,y=Date.now()-y.F;var W=u.D;I=Uo(),Lt(I,new bu(I,x)),Tr(u)}else Sl(u);else if(W=y.m,W==3||W==0&&y.X>0||!(I==1&&Lu(u,y)||I==2&&Pl(u)))switch(x&&x.length>0&&(y=u.h,y.i=y.i.concat(x)),W){case 1:jr(u,5);break;case 4:jr(u,10);break;case 3:jr(u,6);break;default:jr(u,2)}}}function Mu(u,y){let x=u.Qa+Math.floor(Math.random()*u.Za);return u.isActive()||(x*=2),x*y}function jr(u,y){if(u.j.info("Error code "+y),y==2){var x=m(u.bb,u),I=u.Ua;const W=!I;I=new Fe(I||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Bn(I,"https"),Qe(I),W?Ko(I.toString(),x):Ru(I.toString(),x)}else Dt(2);u.I=0,u.l&&u.l.pa(y),or(u),yn(u)}t.bb=function(u){u?(this.j.info("Successfully pinged google.com"),Dt(2)):(this.j.info("Failed to ping google.com"),Dt(1))};function or(u){if(u.I=0,u.ja=[],u.l){const y=wl(u.h);(y.length!=0||u.i.length!=0)&&(j(u.ja,y),j(u.ja,u.i),u.h.i.length=0,T(u.i),u.i.length=0),u.l.oa()}}function Cl(u,y,x){var I=x instanceof Fe?on(x):new Fe(x);if(I.g!="")y&&(I.g=y+"."+I.g),$n(I,I.u);else{var W=l.location;I=W.protocol,y=y?y+"."+W.hostname:W.hostname,W=+W.port;const Z=new Fe(null);I&&Bn(Z,I),y&&(Z.g=y),W&&$n(Z,W),x&&(Z.h=x),I=Z}return x=u.G,y=u.wa,x&&y&&he(I,x,y),he(I,"VER",u.ka),os(u,I),I}function Al(u,y,x){if(y&&!u.L)throw Error("Can't create secondary domain capable XhrIo object.");return y=u.Aa&&!u.ma?new $e(new Te({ab:x})):new $e(u.ma),y.Fa(u.L),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ea(){}t=ea.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function ta(){}ta.prototype.g=function(u,y){return new Gt(u,y)};function Gt(u,y){Rt.call(this),this.g=new kl(y),this.l=u,this.h=y&&y.messageUrlParams||null,u=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(u?u["X-WebChannel-Content-Type"]=y.messageContentType:u={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.sa&&(u?u["X-WebChannel-Client-Profile"]=y.sa:u={"X-WebChannel-Client-Profile":y.sa}),this.g.U=u,(u=y&&y.Qb)&&!z(u)&&(this.g.u=u),this.A=y&&y.supportsCrossDomainXhr||!1,this.v=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!z(y)&&(this.g.G=y,u=this.h,u!==null&&y in u&&(u=this.h,y in u&&delete u[y])),this.j=new Fs(this)}_(Gt,Rt),Gt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Gt.prototype.close=function(){Ae(this.g)},Gt.prototype.o=function(u){var y=this.g;if(typeof u=="string"){var x={};x.__data__=u,u=x}else this.v&&(x={},x.__data__=Oo(u),u=x);y.i.push(new zf(y.Ya++,u)),y.I==3&&Tr(y)},Gt.prototype.N=function(){this.g.l=null,delete this.j,Ae(this.g),delete this.g,Gt.Z.N.call(this)};function Rl(u){$i.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var y=u.__sm__;if(y){e:{for(const x in y){u=x;break e}u=void 0}(this.i=u)&&(u=this.i,y=y!==null&&u in y?y[u]:void 0),this.data=y}else this.data=u}_(Rl,$i);function Ou(){Vo.call(this),this.status=1}_(Ou,Vo);function Fs(u){this.g=u}_(Fs,ea),Fs.prototype.ra=function(){Lt(this.g,"a")},Fs.prototype.qa=function(u){Lt(this.g,new Rl(u))},Fs.prototype.pa=function(u){Lt(this.g,new Ou)},Fs.prototype.oa=function(){Lt(this.g,"b")},ta.prototype.createWebChannel=ta.prototype.g,Gt.prototype.send=Gt.prototype.o,Gt.prototype.open=Gt.prototype.m,Gt.prototype.close=Gt.prototype.close,EN=function(){return new ta},NN=function(){return Uo()},bN=Jr,Op={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Fo.NO_ERROR=0,Fo.TIMEOUT=8,Fo.HTTP_ERROR=6,Vd=Fo,Nu.COMPLETE="complete",wN=Nu,xu.EventType=Ls,Ls.OPEN="a",Ls.CLOSE="b",Ls.ERROR="c",Ls.MESSAGE="d",Rt.prototype.listen=Rt.prototype.J,Jl=xu,$e.prototype.listenOnce=$e.prototype.K,$e.prototype.getLastError=$e.prototype.Ha,$e.prototype.getLastErrorCode=$e.prototype.ya,$e.prototype.getStatus=$e.prototype.ca,$e.prototype.getResponseJson=$e.prototype.La,$e.prototype.getResponseText=$e.prototype.la,$e.prototype.send=$e.prototype.ea,$e.prototype.setWithCredentials=$e.prototype.Fa,xN=$e}).apply(typeof md<"u"?md:typeof self<"u"?self:typeof window<"u"?window:{});const Ux="@firebase/firestore",Fx="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Xt.UNAUTHENTICATED=new Xt(null),Xt.GOOGLE_CREDENTIALS=new Xt("google-credentials-uid"),Xt.FIRST_PARTY=new Xt("first-party-uid"),Xt.MOCK_USER=new Xt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ll="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jo=new my("@firebase/firestore");function fa(){return jo.logLevel}function de(t,...e){if(jo.logLevel<=De.DEBUG){const n=e.map(Ty);jo.debug(`Firestore (${ll}): ${t}`,...n)}}function Ps(t,...e){if(jo.logLevel<=De.ERROR){const n=e.map(Ty);jo.error(`Firestore (${ll}): ${t}`,...n)}}function Ka(t,...e){if(jo.logLevel<=De.WARN){const n=e.map(Ty);jo.warn(`Firestore (${ll}): ${t}`,...n)}}function Ty(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ee(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,TN(t,r,n)}function TN(t,e,n){let r=`FIRESTORE (${ll}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Ps(r),new Error(r)}function He(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||TN(e,s,r)}function Ie(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ae extends Yr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jN{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class WA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Xt.UNAUTHENTICATED))}shutdown(){}}class HA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class qA{constructor(e){this.t=e,this.currentUser=Xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){He(this.o===void 0,42304);let r=this.i;const s=f=>this.i!==r?(r=this.i,n(f)):Promise.resolve();let o=new xs;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new xs,e.enqueueRetryable(()=>s(this.currentUser))};const l=()=>{const f=o;e.enqueueRetryable(async()=>{await f.promise,await s(this.currentUser)})},h=f=>{de("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(f=>h(f)),setTimeout(()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?h(f):(de("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new xs)}},0),l()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(de("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(He(typeof r.accessToken=="string",31837,{l:r}),new jN(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return He(e===null||typeof e=="string",2055,{h:e}),new Xt(e)}}class ZA{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Xt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class GA{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new ZA(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Bx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class KA{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Rn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){He(this.o===void 0,3512);const r=o=>{o.error!=null&&de("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.m;return this.m=o.token,de("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?n(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};const s=o=>{de("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>s(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?s(o):de("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Bx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(He(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Bx(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QA(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=QA(40);for(let o=0;o<s.length;++o)r.length<20&&s[o]<n&&(r+=e.charAt(s[o]%62))}return r}}function ze(t,e){return t<e?-1:t>e?1:0}function Vp(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),o=e.charAt(r);if(s!==o)return Nm(s)===Nm(o)?ze(s,o):Nm(s)?1:-1}return ze(t.length,e.length)}const YA=55296,XA=57343;function Nm(t){const e=t.charCodeAt(0);return e>=YA&&e<=XA}function Qa(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $x="__name__";class Ar{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ee(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Ee(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ar.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ar?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const o=Ar.compareSegments(e.get(s),n.get(s));if(o!==0)return o}return ze(e.length,n.length)}static compareSegments(e,n){const r=Ar.isNumericId(e),s=Ar.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Ar.extractNumericId(e).compare(Ar.extractNumericId(n)):Vp(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return gi.fromString(e.substring(4,e.length-2))}}class Ye extends Ar{construct(e,n,r){return new Ye(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ae(J.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ye(n)}static emptyPath(){return new Ye([])}}const JA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Wt extends Ar{construct(e,n,r){return new Wt(e,n,r)}static isValidIdentifier(e){return JA.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Wt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===$x}static keyField(){return new Wt([$x])}static fromServerFormat(e){const n=[];let r="",s=0;const o=()=>{if(r.length===0)throw new ae(J.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let l=!1;for(;s<e.length;){const h=e[s];if(h==="\\"){if(s+1===e.length)throw new ae(J.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[s+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new ae(J.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,s+=2}else h==="`"?(l=!l,s++):h!=="."||l?(r+=h,s++):(o(),s++)}if(o(),l)throw new ae(J.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Wt(n)}static emptyPath(){return new Wt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.path=e}static fromPath(e){return new ve(Ye.fromString(e))}static fromName(e){return new ve(Ye.fromString(e).popFirst(5))}static empty(){return new ve(Ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ye.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ve(new Ye(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kN(t,e,n){if(!n)throw new ae(J.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function eR(t,e,n,r){if(e===!0&&r===!0)throw new ae(J.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Wx(t){if(!ve.isDocumentKey(t))throw new ae(J.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Hx(t){if(ve.isDocumentKey(t))throw new ae(J.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function SN(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function of(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ee(12329,{type:typeof t})}function kn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ae(J.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=of(t);throw new ae(J.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function St(t,e){const n={typeString:t};return e&&(n.value=e),n}function cu(t,e){if(!SN(t))throw new ae(J.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const l=t[r];if(s&&typeof l!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(o!==void 0&&l!==o.value){n=`Expected '${r}' field to equal '${o.value}'`;break}}if(n)throw new ae(J.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx=-62135596800,Zx=1e6;class tt{static now(){return tt.fromMillis(Date.now())}static fromDate(e){return tt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*Zx);return new tt(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ae(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ae(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<qx)throw new ae(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ae(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Zx}_compareTo(e){return this.seconds===e.seconds?ze(this.nanoseconds,e.nanoseconds):ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:tt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(cu(e,tt._jsonSchema))return new tt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-qx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}tt._jsonSchemaVersion="firestore/timestamp/1.0",tt._jsonSchema={type:St("string",tt._jsonSchemaVersion),seconds:St("number"),nanoseconds:St("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{static fromTimestamp(e){return new Se(e)}static min(){return new Se(new tt(0,0))}static max(){return new Se(new tt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bc=-1;function tR(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=Se.fromTimestamp(r===1e9?new tt(n+1,0):new tt(n,r));return new bi(s,ve.empty(),e)}function nR(t){return new bi(t.readTime,t.key,Bc)}class bi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new bi(Se.min(),ve.empty(),Bc)}static max(){return new bi(Se.max(),ve.empty(),Bc)}}function rR(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ve.comparator(t.documentKey,e.documentKey),n!==0?n:ze(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class iR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cl(t){if(t.code!==J.FAILED_PRECONDITION||t.message!==sR)throw t;de("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ee(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ee((r,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,s)},this.catchCallback=o=>{this.wrapFailure(n,o).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ee?n:ee.resolve(n)}catch(n){return ee.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ee.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ee.reject(n)}static resolve(e){return new ee((n,r)=>{n(e)})}static reject(e){return new ee((n,r)=>{r(e)})}static waitFor(e){return new ee((n,r)=>{let s=0,o=0,l=!1;e.forEach(h=>{++s,h.next(()=>{++o,l&&o===s&&n()},f=>r(f))}),l=!0,o===s&&n()})}static or(e){let n=ee.resolve(!1);for(const r of e)n=n.next(s=>s?ee.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,o)=>{r.push(n.call(this,s,o))}),this.waitFor(r)}static mapArray(e,n){return new ee((r,s)=>{const o=e.length,l=new Array(o);let h=0;for(let f=0;f<o;f++){const m=f;n(e[m]).next(g=>{l[m]=g,++h,h===o&&r(l)},g=>s(g))}})}static doWhile(e,n){return new ee((r,s)=>{const o=()=>{e()===!0?n().next(()=>{o()},s):r()};o()})}}function oR(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ul(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}af.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ky=-1;function lf(t){return t==null}function Eh(t){return t===0&&1/t==-1/0}function aR(t){return typeof t=="number"&&Number.isInteger(t)&&!Eh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PN="";function lR(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Gx(e)),e=cR(t.get(n),e);return Gx(e)}function cR(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const o=t.charAt(s);switch(o){case"\0":n+="";break;case PN:n+="";break;default:n+=o}}return n}function Gx(t){return t+PN+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kx(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Oi(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function IN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(e,n){this.comparator=e,this.root=n||Ft.EMPTY}insert(e,n){return new ut(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ft.BLACK,null,null))}remove(e){return new ut(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ft.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new pd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new pd(this.root,e,this.comparator,!1)}getReverseIterator(){return new pd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new pd(this.root,e,this.comparator,!0)}}class pd{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,n&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ft{constructor(e,n,r,s,o){this.key=e,this.value=n,this.color=r??Ft.RED,this.left=s??Ft.EMPTY,this.right=o??Ft.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,o){return new Ft(e??this.key,n??this.value,r??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const o=r(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,n,r),null):o===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ft.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Ft.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ft.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ft.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ee(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ee(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ee(27949);return e+(this.isRed()?0:1)}}Ft.EMPTY=null,Ft.RED=!0,Ft.BLACK=!1;Ft.EMPTY=new class{constructor(){this.size=0}get key(){throw Ee(57766)}get value(){throw Ee(16141)}get color(){throw Ee(16727)}get left(){throw Ee(29726)}get right(){throw Ee(36894)}copy(e,n,r,s,o){return this}insert(e,n,r){return new Ft(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e){this.comparator=e,this.data=new ut(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Qx(this.data.getIterator())}getIteratorFrom(e){return new Qx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ct)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,o=r.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ct(this.comparator);return n.data=e,n}}class Qx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.fields=e,e.sort(Wt.comparator)}static empty(){return new Dn([])}unionWith(e){let n=new Ct(Wt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Dn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Qa(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new CN("Invalid base64 string: "+o):o}}(e);return new Zt(n)}static fromUint8Array(e){const n=function(s){let o="";for(let l=0;l<s.length;++l)o+=String.fromCharCode(s[l]);return o}(e);return new Zt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Zt.EMPTY_BYTE_STRING=new Zt("");const uR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ni(t){if(He(!!t,39018),typeof t=="string"){let e=0;const n=uR.exec(t);if(He(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:yt(t.seconds),nanos:yt(t.nanos)}}function yt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ei(t){return typeof t=="string"?Zt.fromBase64String(t):Zt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AN="server_timestamp",RN="__type__",LN="__previous_value__",DN="__local_write_time__";function Sy(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[RN])==null?void 0:r.stringValue)===AN}function cf(t){const e=t.mapValue.fields[LN];return Sy(e)?cf(e):e}function $c(t){const e=Ni(t.mapValue.fields[DN].timestampValue);return new tt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dR{constructor(e,n,r,s,o,l,h,f,m,g){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=h,this.longPollingOptions=f,this.useFetchStreams=m,this.isUsingEmulator=g}}const Th="(default)";class Wc{constructor(e,n){this.projectId=e,this.database=n||Th}static empty(){return new Wc("","")}get isDefaultDatabase(){return this.database===Th}isEqual(e){return e instanceof Wc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zN="__type__",hR="__max__",gd={mapValue:{}},MN="__vector__",jh="value";function Ti(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Sy(t)?4:mR(t)?9007199254740991:fR(t)?10:11:Ee(28295,{value:t})}function Kr(t,e){if(t===e)return!0;const n=Ti(t);if(n!==Ti(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return $c(t).isEqual($c(e));case 3:return function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const l=Ni(s.timestampValue),h=Ni(o.timestampValue);return l.seconds===h.seconds&&l.nanos===h.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,o){return Ei(s.bytesValue).isEqual(Ei(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,o){return yt(s.geoPointValue.latitude)===yt(o.geoPointValue.latitude)&&yt(s.geoPointValue.longitude)===yt(o.geoPointValue.longitude)}(t,e);case 2:return function(s,o){if("integerValue"in s&&"integerValue"in o)return yt(s.integerValue)===yt(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const l=yt(s.doubleValue),h=yt(o.doubleValue);return l===h?Eh(l)===Eh(h):isNaN(l)&&isNaN(h)}return!1}(t,e);case 9:return Qa(t.arrayValue.values||[],e.arrayValue.values||[],Kr);case 10:case 11:return function(s,o){const l=s.mapValue.fields||{},h=o.mapValue.fields||{};if(Kx(l)!==Kx(h))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(h[f]===void 0||!Kr(l[f],h[f])))return!1;return!0}(t,e);default:return Ee(52216,{left:t})}}function Hc(t,e){return(t.values||[]).find(n=>Kr(n,e))!==void 0}function Ya(t,e){if(t===e)return 0;const n=Ti(t),r=Ti(e);if(n!==r)return ze(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ze(t.booleanValue,e.booleanValue);case 2:return function(o,l){const h=yt(o.integerValue||o.doubleValue),f=yt(l.integerValue||l.doubleValue);return h<f?-1:h>f?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1}(t,e);case 3:return Yx(t.timestampValue,e.timestampValue);case 4:return Yx($c(t),$c(e));case 5:return Vp(t.stringValue,e.stringValue);case 6:return function(o,l){const h=Ei(o),f=Ei(l);return h.compareTo(f)}(t.bytesValue,e.bytesValue);case 7:return function(o,l){const h=o.split("/"),f=l.split("/");for(let m=0;m<h.length&&m<f.length;m++){const g=ze(h[m],f[m]);if(g!==0)return g}return ze(h.length,f.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,l){const h=ze(yt(o.latitude),yt(l.latitude));return h!==0?h:ze(yt(o.longitude),yt(l.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Xx(t.arrayValue,e.arrayValue);case 10:return function(o,l){var w,T,j,D;const h=o.fields||{},f=l.fields||{},m=(w=h[jh])==null?void 0:w.arrayValue,g=(T=f[jh])==null?void 0:T.arrayValue,_=ze(((j=m==null?void 0:m.values)==null?void 0:j.length)||0,((D=g==null?void 0:g.values)==null?void 0:D.length)||0);return _!==0?_:Xx(m,g)}(t.mapValue,e.mapValue);case 11:return function(o,l){if(o===gd.mapValue&&l===gd.mapValue)return 0;if(o===gd.mapValue)return 1;if(l===gd.mapValue)return-1;const h=o.fields||{},f=Object.keys(h),m=l.fields||{},g=Object.keys(m);f.sort(),g.sort();for(let _=0;_<f.length&&_<g.length;++_){const w=Vp(f[_],g[_]);if(w!==0)return w;const T=Ya(h[f[_]],m[g[_]]);if(T!==0)return T}return ze(f.length,g.length)}(t.mapValue,e.mapValue);default:throw Ee(23264,{he:n})}}function Yx(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ze(t,e);const n=Ni(t),r=Ni(e),s=ze(n.seconds,r.seconds);return s!==0?s:ze(n.nanos,r.nanos)}function Xx(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const o=Ya(n[s],r[s]);if(o)return o}return ze(n.length,r.length)}function Xa(t){return Up(t)}function Up(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ni(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ei(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ve.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const o of n.values||[])s?s=!1:r+=",",r+=Up(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",o=!0;for(const l of r)o?o=!1:s+=",",s+=`${l}:${Up(n.fields[l])}`;return s+"}"}(t.mapValue):Ee(61005,{value:t})}function Ud(t){switch(Ti(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=cf(t);return e?16+Ud(e):16;case 5:return 2*t.stringValue.length;case 6:return Ei(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,o)=>s+Ud(o),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Oi(r.fields,(o,l)=>{s+=o.length+Ud(l)}),s}(t.mapValue);default:throw Ee(13486,{value:t})}}function Jx(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Fp(t){return!!t&&"integerValue"in t}function Py(t){return!!t&&"arrayValue"in t}function e0(t){return!!t&&"nullValue"in t}function t0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Fd(t){return!!t&&"mapValue"in t}function fR(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[zN])==null?void 0:r.stringValue)===MN}function mc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Oi(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=mc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=mc(t.arrayValue.values[n]);return e}return{...t}}function mR(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===hR}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e){this.value=e}static empty(){return new bn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Fd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=mc(n)}setAll(e){let n=Wt.emptyPath(),r={},s=[];e.forEach((l,h)=>{if(!n.isImmediateParentOf(h)){const f=this.getFieldsMap(n);this.applyChanges(f,r,s),r={},s=[],n=h.popLast()}l?r[h.lastSegment()]=mc(l):s.push(h.lastSegment())});const o=this.getFieldsMap(n);this.applyChanges(o,r,s)}delete(e){const n=this.field(e.popLast());Fd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Kr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Fd(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Oi(n,(s,o)=>e[s]=o);for(const s of r)delete e[s]}clone(){return new bn(mc(this.value))}}function ON(t){const e=[];return Oi(t.fields,(n,r)=>{const s=new Wt([n]);if(Fd(r)){const o=ON(r.mapValue).fields;if(o.length===0)e.push(s);else for(const l of o)e.push(s.child(l))}else e.push(s)}),new Dn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e,n,r,s,o,l,h){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=o,this.data=l,this.documentState=h}static newInvalidDocument(e){return new en(e,0,Se.min(),Se.min(),Se.min(),bn.empty(),0)}static newFoundDocument(e,n,r,s){return new en(e,1,n,Se.min(),r,s,0)}static newNoDocument(e,n){return new en(e,2,n,Se.min(),Se.min(),bn.empty(),0)}static newUnknownDocument(e,n){return new en(e,3,n,Se.min(),Se.min(),bn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=bn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=bn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof en&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new en(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e,n){this.position=e,this.inclusive=n}}function n0(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const o=e[s],l=t.position[s];if(o.field.isKeyField()?r=ve.comparator(ve.fromName(l.referenceValue),n.key):r=Ya(l,n.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function r0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Kr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(e,n="asc"){this.field=e,this.dir=n}}function pR(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let VN=class{};class kt extends VN{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new yR(e,n,r):n==="array-contains"?new xR(e,r):n==="in"?new wR(e,r):n==="not-in"?new bR(e,r):n==="array-contains-any"?new NR(e,r):new kt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new _R(e,r):new vR(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ya(n,this.value)):n!==null&&Ti(this.value)===Ti(n)&&this.matchesComparison(Ya(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ee(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class _r extends VN{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new _r(e,n)}matches(e){return UN(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function UN(t){return t.op==="and"}function FN(t){return gR(t)&&UN(t)}function gR(t){for(const e of t.filters)if(e instanceof _r)return!1;return!0}function Bp(t){if(t instanceof kt)return t.field.canonicalString()+t.op.toString()+Xa(t.value);if(FN(t))return t.filters.map(e=>Bp(e)).join(",");{const e=t.filters.map(n=>Bp(n)).join(",");return`${t.op}(${e})`}}function BN(t,e){return t instanceof kt?function(r,s){return s instanceof kt&&r.op===s.op&&r.field.isEqual(s.field)&&Kr(r.value,s.value)}(t,e):t instanceof _r?function(r,s){return s instanceof _r&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((o,l,h)=>o&&BN(l,s.filters[h]),!0):!1}(t,e):void Ee(19439)}function $N(t){return t instanceof kt?function(n){return`${n.field.canonicalString()} ${n.op} ${Xa(n.value)}`}(t):t instanceof _r?function(n){return n.op.toString()+" {"+n.getFilters().map($N).join(" ,")+"}"}(t):"Filter"}class yR extends kt{constructor(e,n,r){super(e,n,r),this.key=ve.fromName(r.referenceValue)}matches(e){const n=ve.comparator(e.key,this.key);return this.matchesComparison(n)}}class _R extends kt{constructor(e,n){super(e,"in",n),this.keys=WN("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class vR extends kt{constructor(e,n){super(e,"not-in",n),this.keys=WN("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function WN(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>ve.fromName(r.referenceValue))}class xR extends kt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Py(n)&&Hc(n.arrayValue,this.value)}}class wR extends kt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Hc(this.value.arrayValue,n)}}class bR extends kt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Hc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Hc(this.value.arrayValue,n)}}class NR extends kt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Py(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Hc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(e,n=null,r=[],s=[],o=null,l=null,h=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=o,this.startAt=l,this.endAt=h,this.Te=null}}function s0(t,e=null,n=[],r=[],s=null,o=null,l=null){return new ER(t,e,n,r,s,o,l)}function Iy(t){const e=Ie(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Bp(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),lf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Xa(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Xa(r)).join(",")),e.Te=n}return e.Te}function Cy(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!pR(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!BN(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!r0(t.startAt,e.startAt)&&r0(t.endAt,e.endAt)}function $p(t){return ve.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e,n=null,r=[],s=[],o=null,l="F",h=null,f=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=o,this.limitType=l,this.startAt=h,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function TR(t,e,n,r,s,o,l,h){return new uu(t,e,n,r,s,o,l,h)}function uf(t){return new uu(t)}function i0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function HN(t){return t.collectionGroup!==null}function pc(t){const e=Ie(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),n.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let h=new Ct(Wt.comparator);return l.filters.forEach(f=>{f.getFlattenedFilters().forEach(m=>{m.isInequality()&&(h=h.add(m.field))})}),h})(e).forEach(o=>{n.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Sh(o,r))}),n.has(Wt.keyField().canonicalString())||e.Ie.push(new Sh(Wt.keyField(),r))}return e.Ie}function Wr(t){const e=Ie(t);return e.Ee||(e.Ee=jR(e,pc(t))),e.Ee}function jR(t,e){if(t.limitType==="F")return s0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const o=s.dir==="desc"?"asc":"desc";return new Sh(s.field,o)});const n=t.endAt?new kh(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new kh(t.startAt.position,t.startAt.inclusive):null;return s0(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Wp(t,e){const n=t.filters.concat([e]);return new uu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Hp(t,e,n){return new uu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function df(t,e){return Cy(Wr(t),Wr(e))&&t.limitType===e.limitType}function qN(t){return`${Iy(Wr(t))}|lt:${t.limitType}`}function ma(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>$N(s)).join(", ")}]`),lf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Xa(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Xa(s)).join(",")),`Target(${r})`}(Wr(t))}; limitType=${t.limitType})`}function hf(t,e){return e.isFoundDocument()&&function(r,s){const o=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):ve.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(t,e)&&function(r,s){for(const o of pc(r))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const o of r.filters)if(!o.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(l,h,f){const m=n0(l,h,f);return l.inclusive?m<=0:m<0}(r.startAt,pc(r),s)||r.endAt&&!function(l,h,f){const m=n0(l,h,f);return l.inclusive?m>=0:m>0}(r.endAt,pc(r),s))}(t,e)}function kR(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function ZN(t){return(e,n)=>{let r=!1;for(const s of pc(t)){const o=SR(s,e,n);if(o!==0)return o;r=r||s.field.isKeyField()}return 0}}function SR(t,e,n){const r=t.field.isKeyField()?ve.comparator(e.key,n.key):function(o,l,h){const f=l.data.field(o),m=h.data.field(o);return f!==null&&m!==null?Ya(f,m):Ee(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ee(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,o]of r)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Oi(this.inner,(n,r)=>{for(const[s,o]of r)e(s,o)})}isEmpty(){return IN(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PR=new ut(ve.comparator);function Is(){return PR}const GN=new ut(ve.comparator);function ec(...t){let e=GN;for(const n of t)e=e.insert(n.key,n);return e}function KN(t){let e=GN;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function lo(){return gc()}function QN(){return gc()}function gc(){return new Lo(t=>t.toString(),(t,e)=>t.isEqual(e))}const IR=new ut(ve.comparator),CR=new Ct(ve.comparator);function Me(...t){let e=CR;for(const n of t)e=e.add(n);return e}const AR=new Ct(ze);function RR(){return AR}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ay(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Eh(e)?"-0":e}}function YN(t){return{integerValue:""+t}}function LR(t,e){return aR(e)?YN(e):Ay(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(){this._=void 0}}function DR(t,e,n){return t instanceof qc?function(s,o){const l={fields:{[RN]:{stringValue:AN},[DN]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&Sy(o)&&(o=cf(o)),o&&(l.fields[LN]=o),{mapValue:l}}(n,e):t instanceof Zc?JN(t,e):t instanceof Gc?eE(t,e):function(s,o){const l=XN(s,o),h=o0(l)+o0(s.Ae);return Fp(l)&&Fp(s.Ae)?YN(h):Ay(s.serializer,h)}(t,e)}function zR(t,e,n){return t instanceof Zc?JN(t,e):t instanceof Gc?eE(t,e):n}function XN(t,e){return t instanceof Ph?function(r){return Fp(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}class qc extends ff{}class Zc extends ff{constructor(e){super(),this.elements=e}}function JN(t,e){const n=tE(e);for(const r of t.elements)n.some(s=>Kr(s,r))||n.push(r);return{arrayValue:{values:n}}}class Gc extends ff{constructor(e){super(),this.elements=e}}function eE(t,e){let n=tE(e);for(const r of t.elements)n=n.filter(s=>!Kr(s,r));return{arrayValue:{values:n}}}class Ph extends ff{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function o0(t){return yt(t.integerValue||t.doubleValue)}function tE(t){return Py(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MR{constructor(e,n){this.field=e,this.transform=n}}function OR(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Zc&&s instanceof Zc||r instanceof Gc&&s instanceof Gc?Qa(r.elements,s.elements,Kr):r instanceof Ph&&s instanceof Ph?Kr(r.Ae,s.Ae):r instanceof qc&&s instanceof qc}(t.transform,e.transform)}class VR{constructor(e,n){this.version=e,this.transformResults=n}}class Sn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Sn}static exists(e){return new Sn(void 0,e)}static updateTime(e){return new Sn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class mf{}function nE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new pf(t.key,Sn.none()):new du(t.key,t.data,Sn.none());{const n=t.data,r=bn.empty();let s=new Ct(Wt.comparator);for(let o of e.fields)if(!s.has(o)){let l=n.field(o);l===null&&o.length>1&&(o=o.popLast(),l=n.field(o)),l===null?r.delete(o):r.set(o,l),s=s.add(o)}return new Vi(t.key,r,new Dn(s.toArray()),Sn.none())}}function UR(t,e,n){t instanceof du?function(s,o,l){const h=s.value.clone(),f=l0(s.fieldTransforms,o,l.transformResults);h.setAll(f),o.convertToFoundDocument(l.version,h).setHasCommittedMutations()}(t,e,n):t instanceof Vi?function(s,o,l){if(!Bd(s.precondition,o))return void o.convertToUnknownDocument(l.version);const h=l0(s.fieldTransforms,o,l.transformResults),f=o.data;f.setAll(rE(s)),f.setAll(h),o.convertToFoundDocument(l.version,f).setHasCommittedMutations()}(t,e,n):function(s,o,l){o.convertToNoDocument(l.version).setHasCommittedMutations()}(0,e,n)}function yc(t,e,n,r){return t instanceof du?function(o,l,h,f){if(!Bd(o.precondition,l))return h;const m=o.value.clone(),g=c0(o.fieldTransforms,f,l);return m.setAll(g),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),null}(t,e,n,r):t instanceof Vi?function(o,l,h,f){if(!Bd(o.precondition,l))return h;const m=c0(o.fieldTransforms,f,l),g=l.data;return g.setAll(rE(o)),g.setAll(m),l.convertToFoundDocument(l.version,g).setHasLocalMutations(),h===null?null:h.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(_=>_.field))}(t,e,n,r):function(o,l,h){return Bd(o.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):h}(t,e,n)}function FR(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),o=XN(r.transform,s||null);o!=null&&(n===null&&(n=bn.empty()),n.set(r.field,o))}return n||null}function a0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Qa(r,s,(o,l)=>OR(o,l))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class du extends mf{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Vi extends mf{constructor(e,n,r,s,o=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function rE(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function l0(t,e,n){const r=new Map;He(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const o=t[s],l=o.transform,h=e.data.field(o.field);r.set(o.field,zR(l,h,n[s]))}return r}function c0(t,e,n){const r=new Map;for(const s of t){const o=s.transform,l=n.data.field(s.field);r.set(s.field,DR(o,l,e))}return r}class pf extends mf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class BR extends mf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(e.key)&&UR(o,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=yc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=yc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=QN();return this.mutations.forEach(s=>{const o=e.get(s.key),l=o.overlayedDocument;let h=this.applyToLocalView(l,o.mutatedFields);h=n.has(s.key)?null:h;const f=nE(l,h);f!==null&&r.set(s.key,f),l.isValidDocument()||l.convertToNoDocument(Se.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Me())}isEqual(e){return this.batchId===e.batchId&&Qa(this.mutations,e.mutations,(n,r)=>a0(n,r))&&Qa(this.baseMutations,e.baseMutations,(n,r)=>a0(n,r))}}class Ry{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){He(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return IR}();const o=e.mutations;for(let l=0;l<o.length;l++)s=s.insert(o[l].key,r[l].version);return new Ry(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HR{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nt,Ve;function qR(t){switch(t){case J.OK:return Ee(64938);case J.CANCELLED:case J.UNKNOWN:case J.DEADLINE_EXCEEDED:case J.RESOURCE_EXHAUSTED:case J.INTERNAL:case J.UNAVAILABLE:case J.UNAUTHENTICATED:return!1;case J.INVALID_ARGUMENT:case J.NOT_FOUND:case J.ALREADY_EXISTS:case J.PERMISSION_DENIED:case J.FAILED_PRECONDITION:case J.ABORTED:case J.OUT_OF_RANGE:case J.UNIMPLEMENTED:case J.DATA_LOSS:return!0;default:return Ee(15467,{code:t})}}function sE(t){if(t===void 0)return Ps("GRPC error has no .code"),J.UNKNOWN;switch(t){case Nt.OK:return J.OK;case Nt.CANCELLED:return J.CANCELLED;case Nt.UNKNOWN:return J.UNKNOWN;case Nt.DEADLINE_EXCEEDED:return J.DEADLINE_EXCEEDED;case Nt.RESOURCE_EXHAUSTED:return J.RESOURCE_EXHAUSTED;case Nt.INTERNAL:return J.INTERNAL;case Nt.UNAVAILABLE:return J.UNAVAILABLE;case Nt.UNAUTHENTICATED:return J.UNAUTHENTICATED;case Nt.INVALID_ARGUMENT:return J.INVALID_ARGUMENT;case Nt.NOT_FOUND:return J.NOT_FOUND;case Nt.ALREADY_EXISTS:return J.ALREADY_EXISTS;case Nt.PERMISSION_DENIED:return J.PERMISSION_DENIED;case Nt.FAILED_PRECONDITION:return J.FAILED_PRECONDITION;case Nt.ABORTED:return J.ABORTED;case Nt.OUT_OF_RANGE:return J.OUT_OF_RANGE;case Nt.UNIMPLEMENTED:return J.UNIMPLEMENTED;case Nt.DATA_LOSS:return J.DATA_LOSS;default:return Ee(39323,{code:t})}}(Ve=Nt||(Nt={}))[Ve.OK=0]="OK",Ve[Ve.CANCELLED=1]="CANCELLED",Ve[Ve.UNKNOWN=2]="UNKNOWN",Ve[Ve.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ve[Ve.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ve[Ve.NOT_FOUND=5]="NOT_FOUND",Ve[Ve.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ve[Ve.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ve[Ve.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ve[Ve.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ve[Ve.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ve[Ve.ABORTED=10]="ABORTED",Ve[Ve.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ve[Ve.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ve[Ve.INTERNAL=13]="INTERNAL",Ve[Ve.UNAVAILABLE=14]="UNAVAILABLE",Ve[Ve.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZR(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GR=new gi([4294967295,4294967295],0);function u0(t){const e=ZR().encode(t),n=new vN;return n.update(e),new Uint8Array(n.digest())}function d0(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new gi([n,r],0),new gi([s,o],0)]}class Ly{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new tc(`Invalid padding: ${n}`);if(r<0)throw new tc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new tc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new tc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=gi.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(gi.fromNumber(r)));return s.compare(GR)===1&&(s=new gi([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=u0(e),[r,s]=d0(n);for(let o=0;o<this.hashCount;o++){const l=this.ye(r,s,o);if(!this.we(l))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),l=new Ly(o,s,n);return r.forEach(h=>l.insert(h)),l}insert(e){if(this.ge===0)return;const n=u0(e),[r,s]=d0(n);for(let o=0;o<this.hashCount;o++){const l=this.ye(r,s,o);this.Se(l)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class tc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e,n,r,s,o){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,hu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new gf(Se.min(),s,new ut(ze),Is(),Me())}}class hu{constructor(e,n,r,s,o){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new hu(r,n,Me(),Me(),Me())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class iE{constructor(e,n){this.targetId=e,this.Ce=n}}class oE{constructor(e,n,r=Zt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class h0{constructor(){this.ve=0,this.Fe=f0(),this.Me=Zt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Me(),n=Me(),r=Me();return this.Fe.forEach((s,o)=>{switch(o){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:Ee(38017,{changeType:o})}}),new hu(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=f0()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,He(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class KR{constructor(e){this.Ge=e,this.ze=new Map,this.je=Is(),this.Je=yd(),this.He=yd(),this.Ye=new ut(ze)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Ee(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const o=s.target;if($p(o))if(r===0){const l=new ve(o.path);this.et(n,l,en.newNoDocument(l,Se.min()))}else He(r===1,20013,{expectedCount:r});else{const l=this._t(n);if(l!==r){const h=this.ut(e),f=h?this.ct(h,e,l):1;if(f!==0){this.it(n);const m=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,m)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:o=0}=n;let l,h;try{l=Ei(r).toUint8Array()}catch(f){if(f instanceof CN)return Ka("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{h=new Ly(l,s,o)}catch(f){return Ka(f instanceof tc?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return h.ge===0?null:h}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(o=>{const l=this.Ge.ht(),h=`projects/${l.projectId}/databases/${l.database}/documents/${o.path.canonicalString()}`;e.mightContain(h)||(this.et(n,o,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((o,l)=>{const h=this.ot(l);if(h){if(o.current&&$p(h.target)){const f=new ve(h.target.path);this.It(f).has(l)||this.Et(l,f)||this.et(l,f,en.newNoDocument(f,e))}o.Be&&(n.set(l,o.ke()),o.qe())}});let r=Me();this.He.forEach((o,l)=>{let h=!0;l.forEachWhile(f=>{const m=this.ot(f);return!m||m.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)}),h&&(r=r.add(o))}),this.je.forEach((o,l)=>l.setReadTime(e));const s=new gf(e,n,this.Ye,this.je,r);return this.je=Is(),this.Je=yd(),this.He=yd(),this.Ye=new ut(ze),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new h0,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Ct(ze),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Ct(ze),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||de("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new h0),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function yd(){return new ut(ve.comparator)}function f0(){return new ut(ve.comparator)}const QR={asc:"ASCENDING",desc:"DESCENDING"},YR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},XR={and:"AND",or:"OR"};class JR{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function qp(t,e){return t.useProto3Json||lf(e)?e:{value:e}}function Ih(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function aE(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function eL(t,e){return Ih(t,e.toTimestamp())}function Hr(t){return He(!!t,49232),Se.fromTimestamp(function(n){const r=Ni(n);return new tt(r.seconds,r.nanos)}(t))}function Dy(t,e){return Zp(t,e).canonicalString()}function Zp(t,e){const n=function(s){return new Ye(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function lE(t){const e=Ye.fromString(t);return He(fE(e),10190,{key:e.toString()}),e}function Gp(t,e){return Dy(t.databaseId,e.path)}function Em(t,e){const n=lE(e);if(n.get(1)!==t.databaseId.projectId)throw new ae(J.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ae(J.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ve(uE(n))}function cE(t,e){return Dy(t.databaseId,e)}function tL(t){const e=lE(t);return e.length===4?Ye.emptyPath():uE(e)}function Kp(t){return new Ye(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function uE(t){return He(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function m0(t,e,n){return{name:Gp(t,e),fields:n.value.mapValue.fields}}function nL(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Ee(39313,{state:m})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],o=function(m,g){return m.useProto3Json?(He(g===void 0||typeof g=="string",58123),Zt.fromBase64String(g||"")):(He(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),Zt.fromUint8Array(g||new Uint8Array))}(t,e.targetChange.resumeToken),l=e.targetChange.cause,h=l&&function(m){const g=m.code===void 0?J.UNKNOWN:sE(m.code);return new ae(g,m.message||"")}(l);n=new oE(r,s,o,h||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Em(t,r.document.name),o=Hr(r.document.updateTime),l=r.document.createTime?Hr(r.document.createTime):Se.min(),h=new bn({mapValue:{fields:r.document.fields}}),f=en.newFoundDocument(s,o,l,h),m=r.targetIds||[],g=r.removedTargetIds||[];n=new $d(m,g,f.key,f)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Em(t,r.document),o=r.readTime?Hr(r.readTime):Se.min(),l=en.newNoDocument(s,o),h=r.removedTargetIds||[];n=new $d([],h,l.key,l)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Em(t,r.document),o=r.removedTargetIds||[];n=new $d([],o,s,null)}else{if(!("filter"in e))return Ee(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:o}=r,l=new HR(s,o),h=r.targetId;n=new iE(h,l)}}return n}function rL(t,e){let n;if(e instanceof du)n={update:m0(t,e.key,e.value)};else if(e instanceof pf)n={delete:Gp(t,e.key)};else if(e instanceof Vi)n={update:m0(t,e.key,e.data),updateMask:hL(e.fieldMask)};else{if(!(e instanceof BR))return Ee(16599,{Vt:e.type});n={verify:Gp(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(o,l){const h=l.transform;if(h instanceof qc)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Zc)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Gc)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof Ph)return{fieldPath:l.field.canonicalString(),increment:h.Ae};throw Ee(20930,{transform:l.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,o){return o.updateTime!==void 0?{updateTime:eL(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Ee(27497)}(t,e.precondition)),n}function sL(t,e){return t&&t.length>0?(He(e!==void 0,14353),t.map(n=>function(s,o){let l=s.updateTime?Hr(s.updateTime):Hr(o);return l.isEqual(Se.min())&&(l=Hr(o)),new VR(l,s.transformResults||[])}(n,e))):[]}function iL(t,e){return{documents:[cE(t,e.path)]}}function oL(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=cE(t,s);const o=function(m){if(m.length!==0)return hE(_r.create(m,"and"))}(e.filters);o&&(n.structuredQuery.where=o);const l=function(m){if(m.length!==0)return m.map(g=>function(w){return{field:pa(w.field),direction:cL(w.dir)}}(g))}(e.orderBy);l&&(n.structuredQuery.orderBy=l);const h=qp(t,e.limit);return h!==null&&(n.structuredQuery.limit=h),e.startAt&&(n.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{ft:n,parent:s}}function aL(t){let e=tL(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){He(r===1,65062);const g=n.from[0];g.allDescendants?s=g.collectionId:e=e.child(g.collectionId)}let o=[];n.where&&(o=function(_){const w=dE(_);return w instanceof _r&&FN(w)?w.getFilters():[w]}(n.where));let l=[];n.orderBy&&(l=function(_){return _.map(w=>function(j){return new Sh(ga(j.field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(j.direction))}(w))}(n.orderBy));let h=null;n.limit&&(h=function(_){let w;return w=typeof _=="object"?_.value:_,lf(w)?null:w}(n.limit));let f=null;n.startAt&&(f=function(_){const w=!!_.before,T=_.values||[];return new kh(T,w)}(n.startAt));let m=null;return n.endAt&&(m=function(_){const w=!_.before,T=_.values||[];return new kh(T,w)}(n.endAt)),TR(e,s,l,o,h,"F",f,m)}function lL(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ee(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function dE(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ga(n.unaryFilter.field);return kt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=ga(n.unaryFilter.field);return kt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=ga(n.unaryFilter.field);return kt.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=ga(n.unaryFilter.field);return kt.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ee(61313);default:return Ee(60726)}}(t):t.fieldFilter!==void 0?function(n){return kt.create(ga(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ee(58110);default:return Ee(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return _r.create(n.compositeFilter.filters.map(r=>dE(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Ee(1026)}}(n.compositeFilter.op))}(t):Ee(30097,{filter:t})}function cL(t){return QR[t]}function uL(t){return YR[t]}function dL(t){return XR[t]}function pa(t){return{fieldPath:t.canonicalString()}}function ga(t){return Wt.fromServerFormat(t.fieldPath)}function hE(t){return t instanceof kt?function(n){if(n.op==="=="){if(t0(n.value))return{unaryFilter:{field:pa(n.field),op:"IS_NAN"}};if(e0(n.value))return{unaryFilter:{field:pa(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(t0(n.value))return{unaryFilter:{field:pa(n.field),op:"IS_NOT_NAN"}};if(e0(n.value))return{unaryFilter:{field:pa(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:pa(n.field),op:uL(n.op),value:n.value}}}(t):t instanceof _r?function(n){const r=n.getFilters().map(s=>hE(s));return r.length===1?r[0]:{compositeFilter:{op:dL(n.op),filters:r}}}(t):Ee(54877,{filter:t})}function hL(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function fE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,n,r,s,o=Se.min(),l=Se.min(),h=Zt.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=h,this.expectedCount=f}withSequenceNumber(e){return new si(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL{constructor(e){this.yt=e}}function mL(t){const e=aL({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Hp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{constructor(){this.Cn=new gL}addToCollectionParentIndex(e,n){return this.Cn.add(n),ee.resolve()}getCollectionParents(e,n){return ee.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ee.resolve()}deleteFieldIndex(e,n){return ee.resolve()}deleteAllFieldIndexes(e){return ee.resolve()}createTargetIndexes(e,n){return ee.resolve()}getDocumentsMatchingTarget(e,n){return ee.resolve(null)}getIndexType(e,n){return ee.resolve(0)}getFieldIndexes(e,n){return ee.resolve([])}getNextCollectionGroupToUpdate(e){return ee.resolve(null)}getMinOffset(e,n){return ee.resolve(bi.min())}getMinOffsetFromCollectionGroup(e,n){return ee.resolve(bi.min())}updateCollectionGroup(e,n,r){return ee.resolve()}updateIndexEntries(e,n){return ee.resolve()}}class gL{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Ct(Ye.comparator),o=!s.has(r);return this.index[n]=s.add(r),o}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ct(Ye.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},mE=41943040;class vn{static withCacheSize(e){return new vn(e,vn.DEFAULT_COLLECTION_PERCENTILE,vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vn.DEFAULT_COLLECTION_PERCENTILE=10,vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,vn.DEFAULT=new vn(mE,vn.DEFAULT_COLLECTION_PERCENTILE,vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),vn.DISABLED=new vn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ja(0)}static cr(){return new Ja(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g0="LruGarbageCollector",yL=1048576;function y0([t,e],[n,r]){const s=ze(t,n);return s===0?ze(e,r):s}class _L{constructor(e){this.Ir=e,this.buffer=new Ct(y0),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();y0(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class vL{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){de(g0,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ul(n)?de(g0,"Ignoring IndexedDB error during garbage collection: ",n):await cl(n)}await this.Vr(3e5)})}}class xL{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return ee.resolve(af.ce);const r=new _L(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(de("LruGarbageCollector","Garbage collection skipped; disabled"),ee.resolve(p0)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(de("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),p0):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,o,l,h,f,m;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(_=>(_>this.params.maximumSequenceNumbersToCollect?(de("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),s=this.params.maximumSequenceNumbersToCollect):s=_,l=Date.now(),this.nthSequenceNumber(e,s))).next(_=>(r=_,h=Date.now(),this.removeTargets(e,r,n))).next(_=>(o=_,f=Date.now(),this.removeOrphanedDocuments(e,r))).next(_=>(m=Date.now(),fa()<=De.DEBUG&&de("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-g}ms
	Determined least recently used ${s} in `+(h-l)+`ms
	Removed ${o} targets in `+(f-h)+`ms
	Removed ${_} documents in `+(m-f)+`ms
Total Duration: ${m-g}ms`),ee.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:_})))}}function wL(t,e){return new xL(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL{constructor(){this.changes=new Lo(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,en.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?ee.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NL{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EL{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&yc(r.mutation,s,Dn.empty(),tt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Me()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Me()){const s=lo();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(o=>{let l=ec();return o.forEach((h,f)=>{l=l.insert(h,f.overlayedDocument)}),l}))}getOverlayedDocuments(e,n){const r=lo();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Me()))}populateOverlays(e,n,r){const s=[];return r.forEach(o=>{n.has(o)||s.push(o)}),this.documentOverlayCache.getOverlays(e,s).next(o=>{o.forEach((l,h)=>{n.set(l,h)})})}computeViews(e,n,r,s){let o=Is();const l=gc(),h=function(){return gc()}();return n.forEach((f,m)=>{const g=r.get(m.key);s.has(m.key)&&(g===void 0||g.mutation instanceof Vi)?o=o.insert(m.key,m):g!==void 0?(l.set(m.key,g.mutation.getFieldMask()),yc(g.mutation,m,g.mutation.getFieldMask(),tt.now())):l.set(m.key,Dn.empty())}),this.recalculateAndSaveOverlays(e,o).next(f=>(f.forEach((m,g)=>l.set(m,g)),n.forEach((m,g)=>h.set(m,new NL(g,l.get(m)??null))),h))}recalculateAndSaveOverlays(e,n){const r=gc();let s=new ut((l,h)=>l-h),o=Me();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(l=>{for(const h of l)h.keys().forEach(f=>{const m=n.get(f);if(m===null)return;let g=r.get(f)||Dn.empty();g=h.applyToLocalView(m,g),r.set(f,g);const _=(s.get(h.batchId)||Me()).add(f);s=s.insert(h.batchId,_)})}).next(()=>{const l=[],h=s.getReverseIterator();for(;h.hasNext();){const f=h.getNext(),m=f.key,g=f.value,_=QN();g.forEach(w=>{if(!o.has(w)){const T=nE(n.get(w),r.get(w));T!==null&&_.set(w,T),o=o.add(w)}}),l.push(this.documentOverlayCache.saveOverlays(e,m,_))}return ee.waitFor(l)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(l){return ve.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):HN(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(o=>{const l=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-o.size):ee.resolve(lo());let h=Bc,f=o;return l.next(m=>ee.forEach(m,(g,_)=>(h<_.largestBatchId&&(h=_.largestBatchId),o.get(g)?ee.resolve():this.remoteDocumentCache.getEntry(e,g).next(w=>{f=f.insert(g,w)}))).next(()=>this.populateOverlays(e,m,o)).next(()=>this.computeViews(e,f,m,Me())).next(g=>({batchId:h,changes:KN(g)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ve(n)).next(r=>{let s=ec();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const o=n.collectionGroup;let l=ec();return this.indexManager.getCollectionParents(e,o).next(h=>ee.forEach(h,f=>{const m=function(_,w){return new uu(w,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)}(n,f.child(o));return this.getDocumentsMatchingCollectionQuery(e,m,r,s).next(g=>{g.forEach((_,w)=>{l=l.insert(_,w)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(e,n,r,s){let o;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,o,s))).next(l=>{o.forEach((f,m)=>{const g=m.getKey();l.get(g)===null&&(l=l.insert(g,en.newInvalidDocument(g)))});let h=ec();return l.forEach((f,m)=>{const g=o.get(f);g!==void 0&&yc(g.mutation,m,Dn.empty(),tt.now()),hf(n,m)&&(h=h.insert(f,m))}),h})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TL{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return ee.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Hr(s.createTime)}}(n)),ee.resolve()}getNamedQuery(e,n){return ee.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:mL(s.bundledQuery),readTime:Hr(s.readTime)}}(n)),ee.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jL{constructor(){this.overlays=new ut(ve.comparator),this.qr=new Map}getOverlay(e,n){return ee.resolve(this.overlays.get(n))}getOverlays(e,n){const r=lo();return ee.forEach(n,s=>this.getOverlay(e,s).next(o=>{o!==null&&r.set(s,o)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,o)=>{this.St(e,n,o)}),ee.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(r)),ee.resolve()}getOverlaysForCollection(e,n,r){const s=lo(),o=n.length+1,l=new ve(n.child("")),h=this.overlays.getIteratorFrom(l);for(;h.hasNext();){const f=h.getNext().value,m=f.getKey();if(!n.isPrefixOf(m.path))break;m.path.length===o&&f.largestBatchId>r&&s.set(f.getKey(),f)}return ee.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let o=new ut((m,g)=>m-g);const l=this.overlays.getIterator();for(;l.hasNext();){const m=l.getNext().value;if(m.getKey().getCollectionGroup()===n&&m.largestBatchId>r){let g=o.get(m.largestBatchId);g===null&&(g=lo(),o=o.insert(m.largestBatchId,g)),g.set(m.getKey(),m)}}const h=lo(),f=o.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach((m,g)=>h.set(m,g)),!(h.size()>=s)););return ee.resolve(h)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const l=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new WR(n,r));let o=this.qr.get(n);o===void 0&&(o=Me(),this.qr.set(n,o)),this.qr.set(n,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kL{constructor(){this.sessionToken=Zt.EMPTY_BYTE_STRING}getSessionToken(e){return ee.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ee.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy{constructor(){this.Qr=new Ct(Mt.$r),this.Ur=new Ct(Mt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Mt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Mt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new ve(new Ye([])),r=new Mt(n,e),s=new Mt(n,e+1),o=[];return this.Ur.forEachInRange([r,s],l=>{this.Gr(l),o.push(l.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ve(new Ye([])),r=new Mt(n,e),s=new Mt(n,e+1);let o=Me();return this.Ur.forEachInRange([r,s],l=>{o=o.add(l.key)}),o}containsKey(e){const n=new Mt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Mt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ve.comparator(e.key,n.key)||ze(e.Yr,n.Yr)}static Kr(e,n){return ze(e.Yr,n.Yr)||ve.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SL{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Ct(Mt.$r)}checkEmpty(e){return ee.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new $R(o,n,r,s);this.mutationQueue.push(l);for(const h of s)this.Zr=this.Zr.add(new Mt(h.key,o)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return ee.resolve(l)}lookupMutationBatch(e,n){return ee.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),o=s<0?0:s;return ee.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return ee.resolve(this.mutationQueue.length===0?ky:this.tr-1)}getAllMutationBatches(e){return ee.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Mt(n,0),s=new Mt(n,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([r,s],l=>{const h=this.Xr(l.Yr);o.push(h)}),ee.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ct(ze);return n.forEach(s=>{const o=new Mt(s,0),l=new Mt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,l],h=>{r=r.add(h.Yr)})}),ee.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let o=r;ve.isDocumentKey(o)||(o=o.child(""));const l=new Mt(new ve(o),0);let h=new Ct(ze);return this.Zr.forEachWhile(f=>{const m=f.key.path;return!!r.isPrefixOf(m)&&(m.length===s&&(h=h.add(f.Yr)),!0)},l),ee.resolve(this.ti(h))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){He(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return ee.forEach(n.mutations,s=>{const o=new Mt(s.key,n.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Mt(n,0),s=this.Zr.firstAfterOrEqual(r);return ee.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,ee.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL{constructor(e){this.ri=e,this.docs=function(){return new ut(ve.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),o=s?s.size:0,l=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return ee.resolve(r?r.document.mutableCopy():en.newInvalidDocument(n))}getEntries(e,n){let r=Is();return n.forEach(s=>{const o=this.docs.get(s);r=r.insert(s,o?o.document.mutableCopy():en.newInvalidDocument(s))}),ee.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let o=Is();const l=n.path,h=new ve(l.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(h);for(;f.hasNext();){const{key:m,value:{document:g}}=f.getNext();if(!l.isPrefixOf(m.path))break;m.path.length>l.length+1||rR(nR(g),r)<=0||(s.has(g.key)||hf(n,g))&&(o=o.insert(g.key,g.mutableCopy()))}return ee.resolve(o)}getAllFromCollectionGroup(e,n,r,s){Ee(9500)}ii(e,n){return ee.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new IL(this)}getSize(e){return ee.resolve(this.size)}}class IL extends bL{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),ee.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CL{constructor(e){this.persistence=e,this.si=new Lo(n=>Iy(n),Cy),this.lastRemoteSnapshotVersion=Se.min(),this.highestTargetId=0,this.oi=0,this._i=new zy,this.targetCount=0,this.ai=Ja.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),ee.resolve()}getLastRemoteSnapshotVersion(e){return ee.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ee.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ee.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),ee.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Ja(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,ee.resolve()}updateTargetData(e,n){return this.Pr(n),ee.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,ee.resolve()}removeTargets(e,n,r){let s=0;const o=[];return this.si.forEach((l,h)=>{h.sequenceNumber<=n&&r.get(h.targetId)===null&&(this.si.delete(l),o.push(this.removeMatchingKeysForTargetId(e,h.targetId)),s++)}),ee.waitFor(o).next(()=>s)}getTargetCount(e){return ee.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return ee.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),ee.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,o=[];return s&&n.forEach(l=>{o.push(s.markPotentiallyOrphaned(e,l))}),ee.waitFor(o)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),ee.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return ee.resolve(r)}containsKey(e,n){return ee.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{constructor(e,n){this.ui={},this.overlays={},this.ci=new af(0),this.li=!1,this.li=!0,this.hi=new kL,this.referenceDelegate=e(this),this.Pi=new CL(this),this.indexManager=new pL,this.remoteDocumentCache=function(s){return new PL(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new fL(n),this.Ii=new TL(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new jL,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new SL(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){de("MemoryPersistence","Starting transaction:",e);const s=new AL(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(o=>this.referenceDelegate.di(s).next(()=>o)).toPromise().then(o=>(s.raiseOnCommittedEvent(),o))}Ai(e,n){return ee.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class AL extends iR{constructor(e){super(),this.currentSequenceNumber=e}}class My{constructor(e){this.persistence=e,this.Ri=new zy,this.Vi=null}static mi(e){return new My(e)}get fi(){if(this.Vi)return this.Vi;throw Ee(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),ee.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),ee.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),ee.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(o=>this.fi.add(o.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ee.forEach(this.fi,r=>{const s=ve.fromPath(r);return this.gi(e,s).next(o=>{o||n.removeEntry(s,Se.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return ee.or([()=>ee.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Ch{constructor(e,n){this.persistence=e,this.pi=new Lo(r=>lR(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=wL(this,n)}static mi(e,n){return new Ch(e,n)}Ei(){}di(e){return ee.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return ee.forEach(this.pi,(r,s)=>this.br(e,r,s).next(o=>o?ee.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),o=s.newChangeBuffer();return s.ii(e,l=>this.br(e,l,n).next(h=>{h||(r++,o.removeEntry(l,Se.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),ee.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),ee.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),ee.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),ee.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Ud(e.data.value)),n}br(e,n,r){return ee.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return ee.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=Me(),s=Me();for(const o of n.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new Oy(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return aP()?8:oR(rn())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const o={result:null};return this.ys(e,n).next(l=>{o.result=l}).next(()=>{if(!o.result)return this.ws(e,n,s,r).next(l=>{o.result=l})}).next(()=>{if(o.result)return;const l=new RL;return this.Ss(e,n,l).next(h=>{if(o.result=h,this.Vs)return this.bs(e,n,l,h.size)})}).next(()=>o.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(fa()<=De.DEBUG&&de("QueryEngine","SDK will not create cache indexes for query:",ma(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ee.resolve()):(fa()<=De.DEBUG&&de("QueryEngine","Query:",ma(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(fa()<=De.DEBUG&&de("QueryEngine","The SDK decides to create cache indexes for query:",ma(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wr(n))):ee.resolve())}ys(e,n){if(i0(n))return ee.resolve(null);let r=Wr(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Hp(n,null,"F"),r=Wr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{const l=Me(...o);return this.ps.getDocuments(e,l).next(h=>this.indexManager.getMinOffset(e,r).next(f=>{const m=this.Ds(n,h);return this.Cs(n,m,l,f.readTime)?this.ys(e,Hp(n,null,"F")):this.vs(e,m,n,f)}))})))}ws(e,n,r,s){return i0(n)||s.isEqual(Se.min())?ee.resolve(null):this.ps.getDocuments(e,r).next(o=>{const l=this.Ds(n,o);return this.Cs(n,l,r,s)?ee.resolve(null):(fa()<=De.DEBUG&&de("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ma(n)),this.vs(e,l,n,tR(s,Bc)).next(h=>h))})}Ds(e,n){let r=new Ct(ZN(e));return n.forEach((s,o)=>{hf(e,o)&&(r=r.add(o))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const o=e.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Ss(e,n,r){return fa()<=De.DEBUG&&de("QueryEngine","Using full collection scan to execute query:",ma(n)),this.ps.getDocumentsMatchingQuery(e,n,bi.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(o=>(n.forEach(l=>{o=o.insert(l.key,l)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vy="LocalStore",DL=3e8;class zL{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new ut(ze),this.xs=new Lo(o=>Iy(o),Cy),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new EL(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function ML(t,e,n,r){return new zL(t,e,n,r)}async function gE(t,e){const n=Ie(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(o=>(s=o,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(o=>{const l=[],h=[];let f=Me();for(const m of s){l.push(m.batchId);for(const g of m.mutations)f=f.add(g.key)}for(const m of o){h.push(m.batchId);for(const g of m.mutations)f=f.add(g.key)}return n.localDocuments.getDocuments(r,f).next(m=>({Ls:m,removedBatchIds:l,addedBatchIds:h}))})})}function OL(t,e){const n=Ie(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),o=n.Ns.newChangeBuffer({trackRemovals:!0});return function(h,f,m,g){const _=m.batch,w=_.keys();let T=ee.resolve();return w.forEach(j=>{T=T.next(()=>g.getEntry(f,j)).next(D=>{const M=m.docVersions.get(j);He(M!==null,48541),D.version.compareTo(M)<0&&(_.applyToRemoteDocument(D,m),D.isValidDocument()&&(D.setReadTime(m.commitVersion),g.addEntry(D)))})}),T.next(()=>h.mutationQueue.removeMutationBatch(f,_))}(n,r,e,o).next(()=>o.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(h){let f=Me();for(let m=0;m<h.mutationResults.length;++m)h.mutationResults[m].transformResults.length>0&&(f=f.add(h.batch.mutations[m].key));return f}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function yE(t){const e=Ie(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function VL(t,e){const n=Ie(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const l=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const h=[];e.targetChanges.forEach((g,_)=>{const w=s.get(_);if(!w)return;h.push(n.Pi.removeMatchingKeys(o,g.removedDocuments,_).next(()=>n.Pi.addMatchingKeys(o,g.addedDocuments,_)));let T=w.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(_)!==null?T=T.withResumeToken(Zt.EMPTY_BYTE_STRING,Se.min()).withLastLimboFreeSnapshotVersion(Se.min()):g.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(g.resumeToken,r)),s=s.insert(_,T),function(D,M,k){return D.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=DL?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(w,T,g)&&h.push(n.Pi.updateTargetData(o,T))});let f=Is(),m=Me();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&h.push(n.persistence.referenceDelegate.updateLimboDocument(o,g))}),h.push(UL(o,l,e.documentUpdates).next(g=>{f=g.ks,m=g.qs})),!r.isEqual(Se.min())){const g=n.Pi.getLastRemoteSnapshotVersion(o).next(_=>n.Pi.setTargetsMetadata(o,o.currentSequenceNumber,r));h.push(g)}return ee.waitFor(h).next(()=>l.apply(o)).next(()=>n.localDocuments.getLocalViewOfDocuments(o,f,m)).next(()=>f)}).then(o=>(n.Ms=s,o))}function UL(t,e,n){let r=Me(),s=Me();return n.forEach(o=>r=r.add(o)),e.getEntries(t,r).next(o=>{let l=Is();return n.forEach((h,f)=>{const m=o.get(h);f.isFoundDocument()!==m.isFoundDocument()&&(s=s.add(h)),f.isNoDocument()&&f.version.isEqual(Se.min())?(e.removeEntry(h,f.readTime),l=l.insert(h,f)):!m.isValidDocument()||f.version.compareTo(m.version)>0||f.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(f),l=l.insert(h,f)):de(Vy,"Ignoring outdated watch update for ",h,". Current version:",m.version," Watch version:",f.version)}),{ks:l,qs:s}})}function FL(t,e){const n=Ie(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=ky),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function BL(t,e){const n=Ie(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(o=>o?(s=o,ee.resolve(s)):n.Pi.allocateTargetId(r).next(l=>(s=new si(e,l,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function Qp(t,e,n){const r=Ie(t),s=r.Ms.get(e),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,l=>r.persistence.referenceDelegate.removeTarget(l,s))}catch(l){if(!ul(l))throw l;de(Vy,`Failed to update sequence numbers for target ${e}: ${l}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function _0(t,e,n){const r=Ie(t);let s=Se.min(),o=Me();return r.persistence.runTransaction("Execute query","readwrite",l=>function(f,m,g){const _=Ie(f),w=_.xs.get(g);return w!==void 0?ee.resolve(_.Ms.get(w)):_.Pi.getTargetData(m,g)}(r,l,Wr(e)).next(h=>{if(h)return s=h.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(l,h.targetId).next(f=>{o=f})}).next(()=>r.Fs.getDocumentsMatchingQuery(l,e,n?s:Se.min(),n?o:Me())).next(h=>($L(r,kR(e),h),{documents:h,Qs:o})))}function $L(t,e,n){let r=t.Os.get(e)||Se.min();n.forEach((s,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),t.Os.set(e,r)}class v0{constructor(){this.activeTargetIds=RR()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class WL{constructor(){this.Mo=new v0,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new v0,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HL{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x0="ConnectivityMonitor";class w0{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){de(x0,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){de(x0,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _d=null;function Yp(){return _d===null?_d=function(){return 268435456+Math.round(2147483648*Math.random())}():_d++,"0x"+_d.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tm="RestConnection",qL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ZL{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Th?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,o){const l=Yp(),h=this.zo(e,n.toUriEncodedString());de(Tm,`Sending RPC '${e}' ${l}:`,h,r);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,s,o);const{host:m}=new URL(h),g=Di(m);return this.Jo(e,h,f,r,g).then(_=>(de(Tm,`Received RPC '${e}' ${l}: `,_),_),_=>{throw Ka(Tm,`RPC '${e}' ${l} failed with error: `,_,"url: ",h,"request:",r),_})}Ho(e,n,r,s,o,l){return this.Go(e,n,r,s,o)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ll}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,o)=>e[o]=s),r&&r.headers.forEach((s,o)=>e[o]=s)}zo(e,n){const r=qL[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GL{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt="WebChannelConnection";class KL extends ZL{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,o){const l=Yp();return new Promise((h,f)=>{const m=new xN;m.setWithCredentials(!0),m.listenOnce(wN.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case Vd.NO_ERROR:const _=m.getResponseJson();de(Yt,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(_)),h(_);break;case Vd.TIMEOUT:de(Yt,`RPC '${e}' ${l} timed out`),f(new ae(J.DEADLINE_EXCEEDED,"Request time out"));break;case Vd.HTTP_ERROR:const w=m.getStatus();if(de(Yt,`RPC '${e}' ${l} failed with status:`,w,"response text:",m.getResponseText()),w>0){let T=m.getResponseJson();Array.isArray(T)&&(T=T[0]);const j=T==null?void 0:T.error;if(j&&j.status&&j.message){const D=function(k){const S=k.toLowerCase().replace(/_/g,"-");return Object.values(J).indexOf(S)>=0?S:J.UNKNOWN}(j.status);f(new ae(D,j.message))}else f(new ae(J.UNKNOWN,"Server responded with status "+m.getStatus()))}else f(new ae(J.UNAVAILABLE,"Connection failed."));break;default:Ee(9055,{l_:e,streamId:l,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{de(Yt,`RPC '${e}' ${l} completed.`)}});const g=JSON.stringify(s);de(Yt,`RPC '${e}' ${l} sending request:`,s),m.send(n,"POST",g,r,15)})}T_(e,n,r){const s=Yp(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=EN(),h=NN(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(f.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,n,r),f.encodeInitMessageHeaders=!0;const g=o.join("");de(Yt,`Creating RPC '${e}' stream ${s}: ${g}`,f);const _=l.createWebChannel(g,f);this.I_(_);let w=!1,T=!1;const j=new GL({Yo:M=>{T?de(Yt,`Not sending because RPC '${e}' stream ${s} is closed:`,M):(w||(de(Yt,`Opening RPC '${e}' stream ${s} transport.`),_.open(),w=!0),de(Yt,`RPC '${e}' stream ${s} sending:`,M),_.send(M))},Zo:()=>_.close()}),D=(M,k,S)=>{M.listen(k,C=>{try{S(C)}catch(U){setTimeout(()=>{throw U},0)}})};return D(_,Jl.EventType.OPEN,()=>{T||(de(Yt,`RPC '${e}' stream ${s} transport opened.`),j.o_())}),D(_,Jl.EventType.CLOSE,()=>{T||(T=!0,de(Yt,`RPC '${e}' stream ${s} transport closed`),j.a_(),this.E_(_))}),D(_,Jl.EventType.ERROR,M=>{T||(T=!0,Ka(Yt,`RPC '${e}' stream ${s} transport errored. Name:`,M.name,"Message:",M.message),j.a_(new ae(J.UNAVAILABLE,"The operation could not be completed")))}),D(_,Jl.EventType.MESSAGE,M=>{var k;if(!T){const S=M.data[0];He(!!S,16349);const C=S,U=(C==null?void 0:C.error)||((k=C[0])==null?void 0:k.error);if(U){de(Yt,`RPC '${e}' stream ${s} received error:`,U);const F=U.status;let V=function(R){const P=Nt[R];if(P!==void 0)return sE(P)}(F),E=U.message;V===void 0&&(V=J.INTERNAL,E="Unknown error status: "+F+" with message "+U.message),T=!0,j.a_(new ae(V,E)),_.close()}else de(Yt,`RPC '${e}' stream ${s} received:`,S),j.u_(S)}}),D(h,bN.STAT_EVENT,M=>{M.stat===Op.PROXY?de(Yt,`RPC '${e}' stream ${s} detected buffering proxy`):M.stat===Op.NOPROXY&&de(Yt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{j.__()},0),j}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function jm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yf(t){return new JR(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _E{constructor(e,n,r=1e3,s=1.5,o=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&de("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b0="PersistentStream";class vE{constructor(e,n,r,s,o,l,h,f){this.Mi=e,this.S_=r,this.b_=s,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=h,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new _E(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===J.RESOURCE_EXHAUSTED?(Ps(n.toString()),Ps("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===J.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new ae(J.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return de(b0,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(de(b0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class QL extends vE{constructor(e,n,r,s,o,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,l),this.serializer=o}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=nL(this.serializer,e),r=function(o){if(!("targetChange"in o))return Se.min();const l=o.targetChange;return l.targetIds&&l.targetIds.length?Se.min():l.readTime?Hr(l.readTime):Se.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Kp(this.serializer),n.addTarget=function(o,l){let h;const f=l.target;if(h=$p(f)?{documents:iL(o,f)}:{query:oL(o,f).ft},h.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){h.resumeToken=aE(o,l.resumeToken);const m=qp(o,l.expectedCount);m!==null&&(h.expectedCount=m)}else if(l.snapshotVersion.compareTo(Se.min())>0){h.readTime=Ih(o,l.snapshotVersion.toTimestamp());const m=qp(o,l.expectedCount);m!==null&&(h.expectedCount=m)}return h}(this.serializer,e);const r=lL(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Kp(this.serializer),n.removeTarget=e,this.q_(n)}}class YL extends vE{constructor(e,n,r,s,o,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,l),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return He(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,He(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){He(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=sL(e.writeResults,e.commitTime),r=Hr(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Kp(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>rL(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XL{}class JL extends XL{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new ae(J.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Go(e,Zp(n,r),s,o,l)).catch(o=>{throw o.name==="FirebaseError"?(o.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ae(J.UNKNOWN,o.toString())})}Ho(e,n,r,s,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,h])=>this.connection.Ho(e,Zp(n,r),s,l,h,o)).catch(l=>{throw l.name==="FirebaseError"?(l.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new ae(J.UNKNOWN,l.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class e4{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ps(n),this.aa=!1):de("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ko="RemoteStore";class t4{constructor(e,n,r,s,o){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(l=>{r.enqueueAndForget(async()=>{Do(this)&&(de(ko,"Restarting streams for network reachability change."),await async function(f){const m=Ie(f);m.Ea.add(4),await fu(m),m.Ra.set("Unknown"),m.Ea.delete(4),await _f(m)}(this))})}),this.Ra=new e4(r,s)}}async function _f(t){if(Do(t))for(const e of t.da)await e(!0)}async function fu(t){for(const e of t.da)await e(!1)}function xE(t,e){const n=Ie(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),$y(n)?By(n):dl(n).O_()&&Fy(n,e))}function Uy(t,e){const n=Ie(t),r=dl(n);n.Ia.delete(e),r.O_()&&wE(n,e),n.Ia.size===0&&(r.O_()?r.L_():Do(n)&&n.Ra.set("Unknown"))}function Fy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Se.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}dl(t).Y_(e)}function wE(t,e){t.Va.Ue(e),dl(t).Z_(e)}function By(t){t.Va=new KR({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),dl(t).start(),t.Ra.ua()}function $y(t){return Do(t)&&!dl(t).x_()&&t.Ia.size>0}function Do(t){return Ie(t).Ea.size===0}function bE(t){t.Va=void 0}async function n4(t){t.Ra.set("Online")}async function r4(t){t.Ia.forEach((e,n)=>{Fy(t,e)})}async function s4(t,e){bE(t),$y(t)?(t.Ra.ha(e),By(t)):t.Ra.set("Unknown")}async function i4(t,e,n){if(t.Ra.set("Online"),e instanceof oE&&e.state===2&&e.cause)try{await async function(s,o){const l=o.cause;for(const h of o.targetIds)s.Ia.has(h)&&(await s.remoteSyncer.rejectListen(h,l),s.Ia.delete(h),s.Va.removeTarget(h))}(t,e)}catch(r){de(ko,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ah(t,r)}else if(e instanceof $d?t.Va.Ze(e):e instanceof iE?t.Va.st(e):t.Va.tt(e),!n.isEqual(Se.min()))try{const r=await yE(t.localStore);n.compareTo(r)>=0&&await function(o,l){const h=o.Va.Tt(l);return h.targetChanges.forEach((f,m)=>{if(f.resumeToken.approximateByteSize()>0){const g=o.Ia.get(m);g&&o.Ia.set(m,g.withResumeToken(f.resumeToken,l))}}),h.targetMismatches.forEach((f,m)=>{const g=o.Ia.get(f);if(!g)return;o.Ia.set(f,g.withResumeToken(Zt.EMPTY_BYTE_STRING,g.snapshotVersion)),wE(o,f);const _=new si(g.target,f,m,g.sequenceNumber);Fy(o,_)}),o.remoteSyncer.applyRemoteEvent(h)}(t,n)}catch(r){de(ko,"Failed to raise snapshot:",r),await Ah(t,r)}}async function Ah(t,e,n){if(!ul(e))throw e;t.Ea.add(1),await fu(t),t.Ra.set("Offline"),n||(n=()=>yE(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{de(ko,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await _f(t)})}function NE(t,e){return e().catch(n=>Ah(t,n,e))}async function vf(t){const e=Ie(t),n=ji(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ky;for(;o4(e);)try{const s=await FL(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,a4(e,s)}catch(s){await Ah(e,s)}EE(e)&&TE(e)}function o4(t){return Do(t)&&t.Ta.length<10}function a4(t,e){t.Ta.push(e);const n=ji(t);n.O_()&&n.X_&&n.ea(e.mutations)}function EE(t){return Do(t)&&!ji(t).x_()&&t.Ta.length>0}function TE(t){ji(t).start()}async function l4(t){ji(t).ra()}async function c4(t){const e=ji(t);for(const n of t.Ta)e.ea(n.mutations)}async function u4(t,e,n){const r=t.Ta.shift(),s=Ry.from(r,e,n);await NE(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await vf(t)}async function d4(t,e){e&&ji(t).X_&&await async function(r,s){if(function(l){return qR(l)&&l!==J.ABORTED}(s.code)){const o=r.Ta.shift();ji(r).B_(),await NE(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s)),await vf(r)}}(t,e),EE(t)&&TE(t)}async function N0(t,e){const n=Ie(t);n.asyncQueue.verifyOperationInProgress(),de(ko,"RemoteStore received new credentials");const r=Do(n);n.Ea.add(3),await fu(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await _f(n)}async function h4(t,e){const n=Ie(t);e?(n.Ea.delete(2),await _f(n)):e||(n.Ea.add(2),await fu(n),n.Ra.set("Unknown"))}function dl(t){return t.ma||(t.ma=function(n,r,s){const o=Ie(n);return o.sa(),new QL(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(t.datastore,t.asyncQueue,{Xo:n4.bind(null,t),t_:r4.bind(null,t),r_:s4.bind(null,t),H_:i4.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),$y(t)?By(t):t.Ra.set("Unknown")):(await t.ma.stop(),bE(t))})),t.ma}function ji(t){return t.fa||(t.fa=function(n,r,s){const o=Ie(n);return o.sa(),new YL(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:l4.bind(null,t),r_:d4.bind(null,t),ta:c4.bind(null,t),na:u4.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await vf(t)):(await t.fa.stop(),t.Ta.length>0&&(de(ko,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(e,n,r,s,o){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=o,this.deferred=new xs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,o){const l=Date.now()+r,h=new Wy(e,n,l,s,o);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ae(J.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Hy(t,e){if(Ps("AsyncQueue",`${e}: ${t}`),ul(t))return new ae(J.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{static emptySet(e){return new Ua(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ve.comparator(n.key,r.key):(n,r)=>ve.comparator(n.key,r.key),this.keyedMap=ec(),this.sortedSet=new ut(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ua)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,o=r.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ua;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{constructor(){this.ga=new ut(ve.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Ee(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class el{constructor(e,n,r,s,o,l,h,f,m){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=o,this.fromCache=l,this.syncStateChanged=h,this.excludesMetadataChanges=f,this.hasCachedResults=m}static fromInitialDocuments(e,n,r,s,o){const l=[];return n.forEach(h=>{l.push({type:0,doc:h})}),new el(e,n,Ua.emptySet(n),l,r,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&df(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f4{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class m4{constructor(){this.queries=T0(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=Ie(n),o=s.queries;s.queries=T0(),o.forEach((l,h)=>{for(const f of h.Sa)f.onError(r)})})(this,new ae(J.ABORTED,"Firestore shutting down"))}}function T0(){return new Lo(t=>qN(t),df)}async function qy(t,e){const n=Ie(t);let r=3;const s=e.query;let o=n.queries.get(s);o?!o.ba()&&e.Da()&&(r=2):(o=new f4,r=e.Da()?0:1);try{switch(r){case 0:o.wa=await n.onListen(s,!0);break;case 1:o.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(l){const h=Hy(l,`Initialization of query '${ma(e.query)}' failed`);return void e.onError(h)}n.queries.set(s,o),o.Sa.push(e),e.va(n.onlineState),o.wa&&e.Fa(o.wa)&&Gy(n)}async function Zy(t,e){const n=Ie(t),r=e.query;let s=3;const o=n.queries.get(r);if(o){const l=o.Sa.indexOf(e);l>=0&&(o.Sa.splice(l,1),o.Sa.length===0?s=e.Da()?0:1:!o.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function p4(t,e){const n=Ie(t);let r=!1;for(const s of e){const o=s.query,l=n.queries.get(o);if(l){for(const h of l.Sa)h.Fa(s)&&(r=!0);l.wa=s}}r&&Gy(n)}function g4(t,e,n){const r=Ie(t),s=r.queries.get(e);if(s)for(const o of s.Sa)o.onError(n);r.queries.delete(e)}function Gy(t){t.Ca.forEach(e=>{e.next()})}var Xp,j0;(j0=Xp||(Xp={})).Ma="default",j0.Cache="cache";class Ky{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new el(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=el.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Xp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(e){this.key=e}}class kE{constructor(e){this.key=e}}class y4{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Me(),this.mutatedKeys=Me(),this.eu=ZN(e),this.tu=new Ua(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new E0,s=n?n.tu:this.tu;let o=n?n.mutatedKeys:this.mutatedKeys,l=s,h=!1;const f=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,m=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((g,_)=>{const w=s.get(g),T=hf(this.query,_)?_:null,j=!!w&&this.mutatedKeys.has(w.key),D=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let M=!1;w&&T?w.data.isEqual(T.data)?j!==D&&(r.track({type:3,doc:T}),M=!0):this.su(w,T)||(r.track({type:2,doc:T}),M=!0,(f&&this.eu(T,f)>0||m&&this.eu(T,m)<0)&&(h=!0)):!w&&T?(r.track({type:0,doc:T}),M=!0):w&&!T&&(r.track({type:1,doc:w}),M=!0,(f||m)&&(h=!0)),M&&(T?(l=l.add(T),o=D?o.add(g):o.delete(g)):(l=l.delete(g),o=o.delete(g)))}),this.query.limit!==null)for(;l.size>this.query.limit;){const g=this.query.limitType==="F"?l.last():l.first();l=l.delete(g.key),o=o.delete(g.key),r.track({type:1,doc:g})}return{tu:l,iu:r,Cs:h,mutatedKeys:o}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort((g,_)=>function(T,j){const D=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ee(20277,{Rt:M})}};return D(T)-D(j)}(g.type,_.type)||this.eu(g.doc,_.doc)),this.ou(r),s=s??!1;const h=n&&!s?this._u():[],f=this.Xa.size===0&&this.current&&!s?1:0,m=f!==this.Za;return this.Za=f,l.length!==0||m?{snapshot:new el(this.query,e.tu,o,l,e.mutatedKeys,f===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:h}:{au:h}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new E0,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Me(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new kE(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new jE(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Me();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return el.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Qy="SyncEngine";class _4{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class v4{constructor(e){this.key=e,this.hu=!1}}class x4{constructor(e,n,r,s,o,l){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new Lo(h=>qN(h),df),this.Iu=new Map,this.Eu=new Set,this.du=new ut(ve.comparator),this.Au=new Map,this.Ru=new zy,this.Vu={},this.mu=new Map,this.fu=Ja.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function w4(t,e,n=!0){const r=RE(t);let s;const o=r.Tu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.lu()):s=await SE(r,e,n,!0),s}async function b4(t,e){const n=RE(t);await SE(n,e,!0,!1)}async function SE(t,e,n,r){const s=await BL(t.localStore,Wr(e)),o=s.targetId,l=t.sharedClientState.addLocalQueryTarget(o,n);let h;return r&&(h=await N4(t,e,o,l==="current",s.resumeToken)),t.isPrimaryClient&&n&&xE(t.remoteStore,s),h}async function N4(t,e,n,r,s){t.pu=(_,w,T)=>async function(D,M,k,S){let C=M.view.ru(k);C.Cs&&(C=await _0(D.localStore,M.query,!1).then(({documents:E})=>M.view.ru(E,C)));const U=S&&S.targetChanges.get(M.targetId),F=S&&S.targetMismatches.get(M.targetId)!=null,V=M.view.applyChanges(C,D.isPrimaryClient,U,F);return S0(D,M.targetId,V.au),V.snapshot}(t,_,w,T);const o=await _0(t.localStore,e,!0),l=new y4(e,o.Qs),h=l.ru(o.documents),f=hu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),m=l.applyChanges(h,t.isPrimaryClient,f);S0(t,n,m.au);const g=new _4(e,n,l);return t.Tu.set(e,g),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),m.snapshot}async function E4(t,e,n){const r=Ie(t),s=r.Tu.get(e),o=r.Iu.get(s.targetId);if(o.length>1)return r.Iu.set(s.targetId,o.filter(l=>!df(l,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Qp(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Uy(r.remoteStore,s.targetId),Jp(r,s.targetId)}).catch(cl)):(Jp(r,s.targetId),await Qp(r.localStore,s.targetId,!0))}async function T4(t,e){const n=Ie(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Uy(n.remoteStore,r.targetId))}async function j4(t,e,n){const r=R4(t);try{const s=await function(l,h){const f=Ie(l),m=tt.now(),g=h.reduce((T,j)=>T.add(j.key),Me());let _,w;return f.persistence.runTransaction("Locally write mutations","readwrite",T=>{let j=Is(),D=Me();return f.Ns.getEntries(T,g).next(M=>{j=M,j.forEach((k,S)=>{S.isValidDocument()||(D=D.add(k))})}).next(()=>f.localDocuments.getOverlayedDocuments(T,j)).next(M=>{_=M;const k=[];for(const S of h){const C=FR(S,_.get(S.key).overlayedDocument);C!=null&&k.push(new Vi(S.key,C,ON(C.value.mapValue),Sn.exists(!0)))}return f.mutationQueue.addMutationBatch(T,m,k,h)}).next(M=>{w=M;const k=M.applyToLocalDocumentSet(_,D);return f.documentOverlayCache.saveOverlays(T,M.batchId,k)})}).then(()=>({batchId:w.batchId,changes:KN(_)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(l,h,f){let m=l.Vu[l.currentUser.toKey()];m||(m=new ut(ze)),m=m.insert(h,f),l.Vu[l.currentUser.toKey()]=m}(r,s.batchId,n),await mu(r,s.changes),await vf(r.remoteStore)}catch(s){const o=Hy(s,"Failed to persist write");n.reject(o)}}async function PE(t,e){const n=Ie(t);try{const r=await VL(n.localStore,e);e.targetChanges.forEach((s,o)=>{const l=n.Au.get(o);l&&(He(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?l.hu=!0:s.modifiedDocuments.size>0?He(l.hu,14607):s.removedDocuments.size>0&&(He(l.hu,42227),l.hu=!1))}),await mu(n,r,e)}catch(r){await cl(r)}}function k0(t,e,n){const r=Ie(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((o,l)=>{const h=l.view.va(e);h.snapshot&&s.push(h.snapshot)}),function(l,h){const f=Ie(l);f.onlineState=h;let m=!1;f.queries.forEach((g,_)=>{for(const w of _.Sa)w.va(h)&&(m=!0)}),m&&Gy(f)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function k4(t,e,n){const r=Ie(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),o=s&&s.key;if(o){let l=new ut(ve.comparator);l=l.insert(o,en.newNoDocument(o,Se.min()));const h=Me().add(o),f=new gf(Se.min(),new Map,new ut(ze),l,h);await PE(r,f),r.du=r.du.remove(o),r.Au.delete(e),Yy(r)}else await Qp(r.localStore,e,!1).then(()=>Jp(r,e,n)).catch(cl)}async function S4(t,e){const n=Ie(t),r=e.batch.batchId;try{const s=await OL(n.localStore,e);CE(n,r,null),IE(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await mu(n,s)}catch(s){await cl(s)}}async function P4(t,e,n){const r=Ie(t);try{const s=await function(l,h){const f=Ie(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let g;return f.mutationQueue.lookupMutationBatch(m,h).next(_=>(He(_!==null,37113),g=_.keys(),f.mutationQueue.removeMutationBatch(m,_))).next(()=>f.mutationQueue.performConsistencyCheck(m)).next(()=>f.documentOverlayCache.removeOverlaysForBatchId(m,g,h)).next(()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,g)).next(()=>f.localDocuments.getDocuments(m,g))})}(r.localStore,e);CE(r,e,n),IE(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await mu(r,s)}catch(s){await cl(s)}}function IE(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function CE(t,e,n){const r=Ie(t);let s=r.Vu[r.currentUser.toKey()];if(s){const o=s.get(e);o&&(n?o.reject(n):o.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function Jp(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||AE(t,r)})}function AE(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Uy(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Yy(t))}function S0(t,e,n){for(const r of n)r instanceof jE?(t.Ru.addReference(r.key,e),I4(t,r)):r instanceof kE?(de(Qy,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||AE(t,r.key)):Ee(19791,{wu:r})}function I4(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(de(Qy,"New document in limbo: "+n),t.Eu.add(r),Yy(t))}function Yy(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ve(Ye.fromString(e)),r=t.fu.next();t.Au.set(r,new v4(n)),t.du=t.du.insert(n,r),xE(t.remoteStore,new si(Wr(uf(n.path)),r,"TargetPurposeLimboResolution",af.ce))}}async function mu(t,e,n){const r=Ie(t),s=[],o=[],l=[];r.Tu.isEmpty()||(r.Tu.forEach((h,f)=>{l.push(r.pu(f,e,n).then(m=>{var g;if((m||n)&&r.isPrimaryClient){const _=m?!m.fromCache:(g=n==null?void 0:n.targetChanges.get(f.targetId))==null?void 0:g.current;r.sharedClientState.updateQueryState(f.targetId,_?"current":"not-current")}if(m){s.push(m);const _=Oy.As(f.targetId,m);o.push(_)}}))}),await Promise.all(l),r.Pu.H_(s),await async function(f,m){const g=Ie(f);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",_=>ee.forEach(m,w=>ee.forEach(w.Es,T=>g.persistence.referenceDelegate.addReference(_,w.targetId,T)).next(()=>ee.forEach(w.ds,T=>g.persistence.referenceDelegate.removeReference(_,w.targetId,T)))))}catch(_){if(!ul(_))throw _;de(Vy,"Failed to update sequence numbers: "+_)}for(const _ of m){const w=_.targetId;if(!_.fromCache){const T=g.Ms.get(w),j=T.snapshotVersion,D=T.withLastLimboFreeSnapshotVersion(j);g.Ms=g.Ms.insert(w,D)}}}(r.localStore,o))}async function C4(t,e){const n=Ie(t);if(!n.currentUser.isEqual(e)){de(Qy,"User change. New user:",e.toKey());const r=await gE(n.localStore,e);n.currentUser=e,function(o,l){o.mu.forEach(h=>{h.forEach(f=>{f.reject(new ae(J.CANCELLED,l))})}),o.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await mu(n,r.Ls)}}function A4(t,e){const n=Ie(t),r=n.Au.get(e);if(r&&r.hu)return Me().add(r.key);{let s=Me();const o=n.Iu.get(e);if(!o)return s;for(const l of o){const h=n.Tu.get(l);s=s.unionWith(h.view.nu)}return s}}function RE(t){const e=Ie(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=PE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=A4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=k4.bind(null,e),e.Pu.H_=p4.bind(null,e.eventManager),e.Pu.yu=g4.bind(null,e.eventManager),e}function R4(t){const e=Ie(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=S4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=P4.bind(null,e),e}class Rh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return ML(this.persistence,new LL,e.initialUser,this.serializer)}Cu(e){return new pE(My.mi,this.serializer)}Du(e){return new WL}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Rh.provider={build:()=>new Rh};class L4 extends Rh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){He(this.persistence.referenceDelegate instanceof Ch,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new vL(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?vn.withCacheSize(this.cacheSizeBytes):vn.DEFAULT;return new pE(r=>Ch.mi(r,n),this.serializer)}}class eg{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>k0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=C4.bind(null,this.syncEngine),await h4(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new m4}()}createDatastore(e){const n=yf(e.databaseInfo.databaseId),r=function(o){return new KL(o)}(e.databaseInfo);return function(o,l,h,f){return new JL(o,l,h,f)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,o,l,h){return new t4(r,s,o,l,h)}(this.localStore,this.datastore,e.asyncQueue,n=>k0(this.syncEngine,n,0),function(){return w0.v()?new w0:new HL}())}createSyncEngine(e,n){return function(s,o,l,h,f,m,g){const _=new x4(s,o,l,h,f,m);return g&&(_.gu=!0),_}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const o=Ie(s);de(ko,"RemoteStore shutting down."),o.Ea.add(5),await fu(o),o.Aa.shutdown(),o.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}eg.provider={build:()=>new eg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ps("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ki="FirestoreClient";class D4{constructor(e,n,r,s,o){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Xt.UNAUTHENTICATED,this.clientId=jy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async l=>{de(ki,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l}),this.appCheckCredentials.start(r,l=>(de(ki,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new xs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Hy(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function km(t,e){t.asyncQueue.verifyOperationInProgress(),de(ki,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await gE(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function P0(t,e){t.asyncQueue.verifyOperationInProgress();const n=await z4(t);de(ki,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>N0(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>N0(e.remoteStore,s)),t._onlineComponents=e}async function z4(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){de(ki,"Using user provided OfflineComponentProvider");try{await km(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===J.FAILED_PRECONDITION||s.code===J.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Ka("Error using user provided cache. Falling back to memory cache: "+n),await km(t,new Rh)}}else de(ki,"Using default OfflineComponentProvider"),await km(t,new L4(void 0));return t._offlineComponents}async function LE(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(de(ki,"Using user provided OnlineComponentProvider"),await P0(t,t._uninitializedComponentsProvider._online)):(de(ki,"Using default OnlineComponentProvider"),await P0(t,new eg))),t._onlineComponents}function M4(t){return LE(t).then(e=>e.syncEngine)}async function Lh(t){const e=await LE(t),n=e.eventManager;return n.onListen=w4.bind(null,e.syncEngine),n.onUnlisten=E4.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=b4.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=T4.bind(null,e.syncEngine),n}function O4(t,e,n={}){const r=new xs;return t.asyncQueue.enqueueAndForget(async()=>function(o,l,h,f,m){const g=new Xy({next:w=>{g.Nu(),l.enqueueAndForget(()=>Zy(o,_));const T=w.docs.has(h);!T&&w.fromCache?m.reject(new ae(J.UNAVAILABLE,"Failed to get document because the client is offline.")):T&&w.fromCache&&f&&f.source==="server"?m.reject(new ae(J.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(w)},error:w=>m.reject(w)}),_=new Ky(uf(h.path),g,{includeMetadataChanges:!0,qa:!0});return qy(o,_)}(await Lh(t),t.asyncQueue,e,n,r)),r.promise}function V4(t,e,n={}){const r=new xs;return t.asyncQueue.enqueueAndForget(async()=>function(o,l,h,f,m){const g=new Xy({next:w=>{g.Nu(),l.enqueueAndForget(()=>Zy(o,_)),w.fromCache&&f.source==="server"?m.reject(new ae(J.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(w)},error:w=>m.reject(w)}),_=new Ky(h,g,{includeMetadataChanges:!0,qa:!0});return qy(o,_)}(await Lh(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DE(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I0=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zE="firestore.googleapis.com",C0=!0;class A0{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ae(J.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=zE,this.ssl=C0}else this.host=e.host,this.ssl=e.ssl??C0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=mE;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<yL)throw new ae(J.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}eR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=DE(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ae(J.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ae(J.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ae(J.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xf{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new A0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ae(J.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ae(J.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new A0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new WA;switch(r.type){case"firstParty":return new GA(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ae(J.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=I0.get(n);r&&(de("ComponentProvider","Removing Datastore"),I0.delete(n),r.terminate())}(this),Promise.resolve()}}function U4(t,e,n,r={}){var m;t=kn(t,xf);const s=Di(e),o=t._getSettings(),l={...o,emulatorOptions:t._getEmulatorOptions()},h=`${e}:${n}`;s&&(hy(`https://${h}`),fy("Firestore",!0)),o.host!==zE&&o.host!==h&&Ka("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...o,host:h,ssl:s,emulatorOptions:r};if(!wo(f,l)&&(t._setSettings(f),r.mockUserToken)){let g,_;if(typeof r.mockUserToken=="string")g=r.mockUserToken,_=Xt.MOCK_USER;else{g=C1(r.mockUserToken,(m=t._app)==null?void 0:m.options.projectId);const w=r.mockUserToken.sub||r.mockUserToken.user_id;if(!w)throw new ae(J.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new Xt(w)}t._authCredentials=new HA(new jN(g,_))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new zo(this.firestore,e,this._query)}}class ft{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new yi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ft(this.firestore,e,this._key)}toJSON(){return{type:ft._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(cu(n,ft._jsonSchema))return new ft(e,r||null,new ve(Ye.fromString(n.referencePath)))}}ft._jsonSchemaVersion="firestore/documentReference/1.0",ft._jsonSchema={type:St("string",ft._jsonSchemaVersion),referencePath:St("string")};class yi extends zo{constructor(e,n,r){super(e,n,uf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ft(this.firestore,null,new ve(e))}withConverter(e){return new yi(this.firestore,e,this._path)}}function Bt(t,e,...n){if(t=qe(t),kN("collection","path",e),t instanceof xf){const r=Ye.fromString(e,...n);return Hx(r),new yi(t,null,r)}{if(!(t instanceof ft||t instanceof yi))throw new ae(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ye.fromString(e,...n));return Hx(r),new yi(t.firestore,null,r)}}function at(t,e,...n){if(t=qe(t),arguments.length===1&&(e=jy.newId()),kN("doc","path",e),t instanceof xf){const r=Ye.fromString(e,...n);return Wx(r),new ft(t,null,new ve(r))}{if(!(t instanceof ft||t instanceof yi))throw new ae(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ye.fromString(e,...n));return Wx(r),new ft(t.firestore,t instanceof yi?t.converter:null,new ve(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R0="AsyncQueue";class L0{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new _E(this,"async_queue_retry"),this._c=()=>{const r=jm();r&&de(R0,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=jm();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=jm();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new xs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ul(e))throw e;de(R0,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Ps("INTERNAL UNHANDLED ERROR: ",D0(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Wy.createAndSchedule(this,e,n,r,o=>this.hc(o));return this.tc.push(s),s}uc(){this.nc&&Ee(47125,{Pc:D0(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function D0(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z0(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const o of r)if(o in s&&typeof s[o]=="function")return!0;return!1}(t,["next","error","complete"])}class Cs extends xf{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new L0,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new L0(e),this._firestoreClient=void 0,await e}}}function F4(t,e){const n=typeof t=="object"?t:gy(),r=typeof t=="string"?t:Th,s=tf(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const o=S1("firestore");o&&U4(s,...o)}return s}function pu(t){if(t._terminated)throw new ae(J.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||B4(t),t._firestoreClient}function B4(t){var r,s,o;const e=t._freezeSettings(),n=function(h,f,m,g){return new dR(h,f,m,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,DE(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new D4(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(h){const f=h==null?void 0:h._online.build();return{_offline:h==null?void 0:h._offline.build(f),_online:f}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Qn(Zt.fromBase64String(e))}catch(n){throw new ae(J.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Qn(Zt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Qn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(cu(e,Qn._jsonSchema))return Qn.fromBase64String(e.bytes)}}Qn._jsonSchemaVersion="firestore/bytes/1.0",Qn._jsonSchema={type:St("string",Qn._jsonSchemaVersion),bytes:St("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ae(J.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Wt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ae(J.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ae(J.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ze(this._lat,e._lat)||ze(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:qr._jsonSchemaVersion}}static fromJSON(e){if(cu(e,qr._jsonSchema))return new qr(e.latitude,e.longitude)}}qr._jsonSchemaVersion="firestore/geoPoint/1.0",qr._jsonSchema={type:St("string",qr._jsonSchemaVersion),latitude:St("number"),longitude:St("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==s[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Zr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(cu(e,Zr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Zr(e.vectorValues);throw new ae(J.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Zr._jsonSchemaVersion="firestore/vectorValue/1.0",Zr._jsonSchema={type:St("string",Zr._jsonSchemaVersion),vectorValues:St("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $4=/^__.*__$/;class W4{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Vi(e,this.data,this.fieldMask,n,this.fieldTransforms):new du(e,this.data,n,this.fieldTransforms)}}class ME{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Vi(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function OE(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ee(40011,{Ac:t})}}class Jy{constructor(e,n,r,s,o,l){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Jy({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Dh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(OE(this.Ac)&&$4.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class H4{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||yf(e)}Cc(e,n,r,s=!1){return new Jy({Ac:e,methodName:n,Dc:r,path:Wt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function bf(t){const e=t._freezeSettings(),n=yf(t._databaseId);return new H4(t._databaseId,!!e.ignoreUndefinedProperties,n)}function VE(t,e,n,r,s,o={}){const l=t.Cc(o.merge||o.mergeFields?2:0,e,n,s);t_("Data must be an object, but it was:",l,r);const h=BE(r,l);let f,m;if(o.merge)f=new Dn(l.fieldMask),m=l.fieldTransforms;else if(o.mergeFields){const g=[];for(const _ of o.mergeFields){const w=tg(e,_,n);if(!l.contains(w))throw new ae(J.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);WE(g,w)||g.push(w)}f=new Dn(g),m=l.fieldTransforms.filter(_=>f.covers(_.field))}else f=null,m=l.fieldTransforms;return new W4(new bn(h),f,m)}class Nf extends wf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Nf}}class e_ extends wf{_toFieldTransform(e){return new MR(e.path,new qc)}isEqual(e){return e instanceof e_}}function UE(t,e,n,r){const s=t.Cc(1,e,n);t_("Data must be an object, but it was:",s,r);const o=[],l=bn.empty();Oi(r,(f,m)=>{const g=n_(e,f,n);m=qe(m);const _=s.yc(g);if(m instanceof Nf)o.push(g);else{const w=yu(m,_);w!=null&&(o.push(g),l.set(g,w))}});const h=new Dn(o);return new ME(l,h,s.fieldTransforms)}function FE(t,e,n,r,s,o){const l=t.Cc(1,e,n),h=[tg(e,r,n)],f=[s];if(o.length%2!=0)throw new ae(J.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let w=0;w<o.length;w+=2)h.push(tg(e,o[w])),f.push(o[w+1]);const m=[],g=bn.empty();for(let w=h.length-1;w>=0;--w)if(!WE(m,h[w])){const T=h[w];let j=f[w];j=qe(j);const D=l.yc(T);if(j instanceof Nf)m.push(T);else{const M=yu(j,D);M!=null&&(m.push(T),g.set(T,M))}}const _=new Dn(m);return new ME(g,_,l.fieldTransforms)}function q4(t,e,n,r=!1){return yu(n,t.Cc(r?4:3,e))}function yu(t,e){if($E(t=qe(t)))return t_("Unsupported field value:",e,t),BE(t,e);if(t instanceof wf)return function(r,s){if(!OE(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(s);o&&s.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const o=[];let l=0;for(const h of r){let f=yu(h,s.wc(l));f==null&&(f={nullValue:"NULL_VALUE"}),o.push(f),l++}return{arrayValue:{values:o}}}(t,e)}return function(r,s){if((r=qe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return LR(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=tt.fromDate(r);return{timestampValue:Ih(s.serializer,o)}}if(r instanceof tt){const o=new tt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ih(s.serializer,o)}}if(r instanceof qr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Qn)return{bytesValue:aE(s.serializer,r._byteString)};if(r instanceof ft){const o=s.databaseId,l=r.firestore._databaseId;if(!l.isEqual(o))throw s.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Dy(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Zr)return function(l,h){return{mapValue:{fields:{[zN]:{stringValue:MN},[jh]:{arrayValue:{values:l.toArray().map(m=>{if(typeof m!="number")throw h.Sc("VectorValues must only contain numeric values.");return Ay(h.serializer,m)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${of(r)}`)}(t,e)}function BE(t,e){const n={};return IN(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Oi(t,(r,s)=>{const o=yu(s,e.mc(r));o!=null&&(n[r]=o)}),{mapValue:{fields:n}}}function $E(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof tt||t instanceof qr||t instanceof Qn||t instanceof ft||t instanceof wf||t instanceof Zr)}function t_(t,e,n){if(!$E(n)||!SN(n)){const r=of(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function tg(t,e,n){if((e=qe(e))instanceof gu)return e._internalPath;if(typeof e=="string")return n_(t,e);throw Dh("Field path arguments must be of type string or ",t,!1,void 0,n)}const Z4=new RegExp("[~\\*/\\[\\]]");function n_(t,e,n){if(e.search(Z4)>=0)throw Dh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new gu(...e.split("."))._internalPath}catch{throw Dh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Dh(t,e,n,r,s){const o=r&&!r.isEmpty(),l=s!==void 0;let h=`Function ${e}() called with invalid data`;n&&(h+=" (via `toFirestore()`)"),h+=". ";let f="";return(o||l)&&(f+=" (found",o&&(f+=` in field ${r}`),l&&(f+=` in document ${s}`),f+=")"),new ae(J.INVALID_ARGUMENT,h+t+f)}function WE(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(e,n,r,s,o){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new G4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(r_("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class G4 extends HE{data(){return super.data()}}function r_(t,e){return typeof e=="string"?n_(t,e):e instanceof gu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qE(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ae(J.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class s_{}class K4 extends s_{}function tn(t,e,...n){let r=[];e instanceof s_&&r.push(e),r=r.concat(n),function(o){const l=o.filter(f=>f instanceof i_).length,h=o.filter(f=>f instanceof Ef).length;if(l>1||l>0&&h>0)throw new ae(J.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Ef extends K4{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Ef(e,n,r)}_apply(e){const n=this._parse(e);return ZE(e._query,n),new zo(e.firestore,e.converter,Wp(e._query,n))}_parse(e){const n=bf(e.firestore);return function(o,l,h,f,m,g,_){let w;if(m.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new ae(J.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){O0(_,g);const j=[];for(const D of _)j.push(M0(f,o,D));w={arrayValue:{values:j}}}else w=M0(f,o,_)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||O0(_,g),w=q4(h,l,_,g==="in"||g==="not-in");return kt.create(m,g,w)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function $t(t,e,n){const r=e,s=r_("where",t);return Ef._create(s,r,n)}class i_ extends s_{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new i_(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:_r.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,o){let l=s;const h=o.getFlattenedFilters();for(const f of h)ZE(l,f),l=Wp(l,f)}(e._query,n),new zo(e.firestore,e.converter,Wp(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function M0(t,e,n){if(typeof(n=qe(n))=="string"){if(n==="")throw new ae(J.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!HN(e)&&n.indexOf("/")!==-1)throw new ae(J.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ye.fromString(n));if(!ve.isDocumentKey(r))throw new ae(J.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Jx(t,new ve(r))}if(n instanceof ft)return Jx(t,n._key);throw new ae(J.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${of(n)}.`)}function O0(t,e){if(!Array.isArray(t)||t.length===0)throw new ae(J.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ZE(t,e){const n=function(s,o){for(const l of s)for(const h of l.getFlattenedFilters())if(o.indexOf(h.op)>=0)return h.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ae(J.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ae(J.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Q4{convertValue(e,n="none"){switch(Ti(e)){case 0:return null;case 1:return e.booleanValue;case 2:return yt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ei(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ee(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Oi(e,(s,o)=>{r[s]=this.convertValue(o,n)}),r}convertVectorValue(e){var r,s,o;const n=(o=(s=(r=e.fields)==null?void 0:r[jh].arrayValue)==null?void 0:s.values)==null?void 0:o.map(l=>yt(l.doubleValue));return new Zr(n)}convertGeoPoint(e){return new qr(yt(e.latitude),yt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=cf(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp($c(e));default:return null}}convertTimestamp(e){const n=Ni(e);return new tt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ye.fromString(e);He(fE(r),9688,{name:e});const s=new Wc(r.get(1),r.get(3)),o=new ve(r.popFirst(5));return s.isEqual(n)||Ps(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GE(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class nc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ho extends HE{constructor(e,n,r,s,o,l){super(e,n,r,s,l),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Wd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(r_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ae(J.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=ho._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}ho._jsonSchemaVersion="firestore/documentSnapshot/1.0",ho._jsonSchema={type:St("string",ho._jsonSchemaVersion),bundleSource:St("string","DocumentSnapshot"),bundleName:St("string"),bundle:St("string")};class Wd extends ho{data(e={}){return super.data(e)}}class fo{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new nc(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Wd(this._firestore,this._userDataWriter,r.key,r,new nc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ae(J.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,o){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map(h=>{const f=new Wd(s._firestore,s._userDataWriter,h.doc.key,h.doc,new nc(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);return h.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}})}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(h=>o||h.type!==3).map(h=>{const f=new Wd(s._firestore,s._userDataWriter,h.doc.key,h.doc,new nc(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);let m=-1,g=-1;return h.type!==0&&(m=l.indexOf(h.doc.key),l=l.delete(h.doc.key)),h.type!==1&&(l=l.add(h.doc),g=l.indexOf(h.doc.key)),{type:Y4(h.type),doc:f,oldIndex:m,newIndex:g}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ae(J.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=fo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=jy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(o=>{o._document!==null&&(n.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),s.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Y4(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ee(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tl(t){t=kn(t,ft);const e=kn(t.firestore,Cs);return O4(pu(e),t._key).then(n=>KE(e,t,n))}fo._jsonSchemaVersion="firestore/querySnapshot/1.0",fo._jsonSchema={type:St("string",fo._jsonSchemaVersion),bundleSource:St("string","QuerySnapshot"),bundleName:St("string"),bundle:St("string")};class o_ extends Q4{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ft(this.firestore,null,n)}}function Xn(t){t=kn(t,zo);const e=kn(t.firestore,Cs),n=pu(e),r=new o_(e);return qE(t._query),V4(n,t._query).then(s=>new fo(e,r,t,s))}function nl(t,e,n){t=kn(t,ft);const r=kn(t.firestore,Cs),s=GE(t.converter,e,n);return Tf(r,[VE(bf(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Sn.none())])}function ws(t,e,n,...r){t=kn(t,ft);const s=kn(t.firestore,Cs),o=bf(s);let l;return l=typeof(e=qe(e))=="string"||e instanceof gu?FE(o,"updateDoc",t._key,e,n,r):UE(o,"updateDoc",t._key,e),Tf(s,[l.toMutation(t._key,Sn.exists(!0))])}function a_(t){return Tf(kn(t.firestore,Cs),[new pf(t._key,Sn.none())])}function Kc(t,...e){var f,m,g;t=qe(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||z0(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(z0(e[r])){const _=e[r];e[r]=(f=_.next)==null?void 0:f.bind(_),e[r+1]=(m=_.error)==null?void 0:m.bind(_),e[r+2]=(g=_.complete)==null?void 0:g.bind(_)}let o,l,h;if(t instanceof ft)l=kn(t.firestore,Cs),h=uf(t._key.path),o={next:_=>{e[r]&&e[r](KE(l,t,_))},error:e[r+1],complete:e[r+2]};else{const _=kn(t,zo);l=kn(_.firestore,Cs),h=_._query;const w=new o_(l);o={next:T=>{e[r]&&e[r](new fo(l,w,_,T))},error:e[r+1],complete:e[r+2]},qE(t._query)}return function(w,T,j,D){const M=new Xy(D),k=new Ky(T,M,j);return w.asyncQueue.enqueueAndForget(async()=>qy(await Lh(w),k)),()=>{M.Nu(),w.asyncQueue.enqueueAndForget(async()=>Zy(await Lh(w),k))}}(pu(l),h,s,o)}function Tf(t,e){return function(r,s){const o=new xs;return r.asyncQueue.enqueueAndForget(async()=>j4(await M4(r),s,o)),o.promise}(pu(t),e)}function KE(t,e,n){const r=n.docs.get(e._key),s=new o_(t);return new ho(t,s,e._key,r,new nc(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=bf(e)}set(e,n,r){this._verifyNotCommitted();const s=Sm(e,this._firestore),o=GE(s.converter,n,r),l=VE(this._dataReader,"WriteBatch.set",s._key,o,s.converter!==null,r);return this._mutations.push(l.toMutation(s._key,Sn.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const o=Sm(e,this._firestore);let l;return l=typeof(n=qe(n))=="string"||n instanceof gu?FE(this._dataReader,"WriteBatch.update",o._key,n,r,s):UE(this._dataReader,"WriteBatch.update",o._key,n),this._mutations.push(l.toMutation(o._key,Sn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Sm(e,this._firestore);return this._mutations=this._mutations.concat(new pf(n._key,Sn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ae(J.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Sm(t,e){if((t=qe(t)).firestore!==e)throw new ae(J.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function J4(){return new e_("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V0(t){return pu(t=kn(t,Cs)),new X4(t,e=>Tf(t,e))}(function(e,n=!0){(function(s){ll=s})(Ao),bo(new wi("firestore",(r,{instanceIdentifier:s,options:o})=>{const l=r.getProvider("app").getImmediate(),h=new Cs(new qA(r.getProvider("auth-internal")),new KA(l,r.getProvider("app-check-internal")),function(m,g){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new ae(J.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wc(m.options.projectId,g)}(l,s),l);return o={useFetchStreams:n,...o},h._setSettings(o),h},"PUBLIC").setMultipleInstances(!0)),Fr(Ux,Fx,e),Fr(Ux,Fx,"esm2020")})();var eD="firebase",tD="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fr(eD,tD,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QE="firebasestorage.googleapis.com",YE="storageBucket",nD=2*60*1e3,rD=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt extends Yr{constructor(e,n,r=0){super(Pm(e),`Firebase Storage: ${n} (${Pm(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,pt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Pm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var mt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(mt||(mt={}));function Pm(t){return"storage/"+t}function l_(){const t="An unknown error occurred, please check the error payload for server response.";return new pt(mt.UNKNOWN,t)}function sD(t){return new pt(mt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function iD(t){return new pt(mt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function oD(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new pt(mt.UNAUTHENTICATED,t)}function aD(){return new pt(mt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function lD(t){return new pt(mt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function cD(){return new pt(mt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function uD(){return new pt(mt.CANCELED,"User canceled the upload/download.")}function dD(t){return new pt(mt.INVALID_URL,"Invalid URL '"+t+"'.")}function hD(t){return new pt(mt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function fD(){return new pt(mt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+YE+"' property when initializing the app?")}function mD(){return new pt(mt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function pD(){return new pt(mt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function gD(t){return new pt(mt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ng(t){return new pt(mt.INVALID_ARGUMENT,t)}function XE(){return new pt(mt.APP_DELETED,"The Firebase app was deleted.")}function yD(t){return new pt(mt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function _c(t,e){return new pt(mt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function ql(t){throw new pt(mt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=zn.makeFromUrl(e,n)}catch{return new zn(e,"")}if(r.path==="")return r;throw hD(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function o(U){U.path.charAt(U.path.length-1)==="/"&&(U.path_=U.path_.slice(0,-1))}const l="(/(.*))?$",h=new RegExp("^gs://"+s+l,"i"),f={bucket:1,path:3};function m(U){U.path_=decodeURIComponent(U.path)}const g="v[A-Za-z0-9_]+",_=n.replace(/[.]/g,"\\."),w="(/([^?#]*).*)?$",T=new RegExp(`^https?://${_}/${g}/b/${s}/o${w}`,"i"),j={bucket:1,path:3},D=n===QE?"(?:storage.googleapis.com|storage.cloud.google.com)":n,M="([^?#]*)",k=new RegExp(`^https?://${D}/${s}/${M}`,"i"),C=[{regex:h,indices:f,postModify:o},{regex:T,indices:j,postModify:m},{regex:k,indices:{bucket:1,path:2},postModify:m}];for(let U=0;U<C.length;U++){const F=C[U],V=F.regex.exec(e);if(V){const E=V[F.indices.bucket];let N=V[F.indices.path];N||(N=""),r=new zn(E,N),F.postModify(r);break}}if(r==null)throw dD(e);return r}}class _D{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vD(t,e,n){let r=1,s=null,o=null,l=!1,h=0;function f(){return h===2}let m=!1;function g(...M){m||(m=!0,e.apply(null,M))}function _(M){s=setTimeout(()=>{s=null,t(T,f())},M)}function w(){o&&clearTimeout(o)}function T(M,...k){if(m){w();return}if(M){w(),g.call(null,M,...k);return}if(f()||l){w(),g.call(null,M,...k);return}r<64&&(r*=2);let C;h===1?(h=2,C=0):C=(r+Math.random())*1e3,_(C)}let j=!1;function D(M){j||(j=!0,w(),!m&&(s!==null?(M||(h=2),clearTimeout(s),_(0)):M||(h=1)))}return _(0),o=setTimeout(()=>{l=!0,D(!0)},n),D}function xD(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wD(t){return t!==void 0}function bD(t){return typeof t=="object"&&!Array.isArray(t)}function c_(t){return typeof t=="string"||t instanceof String}function U0(t){return u_()&&t instanceof Blob}function u_(){return typeof Blob<"u"}function F0(t,e,n,r){if(r<e)throw ng(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw ng(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jf(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function JE(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var mo;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(mo||(mo={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ND(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,o=e.indexOf(t)!==-1;return n||s||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ED{constructor(e,n,r,s,o,l,h,f,m,g,_,w=!0,T=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=o,this.additionalRetryCodes_=l,this.callback_=h,this.errorCallback_=f,this.timeout_=m,this.progressCallback_=g,this.connectionFactory_=_,this.retry=w,this.isUsingEmulator=T,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((j,D)=>{this.resolve_=j,this.reject_=D,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new vd(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const l=h=>{const f=h.loaded,m=h.lengthComputable?h.total:-1;this.progressCallback_!==null&&this.progressCallback_(f,m)};this.progressCallback_!==null&&o.addUploadProgressListener(l),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(l),this.pendingConnection_=null;const h=o.getErrorCode()===mo.NO_ERROR,f=o.getStatus();if(!h||ND(f,this.additionalRetryCodes_)&&this.retry){const g=o.getErrorCode()===mo.ABORT;r(!1,new vd(!1,null,g));return}const m=this.successCodes_.indexOf(f)!==-1;r(!0,new vd(m,o))})},n=(r,s)=>{const o=this.resolve_,l=this.reject_,h=s.connection;if(s.wasSuccessCode)try{const f=this.callback_(h,h.getResponse());wD(f)?o(f):o()}catch(f){l(f)}else if(h!==null){const f=l_();f.serverResponse=h.getErrorText(),this.errorCallback_?l(this.errorCallback_(h,f)):l(f)}else if(s.canceled){const f=this.appDelete_?XE():uD();l(f)}else{const f=cD();l(f)}};this.canceled_?n(!1,new vd(!1,null,!0)):this.backoffId_=vD(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&xD(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class vd{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function TD(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function jD(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function kD(t,e){e&&(t["X-Firebase-GMPID"]=e)}function SD(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function PD(t,e,n,r,s,o,l=!0,h=!1){const f=JE(t.urlParams),m=t.url+f,g=Object.assign({},t.headers);return kD(g,e),TD(g,n),jD(g,o),SD(g,r),new ED(m,t.method,g,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,l,h)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ID(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function CD(...t){const e=ID();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(u_())return new Blob(t);throw new pt(mt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function AD(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RD(t){if(typeof atob>"u")throw gD("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Im{constructor(e,n){this.data=e,this.contentType=n||null}}function LD(t,e){switch(t){case Dr.RAW:return new Im(eT(e));case Dr.BASE64:case Dr.BASE64URL:return new Im(tT(t,e));case Dr.DATA_URL:return new Im(zD(e),MD(e))}throw l_()}function eT(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const o=r,l=t.charCodeAt(++n);r=65536|(o&1023)<<10|l&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function DD(t){let e;try{e=decodeURIComponent(t)}catch{throw _c(Dr.DATA_URL,"Malformed data URL.")}return eT(e)}function tT(t,e){switch(t){case Dr.BASE64:{const s=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(s||o)throw _c(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Dr.BASE64URL:{const s=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(s||o)throw _c(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=RD(e)}catch(s){throw s.message.includes("polyfill")?s:_c(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class nT{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw _c(Dr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=OD(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function zD(t){const e=new nT(t);return e.base64?tT(Dr.BASE64,e.rest):DD(e.rest)}function MD(t){return new nT(t).contentType}function OD(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e,n){let r=0,s="";U0(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(U0(this.data_)){const r=this.data_,s=AD(r,e,n);return s===null?null:new ei(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new ei(r,!0)}}static getBlob(...e){if(u_()){const n=e.map(r=>r instanceof ei?r.data_:r);return new ei(CD.apply(null,n))}else{const n=e.map(l=>c_(l)?LD(Dr.RAW,l).data:l.data_);let r=0;n.forEach(l=>{r+=l.byteLength});const s=new Uint8Array(r);let o=0;return n.forEach(l=>{for(let h=0;h<l.length;h++)s[o++]=l[h]}),new ei(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rT(t){let e;try{e=JSON.parse(t)}catch{return null}return bD(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VD(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function UD(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function sT(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FD(t,e){return e}class cn{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||FD}}let xd=null;function BD(t){return!c_(t)||t.length<2?t:sT(t)}function iT(){if(xd)return xd;const t=[];t.push(new cn("bucket")),t.push(new cn("generation")),t.push(new cn("metageneration")),t.push(new cn("name","fullPath",!0));function e(o,l){return BD(l)}const n=new cn("name");n.xform=e,t.push(n);function r(o,l){return l!==void 0?Number(l):l}const s=new cn("size");return s.xform=r,t.push(s),t.push(new cn("timeCreated")),t.push(new cn("updated")),t.push(new cn("md5Hash",null,!0)),t.push(new cn("cacheControl",null,!0)),t.push(new cn("contentDisposition",null,!0)),t.push(new cn("contentEncoding",null,!0)),t.push(new cn("contentLanguage",null,!0)),t.push(new cn("contentType",null,!0)),t.push(new cn("metadata","customMetadata",!0)),xd=t,xd}function $D(t,e){function n(){const r=t.bucket,s=t.fullPath,o=new zn(r,s);return e._makeStorageReference(o)}Object.defineProperty(t,"ref",{get:n})}function WD(t,e,n){const r={};r.type="file";const s=n.length;for(let o=0;o<s;o++){const l=n[o];r[l.local]=l.xform(r,e[l.server])}return $D(r,t),r}function oT(t,e,n){const r=rT(e);return r===null?null:WD(t,r,n)}function HD(t,e,n,r){const s=rT(e);if(s===null||!c_(s.downloadTokens))return null;const o=s.downloadTokens;if(o.length===0)return null;const l=encodeURIComponent;return o.split(",").map(m=>{const g=t.bucket,_=t.fullPath,w="/b/"+l(g)+"/o/"+l(_),T=jf(w,n,r),j=JE({alt:"media",token:m});return T+j})[0]}function qD(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const o=e[s];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}class d_{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aT(t){if(!t)throw l_()}function ZD(t,e){function n(r,s){const o=oT(t,s,e);return aT(o!==null),o}return n}function GD(t,e){function n(r,s){const o=oT(t,s,e);return aT(o!==null),HD(o,s,t.host,t._protocol)}return n}function lT(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=aD():s=oD():n.getStatus()===402?s=iD(t.bucket):n.getStatus()===403?s=lD(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function cT(t){const e=lT(t);function n(r,s){let o=e(r,s);return r.getStatus()===404&&(o=sD(t.path)),o.serverResponse=s.serverResponse,o}return n}function KD(t,e,n){const r=e.fullServerUrl(),s=jf(r,t.host,t._protocol),o="GET",l=t.maxOperationRetryTime,h=new d_(s,o,GD(t,n),l);return h.errorHandler=cT(e),h}function QD(t,e){const n=e.fullServerUrl(),r=jf(n,t.host,t._protocol),s="DELETE",o=t.maxOperationRetryTime;function l(f,m){}const h=new d_(r,s,l,o);return h.successCodes=[200,204],h.errorHandler=cT(e),h}function YD(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function XD(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=YD(null,e)),r}function JD(t,e,n,r,s){const o=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function h(){let C="";for(let U=0;U<2;U++)C=C+Math.random().toString().slice(2);return C}const f=h();l["Content-Type"]="multipart/related; boundary="+f;const m=XD(e,r,s),g=qD(m,n),_="--"+f+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+g+`\r
--`+f+`\r
Content-Type: `+m.contentType+`\r
\r
`,w=`\r
--`+f+"--",T=ei.getBlob(_,r,w);if(T===null)throw mD();const j={name:m.fullPath},D=jf(o,t.host,t._protocol),M="POST",k=t.maxUploadRetryTime,S=new d_(D,M,ZD(t,n),k);return S.urlParams=j,S.headers=l,S.body=T.uploadData(),S.errorHandler=lT(e),S}class ez{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=mo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=mo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=mo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,o){if(this.sent_)throw ql("cannot .send() more than once");if(Di(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),o!==void 0)for(const l in o)o.hasOwnProperty(l)&&this.xhr_.setRequestHeader(l,o[l].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ql("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ql("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ql("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ql("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class tz extends ez{initXhr(){this.xhr_.responseType="text"}}function h_(){return new tz}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e,n){this._service=e,n instanceof zn?this._location=n:this._location=zn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new So(e,n)}get root(){const e=new zn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return sT(this._location.path)}get storage(){return this._service}get parent(){const e=VD(this._location.path);if(e===null)return null;const n=new zn(this._location.bucket,e);return new So(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw yD(e)}}function nz(t,e,n){t._throwIfRoot("uploadBytes");const r=JD(t.storage,t._location,iT(),new ei(e,!0),n);return t.storage.makeRequestWithTokens(r,h_).then(s=>({metadata:s,ref:t}))}function rz(t){t._throwIfRoot("getDownloadURL");const e=KD(t.storage,t._location,iT());return t.storage.makeRequestWithTokens(e,h_).then(n=>{if(n===null)throw pD();return n})}function sz(t){t._throwIfRoot("deleteObject");const e=QD(t.storage,t._location);return t.storage.makeRequestWithTokens(e,h_)}function iz(t,e){const n=UD(t._location.path,e),r=new zn(t._location.bucket,n);return new So(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oz(t){return/^[A-Za-z]+:\/\//.test(t)}function az(t,e){return new So(t,e)}function uT(t,e){if(t instanceof f_){const n=t;if(n._bucket==null)throw fD();const r=new So(n,n._bucket);return e!=null?uT(r,e):r}else return e!==void 0?iz(t,e):t}function lz(t,e){if(e&&oz(e)){if(t instanceof f_)return az(t,e);throw ng("To use ref(service, url), the first argument must be a Storage instance.")}else return uT(t,e)}function B0(t,e){const n=e==null?void 0:e[YE];return n==null?null:zn.makeFromBucketSpec(n,t)}function cz(t,e,n,r={}){t.host=`${e}:${n}`;const s=Di(e);s&&(hy(`https://${t.host}/b`),fy("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:o}=r;o&&(t._overrideAuthToken=typeof o=="string"?o:C1(o,t.app.options.projectId))}class f_{constructor(e,n,r,s,o,l=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=o,this._isUsingEmulator=l,this._bucket=null,this._host=QE,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=nD,this._maxUploadRetryTime=rD,this._requests=new Set,s!=null?this._bucket=zn.makeFromBucketSpec(s,this._host):this._bucket=B0(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=zn.makeFromBucketSpec(this._url,e):this._bucket=B0(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){F0("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){F0("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Rn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new So(this,e)}_makeRequest(e,n,r,s,o=!0){if(this._deleted)return new _D(XE());{const l=PD(e,this._appId,r,s,n,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const $0="@firebase/storage",W0="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dT="storage";function hT(t,e,n){return t=qe(t),nz(t,e,n)}function fT(t){return t=qe(t),rz(t)}function uz(t){return t=qe(t),sz(t)}function m_(t,e){return t=qe(t),lz(t,e)}function dz(t=gy(),e){t=qe(t);const r=tf(t,dT).getImmediate({identifier:e}),s=S1("storage");return s&&hz(r,...s),r}function hz(t,e,n,r={}){cz(t,e,n,r)}function fz(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new f_(n,r,s,e,Ao)}function mz(){bo(new wi(dT,fz,"PUBLIC").setMultipleInstances(!0)),Fr($0,W0,""),Fr($0,W0,"esm2020")}mz();const pz={apiKey:"AIzaSyCBgcl8j_uJDVMpcNFEQvW-EqnshPiW2n8",authDomain:"tomyhomeapp-b7bf1.firebaseapp.com",projectId:"tomyhomeapp-b7bf1",storageBucket:"tomyhomeapp-b7bf1.firebasestorage.app",messagingSenderId:"1034110443870",appId:"1:1034110443870:web:1aa986bfe6fdf770e62fcf",measurementId:"G-Y5P06F4581"},p_=L1(pz),zr=BA(p_),Ce=F4(p_),g_=dz(p_),gz=({service:t})=>a.jsxs(ke,{to:`/uslugodawcy/${t.slug}`,className:"block bg-white rounded-2xl shadow-sm p-6 text-center hover:shadow-lg hover:-translate-y-1 transition-all duration-300",children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-gradient-to-r from-primary/10 to-secondary/10 flex items-center justify-center",children:a.jsx("span",{className:"text-3xl",children:t.icon})}),a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:t.name}),t.price>0?a.jsxs("p",{className:"text-sm text-gray-500",children:["od ",t.price," z"]}):a.jsx("p",{className:"text-sm text-gray-500",children:"Zobacz wszystkie"})]});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var yz={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _z=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),pe=(t,e)=>{const n=O.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:h="",children:f,...m},g)=>O.createElement("svg",{ref:g,...yz,width:s,height:s,stroke:r,strokeWidth:l?Number(o)*24/Number(s):o,className:["lucide",`lucide-${_z(t)}`,h].join(" "),...m},[...e.map(([_,w])=>O.createElement(_,w)),...Array.isArray(f)?f:[f]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H0=pe("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vz=pe("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qc=pe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xz=pe("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rg=pe("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mT=pe("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=pe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sg=pe("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=pe("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wz=pe("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bz=pe("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=pe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ig=pe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pT=pe("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gT=pe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Si=pe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const og=pe("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=pe("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const po=pe("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=pe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q0=pe("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y_=pe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nz=pe("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ag=pe("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yT=pe("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ez=pe("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tz=pe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jz=pe("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=pe("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=pe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zh=pe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lg=pe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=pe("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kz=pe("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sz=pe("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=pe("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pz=pe("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iz=pe("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __=pe("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cz=pe("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Az=pe("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=pe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vc=pe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kf=pe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _T=pe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v_=pe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rz=pe("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vT=pe("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=pe("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z0=pe("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lz=pe("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dz=pe("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zz=pe("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sf=pe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xT=pe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mz=pe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pi=pe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G0=pe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oz=pe("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vz=pe("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=pe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Uz=({review:t})=>{const[e,n]=O.useState(t.helpful),[r,s]=O.useState(!1),o=()=>{r||(n(l=>l+1),s(!0))};return a.jsxs("div",{className:"card card-hover p-6",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[a.jsx("div",{className:`w-12 h-12 rounded-full ${t.gradientClass} flex items-center justify-center text-white font-bold text-lg`,children:t.avatar}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900",children:t.author}),a.jsxs("p",{className:"text-sm text-gray-500",children:[t.service,"  ",t.date]})]})]}),a.jsx("div",{className:"flex items-center gap-1 mb-4",children:[...Array(5)].map((l,h)=>a.jsx(Or,{className:`w-4 h-4 ${h<t.rating?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},h))}),a.jsx("p",{className:"text-gray-600 leading-relaxed mb-4",children:t.content}),a.jsxs("button",{onClick:o,disabled:r,className:`flex items-center gap-2 text-sm transition-colors ${r?"text-accent cursor-default":"text-gray-500 hover:text-accent"}`,children:[a.jsx(Lz,{className:"w-4 h-4"}),a.jsxs("span",{children:["Pomocne (",e,")"]})]})]})},Fz=({target:t,label:e,suffix:n=""})=>{const[r,s]=O.useState(0),[o,l]=O.useState(!1),h=O.useRef(null);O.useEffect(()=>{const m=new IntersectionObserver(g=>{g[0].isIntersecting&&!o&&(l(!0),f())},{threshold:.5});return h.current&&m.observe(h.current),()=>m.disconnect()},[o,t]);const f=()=>{const _=t/60;let w=0;const T=setInterval(()=>{w+=_,w>=t?(s(t),clearInterval(T)):s(Math.floor(w))},2e3/60)};return a.jsxs("div",{ref:h,className:"text-center",children:[a.jsxs("div",{className:"text-4xl lg:text-5xl font-black text-white mb-2",children:[r.toLocaleString(),n]}),a.jsx("div",{className:"text-white/80",children:e})]})},Bz=()=>{const t=[{target:1e4,label:"Zadowolonych klientw",suffix:"+"},{target:500,label:"Specjalistw",suffix:"+"},{target:50,label:"Miast w Polsce",suffix:""},{target:98,label:"Pozytywnych opinii",suffix:"%"}];return a.jsx("section",{className:"py-20 bg-gradient-to-r from-primary to-secondary",children:a.jsx("div",{className:"max-w-7xl mx-auto px-6",children:a.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-8 lg:gap-12",children:t.map((e,n)=>a.jsx(Fz,{target:e.target,label:e.label,suffix:e.suffix},n))})})})},$z=()=>{const{showToast:t}=xr(),{isAuthenticated:e,user:n}=sn(),r=vr(),s=O.useRef(null),o=[{id:"fryzjer",name:"Fryzjer",icon:"",price:80,slug:"fryzjer"},{id:"tatuaze",name:"Tatuae",icon:"",price:200,slug:"tatuaze"},{id:"paznokcie",name:"Paznokcie",icon:"",price:60,slug:"paznokcie"},{id:"masaz",name:"Masa",icon:"",price:120,slug:"masaz"},{id:"makijaz",name:"Makija",icon:"",price:100,slug:"makijaz"},{id:"twarz",name:"Twarz",icon:"",price:120,slug:"twarz"},{id:"inne",name:"Inne usugi",icon:"",price:0,slug:"inne"}],l=[{id:1,author:"Anna Kowalska",avatar:"A",service:"Fryzjer",date:"2 dni temu",rating:5,content:"wietna usuga! Fryzjer przyjecha punktualnie, by bardzo profesjonalny. Efekt przekroczy moje oczekiwania. Na pewno skorzystam ponownie!",helpful:23,gradientClass:"bg-gradient-to-r from-primary to-secondary"},{id:2,author:"Krzysztof Chjan",avatar:"K",service:"Masa",date:"Tydzie temu",rating:5,content:"Bardzo wygodne rozwizanie. Masaysta przywiz profesjonalny st, wszystko przebiego sprawnie. Polecam kademu!",helpful:18,gradientClass:"bg-gradient-to-r from-pink-500 to-rose-500"},{id:3,author:"Magdalena Winiewska",avatar:"M",service:"Manicure",date:"3 dni temu",rating:5,content:"Profesjonalny manicure w domu - wietny efekt, przystpna cena. Oszczdno czasu nieoceniona!",helpful:31,gradientClass:"bg-gradient-to-r from-purple-500 to-indigo-500"}],h=[{step:1,title:"Wybierz usug",description:"Przegldaj kategorie i wybierz specjalist wedug opinii i ceny",gradient:"from-red-400 to-orange-500"},{step:2,title:"Zarezerwuj termin",description:"Wybierz dogodny termin i potwierd rezerwacj online",gradient:"from-primary to-secondary"},{step:3,title:"Specjalista przyjeda",description:"Profesjonalista przyjedzie pod wskazany adres z caym sprztem",gradient:"from-pink-400 to-rose-500"}],f=()=>{var m;(m=s.current)==null||m.scrollIntoView({behavior:"smooth"})};return O.useEffect(()=>{const m=new IntersectionObserver(g=>{g.forEach(_=>{_.isIntersecting&&(_.target.classList.add("opacity-100","translate-y-0"),_.target.classList.remove("opacity-0","translate-y-10"))})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});return document.querySelectorAll(".fade-in-scroll").forEach(g=>{m.observe(g)}),()=>m.disconnect()},[]),a.jsxs("div",{children:[a.jsx("section",{className:"py-20 lg:py-32 animate-fade-in",children:a.jsx("div",{className:"max-w-7xl mx-auto px-6",children:a.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 lg:gap-16 items-center",children:[a.jsxs("div",{className:"animate-slide-in-left",children:[a.jsxs("div",{className:"inline-flex items-center gap-2 bg-accent/10 text-accent px-4 py-2 rounded-full text-sm font-semibold mb-6 animate-bounce-slow",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Nowy w Twojej okolicy"})]}),a.jsxs("h1",{className:"text-4xl lg:text-6xl font-black leading-tight mb-6",children:["Zamw usug i nie tylko",a.jsx("br",{}),a.jsx("span",{className:"gradient-text",children:"Usugi z dojazdem do domu"})]}),a.jsx("p",{className:"text-gray-600 text-lg mb-8 leading-relaxed",children:"Specjalici przyjad pod wskazany adres  fryzjer, manicure, tatuaysta, masa i wicej."}),a.jsxs("div",{className:"flex flex-wrap gap-4",children:[a.jsxs("button",{onClick:()=>{e?f():r("/auth?mode=register&type=client")},className:"btn btn-cta animate-pulse-slow group",children:[a.jsx("span",{children:"Zarezerwuj usug"}),a.jsx("span",{className:"transition-transform group-hover:translate-x-1",children:""})]}),(!e||(n==null?void 0:n.accountType)==="provider")&&a.jsxs(ke,{to:e?"/biznes/dodaj-usluge":"/auth?mode=register&type=provider",className:"btn btn-ghost border-2 border-primary text-primary hover:bg-primary hover:text-white group",children:[a.jsx("span",{children:" Dodaj usug"}),a.jsx("span",{className:"transition-transform group-hover:translate-x-1",children:""})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-6 mt-8 text-sm text-gray-600",children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-green-500",children:""})," Bez opat za dojazd"]}),a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-green-500",children:""})," Sprawdzeni specjalici"]}),a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-green-500",children:""})," Gwarancja satysfakcji"]})]})]}),a.jsx("div",{className:"animate-slide-in-right",children:a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/20 to-secondary/20 rounded-3xl blur-3xl"}),a.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl overflow-hidden",children:[a.jsx("img",{src:"https://images.unsplash.com/photo-1560066984-138dadb4c035?w=600&h=400&fit=crop",alt:"Profesjonalna usuga fryzjerska",className:"w-full h-64 lg:h-80 object-cover"}),a.jsxs("div",{className:"p-6 flex gap-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"10K+"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Zadowolonych klientw"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"500+"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Specjalistw"})]})]})]})]})})]})})}),a.jsx("section",{id:"services",ref:s,className:"py-20 fade-in-scroll opacity-0 translate-y-10 transition-all duration-700",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("span",{className:"inline-block bg-primary/10 text-primary px-4 py-1 rounded-full text-sm font-semibold mb-4",children:"USUGI"}),a.jsx("h2",{className:"text-3xl lg:text-4xl font-bold mb-4",children:"Popularne usugi"}),a.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Wybierz spord szerokiej gamy profesjonalnych usug"})]}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-7 gap-4",children:o.map(m=>a.jsx(gz,{service:m},m.id))})]})}),a.jsx("section",{id:"how",className:"py-20 fade-in-scroll opacity-0 translate-y-10 transition-all duration-700",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("span",{className:"inline-block bg-primary/10 text-primary px-4 py-1 rounded-full text-sm font-semibold mb-4",children:"JAK TO DZIAA"}),a.jsx("h2",{className:"text-3xl lg:text-4xl font-bold mb-4",children:"Proste 3 kroki"}),a.jsx("p",{className:"text-gray-600",children:"Od rezerwacji do realizacji usugi"})]}),a.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:h.map((m,g)=>a.jsxs("div",{className:"text-center p-8 rounded-2xl bg-white shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1",style:{animationDelay:`${g*100}ms`},children:[a.jsxs("div",{className:"text-sm font-bold text-gray-400 mb-4",children:["Krok ",m.step]}),a.jsx("div",{className:`w-16 h-16 mx-auto mb-6 rounded-full bg-gradient-to-r ${m.gradient} flex items-center justify-center`,children:a.jsx("span",{className:"text-white text-2xl",children:""})}),a.jsx("h3",{className:"text-xl font-bold mb-3",children:m.title}),a.jsx("p",{className:"text-gray-600",children:m.description})]},m.step))})]})}),a.jsx("section",{id:"reviews",className:"py-20 fade-in-scroll opacity-0 translate-y-10 transition-all duration-700",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("span",{className:"inline-block bg-primary/10 text-primary px-4 py-1 rounded-full text-sm font-semibold mb-4",children:"OPINIE"}),a.jsx("h2",{className:"text-3xl lg:text-4xl font-bold mb-4",children:"Co mwi nasi klienci"}),a.jsx("p",{className:"text-gray-600",children:"Ponad 10 000 zadowolonych uytkownikw"})]}),a.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:l.map(m=>a.jsx(Uz,{review:m},m.id))})]})}),a.jsx(Bz,{}),a.jsx("section",{className:"py-20 fade-in-scroll opacity-0 translate-y-10 transition-all duration-700",children:a.jsx("div",{className:"max-w-7xl mx-auto px-6",children:a.jsxs("div",{className:"bg-gradient-to-r from-primary to-secondary rounded-3xl p-12 lg:p-16 text-center text-white relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_top_right,rgba(255,255,255,0.1),transparent_70%)]"}),a.jsxs("div",{className:"relative z-10",children:[a.jsx("span",{className:"inline-block bg-white/20 px-4 py-2 rounded-full text-sm font-bold tracking-wider mb-6",children:" ZACZNIJ JU DZI"}),a.jsx("h2",{className:"text-3xl lg:text-5xl font-black mb-4",children:"Gotowy, by zamwi?"}),a.jsx("p",{className:"text-lg opacity-95 max-w-xl mx-auto mb-8",children:"Docz do tysicy zadowolonych klientw. Pierwsze zamwienie z rabatem 20%!"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-8",children:[a.jsxs("button",{onClick:()=>{f(),t("Wybierz usug powyej, aby rozpocz rezerwacj","info")},className:"btn bg-white text-gray-900 font-bold shadow-lg hover:shadow-xl hover:-translate-y-1",children:[a.jsx("span",{children:"Zarezerwuj usug"}),a.jsx("span",{children:""})]}),a.jsx("button",{className:"btn border-2 border-white/30 text-white hover:bg-white/10",children:"Dowiedz si wicej"})]}),a.jsxs("div",{className:"flex flex-wrap gap-6 justify-center text-sm opacity-90",children:[a.jsx("span",{children:" Bez ukrytych kosztw"}),a.jsx("span",{children:" Anuluj bezpatnie"}),a.jsx("span",{children:" Patno po usudze"})]})]})]})})})]})},cg=[{code:"+48",flag:"",name:"Polska",minDigits:9,maxDigits:9},{code:"+49",flag:"",name:"Niemcy",minDigits:10,maxDigits:11},{code:"+33",flag:"",name:"Francja",minDigits:9,maxDigits:9},{code:"+34",flag:"",name:"Hiszpania",minDigits:9,maxDigits:9},{code:"+39",flag:"",name:"Wochy",minDigits:9,maxDigits:10},{code:"+44",flag:"",name:"Wielka Brytania",minDigits:10,maxDigits:10},{code:"+31",flag:"",name:"Holandia",minDigits:9,maxDigits:9},{code:"+32",flag:"",name:"Belgia",minDigits:8,maxDigits:9},{code:"+420",flag:"",name:"Czechy",minDigits:9,maxDigits:9},{code:"+421",flag:"",name:"Sowacja",minDigits:9,maxDigits:9},{code:"+43",flag:"",name:"Austria",minDigits:10,maxDigits:13},{code:"+41",flag:"",name:"Szwajcaria",minDigits:9,maxDigits:9},{code:"+351",flag:"",name:"Portugalia",minDigits:9,maxDigits:9},{code:"+353",flag:"",name:"Irlandia",minDigits:9,maxDigits:9},{code:"+352",flag:"",name:"Luksemburg",minDigits:8,maxDigits:9},{code:"+45",flag:"",name:"Dania",minDigits:8,maxDigits:8},{code:"+46",flag:"",name:"Szwecja",minDigits:9,maxDigits:9},{code:"+47",flag:"",name:"Norwegia",minDigits:8,maxDigits:8},{code:"+358",flag:"",name:"Finlandia",minDigits:9,maxDigits:10},{code:"+354",flag:"",name:"Islandia",minDigits:7,maxDigits:7},{code:"+30",flag:"",name:"Grecja",minDigits:10,maxDigits:10},{code:"+356",flag:"",name:"Malta",minDigits:8,maxDigits:8},{code:"+357",flag:"",name:"Cypr",minDigits:8,maxDigits:8},{code:"+36",flag:"",name:"Wgry",minDigits:9,maxDigits:9},{code:"+40",flag:"",name:"Rumunia",minDigits:9,maxDigits:9},{code:"+359",flag:"",name:"Bugaria",minDigits:9,maxDigits:9},{code:"+385",flag:"",name:"Chorwacja",minDigits:9,maxDigits:9},{code:"+386",flag:"",name:"Sowenia",minDigits:8,maxDigits:8},{code:"+381",flag:"",name:"Serbia",minDigits:9,maxDigits:9},{code:"+382",flag:"",name:"Czarnogra",minDigits:8,maxDigits:8},{code:"+383",flag:"",name:"Kosowo",minDigits:8,maxDigits:8},{code:"+389",flag:"",name:"Macedonia Pn.",minDigits:8,maxDigits:8},{code:"+380",flag:"",name:"Ukraina",minDigits:9,maxDigits:9},{code:"+375",flag:"",name:"Biaoru",minDigits:9,maxDigits:9},{code:"+7",flag:"",name:"Rosja",minDigits:10,maxDigits:10}],wT=t=>cg.find(e=>e.code===t)||cg[0],x_=(t,e)=>{const n=wT(t),r=e.replace(/\D/g,"");return r?r.length<n.minDigits?{valid:!1,message:`Numer dla ${n.name} musi mie min. ${n.minDigits} cyfr`}:r.length>n.maxDigits?{valid:!1,message:`Numer dla ${n.name} moe mie max. ${n.maxDigits} cyfr`}:{valid:!0,message:""}:{valid:!1,message:"Numer telefonu jest wymagany"}},w_=({value:t,countryCode:e,onChange:n,className:r="",error:s})=>{const[o,l]=O.useState(!1),[h,f]=O.useState(""),m=O.useRef(null),g=O.useRef(null),_=wT(e);O.useEffect(()=>{const M=k=>{m.current&&!m.current.contains(k.target)&&(l(!1),f(""))};return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[]);const w=cg.filter(M=>M.name.toLowerCase().includes(h.toLowerCase())||M.code.includes(h)),T=M=>{var k;n(t,M.code),l(!1),f(""),(k=g.current)==null||k.focus()},j=M=>{const k=M.target.value.replace(/[^\d\s]/g,"");n(k,e)},D=()=>`${_.minDigits===_.maxDigits?_.minDigits:`${_.minDigits}-${_.maxDigits}`} cyfr`;return a.jsxs("div",{className:`relative ${r}`,ref:m,children:[a.jsxs("div",{className:`flex rounded-xl border-2 ${s?"border-red-300":"border-gray-200"} focus-within:border-primary overflow-hidden`,children:[a.jsxs("button",{type:"button",onClick:()=>l(!o),className:"flex items-center gap-1 px-3 py-3 bg-gray-50 hover:bg-gray-100 border-r border-gray-200 transition-colors min-w-[100px]",children:[a.jsx("span",{className:"text-xl",children:_.flag}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:_.code}),a.jsx(ig,{className:`w-4 h-4 text-gray-500 transition-transform ${o?"rotate-180":""}`})]}),a.jsx("input",{ref:g,type:"tel",value:t,onChange:j,placeholder:D(),maxLength:_.maxDigits+3,className:"flex-1 px-4 py-3 focus:outline-none"})]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[_.name,": ",_.minDigits===_.maxDigits?`${_.minDigits} cyfr`:`${_.minDigits}-${_.maxDigits} cyfr`]}),s&&a.jsx("p",{className:"text-xs text-red-500 mt-1",children:s}),o&&a.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border-2 border-primary/30 rounded-xl shadow-2xl max-h-80 overflow-hidden",children:[a.jsx("div",{className:"p-2 border-b border-gray-100",children:a.jsx("input",{type:"text",value:h,onChange:M=>f(M.target.value),placeholder:"Szukaj kraju...",className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:border-primary",autoFocus:!0})}),a.jsx("div",{className:"overflow-y-auto max-h-60",children:w.map(M=>a.jsxs("button",{type:"button",onClick:()=>T(M),className:`w-full flex items-center gap-3 px-4 py-3 hover:bg-primary/10 transition-colors text-left ${M.code===e?"bg-primary/5":""}`,children:[a.jsx("span",{className:"text-2xl",children:M.flag}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-gray-900",children:M.name}),a.jsx("div",{className:"text-xs text-gray-500",children:M.code})]}),M.code===e&&a.jsx(Tt,{className:"w-5 h-5 text-primary"})]},M.code))})]})]})},Wz=()=>{const t=vr(),[e]=N1(),{isAuthenticated:n}=sn(),{showToast:r}=xr(),[s,o]=O.useState("select"),[l,h]=O.useState({email:"",password:""}),[f,m]=O.useState(!1),[g,_]=O.useState({email:"",username:"",phone:"",phoneCountryCode:"+48",password:"",confirmPassword:"",businessName:"",terms:!1,accountType:"client"}),[w,T]=O.useState(!1),[j,D]=O.useState(!1),[M,k]=O.useState("");O.useEffect(()=>{const F=e.get("mode"),V=e.get("type");F==="login"?o("login"):F==="register"&&(V==="provider"?(o("register-provider"),_(E=>({...E,accountType:"provider"}))):(o("register-client"),_(E=>({...E,accountType:"client"}))))},[e]),O.useEffect(()=>{if(n){const F=e.get("redirect");t(F||"/")}},[n,t,e]);const S=async F=>{F.preventDefault(),k(""),D(!0);try{await NC(zr,l.email,l.password),r("Logowanie pomylne! Witaj z powrotem!","success");const V=e.get("redirect");t(V||"/")}catch(V){console.error("Login error:",V);let E="Nieprawidowy email lub haso";switch(V.code){case"auth/user-not-found":E="Nie znaleziono uytkownika z tym adresem email";break;case"auth/wrong-password":E="Nieprawidowe haso";break;case"auth/invalid-credential":E="Nieprawidowy email lub haso";break;case"auth/too-many-requests":E="Zbyt wiele nieudanych prb. Sprbuj ponownie pniej";break;case"auth/user-disabled":E="To konto zostao zablokowane";break;case"auth/invalid-email":E="Nieprawidowy format adresu email";break}k(E),r("Bd logowania","error")}finally{D(!1)}},C=async F=>{if(F.preventDefault(),k(""),!g.terms){k("Musisz zaakceptowa regulamin!");return}const V=g.username.trim().split(/\s+/);if(V.length<2||V.some(N=>N.length<2)){k("Podaj pene imi i nazwisko (np. Jan Kowalski)");return}const E=x_(g.phoneCountryCode,g.phone);if(!E.valid){k(E.message);return}if(g.password.length<8){k("Haso musi mie co najmniej 8 znakw");return}if(!/[A-Z]/.test(g.password)){k("Haso musi zawiera co najmniej jedn wielk liter");return}if(!/[a-z]/.test(g.password)){k("Haso musi zawiera co najmniej jedn ma liter");return}if(!/[0-9]/.test(g.password)){k("Haso musi zawiera co najmniej jedn cyfr");return}if(g.password!==g.confirmPassword){k("Hasa nie s takie same");return}D(!0);try{const R=(await bC(zr,g.email,g.password)).user;await zp(R,{displayName:g.username});const P=g.phone.replace(/\D/g,""),A=`${g.phoneCountryCode} ${P}`;await nl(at(Ce,"users",R.uid),{uid:R.uid,username:g.username,email:g.email,phone:A,accountType:g.accountType,businessName:g.businessName||null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),...g.accountType==="provider"&&{isVerified:!1,rating:0,reviewsCount:0,servicesCount:0}}),r("Konto utworzone pomylnie! Witamy w ToMyHomeApp!","success"),g.accountType==="provider"?t("/biznes/dodaj-usluge"):t("/")}catch(N){console.error("Registration error:",N);let R="Bd podczas rejestracji";switch(N.code){case"auth/email-already-in-use":R="Ten adres email jest ju zajty";break;case"auth/invalid-email":R="Nieprawidowy format adresu email";break;case"auth/weak-password":R="Haso jest zbyt sabe";break;case"auth/operation-not-allowed":R="Rejestracja jest tymczasowo niedostpna";break}k(R),r("Bd rejestracji","error")}finally{D(!1)}};if(s==="select")return a.jsx("div",{className:"min-h-screen py-12 px-6 flex items-center justify-center",children:a.jsxs("div",{className:"max-w-lg w-full",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[a.jsx("div",{className:"text-5xl",children:""}),a.jsx("div",{className:"text-5xl",children:""})]}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-3",children:"Witaj w ToMyHomeApp"}),a.jsx("p",{className:"text-gray-600",children:"Znajd specjalistw beauty lub oferuj swoje usugi"})]}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsx("button",{onClick:()=>o("login"),className:"w-full py-4 bg-gradient-to-r from-primary to-secondary text-white rounded-xl font-bold text-lg hover:shadow-lg transition-all mb-6",children:"ZALOGUJ SI"}),a.jsxs("div",{className:"relative my-6",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-gray-200"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"px-4 bg-white text-gray-500",children:"Nie masz konta? Zarejestruj si jako"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("button",{onClick:()=>{o("register-client"),_(F=>({...F,accountType:"client"}))},className:"w-full py-4 border-2 border-primary text-primary rounded-xl font-bold text-lg hover:bg-primary hover:text-white transition-all flex items-center justify-center gap-3",children:[a.jsx(Pi,{className:"w-6 h-6"}),"DLA KLIENTA"]}),a.jsx("p",{className:"text-center text-sm text-gray-500",children:"Szukasz fryzjera, kosmetyczki lub masaysty?"}),a.jsxs("button",{onClick:()=>{o("register-provider"),_(F=>({...F,accountType:"provider"}))},className:"w-full py-4 border-2 border-emerald-500 text-emerald-600 rounded-xl font-bold text-lg hover:bg-emerald-500 hover:text-white transition-all flex items-center justify-center gap-3",children:[a.jsx(sg,{className:"w-6 h-6"}),"DLA USUGODAWCY"]}),a.jsx("p",{className:"text-center text-sm text-gray-500",children:"Oferujesz usugi beauty i chcesz zdobywa klientw?"})]})]})]})});if(s==="login")return a.jsx("div",{className:"min-h-screen py-12 px-6 flex items-center justify-center",children:a.jsxs("div",{className:"max-w-md w-full",children:[a.jsxs("button",{onClick:()=>o("select"),className:"flex items-center gap-2 text-gray-600 hover:text-primary mb-6 transition-colors",children:[a.jsx(Qc,{className:"w-5 h-5"}),"Wr"]}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Zaloguj si"}),a.jsx("p",{className:"text-gray-600",children:"Wpisz swoje dane logowania"})]}),M&&a.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 text-red-600 rounded-xl text-sm flex items-start gap-2",children:[a.jsx("span",{children:""}),a.jsx("span",{children:M})]}),a.jsxs("form",{onSubmit:S,className:"space-y-5",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),a.jsx("input",{type:"email",value:l.email,onChange:F=>h({...l,email:F.target.value}),placeholder:"twoj@email.com",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-primary focus:ring-0 focus:outline-none",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Haso"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:f?"text":"password",value:l.password,onChange:F=>h({...l,password:F.target.value}),placeholder:"",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-primary focus:ring-0 focus:outline-none",required:!0}),a.jsx("button",{type:"button",onClick:()=>m(!f),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:f?a.jsx(po,{className:"w-5 h-5"}):a.jsx(Gr,{className:"w-5 h-5"})})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(ke,{to:"/reset-hasla",className:"text-sm text-primary hover:underline",children:"Zapomniae hasa?"})}),a.jsx("button",{type:"submit",disabled:j,className:"w-full py-4 bg-gradient-to-r from-primary to-secondary text-white rounded-xl font-bold text-lg hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:j?a.jsxs(a.Fragment,{children:[a.jsx(At,{className:"w-5 h-5 animate-spin mr-2"}),"Logowanie..."]}):"ZALOGUJ SI"})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs("p",{className:"text-gray-600",children:["Nie masz konta?"," ",a.jsx("button",{onClick:()=>o("select"),className:"text-primary font-semibold hover:underline",children:"Zarejestruj si"})]})})]})]})});const U=s==="register-provider";return a.jsx("div",{className:"min-h-screen py-12 px-6 flex items-center justify-center",children:a.jsxs("div",{className:"max-w-md w-full",children:[a.jsxs("button",{onClick:()=>o("select"),className:"flex items-center gap-2 text-gray-600 hover:text-primary mb-6 transition-colors",children:[a.jsx(Qc,{className:"w-5 h-5"}),"Wr"]}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:`w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center ${U?"bg-emerald-100":"bg-primary/10"}`,children:U?a.jsx(sg,{className:"w-8 h-8 text-emerald-600"}):a.jsx(Pi,{className:"w-8 h-8 text-primary"})}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:U?"Rejestracja usugodawcy":"Rejestracja klienta"}),a.jsx("p",{className:"text-gray-600",children:U?"Docz i zacznij zdobywa klientw":"Za konto i rezerwuj usugi"})]}),a.jsxs("div",{className:`mb-6 p-4 rounded-xl ${U?"bg-emerald-50":"bg-primary/5"}`,children:[a.jsx("p",{className:"font-semibold mb-2 text-sm",children:U?" Korzyci dla usugodawcy:":" Korzyci dla klienta:"}),a.jsx("ul",{className:"text-sm space-y-1",children:U?a.jsxs(a.Fragment,{children:[a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(Tt,{className:"w-4 h-4 text-emerald-500"})," Wasny profil i portfolio"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(Tt,{className:"w-4 h-4 text-emerald-500"})," Zarzdzanie rezerwacjami online"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(Tt,{className:"w-4 h-4 text-emerald-500"})," Dostp do nowych klientw"]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(Tt,{className:"w-4 h-4 text-primary"})," atwe rezerwacje online"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(Tt,{className:"w-4 h-4 text-primary"})," Historia wizyt i ulubieni"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(Tt,{className:"w-4 h-4 text-primary"})," Powiadomienia i przypomnienia"]})]})})]}),M&&a.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 text-red-600 rounded-xl text-sm flex items-start gap-2",children:[a.jsx("span",{children:""}),a.jsx("span",{children:M})]}),a.jsxs("form",{onSubmit:C,className:"space-y-4",children:[U&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nazwa firmy / salonu"}),a.jsx("input",{type:"text",value:g.businessName,onChange:F=>_({...g,businessName:F.target.value}),placeholder:"np. Beauty Studio Anna",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Imi i nazwisko"}),a.jsx("input",{type:"text",value:g.username,onChange:F=>_({...g,username:F.target.value}),placeholder:"Jan Kowalski",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-primary focus:ring-0 focus:outline-none",required:!0}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Wpisz imi i nazwisko"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),a.jsx("input",{type:"email",value:g.email,onChange:F=>_({...g,email:F.target.value}),placeholder:"twoj@email.com",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-primary focus:ring-0 focus:outline-none",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Numer telefonu"}),a.jsx(w_,{value:g.phone,countryCode:g.phoneCountryCode,onChange:(F,V)=>_({...g,phone:F,phoneCountryCode:V})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Haso"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:w?"text":"password",value:g.password,onChange:F=>_({...g,password:F.target.value}),placeholder:"Wprowad haso",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-primary focus:ring-0 focus:outline-none",required:!0}),a.jsx("button",{type:"button",onClick:()=>T(!w),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:w?a.jsx(po,{className:"w-5 h-5"}):a.jsx(Gr,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"mt-2 text-xs text-gray-500 space-y-1",children:[a.jsxs("p",{className:g.password.length>=8?"text-green-600":"",children:[g.password.length>=8?"":""," Minimum 8 znakw"]}),a.jsxs("p",{className:/[A-Z]/.test(g.password)?"text-green-600":"",children:[/[A-Z]/.test(g.password)?"":""," Co najmniej jedna wielka litera (A-Z)"]}),a.jsxs("p",{className:/[a-z]/.test(g.password)?"text-green-600":"",children:[/[a-z]/.test(g.password)?"":""," Co najmniej jedna maa litera (a-z)"]}),a.jsxs("p",{className:/[0-9]/.test(g.password)?"text-green-600":"",children:[/[0-9]/.test(g.password)?"":""," Co najmniej jedna cyfra (0-9)"]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Powtrz haso"}),a.jsx("input",{type:"password",value:g.confirmPassword,onChange:F=>_({...g,confirmPassword:F.target.value}),placeholder:"Powtrz haso",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-primary focus:ring-0 focus:outline-none",required:!0}),g.confirmPassword&&a.jsx("p",{className:`text-xs mt-1 ${g.password===g.confirmPassword?"text-green-600":"text-red-500"}`,children:g.password===g.confirmPassword?" Hasa s zgodne":" Hasa nie s zgodne"})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("input",{type:"checkbox",id:"terms",checked:g.terms,onChange:F=>_({...g,terms:F.target.checked}),className:"mt-1 w-5 h-5 rounded border-gray-300 text-primary focus:ring-primary"}),a.jsxs("label",{htmlFor:"terms",className:"text-sm text-gray-600",children:["Akceptuj"," ",a.jsx(ke,{to:"/regulamin",className:"text-primary hover:underline",children:"Regulamin"})," ","oraz"," ",a.jsx(ke,{to:"/prywatnosc",className:"text-primary hover:underline",children:"Polityk Prywatnoci"})]})]}),a.jsx("button",{type:"submit",disabled:j,className:`w-full py-4 text-white rounded-xl font-bold text-lg hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center ${U?"bg-gradient-to-r from-emerald-500 to-teal-600":"bg-gradient-to-r from-primary to-secondary"}`,children:j?a.jsxs(a.Fragment,{children:[a.jsx(At,{className:"w-5 h-5 animate-spin mr-2"}),"Rejestracja..."]}):"ZAREJESTRUJ SI"})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs("p",{className:"text-gray-600",children:["Masz ju konto?"," ",a.jsx("button",{onClick:()=>o("login"),className:"text-primary font-semibold hover:underline",children:"Zaloguj si"})]})})]})]})})},Hz=async t=>{try{const e=at(Ce,"users",t),n=await tl(e);return n.exists()?{uid:n.id,...n.data()}:null}catch(e){throw console.error("Error getting user profile:",e),e}},bT=async(t,e)=>{try{const n=at(Ce,"users",t),r={};Object.entries(e).forEach(([s,o])=>{o!==void 0&&(r[s]=o)}),Object.keys(r).length>0&&await ws(n,{...r,updatedAt:J4()}),e.username&&zr.currentUser&&await zp(zr.currentUser,{displayName:e.username}),e.avatar&&zr.currentUser&&await zp(zr.currentUser,{photoURL:e.avatar})}catch(n){throw console.error("Error updating user profile:",n),n}},qz=async(t,e)=>{try{if(!e.type.startsWith("image/"))throw new Error("Plik musi by obrazem");if(e.size>5*1024*1024)throw new Error("Plik jest za duy (max 5MB)");const n=e.name.split(".").pop(),r=`avatars/${t}_${Date.now()}.${n}`,s=m_(g_,r),o=await hT(s,e),l=await fT(o.ref);return await bT(t,{avatar:l}),l}catch(n){throw console.error("Error uploading avatar:",n),n}},Zz=async(t,e)=>{try{const n=zr.currentUser;if(!n||!n.email)throw new Error("Brak zalogowanego uytkownika");if(e.length<8)throw new Error("Haso musi mie co najmniej 8 znakw");if(!/[A-Z]/.test(e))throw new Error("Haso musi zawiera wielk liter");if(!/[a-z]/.test(e))throw new Error("Haso musi zawiera ma liter");if(!/[0-9]/.test(e))throw new Error("Haso musi zawiera cyfr");const r=Mi.credential(n.email,t);await aN(n,r),await TC(n,e)}catch(n){throw console.error("Error changing password:",n),n.code==="auth/wrong-password"?new Error("Nieprawidowe obecne haso"):n.code==="auth/weak-password"?new Error("Nowe haso jest za sabe"):n.code==="auth/requires-recent-login"?new Error("Zaloguj si ponownie i sprbuj jeszcze raz"):n}},Gz=async t=>{try{const e=zr.currentUser;if(!e||!e.email)throw new Error("Brak zalogowanego uytkownika");const n=Mi.credential(e.email,t);await aN(e,n);try{const r=await Hz(e.uid);if(r!=null&&r.avatar&&r.avatar.includes("firebase")){const s=m_(g_,r.avatar);await uz(s)}}catch{console.log("Avatar deletion skipped")}await a_(at(Ce,"users",e.uid)),await CC(e)}catch(e){throw console.error("Error deleting account:",e),e.code==="auth/wrong-password"?new Error("Nieprawidowe haso"):e.code==="auth/requires-recent-login"?new Error("Zaloguj si ponownie i sprbuj jeszcze raz"):e}},Kz=()=>{var S;const t=vr(),{user:e,userData:n,isAuthenticated:r,logout:s}=sn(),{showToast:o}=xr(),[l,h]=O.useState("dashboard"),[f,m]=O.useState(new Date);O.useEffect(()=>{r||t("/auth")},[r,t]);const g=[{id:"dashboard",label:"Panel Gwny",icon:Ez},{id:"referral",label:"Pole znajomym",icon:Nz},{id:"favorites",label:"Ulubione",icon:ag},{id:"wallet",label:"Portfel",icon:Vz},{id:"visits",label:"Moje wizyty",icon:Mr},{id:"settings",label:"Ustawienia",icon:v_},{id:"help",label:"Pomoc",icon:yT}],_=async()=>{if(window.confirm("Czy na pewno chcesz si wylogowa?"))try{await s(),o("Wylogowano pomylnie","success"),t("/")}catch{o("Bd wylogowania","error")}},w=C=>new Date(C.getFullYear(),C.getMonth()+1,0).getDate(),T=C=>{const U=new Date(C.getFullYear(),C.getMonth(),1).getDay();return U===0?6:U-1},j=["Stycze","Luty","Marzec","Kwiecie","Maj","Czerwiec","Lipiec","Sierpie","Wrzesie","Padziernik","Listopad","Grudzie"],D=()=>{const C=w(f),U=T(f),F=new Date,V=["Pn","Wt","r","Cz","Pt","Sb","Nd"];return a.jsxs("div",{className:"bg-white rounded-xl border-2 border-gray-100 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6 pb-4 border-b border-gray-100",children:[a.jsx("button",{onClick:()=>m(new Date(f.getFullYear(),f.getMonth()-1)),className:"p-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors",children:a.jsx(pT,{className:"w-4 h-4"})}),a.jsxs("div",{className:"font-bold text-lg",children:[j[f.getMonth()]," ",f.getFullYear()]}),a.jsx("button",{onClick:()=>m(new Date(f.getFullYear(),f.getMonth()+1)),className:"p-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors",children:a.jsx(gT,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"grid grid-cols-7 gap-2 text-center",children:[V.map(E=>a.jsx("div",{className:"font-semibold text-gray-500 text-sm py-2",children:E},E)),[...Array(U)].map((E,N)=>a.jsx("div",{},`empty-${N}`)),[...Array(C)].map((E,N)=>{const R=N+1,P=R===F.getDate()&&f.getMonth()===F.getMonth()&&f.getFullYear()===F.getFullYear();return a.jsx("div",{className:`py-3 rounded-lg cursor-pointer transition-all hover:scale-110 ${P?"bg-primary text-white font-bold":"bg-gray-50 hover:bg-gray-100"}`,children:R},R)})]})]})},M=()=>{switch(l){case"dashboard":return a.jsxs("div",{children:[a.jsxs("div",{className:"bg-gradient-to-r from-primary to-secondary text-white rounded-2xl p-8 mb-8",children:[a.jsxs("h2",{className:"text-2xl font-bold mb-2",children:["Witaj z powrotem, ",(e==null?void 0:e.username)||(n==null?void 0:n.username),"!"]}),a.jsx("p",{className:"opacity-90",children:"Mio Ci widzie. Oto Twj panel uytkownika gdzie moesz zarzdza swoim kontem i rezerwacjami."})]}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"card p-6 text-center",children:[a.jsx("div",{className:"text-4xl font-bold text-gray-900 mb-2",children:"0"}),a.jsx("div",{className:"text-gray-500",children:"Nadchodzcych wizyt"})]}),a.jsxs("div",{className:"card p-6 text-center",children:[a.jsx("div",{className:"text-4xl font-bold text-gray-900 mb-2",children:"0"}),a.jsx("div",{className:"text-gray-500",children:"Ulubionych miejsc"})]}),a.jsxs("div",{className:"card p-6 text-center",children:[a.jsx("div",{className:"text-4xl font-bold text-gray-900 mb-2",children:"0 z"}),a.jsx("div",{className:"text-gray-500",children:"W portfelu"})]})]})]});case"referral":return a.jsxs("div",{children:[a.jsxs("div",{className:"bg-gradient-to-r from-primary to-secondary text-white rounded-2xl p-8 mb-8",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Zapraszaj i zarabiaj!"}),a.jsxs("p",{className:"text-lg opacity-95",children:["Kady polecony znajomy to ",a.jsx("strong",{children:"50 z"})," na Twoje konto!"]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-8",children:[a.jsx("h3",{className:"font-bold text-lg mb-4",children:"Twj unikalny link:"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("input",{type:"text",readOnly:!0,value:`https://tomyhomeapp.pl/ref/${(e==null?void 0:e.id)||"user"}`,className:"flex-1 px-4 py-3 border-2 border-gray-200 rounded-xl bg-white"}),a.jsx("button",{onClick:()=>{navigator.clipboard.writeText(`https://tomyhomeapp.pl/ref/${(e==null?void 0:e.id)||"user"}`),o("Link skopiowany!","success")},className:"btn btn-primary",children:"Kopiuj"})]})]})]});case"favorites":return a.jsxs("div",{className:"text-center py-16",children:[a.jsx(ag,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"Nie masz jeszcze ulubionych miejsc."})]});case"wallet":return a.jsxs("div",{className:"bg-gradient-to-r from-emerald-500 to-green-400 text-white rounded-2xl p-8",children:[a.jsx("h2",{className:"text-xl mb-2",children:"Dostpne rodki"}),a.jsx("div",{className:"text-5xl font-bold mb-6",children:"0.00 z"}),a.jsx("button",{onClick:()=>o("Funkcja w budowie","info"),className:"btn bg-white text-emerald-600 font-bold",children:"Doaduj"})]});case"visits":return a.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2",children:[a.jsx("h3",{className:"font-bold text-lg mb-4",children:"Kalendarz wizyt"}),D()]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold text-lg mb-4",children:"Nadchodzce wizyty"}),a.jsx("p",{className:"text-gray-500",children:"Brak nadchodzcych wizyt."})]})]});case"settings":return a.jsx(k,{});case"help":return a.jsxs("div",{className:"card p-8",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Centrum Pomocy"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Masz pytania? Skontaktuj si z nami!"}),a.jsx("p",{className:"text-primary font-semibold",children:"pomoc@tomyhomeapp.pl"})]});default:return null}},k=()=>{const C=O.useRef(null),F=(Pe=>{if(!Pe)return{countryCode:"+48",number:""};const st=Pe.match(/^(\+\d{1,3})\s?(.*)$/);return st?{countryCode:st[1],number:st[2]}:{countryCode:"+48",number:Pe}})((n==null?void 0:n.phone)||(e==null?void 0:e.phone)),[V,E]=O.useState({username:(n==null?void 0:n.username)||(e==null?void 0:e.username)||"",phone:F.number,phoneCountryCode:F.countryCode,businessName:(n==null?void 0:n.businessName)||""}),[N,R]=O.useState((n==null?void 0:n.avatar)||(e==null?void 0:e.avatar)||""),[P,A]=O.useState(!1),[$,z]=O.useState(!1),[xe,oe]=O.useState(!1),[ue,ne]=O.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[H,re]=O.useState(!1),[X,Q]=O.useState(!1),[G,le]=O.useState(!1),_e=async Pe=>{var mn;const st=(mn=Pe.target.files)==null?void 0:mn[0];if(!(!st||!(e!=null&&e.id))){z(!0);try{const Y=await qz(e.id,st);R(Y),o("Zdjcie zostao zmienione!","success")}catch(Y){o(Y.message||"Bd przesyania zdjcia","error")}finally{z(!1)}}},ge=async Pe=>{Pe.preventDefault();const st=V.username.trim().split(/\s+/);if(st.length<2||st.some(Y=>Y.length<2)){o("Podaj pene imi i nazwisko (np. Jan Kowalski)","error");return}const mn=x_(V.phoneCountryCode,V.phone);if(!mn.valid){o(mn.message,"error");return}if(e!=null&&e.id){A(!0);try{const Y=`${V.phoneCountryCode} ${V.phone.replace(/\D/g,"")}`,we={username:V.username,phone:Y};V.businessName&&V.businessName.trim()&&(we.businessName=V.businessName.trim()),await bT(e.id,we),o("Zmiany zostay zapisane!","success")}catch(Y){o(Y.message||"Bd zapisywania zmian","error")}finally{A(!1)}}},ye=async Pe=>{if(Pe.preventDefault(),ue.newPassword!==ue.confirmPassword){o("Hasa nie s zgodne","error");return}if(ue.newPassword.length<8){o("Haso musi mie co najmniej 8 znakw","error");return}le(!0);try{await Zz(ue.currentPassword,ue.newPassword),o("Haso zostao zmienione!","success"),oe(!1),ne({currentPassword:"",newPassword:"",confirmPassword:""})}catch(st){o(st.message||"Bd zmiany hasa","error")}finally{le(!1)}},rt=async()=>{const Pe=window.prompt("Aby usun konto, wpisz swoje haso:");if(Pe!==null){if(!Pe||Pe.length<8){o("Nieprawidowe haso","error");return}if(window.confirm("UWAGA: Czy na pewno chcesz usun swoje konto? Ta operacja jest nieodwracalna!"))try{await Gz(Pe),o("Konto zostao usunite","info"),t("/")}catch(st){o(st.message||"Bd usuwania konta","error")}}};return a.jsxs("div",{className:"max-w-2xl space-y-6",children:[a.jsxs("div",{className:"card p-8",children:[a.jsx("h3",{className:"font-bold text-lg mb-6",children:"Zdjcie profilowe"}),a.jsxs("div",{className:"flex items-center gap-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden bg-gradient-to-r from-primary to-secondary flex items-center justify-center text-white text-3xl",children:$?a.jsx(At,{className:"w-8 h-8 animate-spin"}):N?a.jsx("img",{src:N,alt:"Avatar",className:"w-full h-full object-cover"}):""}),a.jsx("button",{onClick:()=>{var Pe;return(Pe=C.current)==null?void 0:Pe.click()},disabled:$,className:"absolute bottom-0 right-0 w-8 h-8 bg-white rounded-full shadow-lg flex items-center justify-center hover:bg-gray-100 transition-colors disabled:opacity-50",children:a.jsx(wz,{className:"w-4 h-4 text-gray-600"})}),a.jsx("input",{ref:C,type:"file",accept:"image/*",onChange:_e,className:"hidden"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-600 text-sm",children:"Kliknij ikon aparatu aby zmieni zdjcie."}),a.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"Max 5MB, formaty: JPG, PNG, GIF"})]})]})]}),a.jsxs("div",{className:"card p-8",children:[a.jsx("h3",{className:"font-bold text-lg mb-6",children:"Dane osobowe"}),a.jsxs("form",{onSubmit:ge,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500 mb-2",children:"Imi i Nazwisko"}),a.jsx("input",{type:"text",value:V.username,onChange:Pe=>E({...V,username:Pe.target.value}),placeholder:"Jan Kowalski",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-primary focus:ring-0 focus:outline-none"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Wpisz imi i nazwisko"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500 mb-2",children:"Email"}),a.jsx("input",{type:"email",value:(n==null?void 0:n.email)||(e==null?void 0:e.email)||"",readOnly:!0,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl bg-gray-50 text-gray-500"}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Email nie moe by zmieniony"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500 mb-2",children:"Telefon"}),a.jsx(w_,{value:V.phone,countryCode:V.phoneCountryCode,onChange:(Pe,st)=>{E({...V,phone:Pe,phoneCountryCode:st})}})]}),((n==null?void 0:n.accountType)==="provider"||(e==null?void 0:e.accountType)==="provider")&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500 mb-2",children:"Nazwa firmy / salonu"}),a.jsx("input",{type:"text",value:V.businessName,onChange:Pe=>E({...V,businessName:Pe.target.value}),placeholder:"np. Beauty Studio Anna",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-primary focus:ring-0 focus:outline-none"})]}),a.jsx("button",{type:"submit",disabled:P,className:"btn btn-primary mt-4 flex items-center gap-2",children:P?a.jsxs(a.Fragment,{children:[a.jsx(At,{className:"w-5 h-5 animate-spin"}),"Zapisywanie..."]}):a.jsxs(a.Fragment,{children:[a.jsx(vc,{className:"w-5 h-5"}),"Zapisz zmiany"]})})]})]}),a.jsxs("div",{className:"card p-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"font-bold text-lg",children:"Zmiana hasa"}),a.jsx("button",{onClick:()=>oe(!xe),className:"text-primary hover:underline text-sm font-medium",children:xe?"Anuluj":"Zmie haso"})]}),xe?a.jsxs("form",{onSubmit:ye,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500 mb-2",children:"Obecne haso"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:H?"text":"password",value:ue.currentPassword,onChange:Pe=>ne({...ue,currentPassword:Pe.target.value}),placeholder:"",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-primary focus:ring-0 focus:outline-none",required:!0}),a.jsx("button",{type:"button",onClick:()=>re(!H),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:H?a.jsx(po,{className:"w-5 h-5"}):a.jsx(Gr,{className:"w-5 h-5"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500 mb-2",children:"Nowe haso"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:X?"text":"password",value:ue.newPassword,onChange:Pe=>ne({...ue,newPassword:Pe.target.value}),placeholder:"",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-primary focus:ring-0 focus:outline-none",required:!0}),a.jsx("button",{type:"button",onClick:()=>Q(!X),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:X?a.jsx(po,{className:"w-5 h-5"}):a.jsx(Gr,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"mt-2 text-xs text-gray-500 space-y-1",children:[a.jsxs("p",{className:ue.newPassword.length>=8?"text-green-600":"",children:[ue.newPassword.length>=8?"":""," Minimum 8 znakw"]}),a.jsxs("p",{className:/[A-Z]/.test(ue.newPassword)?"text-green-600":"",children:[/[A-Z]/.test(ue.newPassword)?"":""," Wielka litera"]}),a.jsxs("p",{className:/[a-z]/.test(ue.newPassword)?"text-green-600":"",children:[/[a-z]/.test(ue.newPassword)?"":""," Maa litera"]}),a.jsxs("p",{className:/[0-9]/.test(ue.newPassword)?"text-green-600":"",children:[/[0-9]/.test(ue.newPassword)?"":""," Cyfra"]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500 mb-2",children:"Potwierd nowe haso"}),a.jsx("input",{type:"password",value:ue.confirmPassword,onChange:Pe=>ne({...ue,confirmPassword:Pe.target.value}),placeholder:"",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-primary focus:ring-0 focus:outline-none",required:!0}),ue.confirmPassword&&a.jsx("p",{className:`text-xs mt-1 ${ue.newPassword===ue.confirmPassword?"text-green-600":"text-red-500"}`,children:ue.newPassword===ue.confirmPassword?" Hasa s zgodne":" Hasa nie s zgodne"})]}),a.jsx("button",{type:"submit",disabled:G,className:"btn btn-primary flex items-center gap-2",children:G?a.jsxs(a.Fragment,{children:[a.jsx(At,{className:"w-5 h-5 animate-spin"}),"Zmieniam..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ya,{className:"w-5 h-5"}),"Zmie haso"]})})]}):a.jsx("p",{className:"text-gray-500 text-sm",children:"Zalecamy regularn zmian hasa dla bezpieczestwa konta."})]}),a.jsxs("div",{className:"card p-8 border-2 border-red-200 bg-red-50",children:[a.jsx("h3",{className:"font-bold text-lg text-red-600 mb-4",children:"Strefa zagroenia"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Po usuniciu konta wszystkie Twoje dane, rezerwacje i historia zostan trwale usunite. Ta operacja jest nieodwracalna."}),a.jsx("button",{onClick:rt,className:"px-4 py-2 bg-red-600 text-white rounded-xl font-medium hover:bg-red-700 transition-colors",children:"Usu moje konto"})]})]})};return r?a.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[a.jsx("div",{className:"lg:hidden mb-6 overflow-x-auto",children:a.jsxs("div",{className:"flex gap-2 pb-2 min-w-max",children:[g.map(C=>a.jsxs("button",{onClick:()=>h(C.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl whitespace-nowrap transition-all ${l===C.id?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[a.jsx(C.icon,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:C.label})]},C.id)),a.jsxs("button",{onClick:_,className:"flex items-center gap-2 px-4 py-2 rounded-xl whitespace-nowrap bg-red-50 text-red-600 hover:bg-red-100 transition-all",children:[a.jsx(zh,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:"Wyloguj"})]})]})}),a.jsxs("div",{className:"flex gap-8",children:[a.jsx("aside",{className:"w-72 shrink-0 hidden lg:block",children:a.jsxs("div",{className:"card p-6 sticky top-24",children:[a.jsxs("div",{className:"text-center mb-6 pb-6 border-b border-gray-100",children:[a.jsx("div",{className:"relative inline-block",children:a.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden bg-gradient-to-r from-primary to-secondary flex items-center justify-center text-white text-3xl",children:n!=null&&n.avatar||e!=null&&e.avatar?a.jsx("img",{src:(n==null?void 0:n.avatar)||(e==null?void 0:e.avatar),alt:"Avatar",className:"w-full h-full object-cover"}):""})}),a.jsx("div",{className:"font-bold text-lg mt-3",children:(n==null?void 0:n.username)||(e==null?void 0:e.username)}),a.jsx("div",{className:"text-gray-500 text-sm",children:(n==null?void 0:n.phone)||(e==null?void 0:e.phone)}),((n==null?void 0:n.accountType)==="provider"||(e==null?void 0:e.accountType)==="provider")&&a.jsx("span",{className:"inline-block mt-2 px-3 py-1 bg-emerald-100 text-emerald-700 text-xs font-medium rounded-full",children:"Usugodawca"})]}),a.jsxs("nav",{className:"space-y-1",children:[g.map(C=>a.jsxs("button",{onClick:()=>h(C.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${l===C.id?"bg-primary text-white":"text-gray-600 hover:bg-gray-100"}`,children:[a.jsx(C.icon,{className:"w-5 h-5"}),a.jsx("span",{className:"font-medium",children:C.label})]},C.id)),a.jsxs("button",{onClick:_,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-red-500 hover:bg-red-50 transition-all",children:[a.jsx(zh,{className:"w-5 h-5"}),a.jsx("span",{className:"font-medium",children:"Wyloguj"})]})]})]})}),a.jsxs("main",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold",children:((S=g.find(C=>C.id===l))==null?void 0:S.label)||"Panel Gwny"}),a.jsxs("p",{className:"text-gray-500",children:[l==="dashboard"&&"Przegld Twojej aktywnoci",l==="referral"&&"Zapraszaj znajomych i zarabiaj",l==="favorites"&&"Twoje ulubione miejsca i usugi",l==="wallet"&&"Zarzdzaj swoimi rodkami",l==="visits"&&"Kalendarz i historia rezerwacji",l==="settings"&&"Personalizuj swoje konto",l==="help"&&"FAQ i Kontakt"]})]}),M()]})]})]}):null},to="providers",ug=()=>Date.now().toString(36)+Math.random().toString(36).substr(2,9),Qz=()=>({monday:{from:"09:00",to:"18:00",enabled:!0},tuesday:{from:"09:00",to:"18:00",enabled:!0},wednesday:{from:"09:00",to:"18:00",enabled:!0},thursday:{from:"09:00",to:"18:00",enabled:!0},friday:{from:"09:00",to:"18:00",enabled:!0},saturday:{from:"10:00",to:"15:00",enabled:!0},sunday:{from:"00:00",to:"00:00",enabled:!1}}),da=(t,e)=>{var h,f;const n=new Date().toISOString(),r=e||((h=t.id)==null?void 0:h.toString())||ug();let s=[];t.services&&Array.isArray(t.services)&&(s=t.services.map((m,g)=>({id:m.id||`service-${g}`,name:m.name||"",description:m.description||"",duration:m.duration||"30 min",price:Number(m.price)||0,oldPrice:m.oldPrice?Number(m.oldPrice):void 0,discount:m.discount?Number(m.discount):void 0,badge:m.badge,category:m.category||"Usugi"})));let o;t.location&&typeof t.location=="object"?o={city:t.location.city||"",district:t.location.district||"",address:t.location.address||"",postalCode:t.location.postalCode||"",lat:Number(t.location.lat)||52.2297,lng:Number(t.location.lng)||21.0122}:o={city:"",district:"",address:"",postalCode:"",lat:52.2297,lng:21.0122};const l=[o.city,o.district].filter(Boolean).join(", ")||"Nie podano";return{id:r,ownerId:((f=t.ownerId)==null?void 0:f.toString())||"",name:t.name||"",profession:t.profession||"",description:t.description||"",experience:t.experience||"",category:t.category||"",location:o,locationString:l,travelRadius:Number(t.travelRadius)||10,hasTravel:t.hasTravel??!0,image:t.image||"https://images.unsplash.com/photo-1560066984-138dadb4c035?w=400&h=400&fit=crop",portfolio:t.portfolio||[],services:s,serviceNames:s.map(m=>m.name),features:t.features||[],priceFrom:s.length>0?Math.min(...s.map(m=>m.price)):0,rating:Number(t.rating)||0,reviewsCount:Number(t.reviewsCount)||0,completedServices:Number(t.completedServices)||0,punctuality:Number(t.punctuality)||95,regularClients:Number(t.regularClients)||0,certifications:t.certifications||[],workingHours:t.workingHours||Qz(),acceptsCard:t.acceptsCard??!0,responseTime:t.responseTime||"24h",isPremium:t.isPremium||!1,isVerified:t.isVerified||!1,isActive:t.isActive??!0,isAvailableToday:t.isAvailableToday??!0,createdAt:t.createdAt||n,updatedAt:t.updatedAt||n,ownerEmail:t.ownerEmail||"",ownerUsername:t.ownerUsername||"",ownerPhone:t.ownerPhone||"",ownerAvatar:t.ownerAvatar||""}},tr={async getAll(){try{const t=await Xn(Bt(Ce,to));return console.log("Firebase getAll - znaleziono:",t.docs.length),t.docs.map(e=>da({...e.data(),id:e.id}))}catch(t){return console.error("Firebase getAll error:",t),[]}},async getById(t){try{const e=at(Ce,to,t),n=await tl(e);return n.exists()?da({...n.data(),id:n.id}):null}catch(e){return console.error("Firebase getById error:",e),null}},async getByCategory(t){try{const e=tn(Bt(Ce,to),$t("category","==",t));return(await Xn(e)).docs.map(r=>da({...r.data(),id:r.id}))}catch(e){return console.error("Firebase getByCategory error:",e),[]}},async getByOwner(t){try{const e=tn(Bt(Ce,to),$t("ownerId","==",t));return(await Xn(e)).docs.map(r=>da({...r.data(),id:r.id}))}catch(e){return console.error("Firebase getByOwner error:",e),[]}},async create(t,e){const n=ug(),r=da({...t,ownerId:e,isActive:!0},n),s=JSON.parse(JSON.stringify(r));try{return console.log("Firebase create - zapisuj:",s),await nl(at(Ce,to,n),s),console.log("Firebase create - zapisano pomylnie"),window.dispatchEvent(new CustomEvent("providerCreated",{detail:r})),r}catch(o){throw console.error("Firebase create error:",o),o}},async update(t,e){try{const n=await this.getById(t);if(!n)return null;const r=da({...n,...e},t);r.updatedAt=new Date().toISOString();const s=JSON.parse(JSON.stringify(r));return await ws(at(Ce,to,t),s),window.dispatchEvent(new CustomEvent("providerUpdated",{detail:r})),r}catch(n){throw console.error("Firebase update error:",n),n}},async delete(t){try{return await a_(at(Ce,to,t)),window.dispatchEvent(new CustomEvent("providerDeleted",{detail:{id:t}})),!0}catch(e){return console.error("Firebase delete error:",e),!1}},async uploadImage(t,e){try{const n=`providers/${e}/${Date.now()}_${t.name}`,r=m_(g_,n);return await hT(r,t),fT(r)}catch(n){throw console.error("Firebase upload error:",n),n}},async addService(t,e){const n=await this.getById(t);if(!n)return null;const r={...e,id:ug()},s=[...n.services,r];return this.update(t,{services:s,serviceNames:s.map(o=>o.name),priceFrom:Math.min(...s.map(o=>o.price))})},async removeService(t,e){const n=await this.getById(t);if(!n)return null;const r=n.services.filter(s=>s.id!==e);return this.update(t,{services:r,serviceNames:r.map(s=>s.name),priceFrom:r.length>0?Math.min(...r.map(s=>s.price)):0})}},Yz={fryzjer:["fryzjer","fryzjerstwo","hair"],pedicure:["pedicure","pedikre"],paznokcie:["paznokcie","manicure","nails","stylizacja paznokci"],masaz:["masa","masaz","massage"],makijaz:["makija","makijaz","makeup","wiza"],"pielegnacja-twarzy":["pielgnacja twarzy","kosmetyka","facial"],depilacja:["depilacja","wax","waxing"],barber:["barber","fryzjer mski","barbershop"],tatuaz:["tatua","tatuaz","tattoo"]},K0=()=>{const{category:t}=y1(),{showToast:e}=xr(),[n,r]=O.useState([]),[s,o]=O.useState(!0),[l,h]=O.useState(!1),[f,m]=O.useState(!0),[g,_]=O.useState(0),[w,T]=O.useState([]),[j,D]=O.useState(""),[M,k]=O.useState(null),[S,C]=O.useState("rating"),U=async(A=!1)=>{A?h(!0):o(!0);try{let $=await tr.getAll();if(t){const z=Yz[t]||[t];$=$.filter(xe=>{if(!xe.category)return!1;const oe=xe.category.toLowerCase();return z.some(ue=>oe.includes(ue.toLowerCase()))})}S==="rating"?$.sort((z,xe)=>xe.rating-z.rating):S==="price-asc"?$.sort((z,xe)=>z.priceFrom-xe.priceFrom):S==="price-desc"&&$.sort((z,xe)=>xe.priceFrom-z.priceFrom),w.includes("available-today")&&($=$.filter(z=>z.isAvailableToday)),w.includes("with-travel")&&($=$.filter(z=>z.hasTravel)),r($),_($.length),m(!1)}catch($){console.error("Bd pobierania usugodawcw:",$),e("Bd adowania danych","error")}finally{o(!1),h(!1)}};O.useEffect(()=>{U()},[t,j,M,S,w]);const F={locations:["Wszystkie dzielnice","Centrum","Mokotw","Wola","Praga","Ursynw"],specializations:["Wszystkie","Fryzjer damski","Fryzjer mski","Fryzjer dziecicy","Koloryzacja","Fryzury lubne"],ratings:[{label:"Wszystkie oceny",value:null},{label:" 5.0",value:5},{label:" 4.5+",value:4.5},{label:" 4.0+",value:4},{label:" 3.5+",value:3.5}]},V=[{id:"available-today",label:"Dostpny dzi"},{id:"with-travel",label:"Z dojazdem"},{id:"recommended",label:"Polecany"},{id:"discount",label:"Nowi uytkownicy -20%"},{id:"weekend",label:"Weekend"}],E=A=>{T($=>$.includes(A)?$.filter(z=>z!==A):[...$,A])},N=()=>{T([]),D(""),k(null),e("Filtry wyczyszczone","info")},R=t?t.charAt(0).toUpperCase()+t.slice(1):"Wszystkie usugi",P=()=>{!l&&f&&U(!0)};return a.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[a.jsxs("nav",{className:"flex items-center gap-2 text-sm text-gray-500 mb-6",children:[a.jsx(ke,{to:"/",className:"hover:text-primary transition-colors",children:"Strona gwna"}),a.jsx("span",{children:"/"}),a.jsx(ke,{to:"/uslugodawcy",className:"hover:text-primary transition-colors",children:"Usugi"}),t&&a.jsxs(a.Fragment,{children:[a.jsx("span",{children:"/"}),a.jsx("span",{className:"text-gray-900",children:R})]})]}),a.jsxs("div",{className:"text-center mb-10",children:[a.jsx("span",{className:"inline-block bg-primary/10 text-primary px-4 py-1 rounded-full text-sm font-semibold mb-4",children:R.toUpperCase()}),a.jsx("h1",{className:"text-3xl lg:text-4xl font-bold mb-4",children:"Wybierz swojego specjalist"}),a.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Znajd idealnego specjalist w Twojej okolicy. Sprawd opinie, ceny i dostpne terminy."})]}),a.jsxs("section",{className:"card p-6 mb-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[a.jsx(y_,{className:"w-5 h-5"}),"Filtry wyszukiwania"]}),a.jsx("button",{onClick:N,className:"text-sm text-primary hover:underline",children:"Wyczy filtry"})]}),a.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Lokalizacja"}),a.jsx("select",{value:j,onChange:A=>D(A.target.value==="Wszystkie dzielnice"?"":A.target.value),className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl focus:border-primary focus:ring-0",children:F.locations.map(A=>a.jsx("option",{value:A,children:A},A))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Specjalizacja"}),a.jsx("select",{className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl focus:border-primary focus:ring-0",children:F.specializations.map(A=>a.jsx("option",{value:A.toLowerCase(),children:A},A))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Ocena"}),a.jsx("select",{value:M??"",onChange:A=>k(A.target.value?parseFloat(A.target.value):null),className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl focus:border-primary focus:ring-0",children:F.ratings.map(A=>a.jsx("option",{value:A.value??"",children:A.label},A.label))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Zakres cen"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",placeholder:"Od",defaultValue:50,className:"w-full px-3 py-2.5 border-2 border-gray-200 rounded-xl focus:border-primary focus:ring-0"}),a.jsx("span",{children:"-"}),a.jsx("input",{type:"number",placeholder:"Do",defaultValue:200,className:"w-full px-3 py-2.5 border-2 border-gray-200 rounded-xl focus:border-primary focus:ring-0"})]})]})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:V.map(A=>a.jsx("button",{onClick:()=>E(A.id),className:`px-4 py-2 rounded-full text-sm font-medium transition-all ${w.includes(A.id)?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:A.label},A.id))})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:[a.jsx("div",{className:"text-gray-600",children:s?a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(At,{className:"w-4 h-4 animate-spin"}),"adowanie..."]}):a.jsxs(a.Fragment,{children:["Znaleziono ",a.jsxs("strong",{className:"text-gray-900",children:[g," specjalistw"]})," w Twojej okolicy"]})}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Sortuj:"}),a.jsxs("select",{value:S,onChange:A=>C(A.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl focus:border-primary focus:ring-0 text-sm",children:[a.jsx("option",{value:"rating",children:"Najwyej oceniane"}),a.jsx("option",{value:"recommended",children:"Polecane"}),a.jsx("option",{value:"price-asc",children:"Cena: od najniszej"}),a.jsx("option",{value:"price-desc",children:"Cena: od najwyszej"}),a.jsx("option",{value:"distance",children:"Najbliej"})]})]})]}),s&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[a.jsx(At,{className:"w-12 h-12 animate-spin text-primary mb-4"}),a.jsx("p",{className:"text-gray-500",children:"adowanie specjalistw..."})]}),!s&&n.length===0&&a.jsxs("div",{className:"text-center py-20",children:[a.jsx("div",{className:"text-6xl mb-4",children:""}),a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Brak wynikw"}),a.jsx("p",{className:"text-gray-500 mb-4",children:"Nie znaleziono specjalistw speniajcych kryteria wyszukiwania."}),a.jsx("button",{onClick:N,className:"btn btn-primary",children:"Wyczy filtry"})]}),!s&&n.length>0&&a.jsx("div",{className:"grid gap-6",children:n.map(A=>a.jsxs("div",{className:"card card-hover p-6 grid md:grid-cols-[200px,1fr,200px] gap-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:A.image,alt:A.name,className:"w-full h-48 md:h-full object-cover rounded-xl"}),A.isPremium&&a.jsx("div",{className:"absolute top-3 left-3 bg-gradient-to-r from-amber-400 to-orange-500 text-white text-xs font-bold px-3 py-1 rounded-full",children:" Premium"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:A.name}),a.jsx("p",{className:"text-gray-500",children:A.profession})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx("div",{className:"flex",children:[...Array(5)].map(($,z)=>a.jsx(Or,{className:`w-4 h-4 ${z<Math.floor(A.rating)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},z))}),a.jsx("span",{className:"font-bold text-gray-900",children:A.rating}),a.jsxs("span",{className:"text-gray-500",children:["(",A.reviewsCount," opinii)"]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-4",children:[a.jsx(Fa,{className:"w-4 h-4"}),a.jsx("span",{children:A.locationString})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[A.serviceNames.slice(0,4).map(($,z)=>a.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-sm",children:$},z)),A.serviceNames.length>4&&a.jsxs("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-sm",children:["+",A.serviceNames.length-4]})]}),a.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:A.description}),a.jsx("div",{className:"flex flex-wrap gap-4",children:A.features.slice(0,3).map($=>a.jsxs("span",{className:"flex items-center gap-1 text-sm text-gray-600",children:[a.jsx(Tt,{className:"w-4 h-4 text-green-500"}),$]},$))})]}),a.jsxs("div",{className:"flex flex-col justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:`flex items-center gap-2 text-sm mb-4 ${A.isAvailableToday?"text-green-600":"text-orange-500"}`,children:[a.jsx("span",{className:`w-2 h-2 rounded-full ${A.isAvailableToday?"bg-green-500":"bg-orange-500"}`}),A.isAvailableToday?"Dostpna dzi":"Zajta dzi"]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Od"}),a.jsxs("div",{className:"text-3xl font-bold text-gray-900",children:[A.priceFrom," ",a.jsx("span",{className:"text-base font-normal text-gray-500",children:"z"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{to:`/uslugodawcy/profil/${A.id}`,className:"w-full btn btn-primary justify-center",children:"Zarezerwuj"}),a.jsx(ke,{to:`/uslugodawcy/profil/${A.id}`,className:"w-full btn btn-ghost justify-center",children:"Zobacz profil"})]})]})]},A.id))}),!s&&f&&n.length>0&&a.jsx("div",{className:"flex justify-center mt-10",children:a.jsx("button",{onClick:P,disabled:l,className:"btn btn-ghost px-8 py-3 text-lg",children:l?a.jsxs(a.Fragment,{children:[a.jsx(At,{className:"w-5 h-5 animate-spin mr-2"}),"adowanie..."]}):"Zaaduj wicej"})}),!s&&!f&&n.length>0&&a.jsx("div",{className:"text-center mt-10 py-6 border-t border-gray-200",children:a.jsxs("p",{className:"text-gray-500",children:["To wszyscy dostpni specjalici (",g,")"]})}),a.jsxs("button",{className:"fixed bottom-6 right-6 btn btn-primary shadow-xl",children:[a.jsx(Fa,{className:"w-5 h-5"}),a.jsx("span",{children:"Poka na mapie"})]})]})},Hs="notifications",Xz=()=>Date.now().toString(36)+Math.random().toString(36).substr(2,9),wn={async create(t){const e=Xz(),n=new Date().toISOString(),r={id:e,userId:t.userId,type:t.type,title:t.title,message:t.message,data:t.data,read:!1,createdAt:n};try{return await nl(at(Ce,Hs,e),r),console.log("Notification created:",r),window.dispatchEvent(new CustomEvent("newNotification",{detail:r})),r}catch(s){throw console.error("Notification create error:",s),s}},async getByUser(t){try{const e=tn(Bt(Ce,Hs),$t("userId","==",t));return(await Xn(e)).docs.map(s=>s.data()).sort((s,o)=>new Date(o.createdAt).getTime()-new Date(s.createdAt).getTime())}catch(e){return console.error("Notification getByUser error:",e),[]}},async getUnreadByUser(t){try{const e=tn(Bt(Ce,Hs),$t("userId","==",t));return(await Xn(e)).docs.map(s=>s.data()).filter(s=>!s.read).sort((s,o)=>new Date(o.createdAt).getTime()-new Date(s.createdAt).getTime())}catch(e){return console.error("Notification getUnreadByUser error:",e),[]}},async countUnread(t){try{return(await this.getUnreadByUser(t)).length}catch(e){return console.error("Notification countUnread error:",e),0}},async markAsRead(t){try{await ws(at(Ce,Hs,t),{read:!0})}catch(e){throw console.error("Notification markAsRead error:",e),e}},async markAllAsRead(t){try{const e=await this.getUnreadByUser(t);if(e.length===0)return;const n=V0(Ce);e.forEach(r=>{const s=at(Ce,Hs,r.id);n.update(s,{read:!0})}),await n.commit()}catch(e){throw console.error("Notification markAllAsRead error:",e),e}},async delete(t){try{await a_(at(Ce,Hs,t))}catch(e){throw console.error("Notification delete error:",e),e}},async deleteAllByUser(t){try{const e=await this.getByUser(t);if(e.length===0)return;const n=V0(Ce);e.forEach(r=>{const s=at(Ce,Hs,r.id);n.delete(s)}),await n.commit()}catch(e){throw console.error("Notification deleteAllByUser error:",e),e}},subscribe(t,e){const n=tn(Bt(Ce,Hs),$t("userId","==",t));return Kc(n,r=>{const s=r.docs.map(o=>o.data());s.sort((o,l)=>new Date(l.createdAt).getTime()-new Date(o.createdAt).getTime()),e(s)})},getIcon(t){return{booking_request:"",booking_confirmed:"",booking_cancelled:"",booking_completed:"",booking_reminder:"",new_message:"",new_review:"",system:""}[t]||""},getColor(t){return{booking_request:"bg-blue-100 text-blue-600",booking_confirmed:"bg-green-100 text-green-600",booking_cancelled:"bg-red-100 text-red-600",booking_completed:"bg-purple-100 text-purple-600",booking_reminder:"bg-yellow-100 text-yellow-600",new_message:"bg-indigo-100 text-indigo-600",new_review:"bg-orange-100 text-orange-600",system:"bg-gray-100 text-gray-600"}[t]||"bg-gray-100 text-gray-600"}},Ir="bookings",Jz=()=>Date.now().toString(36)+Math.random().toString(36).substr(2,9),Jn={async create(t){const e=Jz(),n=new Date().toISOString(),r={id:e,...t,status:"pending",createdAt:n,updatedAt:n};try{return await nl(at(Ce,Ir,e),r),console.log("Booking created:",r),await wn.create({userId:t.providerId,type:"booking_request",title:"Nowa proba o rezerwacj",message:`${t.clientName} chce zarezerwowa ${t.serviceName} na ${t.date} o ${t.time}`,data:{bookingId:e}}),r}catch(s){throw console.error("Booking create error:",s),s}},async getById(t){try{const e=at(Ce,Ir,t),n=await tl(e);return n.exists()?n.data():null}catch(e){return console.error("Booking getById error:",e),null}},async getByClient(t){try{const e=tn(Bt(Ce,Ir),$t("clientId","==",t));return(await Xn(e)).docs.map(s=>s.data()).sort((s,o)=>new Date(o.createdAt).getTime()-new Date(s.createdAt).getTime())}catch(e){return console.error("Booking getByClient error:",e),[]}},async getByProvider(t){try{const e=tn(Bt(Ce,Ir),$t("providerId","==",t));return(await Xn(e)).docs.map(s=>s.data()).sort((s,o)=>new Date(o.createdAt).getTime()-new Date(s.createdAt).getTime())}catch(e){return console.error("Booking getByProvider error:",e),[]}},async getByProviderAndDate(t,e){try{const n=tn(Bt(Ce,Ir),$t("providerId","==",t),$t("date","==",e));return(await Xn(n)).docs.map(s=>s.data())}catch(n){return console.error("Booking getByProviderAndDate error:",n),[]}},async confirm(t){try{const e=await this.getById(t);if(!e)return null;const n=new Date().toISOString(),r={status:"confirmed",updatedAt:n,confirmedAt:n};return await ws(at(Ce,Ir,t),r),await wn.create({userId:e.clientId,type:"booking_confirmed",title:"Rezerwacja potwierdzona! ",message:`${e.providerName} potwierdzi Twoj rezerwacj na ${e.date} o ${e.time}`,data:{bookingId:t}}),{...e,...r}}catch(e){throw console.error("Booking confirm error:",e),e}},async cancel(t,e){try{const n=await this.getById(t);if(!n)return null;const r=new Date().toISOString(),s={status:"cancelled",updatedAt:r,cancelledAt:r};await ws(at(Ce,Ir,t),s);const o=e==="client"?n.providerId:n.clientId,l=e==="client"?n.clientName:n.providerName;return await wn.create({userId:o,type:"booking_cancelled",title:"Rezerwacja anulowana ",message:`${l} anulowa rezerwacj na ${n.date} o ${n.time}`,data:{bookingId:t}}),{...n,...s}}catch(n){throw console.error("Booking cancel error:",n),n}},async complete(t){try{const e=await this.getById(t);if(!e)return null;const n=new Date().toISOString(),r={status:"completed",updatedAt:n,completedAt:n};return await ws(at(Ce,Ir,t),r),await wn.create({userId:e.clientId,type:"booking_completed",title:"Usuga zakoczona! ",message:`Jak oceniasz usug ${e.serviceName} u ${e.providerName}? Zostaw opini!`,data:{bookingId:t,providerId:e.providerId}}),{...e,...r}}catch(e){throw console.error("Booking complete error:",e),e}},async isTimeSlotAvailable(t,e,n){try{return!(await this.getByProviderAndDate(t,e)).find(o=>o.time===n&&(o.status==="pending"||o.status==="confirmed"))}catch(r){return console.error("isTimeSlotAvailable error:",r),!1}},async getBookedSlots(t,e){try{return(await this.getByProviderAndDate(t,e)).filter(r=>r.status==="pending"||r.status==="confirmed").map(r=>r.time)}catch(n){return console.error("getBookedSlots error:",n),[]}},async getProviderStats(t){try{const e=await this.getByProvider(t),n=new Date,r=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`,s=e.filter(m=>m.status==="completed"),o=e.filter(m=>m.status==="pending"),l=e.filter(m=>m.status==="cancelled"),h=e.filter(m=>m.date.startsWith(r)),f=h.filter(m=>m.status==="completed");return{totalBookings:e.length,completedBookings:s.length,pendingBookings:o.length,cancelledBookings:l.length,totalRevenue:s.reduce((m,g)=>m+g.servicePrice,0),thisMonthRevenue:f.reduce((m,g)=>m+g.servicePrice,0),thisMonthBookings:h.length}}catch(e){return console.error("getProviderStats error:",e),{totalBookings:0,completedBookings:0,pendingBookings:0,cancelledBookings:0,totalRevenue:0,thisMonthRevenue:0,thisMonthBookings:0}}},subscribeToProviderBookings(t,e){const n=tn(Bt(Ce,Ir),$t("providerId","==",t));return Kc(n,r=>{const s=r.docs.map(o=>o.data());s.sort((o,l)=>new Date(l.createdAt).getTime()-new Date(o.createdAt).getTime()),e(s)})},subscribeToClientBookings(t,e){const n=tn(Bt(Ce,Ir),$t("clientId","==",t));return Kc(n,r=>{const s=r.docs.map(o=>o.data());s.sort((o,l)=>new Date(l.createdAt).getTime()-new Date(o.createdAt).getTime()),e(s)})}},wd=({icon:t,value:e,label:n,color:r})=>a.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-xl ${r}`,children:[a.jsx(t,{className:"w-4 h-4"}),a.jsx("span",{className:"font-bold",children:e}),a.jsx("span",{className:"text-sm opacity-80",children:n})]}),eM=({service:t,isSelected:e,onToggle:n})=>a.jsxs("div",{onClick:n,className:`p-4 rounded-xl border-2 cursor-pointer transition-all ${e?"border-primary bg-primary/5 shadow-md":"border-gray-200 hover:border-gray-300 hover:shadow-sm"}`,children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h4",{className:"font-bold text-gray-900",children:t.name}),t.badge&&a.jsx("span",{className:`px-2 py-0.5 text-xs font-bold rounded-full ${t.badge==="Premium"?"bg-yellow-100 text-yellow-700":"bg-primary/10 text-primary"}`,children:t.badge})]}),t.description&&a.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:t.description})]}),a.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors ${e?"bg-primary border-primary":"border-gray-300"}`,children:e&&a.jsx(Tt,{className:"w-4 h-4 text-white"})})]}),a.jsxs("div",{className:"flex items-center justify-between mt-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[a.jsx(Si,{className:"w-4 h-4"}),a.jsx("span",{children:t.duration})]}),a.jsxs("div",{className:"text-right",children:[t.oldPrice&&a.jsxs("span",{className:"text-sm text-gray-400 line-through mr-2",children:[t.oldPrice," z"]}),a.jsxs("span",{className:"text-lg font-bold text-primary",children:[t.price," z"]}),t.discount&&a.jsxs("span",{className:"ml-2 text-xs bg-red-100 text-red-600 px-2 py-0.5 rounded-full",children:["-",t.discount,"%"]})]})]})]}),tM=()=>{var X;const{id:t}=y1(),e=vr(),{showToast:n}=xr(),{user:r}=sn(),[s,o]=O.useState(null),[l,h]=O.useState(!0),[f,m]=O.useState(!1),[g,_]=O.useState([]),[w,T]=O.useState(null),[j,D]=O.useState(null),[M,k]=O.useState("Wszystkie"),[S,C]=O.useState(!1),[U,F]=O.useState([]),[V,E]=O.useState(!1),[N]=O.useState({month:"Grudzie",year:2025});O.useEffect(()=>{(async()=>{if(t){h(!0);try{const le=await tr.getById(t);le?o(le):n("Nie znaleziono profilu usugodawcy","error")}catch(le){console.error("Error loading provider:",le),n("Bd adowania profilu","error")}finally{h(!1)}}})();const G=le=>{var _e;((_e=le.detail)==null?void 0:_e.id)===t&&o(le.detail)};return window.addEventListener("providerUpdated",G),()=>window.removeEventListener("providerUpdated",G)},[t]);const R=s!=null&&s.services?["Wszystkie",...new Set(s.services.map(Q=>Q.category).filter(Boolean))]:["Wszystkie"],P=((X=s==null?void 0:s.services)==null?void 0:X.filter(Q=>M==="Wszystkie"||Q.category===M))||[],A=g.reduce((Q,G)=>Q+G.price,0),$=g.reduce((Q,G)=>{const le=G.duration.match(/(\d+)/);return Q+(le?parseInt(le[1]):30)},0),z=Q=>{_(G=>G.find(le=>le.id===Q.id)?G.filter(le=>le.id!==Q.id):[...G,Q])},oe=(()=>{const Q=new Date,G=[],le=new Date(Q.getFullYear(),Q.getMonth(),1),_e=le.getDay()===0?6:le.getDay()-1;for(let ge=0;ge<35;ge++){const ye=new Date(Q.getFullYear(),Q.getMonth(),ge-_e+1),rt=ye.getMonth()===Q.getMonth();G.push({day:ye.getDate(),isToday:ye.toDateString()===Q.toDateString(),disabled:!rt||ye<Q||ye.getDay()===0,fullDate:ye})}return G})();O.useEffect(()=>{(async()=>{if(!(s!=null&&s.id)||!w)return;const G=new Date,le=`${G.getFullYear()}-${String(G.getMonth()+1).padStart(2,"0")}-${String(w).padStart(2,"0")}`,_e=await Jn.getBookedSlots(s.id,le);F(_e)})()},[s==null?void 0:s.id,w]);const ne=(()=>{const Q=[];for(let G=9;G<=18;G++){const le=`${String(G).padStart(2,"0")}:00`;Q.push({time:le,disabled:U.includes(le)})}return Q})(),H=async()=>{if(!r||!r.id){n("Zaloguj si, aby zarezerwowa wizyt","info"),e(`/auth?mode=login&redirect=/uslugodawcy/profil/${t}`);return}if(g.length===0){n("Wybierz przynajmniej jedn usug","error");return}if(!w||!j){n("Wybierz dat i godzin","error");return}if(s){m(!0),console.log("Creating booking for user:",r.id);try{const Q=new Date,G=`${Q.getFullYear()}-${String(Q.getMonth()+1).padStart(2,"0")}-${String(w).padStart(2,"0")}`;if(!await Jn.isTimeSlotAvailable(s.id,G,j)){n("Ten termin jest ju zajty. Wybierz inny.","error"),m(!1);return}const _e=g[0];await Jn.create({clientId:r.id,clientName:r.username||"Klient",clientEmail:r.email||"",clientPhone:r.phone||"",providerId:s.id,providerName:s.name,providerImage:s.image,serviceId:_e.id,serviceName:g.map(ge=>ge.name).join(", "),servicePrice:A,serviceDuration:`${$} min`,date:G,time:j}),console.log("Booking created successfully"),C(!0)}catch(Q){console.error("Bd rezerwacji:",Q),n("Bd podczas tworzenia rezerwacji","error")}finally{m(!1)}}};if(l)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"adowanie profilu..."})]})});if(!s)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-6xl mb-4",children:""}),a.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Nie znaleziono profilu"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Ten usugodawca nie istnieje lub zosta usunity"}),a.jsx("button",{onClick:()=>e("/uslugodawcy"),className:"px-6 py-2 bg-primary text-white rounded-xl hover:bg-primary/90",children:"Wr do listy"})]})});const re={monday:"Pon",tuesday:"Wt",wednesday:"r",thursday:"Czw",friday:"Pt",saturday:"Sob",sunday:"Nd"};return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white border-b sticky top-0 z-40",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:a.jsxs("div",{className:"flex items-center justify-between h-14",children:[a.jsxs("button",{onClick:()=>e(-1),className:"flex items-center gap-2 text-gray-600 hover:text-primary transition-colors",children:[a.jsx(Qc,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Wr"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>E(!V),className:`p-2 rounded-full transition-colors ${V?"text-red-500 bg-red-50":"text-gray-400 hover:text-red-500 hover:bg-red-50"}`,children:a.jsx(ag,{className:`w-5 h-5 ${V?"fill-current":""}`})}),a.jsx("button",{className:"p-2 rounded-full text-gray-400 hover:text-primary hover:bg-primary/10 transition-colors",children:a.jsx(Rz,{className:"w-5 h-5"})})]})]})})}),a.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-6",children:a.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:[a.jsxs("div",{className:"relative h-48 sm:h-64",children:[a.jsx("img",{src:s.image,alt:s.name,className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),a.jsxs("div",{className:"absolute top-4 left-4 flex gap-2",children:[s.isPremium&&a.jsxs("span",{className:"px-3 py-1 bg-yellow-400 text-yellow-900 text-xs font-bold rounded-full flex items-center gap-1",children:[a.jsx(Or,{className:"w-3 h-3 fill-current"})," Premium"]}),s.isVerified&&a.jsxs("span",{className:"px-3 py-1 bg-green-500 text-white text-xs font-bold rounded-full flex items-center gap-1",children:[a.jsx(vT,{className:"w-3 h-3"})," Zweryfikowany"]})]}),a.jsxs("div",{className:"absolute bottom-4 left-4 right-4 text-white",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:s.name}),a.jsx("p",{className:"text-white/90",children:s.profession})]})]}),a.jsxs("div",{className:"p-4 flex flex-wrap gap-3",children:[a.jsx(wd,{icon:Or,value:s.rating>0?s.rating.toFixed(1):"Nowy",label:s.reviewsCount>0?`(${s.reviewsCount} opinii)`:"",color:"bg-yellow-50 text-yellow-700"}),s.completedServices>0&&a.jsx(wd,{icon:rg,value:s.completedServices,label:"usug",color:"bg-blue-50 text-blue-700"}),s.hasTravel&&a.jsx(wd,{icon:bz,value:`${s.travelRadius} km`,label:"dojazd",color:"bg-green-50 text-green-700"}),s.acceptsCard&&a.jsx(wd,{icon:og,value:"Karta",label:"",color:"bg-purple-50 text-purple-700"})]})]}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"O mnie"}),s.description?a.jsx("p",{className:"text-gray-600 whitespace-pre-line",children:s.description}):a.jsx("p",{className:"text-gray-400 italic",children:"Brak opisu"}),s.experience&&a.jsxs("p",{className:"mt-4 text-sm text-gray-500 flex items-center gap-2",children:[a.jsx(rg,{className:"w-4 h-4 text-primary"}),s.experience]}),s.features.length>0&&a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Udogodnienia"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:s.features.map((Q,G)=>a.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 text-sm rounded-full",children:Q},G))})]}),s.certifications.length>0&&a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Certyfikaty"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:s.certifications.map((Q,G)=>a.jsxs("span",{className:"px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full flex items-center gap-1",children:[a.jsx(Tt,{className:"w-3 h-3"})," ",Q]},G))})]})]}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"Usugi i cennik"}),R.length>1&&a.jsx("div",{className:"flex gap-2 mb-4 overflow-x-auto pb-2",children:R.map(Q=>a.jsx("button",{onClick:()=>k(Q),className:`px-4 py-2 rounded-xl text-sm font-medium whitespace-nowrap transition-colors ${M===Q?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:Q},Q))}),a.jsx("div",{className:"space-y-3",children:P.length>0?P.map(Q=>a.jsx(eM,{service:Q,isSelected:g.some(G=>G.id===Q.id),onToggle:()=>z(Q)},Q.id)):a.jsxs("div",{className:"text-center py-8",children:[a.jsx("p",{className:"text-gray-500 mb-2",children:"Brak usug"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Ten usugodawca nie doda jeszcze usug"})]})})]}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"Lokalizacja"}),a.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[a.jsx(Fa,{className:"w-5 h-5 text-primary mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:s.locationString}),s.location.address&&a.jsx("p",{className:"text-sm text-gray-500",children:s.location.address}),s.hasTravel&&a.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[" Dojazd do klienta (do ",s.travelRadius," km)"]})]})]}),a.jsx("div",{className:"h-48 bg-gray-100 rounded-xl flex items-center justify-center",children:a.jsx("p",{className:"text-gray-400",children:"Mapa lokalizacji"})})]}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"Godziny pracy"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:Object.entries(s.workingHours).map(([Q,G])=>a.jsxs("div",{className:`p-3 rounded-xl ${G.enabled?"bg-green-50":"bg-gray-100"}`,children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:re[Q]}),a.jsx("p",{className:`text-sm ${G.enabled?"text-green-700":"text-gray-500"}`,children:G.enabled?`${G.from} - ${G.to}`:"Zamknite"})]},Q))})]})]}),a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6 sticky top-20",children:[a.jsx("h3",{className:"text-lg font-bold mb-4",children:"Zarezerwuj wizyt"}),g.length>0?a.jsxs("div",{className:"mb-4 p-4 bg-primary/5 rounded-xl",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Wybrane usugi:"}),g.map(Q=>a.jsxs("div",{className:"flex justify-between text-sm py-1",children:[a.jsx("span",{children:Q.name}),a.jsxs("span",{className:"font-medium",children:[Q.price," z"]})]},Q.id)),a.jsxs("div",{className:"flex justify-between mt-2 pt-2 border-t border-primary/20",children:[a.jsx("span",{className:"font-bold",children:"Razem:"}),a.jsxs("span",{className:"font-bold text-primary",children:[A," z"]})]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Czas: ~",$," min"]})]}):a.jsx("p",{className:"text-sm text-gray-500 mb-4 p-4 bg-gray-50 rounded-xl",children:"Wybierz usugi z listy"}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Data"}),a.jsxs("span",{className:"text-sm text-gray-500",children:[N.month," ",N.year]})]}),a.jsxs("div",{className:"grid grid-cols-7 gap-1 text-center",children:[["Pn","Wt","r","Cz","Pt","So","Nd"].map(Q=>a.jsx("div",{className:"text-xs font-medium text-gray-400 py-1",children:Q},Q)),oe.slice(0,35).map((Q,G)=>a.jsx("button",{disabled:Q.disabled,onClick:()=>!Q.disabled&&T(Q.day),className:`aspect-square text-sm rounded-lg transition-colors ${Q.disabled?"opacity-30 cursor-not-allowed":w===Q.day?"bg-primary text-white":Q.isToday?"ring-2 ring-primary text-primary":"hover:bg-gray-100"}`,children:Q.day},G))]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Godzina"}),a.jsx("div",{className:"grid grid-cols-3 gap-2",children:ne.map(Q=>a.jsx("button",{disabled:Q.disabled,onClick:()=>!Q.disabled&&D(Q.time),className:`py-2 text-sm rounded-lg transition-colors ${Q.disabled?"opacity-30 cursor-not-allowed bg-gray-100":j===Q.time?"bg-primary text-white":"bg-gray-100 hover:bg-gray-200"}`,children:Q.time},Q.time))})]}),a.jsx("button",{onClick:H,disabled:g.length===0||f,className:`w-full py-3 rounded-xl font-bold transition-all flex items-center justify-center gap-2 ${g.length>0&&!f?"bg-gradient-to-r from-primary to-secondary text-white hover:shadow-lg hover:-translate-y-0.5":"bg-gray-200 text-gray-500 cursor-not-allowed"}`,children:f?a.jsxs(a.Fragment,{children:[a.jsx(At,{className:"w-5 h-5 animate-spin"}),"Rezerwuj..."]}):g.length>0?`Zarezerwuj za ${A} z`:"Wybierz usug"}),a.jsxs("button",{onClick:()=>{if(!r){n("Zaloguj si, aby napisa wiadomo","info"),e(`/auth?mode=login&redirect=/uslugodawcy/profil/${t}`);return}e(`/wiadomosci?providerId=${t}`)},className:"w-full mt-3 py-3 border-2 border-gray-200 rounded-xl font-medium text-gray-700 hover:border-primary hover:text-primary transition-colors flex items-center justify-center gap-2",children:[a.jsx(Sz,{className:"w-5 h-5"}),"Napisz wiadomo"]})]})})]})}),S&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsx("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-5xl mb-4",children:""}),a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Rezerwacja wysana!"}),a.jsxs("p",{className:"text-gray-600 mb-4",children:["Twoja proba o rezerwacj u ",a.jsx("strong",{children:s.name})," zostaa wysana. Czekaj na potwierdzenie od usugodawcy."]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 text-left mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-yellow-700 font-medium mb-2",children:[a.jsx(Si,{className:"w-4 h-4"}),"Oczekuje na potwierdzenie"]}),a.jsx("p",{className:"text-sm text-yellow-600",children:"Otrzymasz powiadomienie gdy usugodawca potwierdzi Twoj wizyt."})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 text-left mb-4",children:[a.jsxs("p",{className:"text-sm mb-1",children:[a.jsx("strong",{children:"Data:"})," ",w," ",N.month]}),a.jsxs("p",{className:"text-sm mb-1",children:[a.jsx("strong",{children:"Godzina:"})," ",j]}),a.jsxs("p",{className:"text-sm mb-1",children:[a.jsx("strong",{children:"Usugi:"})," ",g.map(Q=>Q.name).join(", ")]}),a.jsxs("p",{className:"text-sm",children:[a.jsx("strong",{children:"cznie:"})," ",A," z"]})]}),a.jsx("button",{onClick:()=>{C(!1),_([]),T(null),D(null),n("Rezerwacja wysana! Czekaj na potwierdzenie.","success")},className:"w-full py-3 bg-primary text-white rounded-xl font-medium hover:bg-primary/90",children:"OK, rozumiem"})]})})})]})},ha="conversations",bd="messages",Q0=()=>Date.now().toString(36)+Math.random().toString(36).substr(2,9),Lr={async getOrCreateConversation(t,e,n,r,s,o){try{const l=tn(Bt(Ce,ha),$t("participants","array-contains",t)),f=(await Xn(l)).docs.find(w=>w.data().participants.includes(r));if(f)return f.data();const m=Q0(),g=new Date().toISOString(),_={id:m,participants:[t,r],participantNames:{[t]:e,[r]:s},participantAvatars:{[t]:n||"",[r]:o||""},lastMessage:"",lastMessageAt:g,lastMessageSenderId:"",unreadCount:{[t]:0,[r]:0},createdAt:g};return await nl(at(Ce,ha,m),_),_}catch(l){throw console.error("getOrCreateConversation error:",l),l}},async getConversations(t){try{const e=tn(Bt(Ce,ha),$t("participants","array-contains",t));return(await Xn(e)).docs.map(s=>s.data()).sort((s,o)=>new Date(o.lastMessageAt).getTime()-new Date(s.lastMessageAt).getTime())}catch(e){return console.error("getConversations error:",e),[]}},subscribeToConversations(t,e){const n=tn(Bt(Ce,ha),$t("participants","array-contains",t));return Kc(n,r=>{const s=r.docs.map(o=>o.data());s.sort((o,l)=>new Date(l.lastMessageAt).getTime()-new Date(o.lastMessageAt).getTime()),e(s)})},async getMessages(t){try{const e=tn(Bt(Ce,bd),$t("conversationId","==",t));return(await Xn(e)).docs.map(s=>s.data()).sort((s,o)=>new Date(s.createdAt).getTime()-new Date(o.createdAt).getTime())}catch(e){return console.error("getMessages error:",e),[]}},subscribeToMessages(t,e){const n=tn(Bt(Ce,bd),$t("conversationId","==",t));return Kc(n,r=>{const s=r.docs.map(o=>o.data());s.sort((o,l)=>new Date(o.createdAt).getTime()-new Date(l.createdAt).getTime()),e(s)})},async sendMessage(t,e,n,r,s,o){try{const l=Q0(),h=new Date().toISOString(),f={id:l,conversationId:t,senderId:e,senderName:n,senderAvatar:r||"",text:s,createdAt:h,read:!1};await nl(at(Ce,bd,l),f);const m=at(Ce,ha,t),g=await tl(m);if(g.exists()){const w={...g.data().unreadCount};w[o]=(w[o]||0)+1,await ws(m,{lastMessage:s,lastMessageAt:h,lastMessageSenderId:e,unreadCount:w})}return f}catch(l){throw console.error("sendMessage error:",l),l}},async markAsRead(t,e){try{const n=tn(Bt(Ce,bd),$t("conversationId","==",t)),s=(await Xn(n)).docs.filter(h=>{const f=h.data();return f.senderId!==e&&!f.read}).map(h=>ws(h.ref,{read:!0}));await Promise.all(s);const o=at(Ce,ha,t),l=await tl(o);if(l.exists()){const f={...l.data().unreadCount};f[e]=0,await ws(o,{unreadCount:f})}}catch(n){console.error("markAsRead error:",n)}},async countUnread(t){try{return(await this.getConversations(t)).reduce((n,r)=>n+(r.unreadCount[t]||0),0)}catch(e){return console.error("countUnread error:",e),0}},subscribeToUnreadCount(t,e){return this.subscribeToConversations(t,n=>{const r=n.reduce((s,o)=>s+(o.unreadCount[t]||0),0);e(r)})}},nM=()=>{const{user:t}=sn(),e=vr(),[n]=N1(),[r,s]=O.useState([]),[o,l]=O.useState(null),[h,f]=O.useState([]),[m,g]=O.useState(""),[_,w]=O.useState(""),[T,j]=O.useState(!0),[D,M]=O.useState(!1),k=O.useRef(null);O.useEffect(()=>{(async()=>{const E=n.get("providerId");if(!(!E||!(t!=null&&t.id)))try{const N=await tr.getById(E);if(!N)return;const R=await Lr.getOrCreateConversation(t.id,t.username||"Uytkownik",t.avatar||"",N.ownerId,N.name,N.image||"");l(R)}catch(N){console.error("Error initializing conversation:",N)}})()},[n,t]),O.useEffect(()=>{if(!(t!=null&&t.id)){j(!1);return}const V=Lr.subscribeToConversations(t.id,E=>{s(E),j(!1)});return()=>V()},[t==null?void 0:t.id]),O.useEffect(()=>{if(!o||!(t!=null&&t.id))return;Lr.markAsRead(o.id,t.id);const V=Lr.subscribeToMessages(o.id,E=>{f(E)});return()=>V()},[o,t==null?void 0:t.id]),O.useEffect(()=>{var V;(V=k.current)==null||V.scrollIntoView({behavior:"smooth"})},[h]);const S=async()=>{if(!(!m.trim()||!o||!(t!=null&&t.id))){M(!0);try{const V=o.participants.find(E=>E!==t.id)||"";await Lr.sendMessage(o.id,t.id,t.username||"Uytkownik",t.avatar||"",m.trim(),V),g("")}catch(V){console.error("Error sending message:",V)}finally{M(!1)}}},C=V=>{if(!(t!=null&&t.id))return{name:"Nieznany",avatar:""};const E=V.participants.find(N=>N!==t.id)||"";return{name:V.participantNames[E]||"Nieznany",avatar:V.participantAvatars[E]||""}},U=V=>{const E=new Date(V),R=new Date().getTime()-E.getTime(),P=Math.floor(R/6e4),A=Math.floor(R/36e5),$=Math.floor(R/864e5);return P<1?"Teraz":P<60?`${P} min`:A<24?`${A}h`:$<7?`${$}d`:E.toLocaleDateString("pl-PL")},F=r.filter(V=>C(V).name.toLowerCase().includes(_.toLowerCase()));return t?T?a.jsx("div",{className:"min-h-screen pt-24 pb-12 flex items-center justify-center",children:a.jsx(At,{className:"w-12 h-12 animate-spin text-primary"})}):a.jsx("div",{className:"min-h-screen pt-20 pb-0",children:a.jsx("div",{className:"max-w-6xl mx-auto px-6",children:a.jsxs("div",{className:"h-[calc(100vh-120px)] flex bg-white rounded-2xl shadow-lg overflow-hidden",children:[a.jsxs("div",{className:`w-full md:w-80 lg:w-96 border-r border-gray-100 flex flex-col ${o?"hidden md:flex":""}`,children:[a.jsxs("div",{className:"p-4 border-b border-gray-100",children:[a.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-3",children:"Wiadomoci"}),a.jsxs("div",{className:"relative",children:[a.jsx(kf,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Szukaj...",value:_,onChange:V=>w(V.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:F.length===0?a.jsxs("div",{className:"p-8 text-center text-gray-500",children:[a.jsx(bs,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{children:"Brak wiadomoci"}),a.jsx("p",{className:"text-sm mt-1",children:"Napisz do usugodawcy ze strony jego profilu"})]}):F.map(V=>{const E=C(V),N=t!=null&&t.id&&V.unreadCount[t.id]||0;return a.jsx("div",{onClick:()=>l(V),className:`p-4 border-b border-gray-50 cursor-pointer transition-colors ${(o==null?void 0:o.id)===V.id?"bg-primary/10":"hover:bg-gray-50"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"relative",children:[E.avatar?a.jsx("img",{src:E.avatar,alt:E.name,className:"w-12 h-12 rounded-full object-cover"}):a.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-r from-primary to-secondary flex items-center justify-center text-white font-bold",children:E.name.charAt(0).toUpperCase()}),N>0&&a.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center text-white text-xs font-bold",children:N})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"font-medium text-gray-900",children:E.name}),a.jsx("span",{className:"text-xs text-gray-500",children:U(V.lastMessageAt)})]}),a.jsx("p",{className:`text-sm truncate ${N>0?"font-medium text-gray-900":"text-gray-500"}`,children:V.lastMessage||"Brak wiadomoci"})]})]})},V.id)})})]}),o?a.jsxs("div",{className:"flex-1 flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-center gap-3",children:[a.jsx("button",{onClick:()=>l(null),className:"md:hidden p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(Qc,{className:"w-5 h-5"})}),(()=>{const V=C(o);return a.jsxs(a.Fragment,{children:[V.avatar?a.jsx("img",{src:V.avatar,alt:V.name,className:"w-10 h-10 rounded-full object-cover"}):a.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-primary to-secondary flex items-center justify-center text-white font-bold",children:V.name.charAt(0).toUpperCase()}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:V.name}),a.jsx("div",{className:"text-xs text-gray-500",children:"Usugodawca"})]})]})})()]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:[h.length===0?a.jsxs("div",{className:"text-center text-gray-500 py-8",children:[a.jsx("p",{children:"Rozpocznij rozmow"}),a.jsx("p",{className:"text-sm",children:"Napisz do usugodawcy"})]}):h.map(V=>{const E=V.senderId===(t==null?void 0:t.id);return a.jsx("div",{className:`flex ${E?"justify-end":"justify-start"}`,children:a.jsxs("div",{className:`max-w-[70%] rounded-2xl px-4 py-2 ${E?"bg-gradient-to-r from-primary to-secondary text-white":"bg-white text-gray-900 shadow-sm"}`,children:[a.jsx("p",{children:V.text}),a.jsx("div",{className:`text-xs mt-1 ${E?"text-white/70":"text-gray-400"}`,children:U(V.createdAt)})]})},V.id)}),a.jsx("div",{ref:k})]}),a.jsx("div",{className:"p-4 border-t border-gray-100 bg-white",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"text",value:m,onChange:V=>g(V.target.value),onKeyPress:V=>V.key==="Enter"&&S(),placeholder:"Napisz wiadomo...",className:"flex-1 px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-primary focus:border-primary"}),a.jsx("button",{onClick:S,disabled:!m.trim()||D,className:"p-3 bg-gradient-to-r from-primary to-secondary text-white rounded-xl hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",children:D?a.jsx(At,{className:"w-5 h-5 animate-spin"}):a.jsx(_T,{className:"w-5 h-5"})})]})})]}):a.jsx("div",{className:"hidden md:flex flex-1 items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center text-gray-500",children:[a.jsx(bs,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),a.jsx("p",{className:"text-lg",children:"Wybierz konwersacj"}),a.jsx("p",{className:"text-sm",children:"lub napisz do usugodawcy z jego profilu"})]})})]})})}):a.jsx("div",{className:"min-h-screen pt-24 pb-12",children:a.jsx("div",{className:"max-w-4xl mx-auto px-6",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 text-center",children:[a.jsx(bs,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Zaloguj si"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Musisz by zalogowany, aby korzysta z wiadomoci"}),a.jsx("button",{onClick:()=>e("/auth?mode=login"),className:"px-6 py-3 bg-gradient-to-r from-primary to-secondary text-white rounded-xl font-semibold",children:"Zaloguj si"})]})})})},rM=()=>{const{user:t}=sn(),{showToast:e}=xr(),n=vr(),[r,s]=O.useState([]),[o,l]=O.useState(!0),[h,f]=O.useState("all"),[m,g]=O.useState("all");O.useEffect(()=>{if(!t||!t.id){console.log("NotificationsPage: No user or user.id"),l(!1);return}console.log("NotificationsPage: Subscribing for user",t.id);const F=wn.subscribe(t.id,V=>{console.log("NotificationsPage: Got notifications",V.length),s(V),l(!1)});return()=>F()},[t]);const _=async F=>{try{await wn.markAsRead(F)}catch{e("Bd oznaczania jako przeczytane","error")}},w=async()=>{if(!(!t||!t.id))try{await wn.markAllAsRead(t.id),e("Wszystkie oznaczone jako przeczytane","success")}catch{e("Bd oznaczania powiadomie","error")}},T=async F=>{try{await wn.delete(F),e("Powiadomienie usunite","success")}catch{e("Bd usuwania powiadomienia","error")}},j=async()=>{if(!(!t||!t.id)&&confirm("Czy na pewno chcesz usun wszystkie powiadomienia?"))try{await wn.deleteAllByUser(t.id),e("Wszystkie powiadomienia usunite","success")}catch{e("Bd usuwania powiadomie","error")}},D=F=>{var V,E;_(F.id),(V=F.data)!=null&&V.bookingId?n("/profil"):F.type==="new_message"?n("/wiadomosci"):F.type==="new_review"&&((E=F.data)!=null&&E.providerId)&&n(`/uslugodawcy/profil/${F.data.providerId}`)},M=F=>{switch(F){case"booking_request":case"booking_confirmed":case"booking_cancelled":case"booking_completed":case"booking_reminder":return a.jsx(Mr,{className:"w-5 h-5"});case"new_message":return a.jsx(bs,{className:"w-5 h-5"});case"new_review":return a.jsx(Or,{className:"w-5 h-5"});default:return a.jsx(_i,{className:"w-5 h-5"})}},k=F=>{switch(F){case"booking_request":return"bg-blue-100 text-blue-600";case"booking_confirmed":return"bg-green-100 text-green-600";case"booking_cancelled":return"bg-red-100 text-red-600";case"booking_completed":return"bg-purple-100 text-purple-600";case"booking_reminder":return"bg-yellow-100 text-yellow-600";case"new_message":return"bg-indigo-100 text-indigo-600";case"new_review":return"bg-amber-100 text-amber-600";default:return"bg-gray-100 text-gray-600"}},S=F=>{const V=new Date(F),N=new Date().getTime()-V.getTime(),R=Math.floor(N/6e4),P=Math.floor(N/36e5),A=Math.floor(N/864e5);return R<1?"Teraz":R<60?`${R} min temu`:P<24?`${P}h temu`:A===1?"Wczoraj":A<7?`${A} dni temu`:V.toLocaleDateString("pl-PL")},C=r.filter(F=>!(h==="unread"&&F.read||m!=="all"&&(m==="booking"&&!F.type.startsWith("booking")||m==="message"&&F.type!=="new_message"||m==="system"&&F.type!=="system"))),U=r.filter(F=>!F.read).length;return o?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsx(At,{className:"w-8 h-8 animate-spin text-primary"})}):t?a.jsx("div",{className:"min-h-screen bg-gray-50 pt-8 pb-16",children:a.jsxs("div",{className:"max-w-3xl mx-auto px-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Powiadomienia"}),a.jsx("p",{className:"text-gray-600",children:U>0?`${U} nieprzeczytanych`:"Wszystkie przeczytane"})]}),a.jsx("div",{className:"flex items-center gap-2",children:U>0&&a.jsxs("button",{onClick:w,className:"px-4 py-2 text-sm font-medium text-primary hover:bg-primary/10 rounded-lg transition-colors",children:[a.jsx(Tt,{className:"w-4 h-4 inline mr-1"}),"Przeczytaj wszystkie"]})})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 mb-6",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[a.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[a.jsx("button",{onClick:()=>f("all"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-colors ${h==="all"?"bg-white shadow text-gray-900":"text-gray-600"}`,children:"Wszystkie"}),a.jsxs("button",{onClick:()=>f("unread"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-colors ${h==="unread"?"bg-white shadow text-gray-900":"text-gray-600"}`,children:["Nieprzeczytane (",U,")"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(y_,{className:"w-4 h-4 text-gray-400"}),a.jsxs("select",{value:m,onChange:F=>g(F.target.value),className:"bg-transparent text-sm text-gray-600 focus:outline-none cursor-pointer",children:[a.jsx("option",{value:"all",children:"Wszystkie typy"}),a.jsx("option",{value:"booking",children:"Rezerwacje"}),a.jsx("option",{value:"message",children:"Wiadomoci"}),a.jsx("option",{value:"system",children:"Systemowe"})]})]}),r.length>0&&a.jsx("button",{onClick:j,className:"ml-auto text-sm text-red-500 hover:text-red-600",children:"Usu wszystkie"})]})}),a.jsx("div",{className:"space-y-3",children:C.length===0?a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center",children:[a.jsx(_i,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Brak powiadomie"}),a.jsx("p",{className:"text-gray-500",children:h==="unread"?"Wszystkie powiadomienia zostay przeczytane":"Nie masz jeszcze adnych powiadomie"})]}):C.map(F=>a.jsxs("div",{className:`bg-white rounded-xl shadow-sm p-4 flex items-start gap-4 transition-all hover:shadow-md cursor-pointer ${F.read?"":"border-l-4 border-primary"}`,onClick:()=>D(F),children:[a.jsx("div",{className:`p-3 rounded-xl ${k(F.type)}`,children:M(F.type)}),a.jsx("div",{className:"flex-1 min-w-0",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:`font-semibold ${F.read?"text-gray-700":"text-gray-900"}`,children:[wn.getIcon(F.type)," ",F.title]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:F.message}),a.jsx("p",{className:"text-xs text-gray-400 mt-2",children:S(F.createdAt)})]}),a.jsxs("div",{className:"flex items-center gap-1 ml-4",onClick:V=>V.stopPropagation(),children:[!F.read&&a.jsx("button",{onClick:()=>_(F.id),className:"p-1.5 hover:bg-gray-100 rounded-lg transition-colors",title:"Oznacz jako przeczytane",children:a.jsx(Tt,{className:"w-4 h-4 text-gray-400"})}),a.jsx("button",{onClick:()=>T(F.id),className:"p-1.5 hover:bg-red-50 rounded-lg transition-colors",title:"Usu",children:a.jsx(Sf,{className:"w-4 h-4 text-gray-400 hover:text-red-500"})})]})]})})]},F.id))})]})}):a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(_i,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Zaloguj si"}),a.jsx("p",{className:"text-gray-500 mb-4",children:"Zaloguj si, aby zobaczy powiadomienia"}),a.jsx(ke,{to:"/auth",className:"text-primary hover:underline",children:"Przejd do logowania"})]})})},sM=()=>{var l;const[t,e]=O.useState(!1),[n,r]=O.useState(!1),{user:s,logout:o}=sn();return a.jsxs("header",{className:"sticky top-0 z-50 bg-white border-b border-gray-200 shadow-sm",children:[a.jsx("div",{className:"px-4 lg:px-8",children:a.jsxs("div",{className:"h-16 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{className:"lg:hidden p-2 bg-white rounded-lg border border-gray-200 hover:bg-gray-50",onClick:()=>e(!t),style:{backgroundColor:"white"},children:t?a.jsx(Po,{className:"w-5 h-5 text-gray-700"}):a.jsx(kz,{className:"w-5 h-5 text-gray-700"})}),a.jsxs(ke,{to:"/biznes",className:"flex items-center gap-2",children:[a.jsx("div",{className:"h-10 w-10 bg-gradient-to-r from-emerald-500 to-teal-600 rounded-xl flex items-center justify-center",children:a.jsx("span",{className:"text-white font-bold text-sm",children:"T"})}),a.jsxs("div",{className:"hidden sm:block",children:[a.jsx("span",{className:"font-extrabold text-lg text-gray-900",children:"TOMYHOMEAPP"}),a.jsx("span",{className:"ml-2 px-2 py-0.5 bg-emerald-100 text-emerald-700 text-xs font-bold rounded-full",children:"BIZNES"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs(ke,{to:"/",className:"flex items-center gap-2 px-3 py-1.5 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors border border-gray-200",children:[a.jsx("span",{className:"hidden sm:inline",children:"Widok klienta"}),a.jsx("span",{className:"sm:hidden",children:""}),a.jsx("span",{children:""})]}),a.jsxs("button",{className:"relative p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:[a.jsx(_i,{className:"w-5 h-5"}),a.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>r(!n),className:"flex items-center gap-2 p-2 hover:bg-gray-100 rounded-lg transition-colors",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-emerald-500 to-teal-600 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white font-bold text-sm",children:((l=s==null?void 0:s.username)==null?void 0:l.charAt(0).toUpperCase())||"U"})}),a.jsx("span",{className:"hidden md:block text-sm font-medium text-gray-700",children:(s==null?void 0:s.username)||"Uytkownik"})]}),n&&a.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg border border-gray-100 py-2 z-50",children:[a.jsxs(ke,{to:"/biznes/profil",className:"flex items-center gap-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",onClick:()=>r(!1),children:[a.jsx(Pi,{className:"w-4 h-4"}),"Mj profil"]}),a.jsxs(ke,{to:"/biznes/ustawienia",className:"flex items-center gap-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",onClick:()=>r(!1),children:[a.jsx(v_,{className:"w-4 h-4"}),"Ustawienia"]}),a.jsx("hr",{className:"my-2"}),a.jsxs("button",{onClick:()=>{o(),r(!1)},className:"flex items-center gap-2 px-4 py-2 text-sm text-red-600 hover:bg-red-50 w-full text-left",children:[a.jsx(zh,{className:"w-4 h-4"}),"Wyloguj si"]})]})]})]})]})}),t&&a.jsx("div",{className:"lg:hidden fixed inset-0 bg-black/50 z-40",onClick:()=>e(!1)})]})},iM=({isOpen:t=!0,onClose:e})=>{const n=Li(),r=[{icon:jz,label:"Dashboard",to:"/biznes",exact:!0},{icon:sg,label:"Moje usugi",to:"/biznes/uslugi"},{icon:Az,label:"Dodaj usug",to:"/biznes/dodaj-usluge"},{icon:Mr,label:"Kalendarz",to:"/biznes/kalendarz"},{icon:bs,label:"Wiadomoci",to:"/biznes/wiadomosci",badge:3},{icon:mT,label:"Statystyki",to:"/biznes/statystyki"}],s=[{icon:v_,label:"Ustawienia",to:"/biznes/ustawienia"},{icon:yT,label:"Pomoc",to:"/biznes/pomoc"}],o=(l,h=!1)=>h?n.pathname===l:n.pathname.startsWith(l);return a.jsxs(a.Fragment,{children:[t&&a.jsx("div",{className:"lg:hidden fixed inset-0 bg-black/50 z-40",onClick:e}),a.jsx("aside",{className:`
          fixed lg:sticky top-16 left-0 z-40
          w-64 h-[calc(100vh-64px)] bg-white border-r border-gray-200
          transform transition-transform duration-300 ease-in-out
          lg:translate-x-0
          ${t?"translate-x-0":"-translate-x-full"}
        `,children:a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto",children:[a.jsx("div",{className:"mb-4",children:a.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider px-3",children:"Menu gwne"})}),r.map(l=>a.jsxs(ke,{to:l.to,onClick:e,className:`
                  flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium
                  transition-all duration-200
                  ${o(l.to,l.exact)?"bg-gradient-to-r from-emerald-500 to-teal-600 text-white shadow-md":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"}
                `,children:[a.jsx(l.icon,{className:"w-5 h-5"}),a.jsx("span",{className:"flex-1",children:l.label}),l.badge&&a.jsx("span",{className:`
                    px-2 py-0.5 text-xs font-bold rounded-full
                    ${o(l.to,l.exact)?"bg-white/20 text-white":"bg-red-100 text-red-600"}
                  `,children:l.badge})]},l.to))]}),a.jsx("div",{className:"p-4 border-t border-gray-100",children:s.map(l=>a.jsxs(ke,{to:l.to,onClick:e,className:`
                  flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium
                  transition-all duration-200
                  ${o(l.to)?"bg-gray-100 text-gray-900":"text-gray-500 hover:bg-gray-50 hover:text-gray-700"}
                `,children:[a.jsx(l.icon,{className:"w-5 h-5"}),a.jsx("span",{children:l.label})]},l.to))}),a.jsx("div",{className:"p-4",children:a.jsxs("div",{className:"p-4 bg-gradient-to-r from-emerald-500 to-teal-600 rounded-xl text-white",children:[a.jsx("h4",{className:"font-bold mb-1",children:"Przejd na PRO"}),a.jsx("p",{className:"text-xs text-white/80 mb-3",children:"Odblokuj wszystkie funkcje i zwiksz widoczno"}),a.jsx("button",{className:"w-full py-2 bg-white text-emerald-600 rounded-lg text-sm font-semibold hover:bg-gray-50 transition-colors",children:"Sprawd ofert"})]})})]})})]})},oM=()=>{const{isAuthenticated:t,user:e}=sn(),[n,r]=O.useState(!1),s=(e==null?void 0:e.accountType)==="provider"||!!(e!=null&&e.businessName);return t?s?a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx(sM,{}),a.jsxs("div",{className:"flex",children:[a.jsx(iM,{isOpen:n,onClose:()=>r(!1)}),a.jsx("main",{className:"flex-1 min-h-[calc(100vh-64px)] p-4 lg:p-8",children:a.jsx(CS,{})})]})]}):a.jsx(ix,{to:"/",replace:!0}):a.jsx(ix,{to:"/auth?redirect=/biznes",replace:!0})},Y0=()=>{const{user:t}=sn(),{showToast:e}=xr(),[n,r]=O.useState({totalBookings:0,pendingBookings:0,completedBookings:0,revenue:0,thisMonthRevenue:0,rating:0,reviewsCount:0}),[s,o]=O.useState([]),[l,h]=O.useState(!1),[f,m]=O.useState(!0);O.useEffect(()=>{(async()=>{if(!t||!t.id){console.log("BusinessDashboard: No user or user.id"),m(!1);return}console.log("BusinessDashboard: Loading for user",t.id);try{const D=await tr.getByOwner(t.id);if(console.log("BusinessDashboard: Found providers",D.length),D.length>0){h(!0);const M=D[0],k=await Jn.getProviderStats(M.id);r({totalBookings:k.totalBookings,pendingBookings:k.pendingBookings,completedBookings:k.completedBookings,revenue:k.totalRevenue,thisMonthRevenue:k.thisMonthRevenue,rating:M.rating||0,reviewsCount:M.reviewsCount||0});const S=Jn.subscribeToProviderBookings(M.id,C=>{const U=C.filter(F=>F.status==="pending"||F.status==="confirmed").slice(0,5);o(U)});return()=>S()}else h(!1)}catch(D){console.error("Bd adowania danych:",D)}finally{m(!1)}})()},[t]);const g=async j=>{try{await Jn.confirm(j),e("Rezerwacja potwierdzona! ","success")}catch{e("Bd potwierdzania rezerwacji","error")}},_=async j=>{try{await Jn.cancel(j,"provider"),e("Rezerwacja anulowana","info")}catch{e("Bd anulowania rezerwacji","error")}},w=[{title:"Rezerwacje",value:n.totalBookings,subtitle:`${n.pendingBookings} oczekuje`,icon:Mr,color:"emerald"},{title:"Przychd",value:`${n.revenue} z`,subtitle:`${n.thisMonthRevenue} z ten miesic`,icon:Yc,color:"blue"},{title:"Ukoczone",value:n.completedBookings,subtitle:"wizyt",icon:Tt,color:"purple"},{title:"Ocena",value:n.rating>0?n.rating.toFixed(1):"-",subtitle:n.reviewsCount>0?`${n.reviewsCount} opinii`:"brak opinii",icon:Or,color:"amber"}],T=j=>{switch(j){case"confirmed":return a.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:"Potwierdzona"});case"pending":return a.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-700 text-xs font-medium rounded-full",children:"Oczekuje"});case"completed":return a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-full",children:"Zakoczona"});default:return null}};return f?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(At,{className:"w-12 h-12 animate-spin text-emerald-500"})}):l?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Witaj, ",(t==null?void 0:t.username)||"Uytkowniku","! "]}),a.jsx("p",{className:"text-gray-600",children:"Oto przegld Twojego biznesu"})]}),a.jsxs(ke,{to:"/biznes/dodaj-usluge",className:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all",children:[a.jsx(ys,{className:"w-5 h-5"}),"Dodaj usug"]})]}),a.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-4",children:w.map((j,D)=>a.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm",children:[a.jsx("div",{className:"flex items-start justify-between mb-3",children:a.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center bg-${j.color}-100`,children:a.jsx(j.icon,{className:`w-5 h-5 text-${j.color}-600`})})}),a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:j.value}),a.jsx("div",{className:"text-sm text-gray-500",children:j.subtitle})]},D))}),a.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"lg:col-span-2 bg-white rounded-xl shadow-sm",children:[a.jsx("div",{className:"p-5 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Nadchodzce rezerwacje"}),a.jsx(ke,{to:"/biznes/kalendarz",className:"text-sm text-emerald-600 hover:text-emerald-700 font-medium",children:"Zobacz wszystkie "})]})}),a.jsxs("div",{className:"divide-y divide-gray-100",children:[s.map(j=>a.jsxs("div",{className:"p-5 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-emerald-500 to-teal-600 rounded-full flex items-center justify-center text-white font-bold text-sm",children:j.clientName.charAt(0)}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:j.clientName}),a.jsx("div",{className:"text-sm text-gray-500",children:j.serviceName})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-sm text-gray-600",children:j.date}),a.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[a.jsx(Si,{className:"w-3 h-3"}),j.time]})]}),j.status==="pending"&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>g(j.id),className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors",title:"Potwierd",children:a.jsx(Tt,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>_(j.id),className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors",title:"Anuluj",children:a.jsx(Po,{className:"w-4 h-4"})})]}),j.status==="confirmed"&&T(j.status)]})]},j.id)),s.length===0&&a.jsxs("div",{className:"p-8 text-center text-gray-500",children:[a.jsx(Mr,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{children:"Brak nadchodzcych rezerwacji"}),a.jsx("p",{className:"text-sm mt-1",children:"Rezerwacje pojawi si tutaj, gdy klienci je zo"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-5",children:[a.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"Szybkie akcje"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(ke,{to:"/biznes/uslugi",className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 text-emerald-600 rounded-lg flex items-center justify-center",children:a.jsx(Gr,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:"Zobacz swj profil"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Tak widz Ci klienci"})]})]}),a.jsxs(ke,{to:"/biznes/kalendarz",className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center",children:a.jsx(Mr,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:"Zarzdzaj kalendarzem"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Dostpno i godziny"})]})]}),a.jsxs(ke,{to:"/biznes/statystyki",className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 text-purple-600 rounded-lg flex items-center justify-center",children:a.jsx(xT,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:"Zobacz statystyki"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Analizuj swj biznes"})]})]})]})]})]})]}):a.jsxs("div",{className:"max-w-2xl mx-auto text-center py-16",children:[a.jsx("div",{className:"w-24 h-24 bg-gradient-to-r from-emerald-500 to-teal-600 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx(ys,{className:"w-12 h-12 text-white"})}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Witaj w ToMyHomeApp Biznes!"}),a.jsx("p",{className:"text-gray-600 mb-8 max-w-md mx-auto",children:"Nie masz jeszcze profilu usugodawcy. Dodaj swoj pierwsz usug, aby zacz przyjmowa rezerwacje od klientw."}),a.jsxs(ke,{to:"/biznes/dodaj-usluge",className:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all",children:[a.jsx(ys,{className:"w-5 h-5"}),"Dodaj pierwsz usug"]}),a.jsxs("div",{className:"mt-12 grid md:grid-cols-3 gap-6 text-left",children:[a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 text-emerald-600 rounded-lg flex items-center justify-center mb-4",children:a.jsx(ys,{className:"w-5 h-5"})}),a.jsx("h3",{className:"font-bold mb-2",children:"1. Dodaj usug"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Opisz swoj usug, ustal ceny i godziny pracy"})]}),a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center mb-4",children:a.jsx(Gr,{className:"w-5 h-5"})}),a.jsx("h3",{className:"font-bold mb-2",children:"2. Bd widoczny"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Klienci znajd Ci w wyszukiwarce usug"})]}),a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 text-purple-600 rounded-lg flex items-center justify-center mb-4",children:a.jsx(Mr,{className:"w-5 h-5"})}),a.jsx("h3",{className:"font-bold mb-2",children:"3. Przyjmuj rezerwacje"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Zarzdzaj kalendarzem i rozwijaj biznes"})]})]})]})},aM=()=>{const{user:t}=sn(),{showToast:e}=xr(),[n,r]=O.useState(null),[s,o]=O.useState(null),[l,h]=O.useState(!0),[f,m]=O.useState("");O.useEffect(()=>{g()},[t]);const g=async()=>{if(!(t!=null&&t.id)){h(!1);return}h(!0);try{const j=await tr.getByOwner(t.id.toString());if(j.length>0){const D=j[0],M=D.services.map(k=>({id:k.id,name:k.name,description:k.description||"",price:k.price||0,duration:k.duration||"30 min",isActive:!0,category:k.category||"Inne"}));o(D.id),r({id:D.id,name:D.name,profession:D.profession||"",location:D.locationString||"",image:D.image||"",services:M,isActive:D.isActive})}}catch(j){console.error("Bd adowania profilu z Firebase:",j),e("Bd adowania danych","error")}finally{h(!1)}},_=async j=>{if(!n||!s)return;const D=n.services.map(M=>M.id===j?{...M,isActive:!M.isActive}:M);r({...n,services:D});try{await tr.update(s,{services:D.map(M=>({id:M.id,name:M.name,description:M.description,price:M.price,duration:M.duration,category:M.category}))}),e("Status usugi zmieniony","success")}catch(M){console.error("Bd aktualizacji:",M),e("Bd aktualizacji","error"),g()}},w=async j=>{if(!n||!s)return;const D=n.services.filter(M=>M.id!==j);r({...n,services:D});try{await tr.removeService(s,j),e("Usuga usunita","info")}catch(M){console.error("Bd usuwania:",M),e("Bd usuwania usugi","error"),g()}},T=(n==null?void 0:n.services.filter(j=>j.name.toLowerCase().includes(f.toLowerCase())))||[];return l?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500"})}):n?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Moje usugi"}),a.jsx("p",{className:"text-gray-600",children:"Zarzdzaj swoimi usugami i cenami"})]}),a.jsxs(ke,{to:"/biznes/dodaj-usluge",className:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all",children:[a.jsx(ys,{className:"w-5 h-5"}),"Dodaj usug"]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("img",{src:n.image||"https://via.placeholder.com/80",alt:n.name,className:"w-20 h-20 rounded-xl object-cover"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900",children:n.name}),a.jsx("p",{className:"text-gray-500",children:n.profession}),a.jsx("p",{className:"text-sm text-gray-400 mt-1",children:n.location})]}),a.jsxs(ke,{to:`/uslugodawcy/profil/${n.id}`,target:"_blank",className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium",children:[a.jsx(Gr,{className:"w-4 h-4"}),"Podgld profilu"]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(kf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Szukaj usugi...",value:f,onChange:j=>m(j.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),a.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[a.jsx(y_,{className:"w-5 h-5"}),"Filtruj"]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[a.jsx("div",{className:"p-4 border-b border-gray-100",children:a.jsxs("h3",{className:"font-semibold text-gray-900",children:["Wszystkie usugi (",T.length,")"]})}),T.length===0?a.jsx("div",{className:"p-8 text-center text-gray-500",children:f?"Nie znaleziono usug":"Brak usug"}):a.jsx("div",{className:"divide-y divide-gray-100",children:T.map(j=>a.jsxs("div",{className:`p-4 flex items-center justify-between hover:bg-gray-50 transition-colors ${j.isActive?"":"opacity-60"}`,children:[a.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[a.jsx("button",{onClick:()=>_(j.id),className:`p-1 rounded transition-colors ${j.isActive?"text-emerald-500":"text-gray-400"}`,title:j.isActive?"Aktywna":"Nieaktywna",children:j.isActive?a.jsx(zz,{className:"w-8 h-8"}):a.jsx(Dz,{className:"w-8 h-8"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:j.name}),a.jsx("p",{className:"text-sm text-gray-500 line-clamp-1",children:j.description||"Brak opisu"})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"text-right mr-4",children:[a.jsxs("div",{className:"flex items-center gap-1 text-gray-900 font-semibold",children:[a.jsx(Yc,{className:"w-4 h-4"}),j.price," z"]}),a.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[a.jsx(Si,{className:"w-3 h-3"}),j.duration]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>{e("Funkcja edycji w przygotowaniu","info")},className:"p-2 text-gray-500 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition-colors",title:"Edytuj",children:a.jsx(Iz,{className:"w-5 h-5"})}),a.jsx("button",{onClick:()=>{window.confirm("Czy na pewno chcesz usun t usug?")&&w(j.id)},className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Usu",children:a.jsx(Sf,{className:"w-5 h-5"})})]})]})]},j.id))})]})]}):a.jsxs("div",{className:"max-w-2xl mx-auto text-center py-16",children:[a.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx(ys,{className:"w-10 h-10 text-gray-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Nie masz jeszcze usug"}),a.jsx("p",{className:"text-gray-600 mb-8",children:"Dodaj swoj pierwsz usug, aby klienci mogli j znale i zarezerwowa."}),a.jsxs(ke,{to:"/biznes/dodaj-usluge",className:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all",children:[a.jsx(ys,{className:"w-5 h-5"}),"Dodaj pierwsz usug"]})]})};function lM(t,e){const n=O.useRef(e);O.useEffect(function(){e!==n.current&&t.attributionControl!=null&&(n.current!=null&&t.attributionControl.removeAttribution(n.current),e!=null&&t.attributionControl.addAttribution(e)),n.current=e},[t,e])}const cM=1;function uM(t){return Object.freeze({__version:cM,map:t})}function dM(t,e){return Object.freeze({...t,...e})}const NT=O.createContext(null),ET=NT.Provider;function TT(){const t=O.useContext(NT);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function hM(t){function e(n,r){const{instance:s,context:o}=t(n).current;return O.useImperativeHandle(r,()=>s),n.children==null?null:xc.createElement(ET,{value:o},n.children)}return O.forwardRef(e)}function fM(t){function e(n,r){const{instance:s}=t(n).current;return O.useImperativeHandle(r,()=>s),null}return O.forwardRef(e)}function mM(t,e){const n=O.useRef();O.useEffect(function(){return e!=null&&t.instance.on(e),n.current=e,function(){n.current!=null&&t.instance.off(n.current),n.current=null}},[t,e])}function jT(t,e){const n=t.pane??e.pane;return n?{...t,pane:n}:t}var dg={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(t,e){(function(n,r){r(e)})(dj,function(n){var r="1.9.4";function s(i){var c,d,p,v;for(d=1,p=arguments.length;d<p;d++){v=arguments[d];for(c in v)i[c]=v[c]}return i}var o=Object.create||function(){function i(){}return function(c){return i.prototype=c,new i}}();function l(i,c){var d=Array.prototype.slice;if(i.bind)return i.bind.apply(i,d.call(arguments,1));var p=d.call(arguments,2);return function(){return i.apply(c,p.length?p.concat(d.call(arguments)):arguments)}}var h=0;function f(i){return"_leaflet_id"in i||(i._leaflet_id=++h),i._leaflet_id}function m(i,c,d){var p,v,b,B;return B=function(){p=!1,v&&(b.apply(d,v),v=!1)},b=function(){p?v=arguments:(i.apply(d,arguments),setTimeout(B,c),p=!0)},b}function g(i,c,d){var p=c[1],v=c[0],b=p-v;return i===p&&d?i:((i-v)%b+b)%b+v}function _(){return!1}function w(i,c){if(c===!1)return i;var d=Math.pow(10,c===void 0?6:c);return Math.round(i*d)/d}function T(i){return i.trim?i.trim():i.replace(/^\s+|\s+$/g,"")}function j(i){return T(i).split(/\s+/)}function D(i,c){Object.prototype.hasOwnProperty.call(i,"options")||(i.options=i.options?o(i.options):{});for(var d in c)i.options[d]=c[d];return i.options}function M(i,c,d){var p=[];for(var v in i)p.push(encodeURIComponent(d?v.toUpperCase():v)+"="+encodeURIComponent(i[v]));return(!c||c.indexOf("?")===-1?"?":"&")+p.join("&")}var k=/\{ *([\w_ -]+) *\}/g;function S(i,c){return i.replace(k,function(d,p){var v=c[p];if(v===void 0)throw new Error("No value provided for variable "+d);return typeof v=="function"&&(v=v(c)),v})}var C=Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"};function U(i,c){for(var d=0;d<i.length;d++)if(i[d]===c)return d;return-1}var F="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function V(i){return window["webkit"+i]||window["moz"+i]||window["ms"+i]}var E=0;function N(i){var c=+new Date,d=Math.max(0,16-(c-E));return E=c+d,window.setTimeout(i,d)}var R=window.requestAnimationFrame||V("RequestAnimationFrame")||N,P=window.cancelAnimationFrame||V("CancelAnimationFrame")||V("CancelRequestAnimationFrame")||function(i){window.clearTimeout(i)};function A(i,c,d){if(d&&R===N)i.call(c);else return R.call(window,l(i,c))}function $(i){i&&P.call(window,i)}var z={__proto__:null,extend:s,create:o,bind:l,get lastId(){return h},stamp:f,throttle:m,wrapNum:g,falseFn:_,formatNum:w,trim:T,splitWords:j,setOptions:D,getParamString:M,template:S,isArray:C,indexOf:U,emptyImageUrl:F,requestFn:R,cancelFn:P,requestAnimFrame:A,cancelAnimFrame:$};function xe(){}xe.extend=function(i){var c=function(){D(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},d=c.__super__=this.prototype,p=o(d);p.constructor=c,c.prototype=p;for(var v in this)Object.prototype.hasOwnProperty.call(this,v)&&v!=="prototype"&&v!=="__super__"&&(c[v]=this[v]);return i.statics&&s(c,i.statics),i.includes&&(oe(i.includes),s.apply(null,[p].concat(i.includes))),s(p,i),delete p.statics,delete p.includes,p.options&&(p.options=d.options?o(d.options):{},s(p.options,i.options)),p._initHooks=[],p.callInitHooks=function(){if(!this._initHooksCalled){d.callInitHooks&&d.callInitHooks.call(this),this._initHooksCalled=!0;for(var b=0,B=p._initHooks.length;b<B;b++)p._initHooks[b].call(this)}},c},xe.include=function(i){var c=this.prototype.options;return s(this.prototype,i),i.options&&(this.prototype.options=c,this.mergeOptions(i.options)),this},xe.mergeOptions=function(i){return s(this.prototype.options,i),this},xe.addInitHook=function(i){var c=Array.prototype.slice.call(arguments,1),d=typeof i=="function"?i:function(){this[i].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(d),this};function oe(i){if(!(typeof L>"u"||!L||!L.Mixin)){i=C(i)?i:[i];for(var c=0;c<i.length;c++)i[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ue={on:function(i,c,d){if(typeof i=="object")for(var p in i)this._on(p,i[p],c);else{i=j(i);for(var v=0,b=i.length;v<b;v++)this._on(i[v],c,d)}return this},off:function(i,c,d){if(!arguments.length)delete this._events;else if(typeof i=="object")for(var p in i)this._off(p,i[p],c);else{i=j(i);for(var v=arguments.length===1,b=0,B=i.length;b<B;b++)v?this._off(i[b]):this._off(i[b],c,d)}return this},_on:function(i,c,d,p){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(i,c,d)===!1){d===this&&(d=void 0);var v={fn:c,ctx:d};p&&(v.once=!0),this._events=this._events||{},this._events[i]=this._events[i]||[],this._events[i].push(v)}},_off:function(i,c,d){var p,v,b;if(this._events&&(p=this._events[i],!!p)){if(arguments.length===1){if(this._firingCount)for(v=0,b=p.length;v<b;v++)p[v].fn=_;delete this._events[i];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var B=this._listens(i,c,d);if(B!==!1){var q=p[B];this._firingCount&&(q.fn=_,this._events[i]=p=p.slice()),p.splice(B,1)}}},fire:function(i,c,d){if(!this.listens(i,d))return this;var p=s({},c,{type:i,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var v=this._events[i];if(v){this._firingCount=this._firingCount+1||1;for(var b=0,B=v.length;b<B;b++){var q=v[b],K=q.fn;q.once&&this.off(i,K,q.ctx),K.call(q.ctx||this,p)}this._firingCount--}}return d&&this._propagateEvent(p),this},listens:function(i,c,d,p){typeof i!="string"&&console.warn('"string" type argument expected');var v=c;typeof c!="function"&&(p=!!c,v=void 0,d=void 0);var b=this._events&&this._events[i];if(b&&b.length&&this._listens(i,v,d)!==!1)return!0;if(p){for(var B in this._eventParents)if(this._eventParents[B].listens(i,c,d,p))return!0}return!1},_listens:function(i,c,d){if(!this._events)return!1;var p=this._events[i]||[];if(!c)return!!p.length;d===this&&(d=void 0);for(var v=0,b=p.length;v<b;v++)if(p[v].fn===c&&p[v].ctx===d)return v;return!1},once:function(i,c,d){if(typeof i=="object")for(var p in i)this._on(p,i[p],c,!0);else{i=j(i);for(var v=0,b=i.length;v<b;v++)this._on(i[v],c,d,!0)}return this},addEventParent:function(i){return this._eventParents=this._eventParents||{},this._eventParents[f(i)]=i,this},removeEventParent:function(i){return this._eventParents&&delete this._eventParents[f(i)],this},_propagateEvent:function(i){for(var c in this._eventParents)this._eventParents[c].fire(i.type,s({layer:i.target,propagatedFrom:i.target},i),!0)}};ue.addEventListener=ue.on,ue.removeEventListener=ue.clearAllEventListeners=ue.off,ue.addOneTimeEventListener=ue.once,ue.fireEvent=ue.fire,ue.hasEventListeners=ue.listens;var ne=xe.extend(ue);function H(i,c,d){this.x=d?Math.round(i):i,this.y=d?Math.round(c):c}var re=Math.trunc||function(i){return i>0?Math.floor(i):Math.ceil(i)};H.prototype={clone:function(){return new H(this.x,this.y)},add:function(i){return this.clone()._add(X(i))},_add:function(i){return this.x+=i.x,this.y+=i.y,this},subtract:function(i){return this.clone()._subtract(X(i))},_subtract:function(i){return this.x-=i.x,this.y-=i.y,this},divideBy:function(i){return this.clone()._divideBy(i)},_divideBy:function(i){return this.x/=i,this.y/=i,this},multiplyBy:function(i){return this.clone()._multiplyBy(i)},_multiplyBy:function(i){return this.x*=i,this.y*=i,this},scaleBy:function(i){return new H(this.x*i.x,this.y*i.y)},unscaleBy:function(i){return new H(this.x/i.x,this.y/i.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=re(this.x),this.y=re(this.y),this},distanceTo:function(i){i=X(i);var c=i.x-this.x,d=i.y-this.y;return Math.sqrt(c*c+d*d)},equals:function(i){return i=X(i),i.x===this.x&&i.y===this.y},contains:function(i){return i=X(i),Math.abs(i.x)<=Math.abs(this.x)&&Math.abs(i.y)<=Math.abs(this.y)},toString:function(){return"Point("+w(this.x)+", "+w(this.y)+")"}};function X(i,c,d){return i instanceof H?i:C(i)?new H(i[0],i[1]):i==null?i:typeof i=="object"&&"x"in i&&"y"in i?new H(i.x,i.y):new H(i,c,d)}function Q(i,c){if(i)for(var d=c?[i,c]:i,p=0,v=d.length;p<v;p++)this.extend(d[p])}Q.prototype={extend:function(i){var c,d;if(!i)return this;if(i instanceof H||typeof i[0]=="number"||"x"in i)c=d=X(i);else if(i=G(i),c=i.min,d=i.max,!c||!d)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=d.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(d.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(d.y,this.max.y)),this},getCenter:function(i){return X((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,i)},getBottomLeft:function(){return X(this.min.x,this.max.y)},getTopRight:function(){return X(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(i){var c,d;return typeof i[0]=="number"||i instanceof H?i=X(i):i=G(i),i instanceof Q?(c=i.min,d=i.max):c=d=i,c.x>=this.min.x&&d.x<=this.max.x&&c.y>=this.min.y&&d.y<=this.max.y},intersects:function(i){i=G(i);var c=this.min,d=this.max,p=i.min,v=i.max,b=v.x>=c.x&&p.x<=d.x,B=v.y>=c.y&&p.y<=d.y;return b&&B},overlaps:function(i){i=G(i);var c=this.min,d=this.max,p=i.min,v=i.max,b=v.x>c.x&&p.x<d.x,B=v.y>c.y&&p.y<d.y;return b&&B},isValid:function(){return!!(this.min&&this.max)},pad:function(i){var c=this.min,d=this.max,p=Math.abs(c.x-d.x)*i,v=Math.abs(c.y-d.y)*i;return G(X(c.x-p,c.y-v),X(d.x+p,d.y+v))},equals:function(i){return i?(i=G(i),this.min.equals(i.getTopLeft())&&this.max.equals(i.getBottomRight())):!1}};function G(i,c){return!i||i instanceof Q?i:new Q(i,c)}function le(i,c){if(i)for(var d=c?[i,c]:i,p=0,v=d.length;p<v;p++)this.extend(d[p])}le.prototype={extend:function(i){var c=this._southWest,d=this._northEast,p,v;if(i instanceof ge)p=i,v=i;else if(i instanceof le){if(p=i._southWest,v=i._northEast,!p||!v)return this}else return i?this.extend(ye(i)||_e(i)):this;return!c&&!d?(this._southWest=new ge(p.lat,p.lng),this._northEast=new ge(v.lat,v.lng)):(c.lat=Math.min(p.lat,c.lat),c.lng=Math.min(p.lng,c.lng),d.lat=Math.max(v.lat,d.lat),d.lng=Math.max(v.lng,d.lng)),this},pad:function(i){var c=this._southWest,d=this._northEast,p=Math.abs(c.lat-d.lat)*i,v=Math.abs(c.lng-d.lng)*i;return new le(new ge(c.lat-p,c.lng-v),new ge(d.lat+p,d.lng+v))},getCenter:function(){return new ge((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ge(this.getNorth(),this.getWest())},getSouthEast:function(){return new ge(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(i){typeof i[0]=="number"||i instanceof ge||"lat"in i?i=ye(i):i=_e(i);var c=this._southWest,d=this._northEast,p,v;return i instanceof le?(p=i.getSouthWest(),v=i.getNorthEast()):p=v=i,p.lat>=c.lat&&v.lat<=d.lat&&p.lng>=c.lng&&v.lng<=d.lng},intersects:function(i){i=_e(i);var c=this._southWest,d=this._northEast,p=i.getSouthWest(),v=i.getNorthEast(),b=v.lat>=c.lat&&p.lat<=d.lat,B=v.lng>=c.lng&&p.lng<=d.lng;return b&&B},overlaps:function(i){i=_e(i);var c=this._southWest,d=this._northEast,p=i.getSouthWest(),v=i.getNorthEast(),b=v.lat>c.lat&&p.lat<d.lat,B=v.lng>c.lng&&p.lng<d.lng;return b&&B},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(i,c){return i?(i=_e(i),this._southWest.equals(i.getSouthWest(),c)&&this._northEast.equals(i.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function _e(i,c){return i instanceof le?i:new le(i,c)}function ge(i,c,d){if(isNaN(i)||isNaN(c))throw new Error("Invalid LatLng object: ("+i+", "+c+")");this.lat=+i,this.lng=+c,d!==void 0&&(this.alt=+d)}ge.prototype={equals:function(i,c){if(!i)return!1;i=ye(i);var d=Math.max(Math.abs(this.lat-i.lat),Math.abs(this.lng-i.lng));return d<=(c===void 0?1e-9:c)},toString:function(i){return"LatLng("+w(this.lat,i)+", "+w(this.lng,i)+")"},distanceTo:function(i){return Pe.distance(this,ye(i))},wrap:function(){return Pe.wrapLatLng(this)},toBounds:function(i){var c=180*i/40075017,d=c/Math.cos(Math.PI/180*this.lat);return _e([this.lat-c,this.lng-d],[this.lat+c,this.lng+d])},clone:function(){return new ge(this.lat,this.lng,this.alt)}};function ye(i,c,d){return i instanceof ge?i:C(i)&&typeof i[0]!="object"?i.length===3?new ge(i[0],i[1],i[2]):i.length===2?new ge(i[0],i[1]):null:i==null?i:typeof i=="object"&&"lat"in i?new ge(i.lat,"lng"in i?i.lng:i.lon,i.alt):c===void 0?null:new ge(i,c,d)}var rt={latLngToPoint:function(i,c){var d=this.projection.project(i),p=this.scale(c);return this.transformation._transform(d,p)},pointToLatLng:function(i,c){var d=this.scale(c),p=this.transformation.untransform(i,d);return this.projection.unproject(p)},project:function(i){return this.projection.project(i)},unproject:function(i){return this.projection.unproject(i)},scale:function(i){return 256*Math.pow(2,i)},zoom:function(i){return Math.log(i/256)/Math.LN2},getProjectedBounds:function(i){if(this.infinite)return null;var c=this.projection.bounds,d=this.scale(i),p=this.transformation.transform(c.min,d),v=this.transformation.transform(c.max,d);return new Q(p,v)},infinite:!1,wrapLatLng:function(i){var c=this.wrapLng?g(i.lng,this.wrapLng,!0):i.lng,d=this.wrapLat?g(i.lat,this.wrapLat,!0):i.lat,p=i.alt;return new ge(d,c,p)},wrapLatLngBounds:function(i){var c=i.getCenter(),d=this.wrapLatLng(c),p=c.lat-d.lat,v=c.lng-d.lng;if(p===0&&v===0)return i;var b=i.getSouthWest(),B=i.getNorthEast(),q=new ge(b.lat-p,b.lng-v),K=new ge(B.lat-p,B.lng-v);return new le(q,K)}},Pe=s({},rt,{wrapLng:[-180,180],R:6371e3,distance:function(i,c){var d=Math.PI/180,p=i.lat*d,v=c.lat*d,b=Math.sin((c.lat-i.lat)*d/2),B=Math.sin((c.lng-i.lng)*d/2),q=b*b+Math.cos(p)*Math.cos(v)*B*B,K=2*Math.atan2(Math.sqrt(q),Math.sqrt(1-q));return this.R*K}}),st=6378137,mn={R:st,MAX_LATITUDE:85.0511287798,project:function(i){var c=Math.PI/180,d=this.MAX_LATITUDE,p=Math.max(Math.min(d,i.lat),-d),v=Math.sin(p*c);return new H(this.R*i.lng*c,this.R*Math.log((1+v)/(1-v))/2)},unproject:function(i){var c=180/Math.PI;return new ge((2*Math.atan(Math.exp(i.y/this.R))-Math.PI/2)*c,i.x*c/this.R)},bounds:function(){var i=st*Math.PI;return new Q([-i,-i],[i,i])}()};function Y(i,c,d,p){if(C(i)){this._a=i[0],this._b=i[1],this._c=i[2],this._d=i[3];return}this._a=i,this._b=c,this._c=d,this._d=p}Y.prototype={transform:function(i,c){return this._transform(i.clone(),c)},_transform:function(i,c){return c=c||1,i.x=c*(this._a*i.x+this._b),i.y=c*(this._c*i.y+this._d),i},untransform:function(i,c){return c=c||1,new H((i.x/c-this._b)/this._a,(i.y/c-this._d)/this._c)}};function we(i,c,d,p){return new Y(i,c,d,p)}var Je=s({},Pe,{code:"EPSG:3857",projection:mn,transformation:function(){var i=.5/(Math.PI*mn.R);return we(i,.5,-i,.5)}()}),Ke=s({},Je,{code:"EPSG:900913"});function xt(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function Pn(i,c){var d="",p,v,b,B,q,K;for(p=0,b=i.length;p<b;p++){for(q=i[p],v=0,B=q.length;v<B;v++)K=q[v],d+=(v?"L":"M")+K.x+" "+K.y;d+=c?me.svg?"z":"x":""}return d||"M0 0"}var Ui=document.documentElement.style,Fi="ActiveXObject"in window,Rt=Fi&&!document.addEventListener,Lt="msLaunchUri"in navigator&&!("documentMode"in document),Rs=pn("webkit"),_u=pn("android"),hl=pn("android 2")||pn("android 3"),If=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Bi=_u&&pn("Google")&&If<537&&!("AudioNode"in window),Mo=!!window.opera,fl=!Lt&&pn("chrome"),Oo=pn("gecko")&&!Rs&&!Mo&&!Fi,Cf=!fl&&pn("safari"),vu=pn("phantom"),ml="OTransition"in Ui,xu=navigator.platform.indexOf("Win")===0,Ls=Fi&&"transition"in Ui,$i="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!hl,Vo="MozPerspective"in Ui,Jr=!window.L_DISABLE_3D&&(Ls||$i||Vo)&&!ml&&!vu,Ds=typeof orientation<"u"||pn("mobile"),Uo=Ds&&Rs,wu=Ds&&$i,zs=!window.PointerEvent&&window.MSPointerEvent,pl=!!(window.PointerEvent||zs),Dt="ontouchstart"in window||!!window.TouchEvent,bu=!window.L_NO_TOUCH&&(Dt||pl),Wi=Ds&&Mo,Hi=Ds&&Oo,Af=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Rf=function(){var i=!1;try{var c=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("testPassiveEventSupport",_,c),window.removeEventListener("testPassiveEventSupport",_,c)}catch{}return i}(),Ms=function(){return!!document.createElement("canvas").getContext}(),gl=!!(document.createElementNS&&xt("svg").createSVGRect),Lf=!!gl&&function(){var i=document.createElement("div");return i.innerHTML="<svg/>",(i.firstChild&&i.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Fo=!gl&&function(){try{var i=document.createElement("div");i.innerHTML='<v:shape adj="1"/>';var c=i.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}}(),Nu=navigator.platform.indexOf("Mac")===0,Eu=navigator.platform.indexOf("Linux")===0;function pn(i){return navigator.userAgent.toLowerCase().indexOf(i)>=0}var me={ie:Fi,ielt9:Rt,edge:Lt,webkit:Rs,android:_u,android23:hl,androidStock:Bi,opera:Mo,chrome:fl,gecko:Oo,safari:Cf,phantom:vu,opera12:ml,win:xu,ie3d:Ls,webkit3d:$i,gecko3d:Vo,any3d:Jr,mobile:Ds,mobileWebkit:Uo,mobileWebkit3d:wu,msPointer:zs,pointer:pl,touch:bu,touchNative:Dt,mobileOpera:Wi,mobileGecko:Hi,retina:Af,passiveEvents:Rf,canvas:Ms,svg:gl,vml:Fo,inlineSvg:Lf,mac:Nu,linux:Eu},Tu=me.msPointer?"MSPointerDown":"pointerdown",sr=me.msPointer?"MSPointerMove":"pointermove",yl=me.msPointer?"MSPointerUp":"pointerup",_l=me.msPointer?"MSPointerCancel":"pointercancel",qi={touchstart:Tu,touchmove:sr,touchend:yl,touchcancel:_l},Bo={touchstart:vl,touchmove:Fn,touchend:Fn,touchcancel:Fn},es={},ju=!1;function ku(i,c,d){return c==="touchstart"&&Zi(),Bo[c]?(d=Bo[c].bind(this,d),i.addEventListener(qi[c],d,!1),d):(console.warn("wrong event specified:",c),_)}function Df(i,c,d){if(!qi[c]){console.warn("wrong event specified:",c);return}i.removeEventListener(qi[c],d,!1)}function $o(i){es[i.pointerId]=i}function Su(i){es[i.pointerId]&&(es[i.pointerId]=i)}function Wo(i){delete es[i.pointerId]}function Zi(){ju||(document.addEventListener(Tu,$o,!0),document.addEventListener(sr,Su,!0),document.addEventListener(yl,Wo,!0),document.addEventListener(_l,Wo,!0),ju=!0)}function Fn(i,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var d in es)c.touches.push(es[d]);c.changedTouches=[c],i(c)}}function vl(i,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&wt(c),Fn(i,c)}function zf(i){var c={},d,p;for(p in i)d=i[p],c[p]=d&&d.bind?d.bind(i):d;return i=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var Pu=200;function Iu(i,c){i.addEventListener("dblclick",c);var d=0,p;function v(b){if(b.detail!==1){p=b.detail;return}if(!(b.pointerType==="mouse"||b.sourceCapabilities&&!b.sourceCapabilities.firesTouchEvents)){var B=El(b);if(!(B.some(function(K){return K instanceof HTMLLabelElement&&K.attributes.for})&&!B.some(function(K){return K instanceof HTMLInputElement||K instanceof HTMLSelectElement}))){var q=Date.now();q-d<=Pu?(p++,p===2&&c(zf(b))):p=1,d=q}}}return i.addEventListener("click",v),{dblclick:c,simDblclick:v}}function Cu(i,c){i.removeEventListener("dblclick",c.dblclick),i.removeEventListener("click",c.simDblclick)}var Gi=Ho(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ts=Ho(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),xl=ts==="webkitTransition"||ts==="OTransition"?ts+"End":"transitionend";function wl(i){return typeof i=="string"?document.getElementById(i):i}function Os(i,c){var d=i.style[c]||i.currentStyle&&i.currentStyle[c];if((!d||d==="auto")&&document.defaultView){var p=document.defaultView.getComputedStyle(i,null);d=p?p[c]:null}return d==="auto"?null:d}function Oe(i,c,d){var p=document.createElement(i);return p.className=c||"",d&&d.appendChild(p),p}function Fe(i){var c=i.parentNode;c&&c.removeChild(i)}function on(i){for(;i.firstChild;)i.removeChild(i.firstChild)}function Bn(i){var c=i.parentNode;c&&c.lastChild!==i&&c.appendChild(i)}function $n(i){var c=i.parentNode;c&&c.firstChild!==i&&c.insertBefore(i,c.firstChild)}function Ki(i,c){if(i.classList!==void 0)return i.classList.contains(c);var d=wr(i);return d.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(d)}function he(i,c){if(i.classList!==void 0)for(var d=j(c),p=0,v=d.length;p<v;p++)i.classList.add(d[p]);else if(!Ki(i,c)){var b=wr(i);ns(i,(b?b+" ":"")+c)}}function Qe(i,c){i.classList!==void 0?i.classList.remove(c):ns(i,T((" "+wr(i)+" ").replace(" "+c+" "," ")))}function ns(i,c){i.className.baseVal===void 0?i.className=c:i.className.baseVal=c}function wr(i){return i.correspondingElement&&(i=i.correspondingElement),i.className.baseVal===void 0?i.className:i.className.baseVal}function gn(i,c){"opacity"in i.style?i.style.opacity=c:"filter"in i.style&&Au(i,c)}function Au(i,c){var d=!1,p="DXImageTransform.Microsoft.Alpha";try{d=i.filters.item(p)}catch{if(c===1)return}c=Math.round(c*100),d?(d.Enabled=c!==100,d.Opacity=c):i.style.filter+=" progid:"+p+"(opacity="+c+")"}function Ho(i){for(var c=document.documentElement.style,d=0;d<i.length;d++)if(i[d]in c)return i[d];return!1}function rs(i,c,d){var p=c||new H(0,0);i.style[Gi]=(me.ie3d?"translate("+p.x+"px,"+p.y+"px)":"translate3d("+p.x+"px,"+p.y+"px,0)")+(d?" scale("+d+")":"")}function dt(i,c){i._leaflet_pos=c,me.any3d?rs(i,c):(i.style.left=c.x+"px",i.style.top=c.y+"px")}function ss(i){return i._leaflet_pos||new H(0,0)}var ir,In,qo;if("onselectstart"in document)ir=function(){Te(window,"selectstart",wt)},In=function(){Ze(window,"selectstart",wt)};else{var Vs=Ho(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);ir=function(){if(Vs){var i=document.documentElement.style;qo=i[Vs],i[Vs]="none"}},In=function(){Vs&&(document.documentElement.style[Vs]=qo,qo=void 0)}}function Zo(){Te(window,"dragstart",wt)}function Go(){Ze(window,"dragstart",wt)}var Qi,br;function bl(i){for(;i.tabIndex===-1;)i=i.parentNode;i.style&&(Ko(),Qi=i,br=i.style.outlineStyle,i.style.outlineStyle="none",Te(window,"keydown",Ko))}function Ko(){Qi&&(Qi.style.outlineStyle=br,Qi=void 0,br=void 0,Ze(window,"keydown",Ko))}function Ru(i){do i=i.parentNode;while((!i.offsetWidth||!i.offsetHeight)&&i!==document.body);return i}function Wn(i){var c=i.getBoundingClientRect();return{x:c.width/i.offsetWidth||1,y:c.height/i.offsetHeight||1,boundingClientRect:c}}var Mf={__proto__:null,TRANSFORM:Gi,TRANSITION:ts,TRANSITION_END:xl,get:wl,getStyle:Os,create:Oe,remove:Fe,empty:on,toFront:Bn,toBack:$n,hasClass:Ki,addClass:he,removeClass:Qe,setClass:ns,getClass:wr,setOpacity:gn,testProp:Ho,setTransform:rs,setPosition:dt,getPosition:ss,get disableTextSelection(){return ir},get enableTextSelection(){return In},disableImageDrag:Zo,enableImageDrag:Go,preventOutline:bl,restoreOutline:Ko,getSizedParentNode:Ru,getScale:Wn};function Te(i,c,d,p){if(c&&typeof c=="object")for(var v in c)Qo(i,v,c[v],d);else{c=j(c);for(var b=0,B=c.length;b<B;b++)Qo(i,c[b],d,p)}return this}var an="_leaflet_events";function Ze(i,c,d,p){if(arguments.length===1)Us(i),delete i[an];else if(c&&typeof c=="object")for(var v in c)Yi(i,v,c[v],d);else if(c=j(c),arguments.length===2)Us(i,function(q){return U(c,q)!==-1});else for(var b=0,B=c.length;b<B;b++)Yi(i,c[b],d,p);return this}function Us(i,c){for(var d in i[an]){var p=d.split(/\d/)[0];(!c||c(p))&&Yi(i,p,null,null,d)}}var is={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Qo(i,c,d,p){var v=c+f(d)+(p?"_"+f(p):"");if(i[an]&&i[an][v])return this;var b=function(q){return d.call(p||i,q||window.event)},B=b;!me.touchNative&&me.pointer&&c.indexOf("touch")===0?b=ku(i,c,b):me.touch&&c==="dblclick"?b=Iu(i,b):"addEventListener"in i?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?i.addEventListener(is[c]||c,b,me.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(b=function(q){q=q||window.event,jl(i,q)&&B(q)},i.addEventListener(is[c],b,!1)):i.addEventListener(c,B,!1):i.attachEvent("on"+c,b),i[an]=i[an]||{},i[an][v]=b}function Yi(i,c,d,p,v){v=v||c+f(d)+(p?"_"+f(p):"");var b=i[an]&&i[an][v];if(!b)return this;!me.touchNative&&me.pointer&&c.indexOf("touch")===0?Df(i,c,b):me.touch&&c==="dblclick"?Cu(i,b):"removeEventListener"in i?i.removeEventListener(is[c]||c,b,!1):i.detachEvent("on"+c,b),i[an][v]=null}function $e(i){return i.stopPropagation?i.stopPropagation():i.originalEvent?i.originalEvent._stopped=!0:i.cancelBubble=!0,this}function Nl(i){return Qo(i,"wheel",$e),this}function Xi(i){return Te(i,"mousedown touchstart dblclick contextmenu",$e),i._leaflet_disable_click=!0,this}function wt(i){return i.preventDefault?i.preventDefault():i.returnValue=!1,this}function Nr(i){return wt(i),$e(i),this}function El(i){if(i.composedPath)return i.composedPath();for(var c=[],d=i.target;d;)c.push(d),d=d.parentNode;return c}function Ji(i,c){if(!c)return new H(i.clientX,i.clientY);var d=Wn(c),p=d.boundingClientRect;return new H((i.clientX-p.left)/d.x-c.clientLeft,(i.clientY-p.top)/d.y-c.clientTop)}var Er=me.linux&&me.chrome?window.devicePixelRatio:me.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Tl(i){return me.edge?i.wheelDeltaY/2:i.deltaY&&i.deltaMode===0?-i.deltaY/Er:i.deltaY&&i.deltaMode===1?-i.deltaY*20:i.deltaY&&i.deltaMode===2?-i.deltaY*60:i.deltaX||i.deltaZ?0:i.wheelDelta?(i.wheelDeltaY||i.wheelDelta)/2:i.detail&&Math.abs(i.detail)<32765?-i.detail*20:i.detail?i.detail/-32765*60:0}function jl(i,c){var d=c.relatedTarget;if(!d)return!0;try{for(;d&&d!==i;)d=d.parentNode}catch{return!1}return d!==i}var eo={__proto__:null,on:Te,off:Ze,stopPropagation:$e,disableScrollPropagation:Nl,disableClickPropagation:Xi,preventDefault:wt,stop:Nr,getPropagationPath:El,getMousePosition:Ji,getWheelDelta:Tl,isExternalTarget:jl,addListener:Te,removeListener:Ze},kl=ne.extend({run:function(i,c,d,p){this.stop(),this._el=i,this._inProgress=!0,this._duration=d||.25,this._easeOutPower=1/Math.max(p||.5,.2),this._startPos=ss(i),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=A(this._animate,this),this._step()},_step:function(i){var c=+new Date-this._startTime,d=this._duration*1e3;c<d?this._runFrame(this._easeOut(c/d),i):(this._runFrame(1),this._complete())},_runFrame:function(i,c){var d=this._startPos.add(this._offset.multiplyBy(i));c&&d._round(),dt(this._el,d),this.fire("step")},_complete:function(){$(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(i){return 1-Math.pow(1-i,this._easeOutPower)}}),Ae=ne.extend({options:{crs:Je,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(i,c){c=D(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(i),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(ye(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ts&&me.any3d&&!me.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Te(this._proxy,xl,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(i,c,d){if(c=c===void 0?this._zoom:this._limitZoom(c),i=this._limitCenter(ye(i),c,this.options.maxBounds),d=d||{},this._stop(),this._loaded&&!d.reset&&d!==!0){d.animate!==void 0&&(d.zoom=s({animate:d.animate},d.zoom),d.pan=s({animate:d.animate,duration:d.duration},d.pan));var p=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(i,c,d.zoom):this._tryAnimatedPan(i,d.pan);if(p)return clearTimeout(this._sizeTimer),this}return this._resetView(i,c,d.pan&&d.pan.noMoveStart),this},setZoom:function(i,c){return this._loaded?this.setView(this.getCenter(),i,{zoom:c}):(this._zoom=i,this)},zoomIn:function(i,c){return i=i||(me.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+i,c)},zoomOut:function(i,c){return i=i||(me.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-i,c)},setZoomAround:function(i,c,d){var p=this.getZoomScale(c),v=this.getSize().divideBy(2),b=i instanceof H?i:this.latLngToContainerPoint(i),B=b.subtract(v).multiplyBy(1-1/p),q=this.containerPointToLatLng(v.add(B));return this.setView(q,c,{zoom:d})},_getBoundsCenterZoom:function(i,c){c=c||{},i=i.getBounds?i.getBounds():_e(i);var d=X(c.paddingTopLeft||c.padding||[0,0]),p=X(c.paddingBottomRight||c.padding||[0,0]),v=this.getBoundsZoom(i,!1,d.add(p));if(v=typeof c.maxZoom=="number"?Math.min(c.maxZoom,v):v,v===1/0)return{center:i.getCenter(),zoom:v};var b=p.subtract(d).divideBy(2),B=this.project(i.getSouthWest(),v),q=this.project(i.getNorthEast(),v),K=this.unproject(B.add(q).divideBy(2).add(b),v);return{center:K,zoom:v}},fitBounds:function(i,c){if(i=_e(i),!i.isValid())throw new Error("Bounds are not valid.");var d=this._getBoundsCenterZoom(i,c);return this.setView(d.center,d.zoom,c)},fitWorld:function(i){return this.fitBounds([[-90,-180],[90,180]],i)},panTo:function(i,c){return this.setView(i,this._zoom,{pan:c})},panBy:function(i,c){if(i=X(i).round(),c=c||{},!i.x&&!i.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(i))return this._resetView(this.unproject(this.project(this.getCenter()).add(i)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new kl,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){he(this._mapPane,"leaflet-pan-anim");var d=this._getMapPanePos().subtract(i).round();this._panAnim.run(this._mapPane,d,c.duration||.25,c.easeLinearity)}else this._rawPanBy(i),this.fire("move").fire("moveend");return this},flyTo:function(i,c,d){if(d=d||{},d.animate===!1||!me.any3d)return this.setView(i,c,d);this._stop();var p=this.project(this.getCenter()),v=this.project(i),b=this.getSize(),B=this._zoom;i=ye(i),c=c===void 0?B:c;var q=Math.max(b.x,b.y),K=q*this.getZoomScale(B,c),te=v.distanceTo(p)||1,ce=1.42,be=ce*ce;function Re(bt){var Ku=bt?-1:1,oj=bt?K:q,aj=K*K-q*q+Ku*be*be*te*te,lj=2*oj*be*te,Bf=aj/lj,$_=Math.sqrt(Bf*Bf+1)-Bf,cj=$_<1e-9?-18:Math.log($_);return cj}function ln(bt){return(Math.exp(bt)-Math.exp(-bt))/2}function zt(bt){return(Math.exp(bt)+Math.exp(-bt))/2}function Zn(bt){return ln(bt)/zt(bt)}var _n=Re(0);function ca(bt){return q*(zt(_n)/zt(_n+ce*bt))}function nj(bt){return q*(zt(_n)*Zn(_n+ce*bt)-ln(_n))/be}function rj(bt){return 1-Math.pow(1-bt,1.5)}var sj=Date.now(),F_=(Re(1)-_n)/ce,ij=d.duration?1e3*d.duration:1e3*F_*.8;function B_(){var bt=(Date.now()-sj)/ij,Ku=rj(bt)*F_;bt<=1?(this._flyToFrame=A(B_,this),this._move(this.unproject(p.add(v.subtract(p).multiplyBy(nj(Ku)/te)),B),this.getScaleZoom(q/ca(Ku),B),{flyTo:!0})):this._move(i,c)._moveEnd(!0)}return this._moveStart(!0,d.noMoveStart),B_.call(this),this},flyToBounds:function(i,c){var d=this._getBoundsCenterZoom(i,c);return this.flyTo(d.center,d.zoom,c)},setMaxBounds:function(i){return i=_e(i),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),i.isValid()?(this.options.maxBounds=i,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(i){var c=this.options.minZoom;return this.options.minZoom=i,this._loaded&&c!==i&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(i):this},setMaxZoom:function(i){var c=this.options.maxZoom;return this.options.maxZoom=i,this._loaded&&c!==i&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(i):this},panInsideBounds:function(i,c){this._enforcingBounds=!0;var d=this.getCenter(),p=this._limitCenter(d,this._zoom,_e(i));return d.equals(p)||this.panTo(p,c),this._enforcingBounds=!1,this},panInside:function(i,c){c=c||{};var d=X(c.paddingTopLeft||c.padding||[0,0]),p=X(c.paddingBottomRight||c.padding||[0,0]),v=this.project(this.getCenter()),b=this.project(i),B=this.getPixelBounds(),q=G([B.min.add(d),B.max.subtract(p)]),K=q.getSize();if(!q.contains(b)){this._enforcingBounds=!0;var te=b.subtract(q.getCenter()),ce=q.extend(b).getSize().subtract(K);v.x+=te.x<0?-ce.x:ce.x,v.y+=te.y<0?-ce.y:ce.y,this.panTo(this.unproject(v),c),this._enforcingBounds=!1}return this},invalidateSize:function(i){if(!this._loaded)return this;i=s({animate:!1,pan:!0},i===!0?{animate:!0}:i);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var d=this.getSize(),p=c.divideBy(2).round(),v=d.divideBy(2).round(),b=p.subtract(v);return!b.x&&!b.y?this:(i.animate&&i.pan?this.panBy(b):(i.pan&&this._rawPanBy(b),this.fire("move"),i.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:d}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(i){if(i=this._locateOptions=s({timeout:1e4,watch:!1},i),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=l(this._handleGeolocationResponse,this),d=l(this._handleGeolocationError,this);return i.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,d,i):navigator.geolocation.getCurrentPosition(c,d,i),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(i){if(this._container._leaflet_id){var c=i.code,d=i.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+d+"."})}},_handleGeolocationResponse:function(i){if(this._container._leaflet_id){var c=i.coords.latitude,d=i.coords.longitude,p=new ge(c,d),v=p.toBounds(i.coords.accuracy*2),b=this._locateOptions;if(b.setView){var B=this.getBoundsZoom(v);this.setView(p,b.maxZoom?Math.min(B,b.maxZoom):B)}var q={latlng:p,bounds:v,timestamp:i.timestamp};for(var K in i.coords)typeof i.coords[K]=="number"&&(q[K]=i.coords[K]);this.fire("locationfound",q)}},addHandler:function(i,c){if(!c)return this;var d=this[i]=new c(this);return this._handlers.push(d),this.options[i]&&d.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Fe(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&($(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var i;for(i in this._layers)this._layers[i].remove();for(i in this._panes)Fe(this._panes[i]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(i,c){var d="leaflet-pane"+(i?" leaflet-"+i.replace("Pane","")+"-pane":""),p=Oe("div",d,c||this._mapPane);return i&&(this._panes[i]=p),p},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var i=this.getPixelBounds(),c=this.unproject(i.getBottomLeft()),d=this.unproject(i.getTopRight());return new le(c,d)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(i,c,d){i=_e(i),d=X(d||[0,0]);var p=this.getZoom()||0,v=this.getMinZoom(),b=this.getMaxZoom(),B=i.getNorthWest(),q=i.getSouthEast(),K=this.getSize().subtract(d),te=G(this.project(q,p),this.project(B,p)).getSize(),ce=me.any3d?this.options.zoomSnap:1,be=K.x/te.x,Re=K.y/te.y,ln=c?Math.max(be,Re):Math.min(be,Re);return p=this.getScaleZoom(ln,p),ce&&(p=Math.round(p/(ce/100))*(ce/100),p=c?Math.ceil(p/ce)*ce:Math.floor(p/ce)*ce),Math.max(v,Math.min(b,p))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new H(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(i,c){var d=this._getTopLeftPoint(i,c);return new Q(d,d.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(i){return this.options.crs.getProjectedBounds(i===void 0?this.getZoom():i)},getPane:function(i){return typeof i=="string"?this._panes[i]:i},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(i,c){var d=this.options.crs;return c=c===void 0?this._zoom:c,d.scale(i)/d.scale(c)},getScaleZoom:function(i,c){var d=this.options.crs;c=c===void 0?this._zoom:c;var p=d.zoom(i*d.scale(c));return isNaN(p)?1/0:p},project:function(i,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(ye(i),c)},unproject:function(i,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(X(i),c)},layerPointToLatLng:function(i){var c=X(i).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(i){var c=this.project(ye(i))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(i){return this.options.crs.wrapLatLng(ye(i))},wrapLatLngBounds:function(i){return this.options.crs.wrapLatLngBounds(_e(i))},distance:function(i,c){return this.options.crs.distance(ye(i),ye(c))},containerPointToLayerPoint:function(i){return X(i).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(i){return X(i).add(this._getMapPanePos())},containerPointToLatLng:function(i){var c=this.containerPointToLayerPoint(X(i));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(i){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ye(i)))},mouseEventToContainerPoint:function(i){return Ji(i,this._container)},mouseEventToLayerPoint:function(i){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(i))},mouseEventToLatLng:function(i){return this.layerPointToLatLng(this.mouseEventToLayerPoint(i))},_initContainer:function(i){var c=this._container=wl(i);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Te(c,"scroll",this._onScroll,this),this._containerId=f(c)},_initLayout:function(){var i=this._container;this._fadeAnimated=this.options.fadeAnimation&&me.any3d,he(i,"leaflet-container"+(me.touch?" leaflet-touch":"")+(me.retina?" leaflet-retina":"")+(me.ielt9?" leaflet-oldie":"")+(me.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=Os(i,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(i.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var i=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),dt(this._mapPane,new H(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(he(i.markerPane,"leaflet-zoom-hide"),he(i.shadowPane,"leaflet-zoom-hide"))},_resetView:function(i,c,d){dt(this._mapPane,new H(0,0));var p=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var v=this._zoom!==c;this._moveStart(v,d)._move(i,c)._moveEnd(v),this.fire("viewreset"),p&&this.fire("load")},_moveStart:function(i,c){return i&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(i,c,d,p){c===void 0&&(c=this._zoom);var v=this._zoom!==c;return this._zoom=c,this._lastCenter=i,this._pixelOrigin=this._getNewPixelOrigin(i),p?d&&d.pinch&&this.fire("zoom",d):((v||d&&d.pinch)&&this.fire("zoom",d),this.fire("move",d)),this},_moveEnd:function(i){return i&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return $(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(i){dt(this._mapPane,this._getMapPanePos().subtract(i))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(i){this._targets={},this._targets[f(this._container)]=this;var c=i?Ze:Te;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),me.any3d&&this.options.transform3DLimit&&(i?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){$(this._resizeRequest),this._resizeRequest=A(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var i=this._getMapPanePos();Math.max(Math.abs(i.x),Math.abs(i.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(i,c){for(var d=[],p,v=c==="mouseout"||c==="mouseover",b=i.target||i.srcElement,B=!1;b;){if(p=this._targets[f(b)],p&&(c==="click"||c==="preclick")&&this._draggableMoved(p)){B=!0;break}if(p&&p.listens(c,!0)&&(v&&!jl(b,i)||(d.push(p),v))||b===this._container)break;b=b.parentNode}return!d.length&&!B&&!v&&this.listens(c,!0)&&(d=[this]),d},_isClickDisabled:function(i){for(;i&&i!==this._container;){if(i._leaflet_disable_click)return!0;i=i.parentNode}},_handleDOMEvent:function(i){var c=i.target||i.srcElement;if(!(!this._loaded||c._leaflet_disable_events||i.type==="click"&&this._isClickDisabled(c))){var d=i.type;d==="mousedown"&&bl(c),this._fireDOMEvent(i,d)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(i,c,d){if(i.type==="click"){var p=s({},i);p.type="preclick",this._fireDOMEvent(p,p.type,d)}var v=this._findEventTargets(i,c);if(d){for(var b=[],B=0;B<d.length;B++)d[B].listens(c,!0)&&b.push(d[B]);v=b.concat(v)}if(v.length){c==="contextmenu"&&wt(i);var q=v[0],K={originalEvent:i};if(i.type!=="keypress"&&i.type!=="keydown"&&i.type!=="keyup"){var te=q.getLatLng&&(!q._radius||q._radius<=10);K.containerPoint=te?this.latLngToContainerPoint(q.getLatLng()):this.mouseEventToContainerPoint(i),K.layerPoint=this.containerPointToLayerPoint(K.containerPoint),K.latlng=te?q.getLatLng():this.layerPointToLatLng(K.layerPoint)}for(B=0;B<v.length;B++)if(v[B].fire(c,K,!0),K.originalEvent._stopped||v[B].options.bubblingMouseEvents===!1&&U(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(i){return i=i.dragging&&i.dragging.enabled()?i:this,i.dragging&&i.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var i=0,c=this._handlers.length;i<c;i++)this._handlers[i].disable()},whenReady:function(i,c){return this._loaded?i.call(c||this,{target:this}):this.on("load",i,c),this},_getMapPanePos:function(){return ss(this._mapPane)||new H(0,0)},_moved:function(){var i=this._getMapPanePos();return i&&!i.equals([0,0])},_getTopLeftPoint:function(i,c){var d=i&&c!==void 0?this._getNewPixelOrigin(i,c):this.getPixelOrigin();return d.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(i,c){var d=this.getSize()._divideBy(2);return this.project(i,c)._subtract(d)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(i,c,d){var p=this._getNewPixelOrigin(d,c);return this.project(i,c)._subtract(p)},_latLngBoundsToNewLayerBounds:function(i,c,d){var p=this._getNewPixelOrigin(d,c);return G([this.project(i.getSouthWest(),c)._subtract(p),this.project(i.getNorthWest(),c)._subtract(p),this.project(i.getSouthEast(),c)._subtract(p),this.project(i.getNorthEast(),c)._subtract(p)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(i){return this.latLngToLayerPoint(i).subtract(this._getCenterLayerPoint())},_limitCenter:function(i,c,d){if(!d)return i;var p=this.project(i,c),v=this.getSize().divideBy(2),b=new Q(p.subtract(v),p.add(v)),B=this._getBoundsOffset(b,d,c);return Math.abs(B.x)<=1&&Math.abs(B.y)<=1?i:this.unproject(p.add(B),c)},_limitOffset:function(i,c){if(!c)return i;var d=this.getPixelBounds(),p=new Q(d.min.add(i),d.max.add(i));return i.add(this._getBoundsOffset(p,c))},_getBoundsOffset:function(i,c,d){var p=G(this.project(c.getNorthEast(),d),this.project(c.getSouthWest(),d)),v=p.min.subtract(i.min),b=p.max.subtract(i.max),B=this._rebound(v.x,-b.x),q=this._rebound(v.y,-b.y);return new H(B,q)},_rebound:function(i,c){return i+c>0?Math.round(i-c)/2:Math.max(0,Math.ceil(i))-Math.max(0,Math.floor(c))},_limitZoom:function(i){var c=this.getMinZoom(),d=this.getMaxZoom(),p=me.any3d?this.options.zoomSnap:1;return p&&(i=Math.round(i/p)*p),Math.max(c,Math.min(d,i))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Qe(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(i,c){var d=this._getCenterOffset(i)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(d)?!1:(this.panBy(d,c),!0)},_createAnimProxy:function(){var i=this._proxy=Oe("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(i),this.on("zoomanim",function(c){var d=Gi,p=this._proxy.style[d];rs(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),p===this._proxy.style[d]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Fe(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var i=this.getCenter(),c=this.getZoom();rs(this._proxy,this.project(i,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(i){this._animatingZoom&&i.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(i,c,d){if(this._animatingZoom)return!0;if(d=d||{},!this._zoomAnimated||d.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var p=this.getZoomScale(c),v=this._getCenterOffset(i)._divideBy(1-1/p);return d.animate!==!0&&!this.getSize().contains(v)?!1:(A(function(){this._moveStart(!0,d.noMoveStart||!1)._animateZoom(i,c,!0)},this),!0)},_animateZoom:function(i,c,d,p){this._mapPane&&(d&&(this._animatingZoom=!0,this._animateToCenter=i,this._animateToZoom=c,he(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:i,zoom:c,noUpdate:p}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Qe(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Yo(i,c){return new Ae(i,c)}var yn=xe.extend({options:{position:"topright"},initialize:function(i){D(this,i)},getPosition:function(){return this.options.position},setPosition:function(i){var c=this._map;return c&&c.removeControl(this),this.options.position=i,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(i){this.remove(),this._map=i;var c=this._container=this.onAdd(i),d=this.getPosition(),p=i._controlCorners[d];return he(c,"leaflet-control"),d.indexOf("bottom")!==-1?p.insertBefore(c,p.firstChild):p.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Fe(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(i){this._map&&i&&i.screenX>0&&i.screenY>0&&this._map.getContainer().focus()}}),Tr=function(i){return new yn(i)};Ae.include({addControl:function(i){return i.addTo(this),this},removeControl:function(i){return i.remove(),this},_initControlPos:function(){var i=this._controlCorners={},c="leaflet-",d=this._controlContainer=Oe("div",c+"control-container",this._container);function p(v,b){var B=c+v+" "+c+b;i[v+b]=Oe("div",B,d)}p("top","left"),p("top","right"),p("bottom","left"),p("bottom","right")},_clearControlPos:function(){for(var i in this._controlCorners)Fe(this._controlCorners[i]);Fe(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Lu=yn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(i,c,d,p){return d<p?-1:p<d?1:0}},initialize:function(i,c,d){D(this,d),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var p in i)this._addLayer(i[p],p);for(p in c)this._addLayer(c[p],p,!0)},onAdd:function(i){this._initLayout(),this._update(),this._map=i,i.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(i){return yn.prototype.addTo.call(this,i),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var i=0;i<this._layers.length;i++)this._layers[i].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(i,c){return this._addLayer(i,c),this._map?this._update():this},addOverlay:function(i,c){return this._addLayer(i,c,!0),this._map?this._update():this},removeLayer:function(i){i.off("add remove",this._onLayerChange,this);var c=this._getLayer(f(i));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){he(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var i=this._map.getSize().y-(this._container.offsetTop+50);return i<this._section.clientHeight?(he(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=i+"px"):Qe(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Qe(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var i="leaflet-control-layers",c=this._container=Oe("div",i),d=this.options.collapsed;c.setAttribute("aria-haspopup",!0),Xi(c),Nl(c);var p=this._section=Oe("section",i+"-list");d&&(this._map.on("click",this.collapse,this),Te(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var v=this._layersLink=Oe("a",i+"-toggle",c);v.href="#",v.title="Layers",v.setAttribute("role","button"),Te(v,{keydown:function(b){b.keyCode===13&&this._expandSafely()},click:function(b){wt(b),this._expandSafely()}},this),d||this.expand(),this._baseLayersList=Oe("div",i+"-base",p),this._separator=Oe("div",i+"-separator",p),this._overlaysList=Oe("div",i+"-overlays",p),c.appendChild(p)},_getLayer:function(i){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&f(this._layers[c].layer)===i)return this._layers[c]},_addLayer:function(i,c,d){this._map&&i.on("add remove",this._onLayerChange,this),this._layers.push({layer:i,name:c,overlay:d}),this.options.sortLayers&&this._layers.sort(l(function(p,v){return this.options.sortFunction(p.layer,v.layer,p.name,v.name)},this)),this.options.autoZIndex&&i.setZIndex&&(this._lastZIndex++,i.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;on(this._baseLayersList),on(this._overlaysList),this._layerControlInputs=[];var i,c,d,p,v=0;for(d=0;d<this._layers.length;d++)p=this._layers[d],this._addItem(p),c=c||p.overlay,i=i||!p.overlay,v+=p.overlay?0:1;return this.options.hideSingleBase&&(i=i&&v>1,this._baseLayersList.style.display=i?"":"none"),this._separator.style.display=c&&i?"":"none",this},_onLayerChange:function(i){this._handlingClick||this._update();var c=this._getLayer(f(i.target)),d=c.overlay?i.type==="add"?"overlayadd":"overlayremove":i.type==="add"?"baselayerchange":null;d&&this._map.fire(d,c)},_createRadioElement:function(i,c){var d='<input type="radio" class="leaflet-control-layers-selector" name="'+i+'"'+(c?' checked="checked"':"")+"/>",p=document.createElement("div");return p.innerHTML=d,p.firstChild},_addItem:function(i){var c=document.createElement("label"),d=this._map.hasLayer(i.layer),p;i.overlay?(p=document.createElement("input"),p.type="checkbox",p.className="leaflet-control-layers-selector",p.defaultChecked=d):p=this._createRadioElement("leaflet-base-layers_"+f(this),d),this._layerControlInputs.push(p),p.layerId=f(i.layer),Te(p,"click",this._onInputClick,this);var v=document.createElement("span");v.innerHTML=" "+i.name;var b=document.createElement("span");c.appendChild(b),b.appendChild(p),b.appendChild(v);var B=i.overlay?this._overlaysList:this._baseLayersList;return B.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var i=this._layerControlInputs,c,d,p=[],v=[];this._handlingClick=!0;for(var b=i.length-1;b>=0;b--)c=i[b],d=this._getLayer(c.layerId).layer,c.checked?p.push(d):c.checked||v.push(d);for(b=0;b<v.length;b++)this._map.hasLayer(v[b])&&this._map.removeLayer(v[b]);for(b=0;b<p.length;b++)this._map.hasLayer(p[b])||this._map.addLayer(p[b]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var i=this._layerControlInputs,c,d,p=this._map.getZoom(),v=i.length-1;v>=0;v--)c=i[v],d=this._getLayer(c.layerId).layer,c.disabled=d.options.minZoom!==void 0&&p<d.options.minZoom||d.options.maxZoom!==void 0&&p>d.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var i=this._section;this._preventClick=!0,Te(i,"click",wt),this.expand();var c=this;setTimeout(function(){Ze(i,"click",wt),c._preventClick=!1})}}),Du=function(i,c,d){return new Lu(i,c,d)},os=yn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(i){var c="leaflet-control-zoom",d=Oe("div",c+" leaflet-bar"),p=this.options;return this._zoomInButton=this._createButton(p.zoomInText,p.zoomInTitle,c+"-in",d,this._zoomIn),this._zoomOutButton=this._createButton(p.zoomOutText,p.zoomOutTitle,c+"-out",d,this._zoomOut),this._updateDisabled(),i.on("zoomend zoomlevelschange",this._updateDisabled,this),d},onRemove:function(i){i.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(i){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(i.shiftKey?3:1))},_zoomOut:function(i){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(i.shiftKey?3:1))},_createButton:function(i,c,d,p,v){var b=Oe("a",d,p);return b.innerHTML=i,b.href="#",b.title=c,b.setAttribute("role","button"),b.setAttribute("aria-label",c),Xi(b),Te(b,"click",Nr),Te(b,"click",v,this),Te(b,"click",this._refocusOnMap,this),b},_updateDisabled:function(){var i=this._map,c="leaflet-disabled";Qe(this._zoomInButton,c),Qe(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||i._zoom===i.getMinZoom())&&(he(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||i._zoom===i.getMaxZoom())&&(he(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ae.mergeOptions({zoomControl:!0}),Ae.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new os,this.addControl(this.zoomControl))});var zu=function(i){return new os(i)},Sl=yn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(i){var c="leaflet-control-scale",d=Oe("div",c),p=this.options;return this._addScales(p,c+"-line",d),i.on(p.updateWhenIdle?"moveend":"move",this._update,this),i.whenReady(this._update,this),d},onRemove:function(i){i.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(i,c,d){i.metric&&(this._mScale=Oe("div",c,d)),i.imperial&&(this._iScale=Oe("div",c,d))},_update:function(){var i=this._map,c=i.getSize().y/2,d=i.distance(i.containerPointToLatLng([0,c]),i.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(d)},_updateScales:function(i){this.options.metric&&i&&this._updateMetric(i),this.options.imperial&&i&&this._updateImperial(i)},_updateMetric:function(i){var c=this._getRoundNum(i),d=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,d,c/i)},_updateImperial:function(i){var c=i*3.2808399,d,p,v;c>5280?(d=c/5280,p=this._getRoundNum(d),this._updateScale(this._iScale,p+" mi",p/d)):(v=this._getRoundNum(c),this._updateScale(this._iScale,v+" ft",v/c))},_updateScale:function(i,c,d){i.style.width=Math.round(this.options.maxWidth*d)+"px",i.innerHTML=c},_getRoundNum:function(i){var c=Math.pow(10,(Math.floor(i)+"").length-1),d=i/c;return d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:1,c*d}}),Pl=function(i){return new Sl(i)},Il='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Xo=yn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(me.inlineSvg?Il+" ":"")+"Leaflet</a>"},initialize:function(i){D(this,i),this._attributions={}},onAdd:function(i){i.attributionControl=this,this._container=Oe("div","leaflet-control-attribution"),Xi(this._container);for(var c in i._layers)i._layers[c].getAttribution&&this.addAttribution(i._layers[c].getAttribution());return this._update(),i.on("layeradd",this._addAttribution,this),this._container},onRemove:function(i){i.off("layeradd",this._addAttribution,this)},_addAttribution:function(i){i.layer.getAttribution&&(this.addAttribution(i.layer.getAttribution()),i.layer.once("remove",function(){this.removeAttribution(i.layer.getAttribution())},this))},setPrefix:function(i){return this.options.prefix=i,this._update(),this},addAttribution:function(i){return i?(this._attributions[i]||(this._attributions[i]=0),this._attributions[i]++,this._update(),this):this},removeAttribution:function(i){return i?(this._attributions[i]&&(this._attributions[i]--,this._update()),this):this},_update:function(){if(this._map){var i=[];for(var c in this._attributions)this._attributions[c]&&i.push(c);var d=[];this.options.prefix&&d.push(this.options.prefix),i.length&&d.push(i.join(", ")),this._container.innerHTML=d.join(' <span aria-hidden="true">|</span> ')}}});Ae.mergeOptions({attributionControl:!0}),Ae.addInitHook(function(){this.options.attributionControl&&new Xo().addTo(this)});var Jo=function(i){return new Xo(i)};yn.Layers=Lu,yn.Zoom=os,yn.Scale=Sl,yn.Attribution=Xo,Tr.layers=Du,Tr.zoom=zu,Tr.scale=Pl,Tr.attribution=Jo;var Cn=xe.extend({initialize:function(i){this._map=i},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Cn.addTo=function(i,c){return i.addHandler(c,this),this};var Mu={Events:ue},jr=me.touch?"touchstart mousedown":"mousedown",or=ne.extend({options:{clickTolerance:3},initialize:function(i,c,d,p){D(this,p),this._element=i,this._dragStartTarget=c||i,this._preventOutline=d},enable:function(){this._enabled||(Te(this._dragStartTarget,jr,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(or._dragging===this&&this.finishDrag(!0),Ze(this._dragStartTarget,jr,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(i){if(this._enabled&&(this._moved=!1,!Ki(this._element,"leaflet-zoom-anim"))){if(i.touches&&i.touches.length!==1){or._dragging===this&&this.finishDrag();return}if(!(or._dragging||i.shiftKey||i.which!==1&&i.button!==1&&!i.touches)&&(or._dragging=this,this._preventOutline&&bl(this._element),Zo(),ir(),!this._moving)){this.fire("down");var c=i.touches?i.touches[0]:i,d=Ru(this._element);this._startPoint=new H(c.clientX,c.clientY),this._startPos=ss(this._element),this._parentScale=Wn(d);var p=i.type==="mousedown";Te(document,p?"mousemove":"touchmove",this._onMove,this),Te(document,p?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(i){if(this._enabled){if(i.touches&&i.touches.length>1){this._moved=!0;return}var c=i.touches&&i.touches.length===1?i.touches[0]:i,d=new H(c.clientX,c.clientY)._subtract(this._startPoint);!d.x&&!d.y||Math.abs(d.x)+Math.abs(d.y)<this.options.clickTolerance||(d.x/=this._parentScale.x,d.y/=this._parentScale.y,wt(i),this._moved||(this.fire("dragstart"),this._moved=!0,he(document.body,"leaflet-dragging"),this._lastTarget=i.target||i.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),he(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(d),this._moving=!0,this._lastEvent=i,this._updatePosition())}},_updatePosition:function(){var i={originalEvent:this._lastEvent};this.fire("predrag",i),dt(this._element,this._newPos),this.fire("drag",i)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(i){Qe(document.body,"leaflet-dragging"),this._lastTarget&&(Qe(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ze(document,"mousemove touchmove",this._onMove,this),Ze(document,"mouseup touchend touchcancel",this._onUp,this),Go(),In();var c=this._moved&&this._moving;this._moving=!1,or._dragging=!1,c&&this.fire("dragend",{noInertia:i,distance:this._newPos.distanceTo(this._startPos)})}});function Cl(i,c,d){var p,v=[1,4,2,8],b,B,q,K,te,ce,be,Re;for(b=0,ce=i.length;b<ce;b++)i[b]._code=Z(i[b],c);for(q=0;q<4;q++){for(be=v[q],p=[],b=0,ce=i.length,B=ce-1;b<ce;B=b++)K=i[b],te=i[B],K._code&be?te._code&be||(Re=W(te,K,be,c,d),Re._code=Z(Re,c),p.push(Re)):(te._code&be&&(Re=W(te,K,be,c,d),Re._code=Z(Re,c),p.push(Re)),p.push(K));i=p}return i}function Al(i,c){var d,p,v,b,B,q,K,te,ce;if(!i||i.length===0)throw new Error("latlngs not passed");Be(i)||(console.warn("latlngs are not flat! Only the first ring will be used"),i=i[0]);var be=ye([0,0]),Re=_e(i),ln=Re.getNorthWest().distanceTo(Re.getSouthWest())*Re.getNorthEast().distanceTo(Re.getNorthWest());ln<1700&&(be=ea(i));var zt=i.length,Zn=[];for(d=0;d<zt;d++){var _n=ye(i[d]);Zn.push(c.project(ye([_n.lat-be.lat,_n.lng-be.lng])))}for(q=K=te=0,d=0,p=zt-1;d<zt;p=d++)v=Zn[d],b=Zn[p],B=v.y*b.x-b.y*v.x,K+=(v.x+b.x)*B,te+=(v.y+b.y)*B,q+=B*3;q===0?ce=Zn[0]:ce=[K/q,te/q];var ca=c.unproject(X(ce));return ye([ca.lat+be.lat,ca.lng+be.lng])}function ea(i){for(var c=0,d=0,p=0,v=0;v<i.length;v++){var b=ye(i[v]);c+=b.lat,d+=b.lng,p++}return ye([c/p,d/p])}var ta={__proto__:null,clipPolygon:Cl,polygonCenter:Al,centroid:ea};function Gt(i,c){if(!c||!i.length)return i.slice();var d=c*c;return i=y(i,d),i=Fs(i,d),i}function Rl(i,c,d){return Math.sqrt(je(i,c,d,!0))}function Ou(i,c,d){return je(i,c,d)}function Fs(i,c){var d=i.length,p=typeof Uint8Array<"u"?Uint8Array:Array,v=new p(d);v[0]=v[d-1]=1,u(i,v,c,0,d-1);var b,B=[];for(b=0;b<d;b++)v[b]&&B.push(i[b]);return B}function u(i,c,d,p,v){var b=0,B,q,K;for(q=p+1;q<=v-1;q++)K=je(i[q],i[p],i[v],!0),K>b&&(B=q,b=K);b>d&&(c[B]=1,u(i,c,d,p,B),u(i,c,d,B,v))}function y(i,c){for(var d=[i[0]],p=1,v=0,b=i.length;p<b;p++)ie(i[p],i[v])>c&&(d.push(i[p]),v=p);return v<b-1&&d.push(i[b-1]),d}var x;function I(i,c,d,p,v){var b=p?x:Z(i,d),B=Z(c,d),q,K,te;for(x=B;;){if(!(b|B))return[i,c];if(b&B)return!1;q=b||B,K=W(i,c,q,d,v),te=Z(K,d),q===b?(i=K,b=te):(c=K,B=te)}}function W(i,c,d,p,v){var b=c.x-i.x,B=c.y-i.y,q=p.min,K=p.max,te,ce;return d&8?(te=i.x+b*(K.y-i.y)/B,ce=K.y):d&4?(te=i.x+b*(q.y-i.y)/B,ce=q.y):d&2?(te=K.x,ce=i.y+B*(K.x-i.x)/b):d&1&&(te=q.x,ce=i.y+B*(q.x-i.x)/b),new H(te,ce,v)}function Z(i,c){var d=0;return i.x<c.min.x?d|=1:i.x>c.max.x&&(d|=2),i.y<c.min.y?d|=4:i.y>c.max.y&&(d|=8),d}function ie(i,c){var d=c.x-i.x,p=c.y-i.y;return d*d+p*p}function je(i,c,d,p){var v=c.x,b=c.y,B=d.x-v,q=d.y-b,K=B*B+q*q,te;return K>0&&(te=((i.x-v)*B+(i.y-b)*q)/K,te>1?(v=d.x,b=d.y):te>0&&(v+=B*te,b+=q*te)),B=i.x-v,q=i.y-b,p?B*B+q*q:new H(v,b)}function Be(i){return!C(i[0])||typeof i[0][0]!="object"&&typeof i[0][0]<"u"}function We(i){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Be(i)}function gt(i,c){var d,p,v,b,B,q,K,te;if(!i||i.length===0)throw new Error("latlngs not passed");Be(i)||(console.warn("latlngs are not flat! Only the first ring will be used"),i=i[0]);var ce=ye([0,0]),be=_e(i),Re=be.getNorthWest().distanceTo(be.getSouthWest())*be.getNorthEast().distanceTo(be.getNorthWest());Re<1700&&(ce=ea(i));var ln=i.length,zt=[];for(d=0;d<ln;d++){var Zn=ye(i[d]);zt.push(c.project(ye([Zn.lat-ce.lat,Zn.lng-ce.lng])))}for(d=0,p=0;d<ln-1;d++)p+=zt[d].distanceTo(zt[d+1])/2;if(p===0)te=zt[0];else for(d=0,b=0;d<ln-1;d++)if(B=zt[d],q=zt[d+1],v=B.distanceTo(q),b+=v,b>p){K=(b-p)/v,te=[q.x-K*(q.x-B.x),q.y-K*(q.y-B.y)];break}var _n=c.unproject(X(te));return ye([_n.lat+ce.lat,_n.lng+ce.lng])}var Hn={__proto__:null,simplify:Gt,pointToSegmentDistance:Rl,closestPointOnSegment:Ou,clipSegment:I,_getEdgeIntersection:W,_getBitCode:Z,_sqClosestPointOnSegment:je,isFlat:Be,_flat:We,polylineCenter:gt},ar={project:function(i){return new H(i.lng,i.lat)},unproject:function(i){return new ge(i.y,i.x)},bounds:new Q([-180,-90],[180,90])},qn={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Q([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(i){var c=Math.PI/180,d=this.R,p=i.lat*c,v=this.R_MINOR/d,b=Math.sqrt(1-v*v),B=b*Math.sin(p),q=Math.tan(Math.PI/4-p/2)/Math.pow((1-B)/(1+B),b/2);return p=-d*Math.log(Math.max(q,1e-10)),new H(i.lng*c*d,p)},unproject:function(i){for(var c=180/Math.PI,d=this.R,p=this.R_MINOR/d,v=Math.sqrt(1-p*p),b=Math.exp(-i.y/d),B=Math.PI/2-2*Math.atan(b),q=0,K=.1,te;q<15&&Math.abs(K)>1e-7;q++)te=v*Math.sin(B),te=Math.pow((1-te)/(1+te),v/2),K=Math.PI/2-2*Math.atan(b*te)-B,B+=K;return new ge(B*c,i.x*c/d)}},kr={__proto__:null,LonLat:ar,Mercator:qn,SphericalMercator:mn},na=s({},Pe,{code:"EPSG:3395",projection:qn,transformation:function(){var i=.5/(Math.PI*qn.R);return we(i,.5,-i,.5)}()}),ra=s({},Pe,{code:"EPSG:4326",projection:ar,transformation:we(1/180,1,-1/180,.5)}),LT=s({},rt,{projection:ar,transformation:we(1,0,-1,0),scale:function(i){return Math.pow(2,i)},zoom:function(i){return Math.log(i)/Math.LN2},distance:function(i,c){var d=c.lng-i.lng,p=c.lat-i.lat;return Math.sqrt(d*d+p*p)},infinite:!0});rt.Earth=Pe,rt.EPSG3395=na,rt.EPSG3857=Je,rt.EPSG900913=Ke,rt.EPSG4326=ra,rt.Simple=LT;var lr=ne.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(i){return i.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(i){return i&&i.removeLayer(this),this},getPane:function(i){return this._map.getPane(i?this.options[i]||i:this.options.pane)},addInteractiveTarget:function(i){return this._map._targets[f(i)]=this,this},removeInteractiveTarget:function(i){return delete this._map._targets[f(i)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(i){var c=i.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var d=this.getEvents();c.on(d,this),this.once("remove",function(){c.off(d,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});Ae.include({addLayer:function(i){if(!i._layerAdd)throw new Error("The provided object is not a Layer.");var c=f(i);return this._layers[c]?this:(this._layers[c]=i,i._mapToAdd=this,i.beforeAdd&&i.beforeAdd(this),this.whenReady(i._layerAdd,i),this)},removeLayer:function(i){var c=f(i);return this._layers[c]?(this._loaded&&i.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:i}),i.fire("remove")),i._map=i._mapToAdd=null,this):this},hasLayer:function(i){return f(i)in this._layers},eachLayer:function(i,c){for(var d in this._layers)i.call(c,this._layers[d]);return this},_addLayers:function(i){i=i?C(i)?i:[i]:[];for(var c=0,d=i.length;c<d;c++)this.addLayer(i[c])},_addZoomLimit:function(i){(!isNaN(i.options.maxZoom)||!isNaN(i.options.minZoom))&&(this._zoomBoundLayers[f(i)]=i,this._updateZoomLevels())},_removeZoomLimit:function(i){var c=f(i);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var i=1/0,c=-1/0,d=this._getZoomSpan();for(var p in this._zoomBoundLayers){var v=this._zoomBoundLayers[p].options;i=v.minZoom===void 0?i:Math.min(i,v.minZoom),c=v.maxZoom===void 0?c:Math.max(c,v.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=i===1/0?void 0:i,d!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var sa=lr.extend({initialize:function(i,c){D(this,c),this._layers={};var d,p;if(i)for(d=0,p=i.length;d<p;d++)this.addLayer(i[d])},addLayer:function(i){var c=this.getLayerId(i);return this._layers[c]=i,this._map&&this._map.addLayer(i),this},removeLayer:function(i){var c=i in this._layers?i:this.getLayerId(i);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(i){var c=typeof i=="number"?i:this.getLayerId(i);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(i){var c=Array.prototype.slice.call(arguments,1),d,p;for(d in this._layers)p=this._layers[d],p[i]&&p[i].apply(p,c);return this},onAdd:function(i){this.eachLayer(i.addLayer,i)},onRemove:function(i){this.eachLayer(i.removeLayer,i)},eachLayer:function(i,c){for(var d in this._layers)i.call(c,this._layers[d]);return this},getLayer:function(i){return this._layers[i]},getLayers:function(){var i=[];return this.eachLayer(i.push,i),i},setZIndex:function(i){return this.invoke("setZIndex",i)},getLayerId:function(i){return f(i)}}),DT=function(i,c){return new sa(i,c)},as=sa.extend({addLayer:function(i){return this.hasLayer(i)?this:(i.addEventParent(this),sa.prototype.addLayer.call(this,i),this.fire("layeradd",{layer:i}))},removeLayer:function(i){return this.hasLayer(i)?(i in this._layers&&(i=this._layers[i]),i.removeEventParent(this),sa.prototype.removeLayer.call(this,i),this.fire("layerremove",{layer:i})):this},setStyle:function(i){return this.invoke("setStyle",i)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var i=new le;for(var c in this._layers){var d=this._layers[c];i.extend(d.getBounds?d.getBounds():d.getLatLng())}return i}}),zT=function(i,c){return new as(i,c)},ia=xe.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(i){D(this,i)},createIcon:function(i){return this._createIcon("icon",i)},createShadow:function(i){return this._createIcon("shadow",i)},_createIcon:function(i,c){var d=this._getIconUrl(i);if(!d){if(i==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var p=this._createImg(d,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(p,i),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),p},_setIconStyles:function(i,c){var d=this.options,p=d[c+"Size"];typeof p=="number"&&(p=[p,p]);var v=X(p),b=X(c==="shadow"&&d.shadowAnchor||d.iconAnchor||v&&v.divideBy(2,!0));i.className="leaflet-marker-"+c+" "+(d.className||""),b&&(i.style.marginLeft=-b.x+"px",i.style.marginTop=-b.y+"px"),v&&(i.style.width=v.x+"px",i.style.height=v.y+"px")},_createImg:function(i,c){return c=c||document.createElement("img"),c.src=i,c},_getIconUrl:function(i){return me.retina&&this.options[i+"RetinaUrl"]||this.options[i+"Url"]}});function MT(i){return new ia(i)}var Ll=ia.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(i){return typeof Ll.imagePath!="string"&&(Ll.imagePath=this._detectIconPath()),(this.options.imagePath||Ll.imagePath)+ia.prototype._getIconUrl.call(this,i)},_stripUrl:function(i){var c=function(d,p,v){var b=p.exec(d);return b&&b[v]};return i=c(i,/^url\((['"])?(.+)\1\)$/,2),i&&c(i,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var i=Oe("div","leaflet-default-icon-path",document.body),c=Os(i,"background-image")||Os(i,"backgroundImage");if(document.body.removeChild(i),c=this._stripUrl(c),c)return c;var d=document.querySelector('link[href$="leaflet.css"]');return d?d.href.substring(0,d.href.length-11-1):""}}),b_=Cn.extend({initialize:function(i){this._marker=i},addHooks:function(){var i=this._marker._icon;this._draggable||(this._draggable=new or(i,i,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),he(i,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Qe(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(i){var c=this._marker,d=c._map,p=this._marker.options.autoPanSpeed,v=this._marker.options.autoPanPadding,b=ss(c._icon),B=d.getPixelBounds(),q=d.getPixelOrigin(),K=G(B.min._subtract(q).add(v),B.max._subtract(q).subtract(v));if(!K.contains(b)){var te=X((Math.max(K.max.x,b.x)-K.max.x)/(B.max.x-K.max.x)-(Math.min(K.min.x,b.x)-K.min.x)/(B.min.x-K.min.x),(Math.max(K.max.y,b.y)-K.max.y)/(B.max.y-K.max.y)-(Math.min(K.min.y,b.y)-K.min.y)/(B.min.y-K.min.y)).multiplyBy(p);d.panBy(te,{animate:!1}),this._draggable._newPos._add(te),this._draggable._startPos._add(te),dt(c._icon,this._draggable._newPos),this._onDrag(i),this._panRequest=A(this._adjustPan.bind(this,i))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(i){this._marker.options.autoPan&&($(this._panRequest),this._panRequest=A(this._adjustPan.bind(this,i)))},_onDrag:function(i){var c=this._marker,d=c._shadow,p=ss(c._icon),v=c._map.layerPointToLatLng(p);d&&dt(d,p),c._latlng=v,i.latlng=v,i.oldLatLng=this._oldLatLng,c.fire("move",i).fire("drag",i)},_onDragEnd:function(i){$(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",i)}}),Vu=lr.extend({options:{icon:new Ll,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(i,c){D(this,c),this._latlng=ye(i)},onAdd:function(i){this._zoomAnimated=this._zoomAnimated&&i.options.markerZoomAnimation,this._zoomAnimated&&i.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(i){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&i.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(i){var c=this._latlng;return this._latlng=ye(i),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(i){return this.options.zIndexOffset=i,this.update()},getIcon:function(){return this.options.icon},setIcon:function(i){return this.options.icon=i,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var i=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(i)}return this},_initIcon:function(){var i=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),d=i.icon.createIcon(this._icon),p=!1;d!==this._icon&&(this._icon&&this._removeIcon(),p=!0,i.title&&(d.title=i.title),d.tagName==="IMG"&&(d.alt=i.alt||"")),he(d,c),i.keyboard&&(d.tabIndex="0",d.setAttribute("role","button")),this._icon=d,i.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Te(d,"focus",this._panOnFocus,this);var v=i.icon.createShadow(this._shadow),b=!1;v!==this._shadow&&(this._removeShadow(),b=!0),v&&(he(v,c),v.alt=""),this._shadow=v,i.opacity<1&&this._updateOpacity(),p&&this.getPane().appendChild(this._icon),this._initInteraction(),v&&b&&this.getPane(i.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ze(this._icon,"focus",this._panOnFocus,this),Fe(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Fe(this._shadow),this._shadow=null},_setPos:function(i){this._icon&&dt(this._icon,i),this._shadow&&dt(this._shadow,i),this._zIndex=i.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(i){this._icon&&(this._icon.style.zIndex=this._zIndex+i)},_animateZoom:function(i){var c=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(he(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),b_)){var i=this.options.draggable;this.dragging&&(i=this.dragging.enabled(),this.dragging.disable()),this.dragging=new b_(this),i&&this.dragging.enable()}},setOpacity:function(i){return this.options.opacity=i,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var i=this.options.opacity;this._icon&&gn(this._icon,i),this._shadow&&gn(this._shadow,i)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var i=this._map;if(i){var c=this.options.icon.options,d=c.iconSize?X(c.iconSize):X(0,0),p=c.iconAnchor?X(c.iconAnchor):X(0,0);i.panInside(this._latlng,{paddingTopLeft:p,paddingBottomRight:d.subtract(p)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function OT(i,c){return new Vu(i,c)}var Bs=lr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(i){this._renderer=i.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(i){return D(this,i),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&i&&Object.prototype.hasOwnProperty.call(i,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Uu=Bs.extend({options:{fill:!0,radius:10},initialize:function(i,c){D(this,c),this._latlng=ye(i),this._radius=this.options.radius},setLatLng:function(i){var c=this._latlng;return this._latlng=ye(i),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(i){return this.options.radius=this._radius=i,this.redraw()},getRadius:function(){return this._radius},setStyle:function(i){var c=i&&i.radius||this._radius;return Bs.prototype.setStyle.call(this,i),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var i=this._radius,c=this._radiusY||i,d=this._clickTolerance(),p=[i+d,c+d];this._pxBounds=new Q(this._point.subtract(p),this._point.add(p))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(i){return i.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function VT(i,c){return new Uu(i,c)}var Of=Uu.extend({initialize:function(i,c,d){if(typeof c=="number"&&(c=s({},d,{radius:c})),D(this,c),this._latlng=ye(i),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(i){return this._mRadius=i,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var i=[this._radius,this._radiusY||this._radius];return new le(this._map.layerPointToLatLng(this._point.subtract(i)),this._map.layerPointToLatLng(this._point.add(i)))},setStyle:Bs.prototype.setStyle,_project:function(){var i=this._latlng.lng,c=this._latlng.lat,d=this._map,p=d.options.crs;if(p.distance===Pe.distance){var v=Math.PI/180,b=this._mRadius/Pe.R/v,B=d.project([c+b,i]),q=d.project([c-b,i]),K=B.add(q).divideBy(2),te=d.unproject(K).lat,ce=Math.acos((Math.cos(b*v)-Math.sin(c*v)*Math.sin(te*v))/(Math.cos(c*v)*Math.cos(te*v)))/v;(isNaN(ce)||ce===0)&&(ce=b/Math.cos(Math.PI/180*c)),this._point=K.subtract(d.getPixelOrigin()),this._radius=isNaN(ce)?0:K.x-d.project([te,i-ce]).x,this._radiusY=K.y-B.y}else{var be=p.unproject(p.project(this._latlng).subtract([this._mRadius,0]));this._point=d.latLngToLayerPoint(this._latlng),this._radius=this._point.x-d.latLngToLayerPoint(be).x}this._updateBounds()}});function UT(i,c,d){return new Of(i,c,d)}var ls=Bs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(i,c){D(this,c),this._setLatLngs(i)},getLatLngs:function(){return this._latlngs},setLatLngs:function(i){return this._setLatLngs(i),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(i){for(var c=1/0,d=null,p=je,v,b,B=0,q=this._parts.length;B<q;B++)for(var K=this._parts[B],te=1,ce=K.length;te<ce;te++){v=K[te-1],b=K[te];var be=p(i,v,b,!0);be<c&&(c=be,d=p(i,v,b))}return d&&(d.distance=Math.sqrt(c)),d},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return gt(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(i,c){return c=c||this._defaultShape(),i=ye(i),c.push(i),this._bounds.extend(i),this.redraw()},_setLatLngs:function(i){this._bounds=new le,this._latlngs=this._convertLatLngs(i)},_defaultShape:function(){return Be(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(i){for(var c=[],d=Be(i),p=0,v=i.length;p<v;p++)d?(c[p]=ye(i[p]),this._bounds.extend(c[p])):c[p]=this._convertLatLngs(i[p]);return c},_project:function(){var i=new Q;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,i),this._bounds.isValid()&&i.isValid()&&(this._rawPxBounds=i,this._updateBounds())},_updateBounds:function(){var i=this._clickTolerance(),c=new H(i,i);this._rawPxBounds&&(this._pxBounds=new Q([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(i,c,d){var p=i[0]instanceof ge,v=i.length,b,B;if(p){for(B=[],b=0;b<v;b++)B[b]=this._map.latLngToLayerPoint(i[b]),d.extend(B[b]);c.push(B)}else for(b=0;b<v;b++)this._projectLatlngs(i[b],c,d)},_clipPoints:function(){var i=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(i))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,d,p,v,b,B,q,K;for(d=0,v=0,b=this._rings.length;d<b;d++)for(K=this._rings[d],p=0,B=K.length;p<B-1;p++)q=I(K[p],K[p+1],i,p,!0),q&&(c[v]=c[v]||[],c[v].push(q[0]),(q[1]!==K[p+1]||p===B-2)&&(c[v].push(q[1]),v++))}},_simplifyPoints:function(){for(var i=this._parts,c=this.options.smoothFactor,d=0,p=i.length;d<p;d++)i[d]=Gt(i[d],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(i,c){var d,p,v,b,B,q,K=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(i))return!1;for(d=0,b=this._parts.length;d<b;d++)for(q=this._parts[d],p=0,B=q.length,v=B-1;p<B;v=p++)if(!(!c&&p===0)&&Rl(i,q[v],q[p])<=K)return!0;return!1}});function FT(i,c){return new ls(i,c)}ls._flat=We;var oa=ls.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Al(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(i){var c=ls.prototype._convertLatLngs.call(this,i),d=c.length;return d>=2&&c[0]instanceof ge&&c[0].equals(c[d-1])&&c.pop(),c},_setLatLngs:function(i){ls.prototype._setLatLngs.call(this,i),Be(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Be(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var i=this._renderer._bounds,c=this.options.weight,d=new H(c,c);if(i=new Q(i.min.subtract(d),i.max.add(d)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(i))){if(this.options.noClip){this._parts=this._rings;return}for(var p=0,v=this._rings.length,b;p<v;p++)b=Cl(this._rings[p],i,!0),b.length&&this._parts.push(b)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(i){var c=!1,d,p,v,b,B,q,K,te;if(!this._pxBounds||!this._pxBounds.contains(i))return!1;for(b=0,K=this._parts.length;b<K;b++)for(d=this._parts[b],B=0,te=d.length,q=te-1;B<te;q=B++)p=d[B],v=d[q],p.y>i.y!=v.y>i.y&&i.x<(v.x-p.x)*(i.y-p.y)/(v.y-p.y)+p.x&&(c=!c);return c||ls.prototype._containsPoint.call(this,i,!0)}});function BT(i,c){return new oa(i,c)}var cs=as.extend({initialize:function(i,c){D(this,c),this._layers={},i&&this.addData(i)},addData:function(i){var c=C(i)?i:i.features,d,p,v;if(c){for(d=0,p=c.length;d<p;d++)v=c[d],(v.geometries||v.geometry||v.features||v.coordinates)&&this.addData(v);return this}var b=this.options;if(b.filter&&!b.filter(i))return this;var B=Fu(i,b);return B?(B.feature=Wu(i),B.defaultOptions=B.options,this.resetStyle(B),b.onEachFeature&&b.onEachFeature(i,B),this.addLayer(B)):this},resetStyle:function(i){return i===void 0?this.eachLayer(this.resetStyle,this):(i.options=s({},i.defaultOptions),this._setLayerStyle(i,this.options.style),this)},setStyle:function(i){return this.eachLayer(function(c){this._setLayerStyle(c,i)},this)},_setLayerStyle:function(i,c){i.setStyle&&(typeof c=="function"&&(c=c(i.feature)),i.setStyle(c))}});function Fu(i,c){var d=i.type==="Feature"?i.geometry:i,p=d?d.coordinates:null,v=[],b=c&&c.pointToLayer,B=c&&c.coordsToLatLng||Vf,q,K,te,ce;if(!p&&!d)return null;switch(d.type){case"Point":return q=B(p),N_(b,i,q,c);case"MultiPoint":for(te=0,ce=p.length;te<ce;te++)q=B(p[te]),v.push(N_(b,i,q,c));return new as(v);case"LineString":case"MultiLineString":return K=Bu(p,d.type==="LineString"?0:1,B),new ls(K,c);case"Polygon":case"MultiPolygon":return K=Bu(p,d.type==="Polygon"?1:2,B),new oa(K,c);case"GeometryCollection":for(te=0,ce=d.geometries.length;te<ce;te++){var be=Fu({geometry:d.geometries[te],type:"Feature",properties:i.properties},c);be&&v.push(be)}return new as(v);case"FeatureCollection":for(te=0,ce=d.features.length;te<ce;te++){var Re=Fu(d.features[te],c);Re&&v.push(Re)}return new as(v);default:throw new Error("Invalid GeoJSON object.")}}function N_(i,c,d,p){return i?i(c,d):new Vu(d,p&&p.markersInheritOptions&&p)}function Vf(i){return new ge(i[1],i[0],i[2])}function Bu(i,c,d){for(var p=[],v=0,b=i.length,B;v<b;v++)B=c?Bu(i[v],c-1,d):(d||Vf)(i[v]),p.push(B);return p}function Uf(i,c){return i=ye(i),i.alt!==void 0?[w(i.lng,c),w(i.lat,c),w(i.alt,c)]:[w(i.lng,c),w(i.lat,c)]}function $u(i,c,d,p){for(var v=[],b=0,B=i.length;b<B;b++)v.push(c?$u(i[b],Be(i[b])?0:c-1,d,p):Uf(i[b],p));return!c&&d&&v.length>0&&v.push(v[0].slice()),v}function aa(i,c){return i.feature?s({},i.feature,{geometry:c}):Wu(c)}function Wu(i){return i.type==="Feature"||i.type==="FeatureCollection"?i:{type:"Feature",properties:{},geometry:i}}var Ff={toGeoJSON:function(i){return aa(this,{type:"Point",coordinates:Uf(this.getLatLng(),i)})}};Vu.include(Ff),Of.include(Ff),Uu.include(Ff),ls.include({toGeoJSON:function(i){var c=!Be(this._latlngs),d=$u(this._latlngs,c?1:0,!1,i);return aa(this,{type:(c?"Multi":"")+"LineString",coordinates:d})}}),oa.include({toGeoJSON:function(i){var c=!Be(this._latlngs),d=c&&!Be(this._latlngs[0]),p=$u(this._latlngs,d?2:c?1:0,!0,i);return c||(p=[p]),aa(this,{type:(d?"Multi":"")+"Polygon",coordinates:p})}}),sa.include({toMultiPoint:function(i){var c=[];return this.eachLayer(function(d){c.push(d.toGeoJSON(i).geometry.coordinates)}),aa(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(i){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(i);var d=c==="GeometryCollection",p=[];return this.eachLayer(function(v){if(v.toGeoJSON){var b=v.toGeoJSON(i);if(d)p.push(b.geometry);else{var B=Wu(b);B.type==="FeatureCollection"?p.push.apply(p,B.features):p.push(B)}}}),d?aa(this,{geometries:p,type:"GeometryCollection"}):{type:"FeatureCollection",features:p}}});function E_(i,c){return new cs(i,c)}var $T=E_,Hu=lr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(i,c,d){this._url=i,this._bounds=_e(c),D(this,d)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(he(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Fe(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(i){return this.options.opacity=i,this._image&&this._updateOpacity(),this},setStyle:function(i){return i.opacity&&this.setOpacity(i.opacity),this},bringToFront:function(){return this._map&&Bn(this._image),this},bringToBack:function(){return this._map&&$n(this._image),this},setUrl:function(i){return this._url=i,this._image&&(this._image.src=i),this},setBounds:function(i){return this._bounds=_e(i),this._map&&this._reset(),this},getEvents:function(){var i={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},setZIndex:function(i){return this.options.zIndex=i,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var i=this._url.tagName==="IMG",c=this._image=i?this._url:Oe("img");if(he(c,"leaflet-image-layer"),this._zoomAnimated&&he(c,"leaflet-zoom-animated"),this.options.className&&he(c,this.options.className),c.onselectstart=_,c.onmousemove=_,c.onload=l(this.fire,this,"load"),c.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),i){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(i){var c=this._map.getZoomScale(i.zoom),d=this._map._latLngBoundsToNewLayerBounds(this._bounds,i.zoom,i.center).min;rs(this._image,d,c)},_reset:function(){var i=this._image,c=new Q(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),d=c.getSize();dt(i,c.min),i.style.width=d.x+"px",i.style.height=d.y+"px"},_updateOpacity:function(){gn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var i=this.options.errorOverlayUrl;i&&this._url!==i&&(this._url=i,this._image.src=i)},getCenter:function(){return this._bounds.getCenter()}}),WT=function(i,c,d){return new Hu(i,c,d)},T_=Hu.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var i=this._url.tagName==="VIDEO",c=this._image=i?this._url:Oe("video");if(he(c,"leaflet-image-layer"),this._zoomAnimated&&he(c,"leaflet-zoom-animated"),this.options.className&&he(c,this.options.className),c.onselectstart=_,c.onmousemove=_,c.onloadeddata=l(this.fire,this,"load"),i){for(var d=c.getElementsByTagName("source"),p=[],v=0;v<d.length;v++)p.push(d[v].src);this._url=d.length>0?p:[c.src];return}C(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var b=0;b<this._url.length;b++){var B=Oe("source");B.src=this._url[b],c.appendChild(B)}}});function HT(i,c,d){return new T_(i,c,d)}var j_=Hu.extend({_initImage:function(){var i=this._image=this._url;he(i,"leaflet-image-layer"),this._zoomAnimated&&he(i,"leaflet-zoom-animated"),this.options.className&&he(i,this.options.className),i.onselectstart=_,i.onmousemove=_}});function qT(i,c,d){return new j_(i,c,d)}var Sr=lr.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(i,c){i&&(i instanceof ge||C(i))?(this._latlng=ye(i),D(this,c)):(D(this,i),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(i){return i=arguments.length?i:this._source._map,i.hasLayer(this)||i.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(i){return this._map?this.close():(arguments.length?this._source=i:i=this._source,this._prepareOpen(),this.openOn(i._map)),this},onAdd:function(i){this._zoomAnimated=i._zoomAnimated,this._container||this._initLayout(),i._fadeAnimated&&gn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),i._fadeAnimated&&gn(this._container,1),this.bringToFront(),this.options.interactive&&(he(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(i){i._fadeAnimated?(gn(this._container,0),this._removeTimeout=setTimeout(l(Fe,void 0,this._container),200)):Fe(this._container),this.options.interactive&&(Qe(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(i){return this._latlng=ye(i),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(i){return this._content=i,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var i={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Bn(this._container),this},bringToBack:function(){return this._map&&$n(this._container),this},_prepareOpen:function(i){var c=this._source;if(!c._map)return!1;if(c instanceof as){c=null;var d=this._source._layers;for(var p in d)if(d[p]._map){c=d[p];break}if(!c)return!1;this._source=c}if(!i)if(c.getCenter)i=c.getCenter();else if(c.getLatLng)i=c.getLatLng();else if(c.getBounds)i=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(i),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var i=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")i.innerHTML=c;else{for(;i.hasChildNodes();)i.removeChild(i.firstChild);i.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var i=this._map.latLngToLayerPoint(this._latlng),c=X(this.options.offset),d=this._getAnchor();this._zoomAnimated?dt(this._container,i.add(d)):c=c.add(i).add(d);var p=this._containerBottom=-c.y,v=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=p+"px",this._container.style.left=v+"px"}},_getAnchor:function(){return[0,0]}});Ae.include({_initOverlay:function(i,c,d,p){var v=c;return v instanceof i||(v=new i(p).setContent(c)),d&&v.setLatLng(d),v}}),lr.include({_initOverlay:function(i,c,d,p){var v=d;return v instanceof i?(D(v,p),v._source=this):(v=c&&!p?c:new i(p,this),v.setContent(d)),v}});var qu=Sr.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(i){return i=arguments.length?i:this._source._map,!i.hasLayer(this)&&i._popup&&i._popup.options.autoClose&&i.removeLayer(i._popup),i._popup=this,Sr.prototype.openOn.call(this,i)},onAdd:function(i){Sr.prototype.onAdd.call(this,i),i.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Bs||this._source.on("preclick",$e))},onRemove:function(i){Sr.prototype.onRemove.call(this,i),i.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Bs||this._source.off("preclick",$e))},getEvents:function(){var i=Sr.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(i.preclick=this.close),this.options.keepInView&&(i.moveend=this._adjustPan),i},_initLayout:function(){var i="leaflet-popup",c=this._container=Oe("div",i+" "+(this.options.className||"")+" leaflet-zoom-animated"),d=this._wrapper=Oe("div",i+"-content-wrapper",c);if(this._contentNode=Oe("div",i+"-content",d),Xi(c),Nl(this._contentNode),Te(c,"contextmenu",$e),this._tipContainer=Oe("div",i+"-tip-container",c),this._tip=Oe("div",i+"-tip",this._tipContainer),this.options.closeButton){var p=this._closeButton=Oe("a",i+"-close-button",c);p.setAttribute("role","button"),p.setAttribute("aria-label","Close popup"),p.href="#close",p.innerHTML='<span aria-hidden="true">&#215;</span>',Te(p,"click",function(v){wt(v),this.close()},this)}},_updateLayout:function(){var i=this._contentNode,c=i.style;c.width="",c.whiteSpace="nowrap";var d=i.offsetWidth;d=Math.min(d,this.options.maxWidth),d=Math.max(d,this.options.minWidth),c.width=d+1+"px",c.whiteSpace="",c.height="";var p=i.offsetHeight,v=this.options.maxHeight,b="leaflet-popup-scrolled";v&&p>v?(c.height=v+"px",he(i,b)):Qe(i,b),this._containerWidth=this._container.offsetWidth},_animateZoom:function(i){var c=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center),d=this._getAnchor();dt(this._container,c.add(d))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var i=this._map,c=parseInt(Os(this._container,"marginBottom"),10)||0,d=this._container.offsetHeight+c,p=this._containerWidth,v=new H(this._containerLeft,-d-this._containerBottom);v._add(ss(this._container));var b=i.layerPointToContainerPoint(v),B=X(this.options.autoPanPadding),q=X(this.options.autoPanPaddingTopLeft||B),K=X(this.options.autoPanPaddingBottomRight||B),te=i.getSize(),ce=0,be=0;b.x+p+K.x>te.x&&(ce=b.x+p-te.x+K.x),b.x-ce-q.x<0&&(ce=b.x-q.x),b.y+d+K.y>te.y&&(be=b.y+d-te.y+K.y),b.y-be-q.y<0&&(be=b.y-q.y),(ce||be)&&(this.options.keepInView&&(this._autopanning=!0),i.fire("autopanstart").panBy([ce,be]))}},_getAnchor:function(){return X(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ZT=function(i,c){return new qu(i,c)};Ae.mergeOptions({closePopupOnClick:!0}),Ae.include({openPopup:function(i,c,d){return this._initOverlay(qu,i,c,d).openOn(this),this},closePopup:function(i){return i=arguments.length?i:this._popup,i&&i.close(),this}}),lr.include({bindPopup:function(i,c){return this._popup=this._initOverlay(qu,this._popup,i,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(i){return this._popup&&(this instanceof as||(this._popup._source=this),this._popup._prepareOpen(i||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(i){return this._popup&&this._popup.setContent(i),this},getPopup:function(){return this._popup},_openPopup:function(i){if(!(!this._popup||!this._map)){Nr(i);var c=i.layer||i.target;if(this._popup._source===c&&!(c instanceof Bs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(i.latlng);return}this._popup._source=c,this.openPopup(i.latlng)}},_movePopup:function(i){this._popup.setLatLng(i.latlng)},_onKeyPress:function(i){i.originalEvent.keyCode===13&&this._openPopup(i)}});var Zu=Sr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(i){Sr.prototype.onAdd.call(this,i),this.setOpacity(this.options.opacity),i.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(i){Sr.prototype.onRemove.call(this,i),i.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var i=Sr.prototype.getEvents.call(this);return this.options.permanent||(i.preclick=this.close),i},_initLayout:function(){var i="leaflet-tooltip",c=i+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Oe("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+f(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(i){var c,d,p=this._map,v=this._container,b=p.latLngToContainerPoint(p.getCenter()),B=p.layerPointToContainerPoint(i),q=this.options.direction,K=v.offsetWidth,te=v.offsetHeight,ce=X(this.options.offset),be=this._getAnchor();q==="top"?(c=K/2,d=te):q==="bottom"?(c=K/2,d=0):q==="center"?(c=K/2,d=te/2):q==="right"?(c=0,d=te/2):q==="left"?(c=K,d=te/2):B.x<b.x?(q="right",c=0,d=te/2):(q="left",c=K+(ce.x+be.x)*2,d=te/2),i=i.subtract(X(c,d,!0)).add(ce).add(be),Qe(v,"leaflet-tooltip-right"),Qe(v,"leaflet-tooltip-left"),Qe(v,"leaflet-tooltip-top"),Qe(v,"leaflet-tooltip-bottom"),he(v,"leaflet-tooltip-"+q),dt(v,i)},_updatePosition:function(){var i=this._map.latLngToLayerPoint(this._latlng);this._setPosition(i)},setOpacity:function(i){this.options.opacity=i,this._container&&gn(this._container,i)},_animateZoom:function(i){var c=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center);this._setPosition(c)},_getAnchor:function(){return X(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),GT=function(i,c){return new Zu(i,c)};Ae.include({openTooltip:function(i,c,d){return this._initOverlay(Zu,i,c,d).openOn(this),this},closeTooltip:function(i){return i.close(),this}}),lr.include({bindTooltip:function(i,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Zu,this._tooltip,i,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(i){if(!(!i&&this._tooltipHandlersAdded)){var c=i?"off":"on",d={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?d.add=this._openTooltip:(d.mouseover=this._openTooltip,d.mouseout=this.closeTooltip,d.click=this._openTooltip,this._map?this._addFocusListeners():d.add=this._addFocusListeners),this._tooltip.options.sticky&&(d.mousemove=this._moveTooltip),this[c](d),this._tooltipHandlersAdded=!i}},openTooltip:function(i){return this._tooltip&&(this instanceof as||(this._tooltip._source=this),this._tooltip._prepareOpen(i)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(i){return this._tooltip&&this._tooltip.setContent(i),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(i){var c=typeof i.getElement=="function"&&i.getElement();c&&(Te(c,"focus",function(){this._tooltip._source=i,this.openTooltip()},this),Te(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(i){var c=typeof i.getElement=="function"&&i.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(i){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(i)});return}this._tooltip._source=i.layer||i.target,this.openTooltip(this._tooltip.options.sticky?i.latlng:void 0)}},_moveTooltip:function(i){var c=i.latlng,d,p;this._tooltip.options.sticky&&i.originalEvent&&(d=this._map.mouseEventToContainerPoint(i.originalEvent),p=this._map.containerPointToLayerPoint(d),c=this._map.layerPointToLatLng(p)),this._tooltip.setLatLng(c)}});var k_=ia.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(i){var c=i&&i.tagName==="DIV"?i:document.createElement("div"),d=this.options;if(d.html instanceof Element?(on(c),c.appendChild(d.html)):c.innerHTML=d.html!==!1?d.html:"",d.bgPos){var p=X(d.bgPos);c.style.backgroundPosition=-p.x+"px "+-p.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function KT(i){return new k_(i)}ia.Default=Ll;var Dl=lr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:me.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(i){D(this,i)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(i){i._addZoomLimit(this)},onRemove:function(i){this._removeAllTiles(),Fe(this._container),i._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Bn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&($n(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(i){return this.options.opacity=i,this._updateOpacity(),this},setZIndex:function(i){return this.options.zIndex=i,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var i=this._clampZoom(this._map.getZoom());i!==this._tileZoom&&(this._tileZoom=i,this._updateLevels()),this._update()}return this},getEvents:function(){var i={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=m(this._onMoveEnd,this.options.updateInterval,this)),i.move=this._onMove),this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},createTile:function(){return document.createElement("div")},getTileSize:function(){var i=this.options.tileSize;return i instanceof H?i:new H(i,i)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(i){for(var c=this.getPane().children,d=-i(-1/0,1/0),p=0,v=c.length,b;p<v;p++)b=c[p].style.zIndex,c[p]!==this._container&&b&&(d=i(d,+b));isFinite(d)&&(this.options.zIndex=d+i(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!me.ielt9){gn(this._container,this.options.opacity);var i=+new Date,c=!1,d=!1;for(var p in this._tiles){var v=this._tiles[p];if(!(!v.current||!v.loaded)){var b=Math.min(1,(i-v.loaded)/200);gn(v.el,b),b<1?c=!0:(v.active?d=!0:this._onOpaqueTile(v),v.active=!0)}}d&&!this._noPrune&&this._pruneTiles(),c&&($(this._fadeFrame),this._fadeFrame=A(this._updateOpacity,this))}},_onOpaqueTile:_,_initContainer:function(){this._container||(this._container=Oe("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var i=this._tileZoom,c=this.options.maxZoom;if(i!==void 0){for(var d in this._levels)d=Number(d),this._levels[d].el.children.length||d===i?(this._levels[d].el.style.zIndex=c-Math.abs(i-d),this._onUpdateLevel(d)):(Fe(this._levels[d].el),this._removeTilesAtZoom(d),this._onRemoveLevel(d),delete this._levels[d]);var p=this._levels[i],v=this._map;return p||(p=this._levels[i]={},p.el=Oe("div","leaflet-tile-container leaflet-zoom-animated",this._container),p.el.style.zIndex=c,p.origin=v.project(v.unproject(v.getPixelOrigin()),i).round(),p.zoom=i,this._setZoomTransform(p,v.getCenter(),v.getZoom()),_(p.el.offsetWidth),this._onCreateLevel(p)),this._level=p,p}},_onUpdateLevel:_,_onRemoveLevel:_,_onCreateLevel:_,_pruneTiles:function(){if(this._map){var i,c,d=this._map.getZoom();if(d>this.options.maxZoom||d<this.options.minZoom){this._removeAllTiles();return}for(i in this._tiles)c=this._tiles[i],c.retain=c.current;for(i in this._tiles)if(c=this._tiles[i],c.current&&!c.active){var p=c.coords;this._retainParent(p.x,p.y,p.z,p.z-5)||this._retainChildren(p.x,p.y,p.z,p.z+2)}for(i in this._tiles)this._tiles[i].retain||this._removeTile(i)}},_removeTilesAtZoom:function(i){for(var c in this._tiles)this._tiles[c].coords.z===i&&this._removeTile(c)},_removeAllTiles:function(){for(var i in this._tiles)this._removeTile(i)},_invalidateAll:function(){for(var i in this._levels)Fe(this._levels[i].el),this._onRemoveLevel(Number(i)),delete this._levels[i];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(i,c,d,p){var v=Math.floor(i/2),b=Math.floor(c/2),B=d-1,q=new H(+v,+b);q.z=+B;var K=this._tileCoordsToKey(q),te=this._tiles[K];return te&&te.active?(te.retain=!0,!0):(te&&te.loaded&&(te.retain=!0),B>p?this._retainParent(v,b,B,p):!1)},_retainChildren:function(i,c,d,p){for(var v=2*i;v<2*i+2;v++)for(var b=2*c;b<2*c+2;b++){var B=new H(v,b);B.z=d+1;var q=this._tileCoordsToKey(B),K=this._tiles[q];if(K&&K.active){K.retain=!0;continue}else K&&K.loaded&&(K.retain=!0);d+1<p&&this._retainChildren(v,b,d+1,p)}},_resetView:function(i){var c=i&&(i.pinch||i.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(i){this._setView(i.center,i.zoom,!0,i.noUpdate)},_clampZoom:function(i){var c=this.options;return c.minNativeZoom!==void 0&&i<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<i?c.maxNativeZoom:i},_setView:function(i,c,d,p){var v=Math.round(c);this.options.maxZoom!==void 0&&v>this.options.maxZoom||this.options.minZoom!==void 0&&v<this.options.minZoom?v=void 0:v=this._clampZoom(v);var b=this.options.updateWhenZooming&&v!==this._tileZoom;(!p||b)&&(this._tileZoom=v,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),v!==void 0&&this._update(i),d||this._pruneTiles(),this._noPrune=!!d),this._setZoomTransforms(i,c)},_setZoomTransforms:function(i,c){for(var d in this._levels)this._setZoomTransform(this._levels[d],i,c)},_setZoomTransform:function(i,c,d){var p=this._map.getZoomScale(d,i.zoom),v=i.origin.multiplyBy(p).subtract(this._map._getNewPixelOrigin(c,d)).round();me.any3d?rs(i.el,v,p):dt(i.el,v)},_resetGrid:function(){var i=this._map,c=i.options.crs,d=this._tileSize=this.getTileSize(),p=this._tileZoom,v=this._map.getPixelWorldBounds(this._tileZoom);v&&(this._globalTileRange=this._pxBoundsToTileRange(v)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(i.project([0,c.wrapLng[0]],p).x/d.x),Math.ceil(i.project([0,c.wrapLng[1]],p).x/d.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(i.project([c.wrapLat[0],0],p).y/d.x),Math.ceil(i.project([c.wrapLat[1],0],p).y/d.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(i){var c=this._map,d=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),p=c.getZoomScale(d,this._tileZoom),v=c.project(i,this._tileZoom).floor(),b=c.getSize().divideBy(p*2);return new Q(v.subtract(b),v.add(b))},_update:function(i){var c=this._map;if(c){var d=this._clampZoom(c.getZoom());if(i===void 0&&(i=c.getCenter()),this._tileZoom!==void 0){var p=this._getTiledPixelBounds(i),v=this._pxBoundsToTileRange(p),b=v.getCenter(),B=[],q=this.options.keepBuffer,K=new Q(v.getBottomLeft().subtract([q,-q]),v.getTopRight().add([q,-q]));if(!(isFinite(v.min.x)&&isFinite(v.min.y)&&isFinite(v.max.x)&&isFinite(v.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var te in this._tiles){var ce=this._tiles[te].coords;(ce.z!==this._tileZoom||!K.contains(new H(ce.x,ce.y)))&&(this._tiles[te].current=!1)}if(Math.abs(d-this._tileZoom)>1){this._setView(i,d);return}for(var be=v.min.y;be<=v.max.y;be++)for(var Re=v.min.x;Re<=v.max.x;Re++){var ln=new H(Re,be);if(ln.z=this._tileZoom,!!this._isValidTile(ln)){var zt=this._tiles[this._tileCoordsToKey(ln)];zt?zt.current=!0:B.push(ln)}}if(B.sort(function(_n,ca){return _n.distanceTo(b)-ca.distanceTo(b)}),B.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Zn=document.createDocumentFragment();for(Re=0;Re<B.length;Re++)this._addTile(B[Re],Zn);this._level.el.appendChild(Zn)}}}},_isValidTile:function(i){var c=this._map.options.crs;if(!c.infinite){var d=this._globalTileRange;if(!c.wrapLng&&(i.x<d.min.x||i.x>d.max.x)||!c.wrapLat&&(i.y<d.min.y||i.y>d.max.y))return!1}if(!this.options.bounds)return!0;var p=this._tileCoordsToBounds(i);return _e(this.options.bounds).overlaps(p)},_keyToBounds:function(i){return this._tileCoordsToBounds(this._keyToTileCoords(i))},_tileCoordsToNwSe:function(i){var c=this._map,d=this.getTileSize(),p=i.scaleBy(d),v=p.add(d),b=c.unproject(p,i.z),B=c.unproject(v,i.z);return[b,B]},_tileCoordsToBounds:function(i){var c=this._tileCoordsToNwSe(i),d=new le(c[0],c[1]);return this.options.noWrap||(d=this._map.wrapLatLngBounds(d)),d},_tileCoordsToKey:function(i){return i.x+":"+i.y+":"+i.z},_keyToTileCoords:function(i){var c=i.split(":"),d=new H(+c[0],+c[1]);return d.z=+c[2],d},_removeTile:function(i){var c=this._tiles[i];c&&(Fe(c.el),delete this._tiles[i],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(i)}))},_initTile:function(i){he(i,"leaflet-tile");var c=this.getTileSize();i.style.width=c.x+"px",i.style.height=c.y+"px",i.onselectstart=_,i.onmousemove=_,me.ielt9&&this.options.opacity<1&&gn(i,this.options.opacity)},_addTile:function(i,c){var d=this._getTilePos(i),p=this._tileCoordsToKey(i),v=this.createTile(this._wrapCoords(i),l(this._tileReady,this,i));this._initTile(v),this.createTile.length<2&&A(l(this._tileReady,this,i,null,v)),dt(v,d),this._tiles[p]={el:v,coords:i,current:!0},c.appendChild(v),this.fire("tileloadstart",{tile:v,coords:i})},_tileReady:function(i,c,d){c&&this.fire("tileerror",{error:c,tile:d,coords:i});var p=this._tileCoordsToKey(i);d=this._tiles[p],d&&(d.loaded=+new Date,this._map._fadeAnimated?(gn(d.el,0),$(this._fadeFrame),this._fadeFrame=A(this._updateOpacity,this)):(d.active=!0,this._pruneTiles()),c||(he(d.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:d.el,coords:i})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),me.ielt9||!this._map._fadeAnimated?A(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(i){return i.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(i){var c=new H(this._wrapX?g(i.x,this._wrapX):i.x,this._wrapY?g(i.y,this._wrapY):i.y);return c.z=i.z,c},_pxBoundsToTileRange:function(i){var c=this.getTileSize();return new Q(i.min.unscaleBy(c).floor(),i.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var i in this._tiles)if(!this._tiles[i].loaded)return!1;return!0}});function QT(i){return new Dl(i)}var la=Dl.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(i,c){this._url=i,c=D(this,c),c.detectRetina&&me.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(i,c){return this._url===i&&c===void 0&&(c=!0),this._url=i,c||this.redraw(),this},createTile:function(i,c){var d=document.createElement("img");return Te(d,"load",l(this._tileOnLoad,this,c,d)),Te(d,"error",l(this._tileOnError,this,c,d)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(d.referrerPolicy=this.options.referrerPolicy),d.alt="",d.src=this.getTileUrl(i),d},getTileUrl:function(i){var c={r:me.retina?"@2x":"",s:this._getSubdomain(i),x:i.x,y:i.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var d=this._globalTileRange.max.y-i.y;this.options.tms&&(c.y=d),c["-y"]=d}return S(this._url,s(c,this.options))},_tileOnLoad:function(i,c){me.ielt9?setTimeout(l(i,this,null,c),0):i(null,c)},_tileOnError:function(i,c,d){var p=this.options.errorTileUrl;p&&c.getAttribute("src")!==p&&(c.src=p),i(d,c)},_onTileRemove:function(i){i.tile.onload=null},_getZoomForUrl:function(){var i=this._tileZoom,c=this.options.maxZoom,d=this.options.zoomReverse,p=this.options.zoomOffset;return d&&(i=c-i),i+p},_getSubdomain:function(i){var c=Math.abs(i.x+i.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var i,c;for(i in this._tiles)if(this._tiles[i].coords.z!==this._tileZoom&&(c=this._tiles[i].el,c.onload=_,c.onerror=_,!c.complete)){c.src=F;var d=this._tiles[i].coords;Fe(c),delete this._tiles[i],this.fire("tileabort",{tile:c,coords:d})}},_removeTile:function(i){var c=this._tiles[i];if(c)return c.el.setAttribute("src",F),Dl.prototype._removeTile.call(this,i)},_tileReady:function(i,c,d){if(!(!this._map||d&&d.getAttribute("src")===F))return Dl.prototype._tileReady.call(this,i,c,d)}});function S_(i,c){return new la(i,c)}var P_=la.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(i,c){this._url=i;var d=s({},this.defaultWmsParams);for(var p in c)p in this.options||(d[p]=c[p]);c=D(this,c);var v=c.detectRetina&&me.retina?2:1,b=this.getTileSize();d.width=b.x*v,d.height=b.y*v,this.wmsParams=d},onAdd:function(i){this._crs=this.options.crs||i.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,la.prototype.onAdd.call(this,i)},getTileUrl:function(i){var c=this._tileCoordsToNwSe(i),d=this._crs,p=G(d.project(c[0]),d.project(c[1])),v=p.min,b=p.max,B=(this._wmsVersion>=1.3&&this._crs===ra?[v.y,v.x,b.y,b.x]:[v.x,v.y,b.x,b.y]).join(","),q=la.prototype.getTileUrl.call(this,i);return q+M(this.wmsParams,q,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+B},setParams:function(i,c){return s(this.wmsParams,i),c||this.redraw(),this}});function YT(i,c){return new P_(i,c)}la.WMS=P_,S_.wms=YT;var us=lr.extend({options:{padding:.1},initialize:function(i){D(this,i),f(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),he(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var i={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(i.zoomanim=this._onAnimZoom),i},_onAnimZoom:function(i){this._updateTransform(i.center,i.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(i,c){var d=this._map.getZoomScale(c,this._zoom),p=this._map.getSize().multiplyBy(.5+this.options.padding),v=this._map.project(this._center,c),b=p.multiplyBy(-d).add(v).subtract(this._map._getNewPixelOrigin(i,c));me.any3d?rs(this._container,b,d):dt(this._container,b)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var i in this._layers)this._layers[i]._reset()},_onZoomEnd:function(){for(var i in this._layers)this._layers[i]._project()},_updatePaths:function(){for(var i in this._layers)this._layers[i]._update()},_update:function(){var i=this.options.padding,c=this._map.getSize(),d=this._map.containerPointToLayerPoint(c.multiplyBy(-i)).round();this._bounds=new Q(d,d.add(c.multiplyBy(1+i*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),I_=us.extend({options:{tolerance:0},getEvents:function(){var i=us.prototype.getEvents.call(this);return i.viewprereset=this._onViewPreReset,i},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){us.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var i=this._container=document.createElement("canvas");Te(i,"mousemove",this._onMouseMove,this),Te(i,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Te(i,"mouseout",this._handleMouseOut,this),i._leaflet_disable_events=!0,this._ctx=i.getContext("2d")},_destroyContainer:function(){$(this._redrawRequest),delete this._ctx,Fe(this._container),Ze(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var i;this._redrawBounds=null;for(var c in this._layers)i=this._layers[c],i._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){us.prototype._update.call(this);var i=this._bounds,c=this._container,d=i.getSize(),p=me.retina?2:1;dt(c,i.min),c.width=p*d.x,c.height=p*d.y,c.style.width=d.x+"px",c.style.height=d.y+"px",me.retina&&this._ctx.scale(2,2),this._ctx.translate(-i.min.x,-i.min.y),this.fire("update")}},_reset:function(){us.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(i){this._updateDashArray(i),this._layers[f(i)]=i;var c=i._order={layer:i,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(i){this._requestRedraw(i)},_removePath:function(i){var c=i._order,d=c.next,p=c.prev;d?d.prev=p:this._drawLast=p,p?p.next=d:this._drawFirst=d,delete i._order,delete this._layers[f(i)],this._requestRedraw(i)},_updatePath:function(i){this._extendRedrawBounds(i),i._project(),i._update(),this._requestRedraw(i)},_updateStyle:function(i){this._updateDashArray(i),this._requestRedraw(i)},_updateDashArray:function(i){if(typeof i.options.dashArray=="string"){var c=i.options.dashArray.split(/[, ]+/),d=[],p,v;for(v=0;v<c.length;v++){if(p=Number(c[v]),isNaN(p))return;d.push(p)}i.options._dashArray=d}else i.options._dashArray=i.options.dashArray},_requestRedraw:function(i){this._map&&(this._extendRedrawBounds(i),this._redrawRequest=this._redrawRequest||A(this._redraw,this))},_extendRedrawBounds:function(i){if(i._pxBounds){var c=(i.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Q,this._redrawBounds.extend(i._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(i._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var i=this._redrawBounds;if(i){var c=i.getSize();this._ctx.clearRect(i.min.x,i.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var i,c=this._redrawBounds;if(this._ctx.save(),c){var d=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,d.x,d.y),this._ctx.clip()}this._drawing=!0;for(var p=this._drawFirst;p;p=p.next)i=p.layer,(!c||i._pxBounds&&i._pxBounds.intersects(c))&&i._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(i,c){if(this._drawing){var d,p,v,b,B=i._parts,q=B.length,K=this._ctx;if(q){for(K.beginPath(),d=0;d<q;d++){for(p=0,v=B[d].length;p<v;p++)b=B[d][p],K[p?"lineTo":"moveTo"](b.x,b.y);c&&K.closePath()}this._fillStroke(K,i)}}},_updateCircle:function(i){if(!(!this._drawing||i._empty())){var c=i._point,d=this._ctx,p=Math.max(Math.round(i._radius),1),v=(Math.max(Math.round(i._radiusY),1)||p)/p;v!==1&&(d.save(),d.scale(1,v)),d.beginPath(),d.arc(c.x,c.y/v,p,0,Math.PI*2,!1),v!==1&&d.restore(),this._fillStroke(d,i)}},_fillStroke:function(i,c){var d=c.options;d.fill&&(i.globalAlpha=d.fillOpacity,i.fillStyle=d.fillColor||d.color,i.fill(d.fillRule||"evenodd")),d.stroke&&d.weight!==0&&(i.setLineDash&&i.setLineDash(c.options&&c.options._dashArray||[]),i.globalAlpha=d.opacity,i.lineWidth=d.weight,i.strokeStyle=d.color,i.lineCap=d.lineCap,i.lineJoin=d.lineJoin,i.stroke())},_onClick:function(i){for(var c=this._map.mouseEventToLayerPoint(i),d,p,v=this._drawFirst;v;v=v.next)d=v.layer,d.options.interactive&&d._containsPoint(c)&&(!(i.type==="click"||i.type==="preclick")||!this._map._draggableMoved(d))&&(p=d);this._fireEvent(p?[p]:!1,i)},_onMouseMove:function(i){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(i);this._handleMouseHover(i,c)}},_handleMouseOut:function(i){var c=this._hoveredLayer;c&&(Qe(this._container,"leaflet-interactive"),this._fireEvent([c],i,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(i,c){if(!this._mouseHoverThrottled){for(var d,p,v=this._drawFirst;v;v=v.next)d=v.layer,d.options.interactive&&d._containsPoint(c)&&(p=d);p!==this._hoveredLayer&&(this._handleMouseOut(i),p&&(he(this._container,"leaflet-interactive"),this._fireEvent([p],i,"mouseover"),this._hoveredLayer=p)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,i),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(i,c,d){this._map._fireDOMEvent(c,d||c.type,i)},_bringToFront:function(i){var c=i._order;if(c){var d=c.next,p=c.prev;if(d)d.prev=p;else return;p?p.next=d:d&&(this._drawFirst=d),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(i)}},_bringToBack:function(i){var c=i._order;if(c){var d=c.next,p=c.prev;if(p)p.next=d;else return;d?d.prev=p:p&&(this._drawLast=p),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(i)}}});function C_(i){return me.canvas?new I_(i):null}var zl=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(i){return document.createElement("<lvml:"+i+' class="lvml">')}}catch{}return function(i){return document.createElement("<"+i+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),XT={_initContainer:function(){this._container=Oe("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(us.prototype._update.call(this),this.fire("update"))},_initPath:function(i){var c=i._container=zl("shape");he(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",i._path=zl("path"),c.appendChild(i._path),this._updateStyle(i),this._layers[f(i)]=i},_addPath:function(i){var c=i._container;this._container.appendChild(c),i.options.interactive&&i.addInteractiveTarget(c)},_removePath:function(i){var c=i._container;Fe(c),i.removeInteractiveTarget(c),delete this._layers[f(i)]},_updateStyle:function(i){var c=i._stroke,d=i._fill,p=i.options,v=i._container;v.stroked=!!p.stroke,v.filled=!!p.fill,p.stroke?(c||(c=i._stroke=zl("stroke")),v.appendChild(c),c.weight=p.weight+"px",c.color=p.color,c.opacity=p.opacity,p.dashArray?c.dashStyle=C(p.dashArray)?p.dashArray.join(" "):p.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=p.lineCap.replace("butt","flat"),c.joinstyle=p.lineJoin):c&&(v.removeChild(c),i._stroke=null),p.fill?(d||(d=i._fill=zl("fill")),v.appendChild(d),d.color=p.fillColor||p.color,d.opacity=p.fillOpacity):d&&(v.removeChild(d),i._fill=null)},_updateCircle:function(i){var c=i._point.round(),d=Math.round(i._radius),p=Math.round(i._radiusY||d);this._setPath(i,i._empty()?"M0 0":"AL "+c.x+","+c.y+" "+d+","+p+" 0,"+65535*360)},_setPath:function(i,c){i._path.v=c},_bringToFront:function(i){Bn(i._container)},_bringToBack:function(i){$n(i._container)}},Gu=me.vml?zl:xt,Ml=us.extend({_initContainer:function(){this._container=Gu("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Gu("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Fe(this._container),Ze(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){us.prototype._update.call(this);var i=this._bounds,c=i.getSize(),d=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,d.setAttribute("width",c.x),d.setAttribute("height",c.y)),dt(d,i.min),d.setAttribute("viewBox",[i.min.x,i.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(i){var c=i._path=Gu("path");i.options.className&&he(c,i.options.className),i.options.interactive&&he(c,"leaflet-interactive"),this._updateStyle(i),this._layers[f(i)]=i},_addPath:function(i){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(i._path),i.addInteractiveTarget(i._path)},_removePath:function(i){Fe(i._path),i.removeInteractiveTarget(i._path),delete this._layers[f(i)]},_updatePath:function(i){i._project(),i._update()},_updateStyle:function(i){var c=i._path,d=i.options;c&&(d.stroke?(c.setAttribute("stroke",d.color),c.setAttribute("stroke-opacity",d.opacity),c.setAttribute("stroke-width",d.weight),c.setAttribute("stroke-linecap",d.lineCap),c.setAttribute("stroke-linejoin",d.lineJoin),d.dashArray?c.setAttribute("stroke-dasharray",d.dashArray):c.removeAttribute("stroke-dasharray"),d.dashOffset?c.setAttribute("stroke-dashoffset",d.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),d.fill?(c.setAttribute("fill",d.fillColor||d.color),c.setAttribute("fill-opacity",d.fillOpacity),c.setAttribute("fill-rule",d.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(i,c){this._setPath(i,Pn(i._parts,c))},_updateCircle:function(i){var c=i._point,d=Math.max(Math.round(i._radius),1),p=Math.max(Math.round(i._radiusY),1)||d,v="a"+d+","+p+" 0 1,0 ",b=i._empty()?"M0 0":"M"+(c.x-d)+","+c.y+v+d*2+",0 "+v+-d*2+",0 ";this._setPath(i,b)},_setPath:function(i,c){i._path.setAttribute("d",c)},_bringToFront:function(i){Bn(i._path)},_bringToBack:function(i){$n(i._path)}});me.vml&&Ml.include(XT);function A_(i){return me.svg||me.vml?new Ml(i):null}Ae.include({getRenderer:function(i){var c=i.options.renderer||this._getPaneRenderer(i.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(i){if(i==="overlayPane"||i===void 0)return!1;var c=this._paneRenderers[i];return c===void 0&&(c=this._createRenderer({pane:i}),this._paneRenderers[i]=c),c},_createRenderer:function(i){return this.options.preferCanvas&&C_(i)||A_(i)}});var R_=oa.extend({initialize:function(i,c){oa.prototype.initialize.call(this,this._boundsToLatLngs(i),c)},setBounds:function(i){return this.setLatLngs(this._boundsToLatLngs(i))},_boundsToLatLngs:function(i){return i=_e(i),[i.getSouthWest(),i.getNorthWest(),i.getNorthEast(),i.getSouthEast()]}});function JT(i,c){return new R_(i,c)}Ml.create=Gu,Ml.pointsToPath=Pn,cs.geometryToLayer=Fu,cs.coordsToLatLng=Vf,cs.coordsToLatLngs=Bu,cs.latLngToCoords=Uf,cs.latLngsToCoords=$u,cs.getFeature=aa,cs.asFeature=Wu,Ae.mergeOptions({boxZoom:!0});var L_=Cn.extend({initialize:function(i){this._map=i,this._container=i._container,this._pane=i._panes.overlayPane,this._resetStateTimeout=0,i.on("unload",this._destroy,this)},addHooks:function(){Te(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ze(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Fe(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(i){if(!i.shiftKey||i.which!==1&&i.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),ir(),Zo(),this._startPoint=this._map.mouseEventToContainerPoint(i),Te(document,{contextmenu:Nr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(i){this._moved||(this._moved=!0,this._box=Oe("div","leaflet-zoom-box",this._container),he(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(i);var c=new Q(this._point,this._startPoint),d=c.getSize();dt(this._box,c.min),this._box.style.width=d.x+"px",this._box.style.height=d.y+"px"},_finish:function(){this._moved&&(Fe(this._box),Qe(this._container,"leaflet-crosshair")),In(),Go(),Ze(document,{contextmenu:Nr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(i){if(!(i.which!==1&&i.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var c=new le(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(i){i.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ae.addInitHook("addHandler","boxZoom",L_),Ae.mergeOptions({doubleClickZoom:!0});var D_=Cn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(i){var c=this._map,d=c.getZoom(),p=c.options.zoomDelta,v=i.originalEvent.shiftKey?d-p:d+p;c.options.doubleClickZoom==="center"?c.setZoom(v):c.setZoomAround(i.containerPoint,v)}});Ae.addInitHook("addHandler","doubleClickZoom",D_),Ae.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var z_=Cn.extend({addHooks:function(){if(!this._draggable){var i=this._map;this._draggable=new or(i._mapPane,i._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),i.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),i.on("zoomend",this._onZoomEnd,this),i.whenReady(this._onZoomEnd,this))}he(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Qe(this._map._container,"leaflet-grab"),Qe(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var i=this._map;if(i._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=_e(this._map.options.maxBounds);this._offsetLimit=G(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;i.fire("movestart").fire("dragstart"),i.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(i){if(this._map.options.inertia){var c=this._lastTime=+new Date,d=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(d),this._times.push(c),this._prunePositions(c)}this._map.fire("move",i).fire("drag",i)},_prunePositions:function(i){for(;this._positions.length>1&&i-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var i=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(i).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(i,c){return i-(i-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var i=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;i.x<c.min.x&&(i.x=this._viscousLimit(i.x,c.min.x)),i.y<c.min.y&&(i.y=this._viscousLimit(i.y,c.min.y)),i.x>c.max.x&&(i.x=this._viscousLimit(i.x,c.max.x)),i.y>c.max.y&&(i.y=this._viscousLimit(i.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(i)}},_onPreDragWrap:function(){var i=this._worldWidth,c=Math.round(i/2),d=this._initialWorldOffset,p=this._draggable._newPos.x,v=(p-c+d)%i+c-d,b=(p+c+d)%i-c-d,B=Math.abs(v+d)<Math.abs(b+d)?v:b;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=B},_onDragEnd:function(i){var c=this._map,d=c.options,p=!d.inertia||i.noInertia||this._times.length<2;if(c.fire("dragend",i),p)c.fire("moveend");else{this._prunePositions(+new Date);var v=this._lastPos.subtract(this._positions[0]),b=(this._lastTime-this._times[0])/1e3,B=d.easeLinearity,q=v.multiplyBy(B/b),K=q.distanceTo([0,0]),te=Math.min(d.inertiaMaxSpeed,K),ce=q.multiplyBy(te/K),be=te/(d.inertiaDeceleration*B),Re=ce.multiplyBy(-be/2).round();!Re.x&&!Re.y?c.fire("moveend"):(Re=c._limitOffset(Re,c.options.maxBounds),A(function(){c.panBy(Re,{duration:be,easeLinearity:B,noMoveStart:!0,animate:!0})}))}}});Ae.addInitHook("addHandler","dragging",z_),Ae.mergeOptions({keyboard:!0,keyboardPanDelta:80});var M_=Cn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(i){this._map=i,this._setPanDelta(i.options.keyboardPanDelta),this._setZoomDelta(i.options.zoomDelta)},addHooks:function(){var i=this._map._container;i.tabIndex<=0&&(i.tabIndex="0"),Te(i,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ze(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var i=document.body,c=document.documentElement,d=i.scrollTop||c.scrollTop,p=i.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(p,d)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(i){var c=this._panKeys={},d=this.keyCodes,p,v;for(p=0,v=d.left.length;p<v;p++)c[d.left[p]]=[-1*i,0];for(p=0,v=d.right.length;p<v;p++)c[d.right[p]]=[i,0];for(p=0,v=d.down.length;p<v;p++)c[d.down[p]]=[0,i];for(p=0,v=d.up.length;p<v;p++)c[d.up[p]]=[0,-1*i]},_setZoomDelta:function(i){var c=this._zoomKeys={},d=this.keyCodes,p,v;for(p=0,v=d.zoomIn.length;p<v;p++)c[d.zoomIn[p]]=i;for(p=0,v=d.zoomOut.length;p<v;p++)c[d.zoomOut[p]]=-i},_addHooks:function(){Te(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ze(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(i){if(!(i.altKey||i.ctrlKey||i.metaKey)){var c=i.keyCode,d=this._map,p;if(c in this._panKeys){if(!d._panAnim||!d._panAnim._inProgress)if(p=this._panKeys[c],i.shiftKey&&(p=X(p).multiplyBy(3)),d.options.maxBounds&&(p=d._limitOffset(X(p),d.options.maxBounds)),d.options.worldCopyJump){var v=d.wrapLatLng(d.unproject(d.project(d.getCenter()).add(p)));d.panTo(v)}else d.panBy(p)}else if(c in this._zoomKeys)d.setZoom(d.getZoom()+(i.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&d._popup&&d._popup.options.closeOnEscapeKey)d.closePopup();else return;Nr(i)}}});Ae.addInitHook("addHandler","keyboard",M_),Ae.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var O_=Cn.extend({addHooks:function(){Te(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ze(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(i){var c=Tl(i),d=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(i),this._startTime||(this._startTime=+new Date);var p=Math.max(d-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),p),Nr(i)},_performZoom:function(){var i=this._map,c=i.getZoom(),d=this._map.options.zoomSnap||0;i._stop();var p=this._delta/(this._map.options.wheelPxPerZoomLevel*4),v=4*Math.log(2/(1+Math.exp(-Math.abs(p))))/Math.LN2,b=d?Math.ceil(v/d)*d:v,B=i._limitZoom(c+(this._delta>0?b:-b))-c;this._delta=0,this._startTime=null,B&&(i.options.scrollWheelZoom==="center"?i.setZoom(c+B):i.setZoomAround(this._lastMousePos,c+B))}});Ae.addInitHook("addHandler","scrollWheelZoom",O_);var ej=600;Ae.mergeOptions({tapHold:me.touchNative&&me.safari&&me.mobile,tapTolerance:15});var V_=Cn.extend({addHooks:function(){Te(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ze(this._map._container,"touchstart",this._onDown,this)},_onDown:function(i){if(clearTimeout(this._holdTimeout),i.touches.length===1){var c=i.touches[0];this._startPos=this._newPos=new H(c.clientX,c.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(Te(document,"touchend",wt),Te(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),ej),Te(document,"touchend touchcancel contextmenu",this._cancel,this),Te(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function i(){Ze(document,"touchend",wt),Ze(document,"touchend touchcancel",i)},_cancel:function(){clearTimeout(this._holdTimeout),Ze(document,"touchend touchcancel contextmenu",this._cancel,this),Ze(document,"touchmove",this._onMove,this)},_onMove:function(i){var c=i.touches[0];this._newPos=new H(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(i,c){var d=new MouseEvent(i,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});d._simulated=!0,c.target.dispatchEvent(d)}});Ae.addInitHook("addHandler","tapHold",V_),Ae.mergeOptions({touchZoom:me.touch,bounceAtZoomLimits:!0});var U_=Cn.extend({addHooks:function(){he(this._map._container,"leaflet-touch-zoom"),Te(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Qe(this._map._container,"leaflet-touch-zoom"),Ze(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(i){var c=this._map;if(!(!i.touches||i.touches.length!==2||c._animatingZoom||this._zooming)){var d=c.mouseEventToContainerPoint(i.touches[0]),p=c.mouseEventToContainerPoint(i.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(d.add(p)._divideBy(2))),this._startDist=d.distanceTo(p),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),Te(document,"touchmove",this._onTouchMove,this),Te(document,"touchend touchcancel",this._onTouchEnd,this),wt(i)}},_onTouchMove:function(i){if(!(!i.touches||i.touches.length!==2||!this._zooming)){var c=this._map,d=c.mouseEventToContainerPoint(i.touches[0]),p=c.mouseEventToContainerPoint(i.touches[1]),v=d.distanceTo(p)/this._startDist;if(this._zoom=c.getScaleZoom(v,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&v<1||this._zoom>c.getMaxZoom()&&v>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,v===1)return}else{var b=d._add(p)._divideBy(2)._subtract(this._centerPoint);if(v===1&&b.x===0&&b.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(b),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),$(this._animRequest);var B=l(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=A(B,this,!0),wt(i)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,$(this._animRequest),Ze(document,"touchmove",this._onTouchMove,this),Ze(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ae.addInitHook("addHandler","touchZoom",U_),Ae.BoxZoom=L_,Ae.DoubleClickZoom=D_,Ae.Drag=z_,Ae.Keyboard=M_,Ae.ScrollWheelZoom=O_,Ae.TapHold=V_,Ae.TouchZoom=U_,n.Bounds=Q,n.Browser=me,n.CRS=rt,n.Canvas=I_,n.Circle=Of,n.CircleMarker=Uu,n.Class=xe,n.Control=yn,n.DivIcon=k_,n.DivOverlay=Sr,n.DomEvent=eo,n.DomUtil=Mf,n.Draggable=or,n.Evented=ne,n.FeatureGroup=as,n.GeoJSON=cs,n.GridLayer=Dl,n.Handler=Cn,n.Icon=ia,n.ImageOverlay=Hu,n.LatLng=ge,n.LatLngBounds=le,n.Layer=lr,n.LayerGroup=sa,n.LineUtil=Hn,n.Map=Ae,n.Marker=Vu,n.Mixin=Mu,n.Path=Bs,n.Point=H,n.PolyUtil=ta,n.Polygon=oa,n.Polyline=ls,n.Popup=qu,n.PosAnimation=kl,n.Projection=kr,n.Rectangle=R_,n.Renderer=us,n.SVG=Ml,n.SVGOverlay=j_,n.TileLayer=la,n.Tooltip=Zu,n.Transformation=Y,n.Util=z,n.VideoOverlay=T_,n.bind=l,n.bounds=G,n.canvas=C_,n.circle=UT,n.circleMarker=VT,n.control=Tr,n.divIcon=KT,n.extend=s,n.featureGroup=zT,n.geoJSON=E_,n.geoJson=$T,n.gridLayer=QT,n.icon=MT,n.imageOverlay=WT,n.latLng=ye,n.latLngBounds=_e,n.layerGroup=DT,n.map=Yo,n.marker=OT,n.point=X,n.polygon=BT,n.polyline=FT,n.popup=ZT,n.rectangle=JT,n.setOptions=D,n.stamp=f,n.svg=A_,n.svgOverlay=qT,n.tileLayer=S_,n.tooltip=GT,n.transformation=we,n.version=r,n.videoOverlay=HT;var tj=window.L;n.noConflict=function(){return window.L=tj,this},window.L=n})})(dg,dg.exports);var Pf=dg.exports;const kT=J0(Pf);function ST(t,e,n){return Object.freeze({instance:t,context:e,container:n})}function PT(t,e){return e==null?function(r,s){const o=O.useRef();return o.current||(o.current=t(r,s)),o}:function(r,s){const o=O.useRef();o.current||(o.current=t(r,s));const l=O.useRef(r),{instance:h}=o.current;return O.useEffect(function(){l.current!==r&&(e(h,r,l.current),l.current=r)},[h,r,s]),o}}function pM(t,e){O.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){var o;(o=e.layerContainer)==null||o.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function IT(t){return function(n){const r=TT(),s=t(jT(n,r),r);return lM(r.map,n.attribution),mM(s.current,n.eventHandlers),pM(s.current,r),s}}function gM(t,e){const n=PT(t,e),r=IT(n);return hM(r)}function yM(t,e){const n=PT(t,e),r=IT(n);return fM(r)}function _M(t,e,n){const{opacity:r,zIndex:s}=e;r!=null&&r!==n.opacity&&t.setOpacity(r),s!=null&&s!==n.zIndex&&t.setZIndex(s)}function CT(){return TT().map}function vM(t){const e=CT();return O.useEffect(function(){return e.on(t),function(){e.off(t)}},[e,t]),e}function hg(){return hg=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},hg.apply(this,arguments)}function xM({bounds:t,boundsOptions:e,center:n,children:r,className:s,id:o,placeholder:l,style:h,whenReady:f,zoom:m,...g},_){const[w]=O.useState({className:s,id:o,style:h}),[T,j]=O.useState(null);O.useImperativeHandle(_,()=>(T==null?void 0:T.map)??null,[T]);const D=O.useCallback(k=>{if(k!==null&&T===null){const S=new Pf.Map(k,g);n!=null&&m!=null?S.setView(n,m):t!=null&&S.fitBounds(t,e),f!=null&&S.whenReady(f),j(uM(S))}},[]);O.useEffect(()=>()=>{T==null||T.map.remove()},[T]);const M=T?xc.createElement(ET,{value:T},r):l??null;return xc.createElement("div",hg({},w,{ref:D}),M)}const wM=O.forwardRef(xM),bM=gM(function({position:e,...n},r){const s=new Pf.Marker(e,n);return ST(s,dM(r,{overlayContainer:s}))},function(e,n,r){n.position!==r.position&&e.setLatLng(n.position),n.icon!=null&&n.icon!==r.icon&&e.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==r.zIndexOffset&&e.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==r.opacity&&e.setOpacity(n.opacity),e.dragging!=null&&n.draggable!==r.draggable&&(n.draggable===!0?e.dragging.enable():e.dragging.disable())}),NM=yM(function({url:e,...n},r){const s=new Pf.TileLayer(e,jT(n,r));return ST(s,r)},function(e,n,r){_M(e,n,r);const{url:s}=n;s!=null&&s!==r.url&&e.setUrl(s)});delete kT.Icon.Default.prototype._getIconUrl;kT.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"});const EM=({onLocationSelect:t})=>(vM({click:e=>{t(e.latlng.lat,e.latlng.lng)}}),null),TM=({lat:t,lng:e})=>{const n=CT();return O.useEffect(()=>{n.setView([t,e],16)},[t,e,n]),null},jM=()=>{var mn;const t=vr(),{isAuthenticated:e,user:n,userData:r}=sn(),{showToast:s}=xr(),[o,l]=O.useState(1),[h,f]=O.useState(!1),[m,g]=O.useState(null),[_,w]=O.useState(null),[T,j]=O.useState(""),[D,M]=O.useState(!1),[k,S]=O.useState([]),[C,U]=O.useState(!1),F=O.useRef(null),[V,E]=O.useState({businessName:"",profession:"",description:"",experience:"",location:{city:"",district:"",address:"",postalCode:"",lat:52.2297,lng:21.0122},services:[],features:[],workingHours:{monday:{from:"09:00",to:"17:00",enabled:!0},tuesday:{from:"09:00",to:"17:00",enabled:!0},wednesday:{from:"09:00",to:"17:00",enabled:!0},thursday:{from:"09:00",to:"17:00",enabled:!0},friday:{from:"09:00",to:"17:00",enabled:!0},saturday:{from:"10:00",to:"14:00",enabled:!0},sunday:{from:"10:00",to:"14:00",enabled:!1}},image:"",category:"",travelRadius:10}),[N,R]=O.useState({name:"",price:0,duration:"30 min",description:""}),[P,A]=O.useState(""),[$,z]=O.useState([52.2297,21.0122]),xe=async Y=>{if(!Y||Y.length<3){S([]),U(!1);return}M(!0);try{const Je=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(Y)}&countrycodes=pl&addressdetails=1&limit=5`,{headers:{"Accept-Language":"pl"}})).json();S(Je),U(!0)}catch(we){console.error("Bd wyszukiwania:",we)}finally{M(!1)}},oe=Y=>{j(Y),F.current&&clearTimeout(F.current),F.current=setTimeout(()=>{xe(Y)},500)},ue=Y=>{const we=parseFloat(Y.lat),Je=parseFloat(Y.lon),Ke=Y.address;z([we,Je]),E(xt=>({...xt,location:{city:Ke.city||Ke.town||Ke.village||"",district:Ke.suburb||Ke.neighbourhood||"",address:`${Ke.road||""}${Ke.house_number?" "+Ke.house_number:""}`.trim(),postalCode:Ke.postcode||"",lat:we,lng:Je}})),U(!1),j(Y.display_name.split(",")[0])},ne=async(Y,we)=>{try{const xt=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${Y}&lon=${we}&addressdetails=1`,{headers:{"Accept-Language":"pl"}})).json()).address;E(Pn=>({...Pn,location:{city:xt.city||xt.town||xt.village||"",district:xt.suburb||xt.neighbourhood||"",address:`${xt.road||""}${xt.house_number?" "+xt.house_number:""}`.trim(),postalCode:xt.postcode||"",lat:Y,lng:we}}))}catch(Je){console.error("Bd reverse geocoding:",Je)}},H=(Y,we)=>{z([Y,we]),ne(Y,we)},re=Y=>{var Je;const we=(Je=Y.target.files)==null?void 0:Je[0];if(we){if(!we.type.startsWith("image/")){s("Wybierz plik graficzny","error");return}if(we.size>5*1024*1024){s("Plik za duy (max 5MB)","error");return}w(we);const Ke=new FileReader;Ke.onloadend=()=>g(Ke.result),Ke.readAsDataURL(we)}},X=()=>{w(null),g(null)},Q=()=>{if(!N.name||N.price<=0){s("Podaj nazw i cen usugi","error");return}const Y={id:Date.now().toString(),...N};E(we=>({...we,services:[...we.services,Y]})),R({name:"",price:0,duration:"30 min",description:""}),s("Usuga dodana!","success")},G=Y=>{E(we=>({...we,services:we.services.filter(Je=>Je.id!==Y)}))},le=Y=>{Y.trim()&&(V.features.includes(Y)||(E(we=>({...we,features:[...we.features,Y]})),A("")))},_e=Y=>{E(we=>({...we,features:we.features.filter(Je=>Je!==Y)}))},ge=async()=>{var Y;if(!e){s("Musisz by zalogowany","error"),t("/auth?redirect=/biznes/dodaj-usluge");return}if(!V.businessName){s("Podaj nazw firmy","error"),l(1);return}if(!V.category){s("Wybierz kategori","error"),l(1);return}if(!V.location.city){s("Podaj lokalizacj","error"),l(2);return}if(V.services.length===0){s("Dodaj przynajmniej jedn usug","error"),l(3);return}f(!0);try{const we=((Y=n==null?void 0:n.id)==null?void 0:Y.toString())||"";if(console.log("=== DEBUG SAVE ==="),console.log("user:",n),console.log("ownerId:",we),console.log("formData:",V),!we){s("Bd: brak ID uytkownika","error"),f(!1);return}const Je=await tr.getByOwner(we);console.log("existingProviders:",Je);const Ke=Je[0],xt={name:V.businessName,profession:V.profession,category:V.category,description:V.description,experience:V.experience||"",location:V.location,services:V.services.map(Pn=>({...Pn,id:Pn.id||`service_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,category:"Usugi"})),features:V.features,image:m||(Ke==null?void 0:Ke.image)||"https://images.unsplash.com/photo-1560066984-138dadb4c035?w=400&h=400&fit=crop",workingHours:V.workingHours,travelRadius:V.travelRadius,hasTravel:V.features.includes("Dojazd do klienta"),acceptsCard:V.features.includes("Patno kart"),ownerEmail:(r==null?void 0:r.email)||(n==null?void 0:n.email)||"",ownerUsername:(r==null?void 0:r.username)||(n==null?void 0:n.username)||"",ownerPhone:(r==null?void 0:r.phone)||(n==null?void 0:n.phone)||"",ownerAvatar:(r==null?void 0:r.avatar)||(n==null?void 0:n.avatar)||"",isVerified:(r==null?void 0:r.isVerified)||!1};if(Ke)console.log("Aktualizuj istniejcy profil:",Ke.id),await tr.update(Ke.id,xt),s(" Profil zaktualizowany!","success");else{console.log("Tworz nowy profil z ownerId:",we),console.log("providerData:",xt);const Pn=await tr.create(xt,we);console.log("Utworzony provider:",Pn),s(" Profil utworzony pomylnie!","success")}t("/biznes/uslugi")}catch(we){console.error("Bd zapisywania:",we),s("Bd podczas zapisywania","error")}finally{f(!1)}},ye=[{id:"fryzjer",name:"Fryzjer / Barber",icon:""},{id:"paznokcie",name:"Paznokcie / Manicure",icon:""},{id:"masaz",name:"Masa",icon:""},{id:"makijaz",name:"Makija",icon:""},{id:"tatuaze",name:"Tatuae",icon:""},{id:"kosmetyka",name:"Kosmetyka / Twarz",icon:""},{id:"inne",name:"Inne usugi",icon:""}],rt=["15 min","30 min","45 min","1h","1h 30min","2h","2h 30min","3h"],Pe=["Dojazd do klienta","Produkty premium","Konsultacja gratis","Parking","WiFi","Klimatyzacja","Patno kart","Rezerwacja online"],st=[{number:1,title:"Podstawowe info",icon:Z0},{number:2,title:"Lokalizacja",icon:Fa},{number:3,title:"Usugi i ceny",icon:Yc},{number:4,title:"Szczegy",icon:q0}];return a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs("div",{className:"mb-8",children:[a.jsxs("button",{onClick:()=>t(-1),className:"flex items-center gap-2 text-gray-600 hover:text-emerald-600 mb-4 transition-colors",children:[a.jsx(Qc,{className:"w-5 h-5"}),"Wr"]}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Dodaj now usug"}),a.jsx("p",{className:"text-gray-600",children:"Stwrz profil swojej usugi i zacznij przyjmowa klientw"})]}),a.jsx("div",{className:"flex items-center justify-between mb-8 bg-white rounded-2xl p-4 shadow-sm",children:st.map((Y,we)=>a.jsxs("div",{className:"flex items-center",children:[a.jsxs("button",{onClick:()=>l(Y.number),className:`flex items-center gap-3 px-4 py-2 rounded-xl transition-all ${o===Y.number?"bg-gradient-to-r from-emerald-500 to-teal-600 text-white":o>Y.number?"bg-green-100 text-green-600":"bg-gray-100 text-gray-500"}`,children:[a.jsx(Y.icon,{className:"w-5 h-5"}),a.jsx("span",{className:"hidden sm:inline font-medium",children:Y.title})]}),we<st.length-1&&a.jsx("div",{className:`w-8 lg:w-16 h-1 mx-2 rounded ${o>Y.number?"bg-green-400":"bg-gray-200"}`})]},Y.number))}),a.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-8",children:[o===1&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("h2",{className:"text-xl font-bold mb-6 flex items-center gap-2",children:[a.jsx(Z0,{className:"w-6 h-6 text-emerald-500"}),"Podstawowe informacje"]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nazwa firmy / salonu ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:V.businessName,onChange:Y=>E({...V,businessName:Y.target.value}),placeholder:"np. Beauty Studio Anna",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Kategoria ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:ye.map(Y=>a.jsxs("button",{type:"button",onClick:()=>E({...V,category:Y.id}),className:`p-4 rounded-xl border-2 text-center transition-all ${V.category===Y.id?"border-emerald-500 bg-emerald-50":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx("span",{className:"text-2xl mb-2 block",children:Y.icon}),a.jsx("span",{className:"text-sm font-medium",children:Y.name})]},Y.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tytu zawodowy"}),a.jsx("input",{type:"text",value:V.profession,onChange:Y=>E({...V,profession:Y.target.value}),placeholder:"np. Mistrz Fryzjerstwa",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Zdjcie profilowe"}),m?a.jsxs("div",{className:"relative inline-block",children:[a.jsx("img",{src:m,alt:"Podgld",className:"w-48 h-48 object-cover rounded-xl shadow-md"}),a.jsx("button",{type:"button",onClick:X,className:"absolute -top-2 -right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600",children:a.jsx(Po,{className:"w-4 h-4"})})]}):a.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-gray-300 rounded-xl cursor-pointer hover:border-emerald-500 hover:bg-emerald-50 transition-all",children:[a.jsx(Mz,{className:"w-10 h-10 mb-3 text-gray-400"}),a.jsx("p",{className:"text-sm text-gray-500",children:a.jsx("span",{className:"font-semibold text-emerald-600",children:"Kliknij aby wybra"})}),a.jsx("p",{className:"text-xs text-gray-400",children:"PNG, JPG (max. 5MB)"}),a.jsx("input",{type:"file",accept:"image/*",onChange:re,className:"hidden"})]})]})]}),o===2&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("h2",{className:"text-xl font-bold mb-6 flex items-center gap-2",children:[a.jsx(Fa,{className:"w-6 h-6 text-emerald-500"}),"Lokalizacja"]}),a.jsxs("div",{className:"relative z-20",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wyszukaj adres"}),a.jsxs("div",{className:"relative",children:[a.jsx(kf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",value:T,onChange:Y=>oe(Y.target.value),placeholder:"Wpisz adres, np. Marszakowska 10, Warszawa",className:"w-full pl-10 pr-10 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none"}),D&&a.jsx(At,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-emerald-500 animate-spin"})]}),C&&k.length>0&&a.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border-2 border-emerald-300 rounded-xl shadow-2xl max-h-72 overflow-y-auto",children:[a.jsx("div",{className:"p-2 bg-emerald-50 border-b border-emerald-200 text-sm text-emerald-700 font-medium",children:" Wybierz adres z listy:"}),k.map(Y=>a.jsxs("button",{onClick:()=>ue(Y),className:"w-full px-4 py-3 text-left hover:bg-emerald-50 border-b border-gray-100 last:border-0 transition-colors",children:[a.jsx("div",{className:"font-medium text-gray-900",children:Y.display_name.split(",")[0]}),a.jsx("div",{className:"text-sm text-gray-500 truncate",children:Y.display_name})]},Y.place_id))]})]}),a.jsx("div",{className:"rounded-xl overflow-hidden border-2 border-gray-200 relative z-10",style:{height:"300px"},children:a.jsxs(wM,{center:$,zoom:13,style:{height:"100%",width:"100%"},children:[a.jsx(NM,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),a.jsx(bM,{position:$}),a.jsx(EM,{onLocationSelect:H}),a.jsx(TM,{lat:$[0],lng:$[1]})]})}),a.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-2",children:[a.jsx(Fa,{className:"w-4 h-4"}),"Kliknij na map aby wybra dokadn lokalizacj"]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Miasto ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:V.location.city,onChange:Y=>E({...V,location:{...V.location,city:Y.target.value}}),placeholder:"np. Warszawa",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dzielnica"}),a.jsx("input",{type:"text",value:V.location.district,onChange:Y=>E({...V,location:{...V.location,district:Y.target.value}}),placeholder:"np. Mokotw",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ulica i numer"}),a.jsx("input",{type:"text",value:V.location.address,onChange:Y=>E({...V,location:{...V.location,address:Y.target.value}}),placeholder:"np. ul. Marszakowska 1",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kod pocztowy"}),a.jsx("input",{type:"text",value:V.location.postalCode,onChange:Y=>E({...V,location:{...V.location,postalCode:Y.target.value}}),placeholder:"np. 00-001",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Maksymalny zasig dojazdu: ",a.jsxs("span",{className:"font-bold text-emerald-600",children:[V.travelRadius," km"]})]}),a.jsx("input",{type:"range",min:"1",max:"50",value:V.travelRadius,onChange:Y=>E({...V,travelRadius:parseInt(Y.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-emerald-500"}),a.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[a.jsx("span",{children:"1 km"}),a.jsx("span",{children:"25 km"}),a.jsx("span",{children:"50 km"})]})]})]}),o===3&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("h2",{className:"text-xl font-bold mb-6 flex items-center gap-2",children:[a.jsx(Yc,{className:"w-6 h-6 text-emerald-500"}),"Usugi i ceny"]}),V.services.length>0&&a.jsxs("div",{className:"space-y-3 mb-6",children:[a.jsxs("h3",{className:"font-medium text-gray-700",children:["Dodane usugi (",V.services.length,")"]}),V.services.map(Y=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:Y.name}),a.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-3",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Si,{className:"w-3 h-3"})," ",Y.duration]}),a.jsxs("span",{className:"font-semibold text-emerald-600",children:[Y.price," z"]})]})]}),a.jsx("button",{onClick:()=>G(Y.id),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg",children:a.jsx(Sf,{className:"w-5 h-5"})})]},Y.id))]}),a.jsxs("div",{className:"p-6 bg-emerald-50 rounded-xl",children:[a.jsxs("h3",{className:"font-bold mb-4 flex items-center gap-2",children:[a.jsx(ys,{className:"w-5 h-5"}),"Dodaj now usug"]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Nazwa usugi *"}),a.jsx("input",{type:"text",value:N.name,onChange:Y=>R({...N,name:Y.target.value}),placeholder:"np. Strzyenie damskie",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Cena (z) *"}),a.jsx("input",{type:"number",value:N.price||"",onChange:Y=>R({...N,price:Number(Y.target.value)}),placeholder:"np. 80",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Czas trwania"}),a.jsx("select",{value:N.duration,onChange:Y=>R({...N,duration:Y.target.value}),className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none",children:rt.map(Y=>a.jsx("option",{value:Y,children:Y},Y))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Opis (opcjonalnie)"}),a.jsx("input",{type:"text",value:N.description,onChange:Y=>R({...N,description:Y.target.value}),placeholder:"Krtki opis",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none"})]})]}),a.jsxs("button",{type:"button",onClick:Q,className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all",children:[a.jsx(ys,{className:"w-5 h-5"}),"Dodaj usug"]})]})]}),o===4&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("h2",{className:"text-xl font-bold mb-6 flex items-center gap-2",children:[a.jsx(q0,{className:"w-6 h-6 text-emerald-500"}),"Dodatkowe informacje"]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opis dziaalnoci"}),a.jsx("textarea",{value:V.description,onChange:Y=>E({...V,description:Y.target.value}),placeholder:"Opisz swoj dziaalno...",rows:4,className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none resize-none"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[a.jsx(rg,{className:"w-5 h-5"}),"Dowiadczenie i kwalifikacje"]}),a.jsx("textarea",{value:V.experience,onChange:Y=>E({...V,experience:Y.target.value}),placeholder:"np. 10 lat dowiadczenia, certyfikaty...",rows:3,className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none resize-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Udogodnienia"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:V.features.map(Y=>a.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-emerald-100 text-emerald-700 rounded-full text-sm",children:[Y,a.jsx("button",{onClick:()=>_e(Y),className:"hover:text-red-500",children:""})]},Y))}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:Pe.filter(Y=>!V.features.includes(Y)).map(Y=>a.jsxs("button",{type:"button",onClick:()=>le(Y),className:"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-sm hover:bg-gray-200",children:["+ ",Y]},Y))})]}),a.jsxs("div",{className:"mt-8 p-6 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl",children:[a.jsx("h3",{className:"font-bold text-lg mb-4",children:" Podsumowanie"}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Nazwa:"})," ",a.jsx("strong",{children:V.businessName||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Kategoria:"})," ",a.jsx("strong",{children:((mn=ye.find(Y=>Y.id===V.category))==null?void 0:mn.name)||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Lokalizacja:"})," ",a.jsxs("strong",{children:[V.location.city,V.location.district&&`, ${V.location.district}`]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Liczba usug:"})," ",a.jsx("strong",{children:V.services.length})]})]})]})]}),a.jsxs("div",{className:"flex justify-between mt-8 pt-6 border-t border-gray-100",children:[a.jsx("button",{type:"button",onClick:()=>l(Y=>Math.max(1,Y-1)),disabled:o===1,className:"px-6 py-2 border border-gray-300 rounded-xl font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:" Wstecz"}),o<4?a.jsx("button",{type:"button",onClick:()=>l(Y=>Math.min(4,Y+1)),className:"px-6 py-2 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl font-semibold hover:shadow-lg",children:"Dalej "}):a.jsx("button",{type:"button",onClick:ge,disabled:h,className:"px-6 py-2 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl font-semibold hover:shadow-lg disabled:opacity-50 flex items-center gap-2",children:h?a.jsxs(a.Fragment,{children:[a.jsx(At,{className:"w-5 h-5 animate-spin"}),"Zapisywanie..."]}):a.jsxs(a.Fragment,{children:[a.jsx(vc,{className:"w-5 h-5"}),"Zapisz usug"]})})]})]})]})},kM=()=>{const{user:t}=sn(),{showToast:e}=xr(),[n,r]=O.useState(new Date),[s,o]=O.useState(new Date().toISOString().split("T")[0]),[l,h]=O.useState("week"),[f,m]=O.useState([]),[g,_]=O.useState(null),[w,T]=O.useState(!1),[j,D]=O.useState(!0);O.useEffect(()=>{(async()=>{if(!t||!t.id){console.log("BusinessCalendar: No user or user.id"),D(!1);return}console.log("BusinessCalendar: Loading for user",t.id);try{const H=await tr.getByOwner(t.id);if(console.log("BusinessCalendar: Found providers",H.length),H.length>0){const re=H[0],X=Jn.subscribeToProviderBookings(re.id,Q=>{console.log("BusinessCalendar: Got bookings",Q.length),m(Q),D(!1)});return()=>X()}else D(!1)}catch(H){console.error("BusinessCalendar: Error loading bookings:",H),D(!1)}})()},[t]);const M=async ne=>{try{await Jn.confirm(ne),e("Rezerwacja potwierdzona! ","success")}catch{e("Bd potwierdzania rezerwacji","error")}},k=async ne=>{try{await Jn.cancel(ne,"provider"),e("Rezerwacja anulowana","info"),T(!1),_(null)}catch{e("Bd anulowania rezerwacji","error")}},S=async ne=>{try{await Jn.complete(ne),e("Usuga oznaczona jako zakoczona! ","success"),T(!1),_(null)}catch{e("Bd oznaczania usugi","error")}},C=()=>{const ne=new Date(n);l==="month"?ne.setMonth(ne.getMonth()-1):l==="week"?ne.setDate(ne.getDate()-7):ne.setDate(ne.getDate()-1),r(ne)},U=()=>{const ne=new Date(n);l==="month"?ne.setMonth(ne.getMonth()+1):l==="week"?ne.setDate(ne.getDate()+7):ne.setDate(ne.getDate()+1),r(ne)},F=()=>{r(new Date),o(new Date().toISOString().split("T")[0])},V=ne=>{const H=ne.getFullYear(),re=ne.getMonth(),X=new Date(H,re,1),Q=new Date(H,re+1,0),G=[],le=X.getDay()||7;for(let ge=le-1;ge>0;ge--)G.push(new Date(H,re,1-ge));for(let ge=1;ge<=Q.getDate();ge++)G.push(new Date(H,re,ge));const _e=42-G.length;for(let ge=1;ge<=_e;ge++)G.push(new Date(H,re+1,ge));return G},E=ne=>{const H=[],re=new Date(ne),X=re.getDay()||7;re.setDate(re.getDate()-X+1);for(let Q=0;Q<7;Q++)H.push(new Date(re.getTime()+Q*864e5));return H},N=ne=>ne.toISOString().split("T")[0],R=ne=>f.filter(H=>H.date===ne).sort((H,re)=>H.time.localeCompare(re.time)),P=ne=>{switch(ne){case"confirmed":return"bg-green-100 text-green-700 border-green-200";case"pending":return"bg-yellow-100 text-yellow-700 border-yellow-200";case"completed":return"bg-gray-100 text-gray-700 border-gray-200";case"cancelled":return"bg-red-100 text-red-700 border-red-200";default:return"bg-gray-100 text-gray-700"}},A=ne=>{switch(ne){case"confirmed":return"Potwierdzona";case"pending":return"Oczekuje";case"completed":return"Zakoczona";case"cancelled":return"Anulowana";default:return ne}},$=async(ne,H)=>{try{H==="confirmed"?await M(ne):H==="cancelled"?await k(ne):H==="completed"&&await S(ne)}catch{e("Bd zmiany statusu","error")}};if(j)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(At,{className:"w-12 h-12 animate-spin text-emerald-500"})});const z=Array.from({length:12},(ne,H)=>H+8),xe=["Pon","Wt","r","Czw","Pt","Sob","Nd"],oe=["Stycze","Luty","Marzec","Kwiecie","Maj","Czerwiec","Lipiec","Sierpie","Wrzesie","Padziernik","Listopad","Grudzie"],ue=E(n);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Kalendarz"}),a.jsx("p",{className:"text-gray-600",children:"Zarzdzaj swoimi rezerwacjami"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:F,className:"px-4 py-2 bg-white border border-gray-200 rounded-lg text-sm font-medium hover:bg-gray-50",children:"Dzisiaj"}),a.jsx("div",{className:"flex bg-white border border-gray-200 rounded-lg overflow-hidden",children:["day","week","month"].map(ne=>a.jsx("button",{onClick:()=>h(ne),className:`px-4 py-2 text-sm font-medium transition-colors ${l===ne?"bg-emerald-500 text-white":"text-gray-600 hover:bg-gray-50"}`,children:ne==="day"?"Dzie":ne==="week"?"Tydzie":"Miesic"},ne))})]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("button",{onClick:C,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(pT,{className:"w-5 h-5"})}),a.jsx("h2",{className:"text-lg font-bold text-gray-900",children:l==="day"?new Date(s).toLocaleDateString("pl-PL",{weekday:"long",day:"numeric",month:"long",year:"numeric"}):l==="week"?`${ue[0].toLocaleDateString("pl-PL",{day:"numeric",month:"short"})} - ${ue[6].toLocaleDateString("pl-PL",{day:"numeric",month:"short",year:"numeric"})}`:`${oe[n.getMonth()]} ${n.getFullYear()}`}),a.jsx("button",{onClick:U,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(gT,{className:"w-5 h-5"})})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[l==="week"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-8 border-b border-gray-200",children:[a.jsx("div",{className:"p-3 text-center text-sm font-medium text-gray-500 border-r border-gray-200",children:"Godzina"}),ue.map((ne,H)=>{const re=N(ne),X=re===new Date().toISOString().split("T")[0],Q=R(re);return a.jsxs("div",{className:`p-3 text-center border-r border-gray-200 last:border-r-0 cursor-pointer hover:bg-gray-50 ${X?"bg-emerald-50":""}`,onClick:()=>o(re),children:[a.jsx("div",{className:"text-xs text-gray-500",children:xe[H]}),a.jsx("div",{className:`text-lg font-bold ${X?"text-emerald-600":"text-gray-900"}`,children:ne.getDate()}),Q.length>0&&a.jsxs("div",{className:"text-xs text-emerald-600 font-medium",children:[Q.length," rez."]})]},H)})]}),a.jsx("div",{className:"max-h-[600px] overflow-y-auto",children:z.map(ne=>a.jsxs("div",{className:"grid grid-cols-8 border-b border-gray-100",children:[a.jsxs("div",{className:"p-2 text-center text-sm text-gray-500 border-r border-gray-200 bg-gray-50",children:[ne,":00"]}),ue.map((H,re)=>{const X=N(H),Q=f.filter(G=>G.date===X&&parseInt(G.time.split(":")[0])===ne);return a.jsx("div",{className:"p-1 border-r border-gray-100 last:border-r-0 min-h-[60px] relative",children:Q.map(G=>a.jsxs("button",{onClick:()=>{_(G),T(!0)},className:`w-full text-left p-2 rounded-lg text-xs mb-1 border ${P(G.status)} hover:shadow-md transition-shadow`,children:[a.jsx("div",{className:"font-bold truncate",children:G.time}),a.jsx("div",{className:"truncate",children:G.clientName}),a.jsx("div",{className:"truncate text-gray-600",children:G.serviceName})]},G.id))},re)})]},ne))})]}),l==="day"&&a.jsxs("div",{className:"p-4",children:[a.jsxs("h3",{className:"font-bold text-lg mb-4 flex items-center gap-2",children:[a.jsx(Mr,{className:"w-5 h-5 text-emerald-500"}),"Rezerwacje na ",new Date(s).toLocaleDateString("pl-PL",{weekday:"long",day:"numeric",month:"long"})]}),a.jsx("div",{className:"space-y-3",children:z.map(ne=>{const H=f.filter(re=>re.date===s&&parseInt(re.time.split(":")[0])===ne);return a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"w-16 text-sm text-gray-500 font-medium pt-2",children:[ne,":00"]}),a.jsx("div",{className:"flex-1 min-h-[60px] border-l-2 border-gray-200 pl-4",children:H.length===0?a.jsx("div",{className:"text-sm text-gray-400 py-2",children:""}):H.map(re=>a.jsx("button",{onClick:()=>{_(re),T(!0)},className:`w-full text-left p-4 rounded-xl border-2 mb-2 ${P(re.status)} hover:shadow-lg transition-all`,children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"font-bold text-gray-900",children:[re.time," - ",re.clientName]}),a.jsx("div",{className:"text-sm mt-1",children:re.serviceName}),a.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[re.serviceDuration," min  ",re.servicePrice," z"]})]}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P(re.status)}`,children:A(re.status)})]})},re.id))})]},ne)})})]}),l==="month"&&a.jsxs("div",{className:"p-4",children:[a.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:xe.map(ne=>a.jsx("div",{className:"text-center text-sm font-medium text-gray-500 py-2",children:ne},ne))}),a.jsx("div",{className:"grid grid-cols-7 gap-1",children:V(n).map((ne,H)=>{const re=N(ne),X=ne.getMonth()===n.getMonth(),Q=re===new Date().toISOString().split("T")[0],G=re===s,le=R(re);return a.jsxs("button",{onClick:()=>{o(re),h("day")},className:`p-2 min-h-[80px] rounded-lg text-left transition-all ${X?"bg-white":"bg-gray-50"} ${Q?"ring-2 ring-emerald-500":""} ${G?"bg-emerald-50":""} hover:bg-gray-100`,children:[a.jsx("div",{className:`text-sm font-medium ${X?"text-gray-900":"text-gray-400"}`,children:ne.getDate()}),le.slice(0,2).map(_e=>a.jsxs("div",{className:`text-xs p-1 rounded mt-1 truncate ${P(_e.status)}`,children:[_e.time," ",_e.clientName.split(" ")[0]]},_e.id)),le.length>2&&a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["+",le.length-2," wicej"]})]},H)})})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsx("h3",{className:"font-bold text-lg mb-4",children:"Podsumowanie dnia"}),a.jsxs("div",{className:"grid sm:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"p-4 bg-blue-50 rounded-xl",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:R(new Date().toISOString().split("T")[0]).length}),a.jsx("div",{className:"text-sm text-blue-600",children:"Rezerwacje dzi"})]}),a.jsxs("div",{className:"p-4 bg-yellow-50 rounded-xl",children:[a.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:f.filter(ne=>ne.status==="pending").length}),a.jsx("div",{className:"text-sm text-yellow-600",children:"Oczekujce"})]}),a.jsxs("div",{className:"p-4 bg-green-50 rounded-xl",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:f.filter(ne=>ne.status==="confirmed").length}),a.jsx("div",{className:"text-sm text-green-600",children:"Potwierdzone"})]}),a.jsxs("div",{className:"p-4 bg-purple-50 rounded-xl",children:[a.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[f.filter(ne=>ne.date===new Date().toISOString().split("T")[0]).reduce((ne,H)=>ne+H.servicePrice,0)," z"]}),a.jsx("div",{className:"text-sm text-purple-600",children:"Przychd dzi"})]})]})]}),w&&g&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsx("div",{className:"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Szczegy rezerwacji"}),a.jsx("button",{onClick:()=>{T(!1),_(null)},className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(Po,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Status:"}),a.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${P(g.status)}`,children:A(g.status)})]}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Pi,{className:"w-5 h-5 text-gray-400"}),a.jsx("span",{className:"font-medium",children:g.clientName})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(__,{className:"w-5 h-5 text-gray-400"}),a.jsx("a",{href:`tel:${g.clientPhone}`,className:"text-emerald-600 hover:underline",children:g.clientPhone})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(lg,{className:"w-5 h-5 text-gray-400"}),a.jsx("a",{href:`mailto:${g.clientEmail}`,className:"text-emerald-600 hover:underline",children:g.clientEmail})]})]}),a.jsxs("div",{className:"p-4 bg-emerald-50 rounded-xl",children:[a.jsx("div",{className:"font-bold text-emerald-700",children:g.serviceName}),a.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-emerald-600",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Si,{className:"w-4 h-4"}),g.time]}),a.jsx("span",{children:g.serviceDuration}),a.jsxs("span",{className:"font-bold",children:[g.servicePrice," z"]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[g.status==="pending"&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>$(g.id,"confirmed"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-green-500 text-white rounded-xl font-semibold hover:bg-green-600",children:[a.jsx(Tt,{className:"w-5 h-5"}),"Potwierd"]}),a.jsxs("button",{onClick:()=>$(g.id,"cancelled"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-red-500 text-white rounded-xl font-semibold hover:bg-red-600",children:[a.jsx(Po,{className:"w-5 h-5"}),"Anuluj"]})]}),g.status==="confirmed"&&a.jsxs("button",{onClick:()=>$(g.id,"completed"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-emerald-500 text-white rounded-xl font-semibold hover:bg-emerald-600",children:[a.jsx(Tt,{className:"w-5 h-5"}),"Oznacz jako zakoczone"]})]})]})]})})})]})},SM=()=>{const{user:t}=sn(),[e,n]=O.useState("month"),[r,s]=O.useState(!0),[o,l]=O.useState({revenue:{total:0,change:0,byDay:[]},bookings:{total:0,change:0,completed:0,cancelled:0,pending:0,confirmed:0},clients:{total:0,new:0,returning:0},rating:{average:0,count:0,distribution:[]},topServices:[],peakHours:[]});if(O.useEffect(()=>{(async()=>{if(!(t!=null&&t.id)){s(!1);return}try{const j=await tr.getByOwner(t.id);if(j.length===0){s(!1);return}const D=j[0],M=await Jn.getByProvider(D.id),k=new Date;let S;e==="week"?S=new Date(k.getTime()-6048e5):e==="month"?S=new Date(k.getTime()-2592e6):S=new Date(k.getTime()-31536e6);const C=M.filter(G=>new Date(G.createdAt)>=S),U=C.filter(G=>G.status==="completed").length,F=C.filter(G=>G.status==="cancelled").length,V=C.filter(G=>G.status==="pending").length,E=C.filter(G=>G.status==="confirmed").length,N=C.filter(G=>G.status==="completed"||G.status==="confirmed").reduce((G,le)=>G+(le.servicePrice||0),0),P=["Nd","Pon","Wt","r","Czw","Pt","Sob"].map(G=>({day:G,amount:0}));C.filter(G=>G.status==="completed"||G.status==="confirmed").forEach(G=>{const le=new Date(G.date).getDay();P[le].amount+=G.servicePrice||0});const A=P.shift();P.push(A);const $=new Set(C.map(G=>G.clientId)),z={};C.forEach(G=>{z[G.clientId]=(z[G.clientId]||0)+1});const xe=Object.values(z).filter(G=>G>1).length,oe={};C.forEach(G=>{oe[G.serviceName]||(oe[G.serviceName]={count:0,revenue:0}),oe[G.serviceName].count++,(G.status==="completed"||G.status==="confirmed")&&(oe[G.serviceName].revenue+=G.servicePrice||0)});const ue=Object.entries(oe).map(([G,le])=>({name:G,...le})).sort((G,le)=>le.revenue-G.revenue).slice(0,4),ne={};for(let G=9;G<=18;G++)ne[`${G}:00`]=0;C.forEach(G=>{var _e;const le=(_e=G.time)==null?void 0:_e.split(":")[0];le&&ne[`${le}:00`]!==void 0&&ne[`${le}:00`]++});const H=Object.entries(ne).map(([G,le])=>({hour:G,bookings:le})),re=D.rating||0,X=D.reviewsCount||0,Q=[{stars:5,count:Math.round(X*.7)},{stars:4,count:Math.round(X*.2)},{stars:3,count:Math.round(X*.07)},{stars:2,count:Math.round(X*.02)},{stars:1,count:Math.round(X*.01)}];l({revenue:{total:N,change:0,byDay:P},bookings:{total:C.length,change:0,completed:U,cancelled:F,pending:V,confirmed:E},clients:{total:$.size,new:$.size-xe,returning:xe},rating:{average:re,count:X,distribution:Q},topServices:ue,peakHours:H})}catch(j){console.error("Error loading stats:",j)}finally{s(!1)}})()},[t,e]),r)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(At,{className:"w-12 h-12 animate-spin text-emerald-500"})});const h=Math.max(...o.revenue.byDay.map(T=>T.amount),1),f=Math.max(...o.peakHours.map(T=>T.bookings),1),m=o.rating.distribution.reduce((T,j)=>T+j.count,0)||1,g=o.bookings.total||1,_=o.peakHours.reduce((T,j)=>j.bookings>T.bookings?j:T,{hour:"-",bookings:0}),w=[{title:"Przychd",value:`${o.revenue.total.toLocaleString()} z`,change:o.revenue.change,icon:Yc,bgColor:"bg-emerald-100",textColor:"text-emerald-600"},{title:"Rezerwacje",value:o.bookings.total,change:o.bookings.change,icon:Mr,bgColor:"bg-blue-100",textColor:"text-blue-600"},{title:"Klienci",value:o.clients.total,subtitle:`${o.clients.new} nowych`,icon:G0,bgColor:"bg-purple-100",textColor:"text-purple-600"},{title:"Ocena",value:o.rating.average.toFixed(1),subtitle:`${o.rating.count} opinii`,icon:Or,bgColor:"bg-amber-100",textColor:"text-amber-600"},{title:"Ukoczone",value:o.bookings.completed,subtitle:"usug",icon:Si,bgColor:"bg-pink-100",textColor:"text-pink-600"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Statystyki"}),a.jsx("p",{className:"text-gray-600",children:"Analizuj wyniki swojego biznesu"})]}),a.jsx("div",{className:"flex bg-white border border-gray-200 rounded-lg overflow-hidden",children:["week","month","year"].map(T=>a.jsx("button",{onClick:()=>n(T),className:`px-4 py-2 text-sm font-medium transition-colors ${e===T?"bg-emerald-500 text-white":"text-gray-600 hover:bg-gray-50"}`,children:T==="week"?"Tydzie":T==="month"?"Miesic":"Rok"},T))})]}),a.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-5 gap-4",children:w.map((T,j)=>a.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${T.bgColor}`,children:a.jsx(T.icon,{className:`w-5 h-5 ${T.textColor}`})}),T.change!==void 0&&T.change!==0&&a.jsxs("div",{className:`flex items-center gap-1 text-sm font-medium ${T.change>=0?"text-green-600":"text-red-600"}`,children:[T.change>=0?a.jsx(xz,{className:"w-4 h-4"}):a.jsx(vz,{className:"w-4 h-4"}),Math.abs(T.change),"%"]})]}),a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:T.value}),a.jsx("div",{className:"text-sm text-gray-500",children:T.subtitle||T.title})]},j))}),a.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(mT,{className:"w-5 h-5 text-emerald-500"}),"Przychody wedug dni"]}),a.jsxs("span",{className:"text-2xl font-bold text-emerald-600",children:[o.revenue.total.toLocaleString()," z"]})]}),a.jsx("div",{className:"flex items-end justify-between gap-2 h-48",children:o.revenue.byDay.map((T,j)=>a.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[a.jsx("div",{className:"w-full relative flex flex-col justify-end h-40",children:a.jsx("div",{className:"w-full bg-gradient-to-t from-emerald-500 to-emerald-400 rounded-t-lg transition-all hover:from-emerald-600 hover:to-emerald-500",style:{height:`${T.amount/h*100}%`,minHeight:T.amount>0?"8px":"0"}})}),a.jsx("div",{className:"mt-2 text-xs text-gray-500 font-medium",children:T.day}),a.jsx("div",{className:"text-xs text-gray-400",children:T.amount>0?`${T.amount}`:"-"})]},j))})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2 mb-6",children:[a.jsx(Si,{className:"w-5 h-5 text-blue-500"}),"Godziny rezerwacji"]}),a.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:o.peakHours.map((T,j)=>a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 text-sm text-gray-600 font-medium",children:T.hour}),a.jsx("div",{className:"flex-1 h-6 bg-gray-100 rounded-full overflow-hidden",children:a.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-cyan-400 rounded-full",style:{width:`${T.bookings/f*100}%`}})}),a.jsx("div",{className:"w-8 text-sm text-gray-600 font-medium text-right",children:T.bookings})]},j))}),a.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:a.jsxs("p",{className:"text-sm text-gray-500",children:[" Popularna godzina: ",a.jsx("strong",{children:_.hour})," (",_.bookings," rez.)"]})})]})]}),a.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2 mb-6",children:[a.jsx(Cz,{className:"w-5 h-5 text-purple-500"}),"Status rezerwacji"]}),a.jsx("div",{className:"flex items-center justify-center mb-6",children:a.jsxs("div",{className:"relative w-40 h-40",children:[o.bookings.total>0?a.jsxs("svg",{viewBox:"0 0 100 100",className:"w-full h-full -rotate-90",children:[a.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#10b981",strokeWidth:"20",strokeDasharray:`${o.bookings.completed/g*251.2} 251.2`}),a.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#3b82f6",strokeWidth:"20",strokeDasharray:`${o.bookings.confirmed/g*251.2} 251.2`,strokeDashoffset:`-${o.bookings.completed/g*251.2}`}),a.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#f59e0b",strokeWidth:"20",strokeDasharray:`${o.bookings.pending/g*251.2} 251.2`,strokeDashoffset:`-${(o.bookings.completed+o.bookings.confirmed)/g*251.2}`}),a.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#ef4444",strokeWidth:"20",strokeDasharray:`${o.bookings.cancelled/g*251.2} 251.2`,strokeDashoffset:`-${(o.bookings.completed+o.bookings.confirmed+o.bookings.pending)/g*251.2}`})]}):a.jsx("div",{className:"w-full h-full rounded-full border-8 border-gray-200"}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold",children:o.bookings.total}),a.jsx("div",{className:"text-xs text-gray-500",children:"rezerwacji"})]})})]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Zakoczone"})]}),a.jsx("span",{className:"font-medium",children:o.bookings.completed})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Potwierdzone"})]}),a.jsx("span",{className:"font-medium",children:o.bookings.confirmed})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Oczekujce"})]}),a.jsx("span",{className:"font-medium",children:o.bookings.pending})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Anulowane"})]}),a.jsx("span",{className:"font-medium",children:o.bookings.cancelled})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2 mb-6",children:[a.jsx(Or,{className:"w-5 h-5 text-amber-500"}),"Rozkad ocen"]}),a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"text-5xl font-bold text-gray-900",children:o.rating.average.toFixed(1)}),a.jsx("div",{className:"flex items-center justify-center gap-1 mt-2",children:[1,2,3,4,5].map(T=>a.jsx(Or,{className:`w-5 h-5 ${T<=Math.round(o.rating.average)?"text-amber-400 fill-amber-400":"text-gray-300"}`},T))}),a.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[o.rating.count," opinii"]})]}),a.jsx("div",{className:"space-y-2",children:o.rating.distribution.map(T=>a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"flex items-center gap-1 w-12",children:[a.jsx("span",{className:"text-sm font-medium",children:T.stars}),a.jsx(Or,{className:"w-3 h-3 text-amber-400 fill-amber-400"})]}),a.jsx("div",{className:"flex-1 h-2 bg-gray-100 rounded-full overflow-hidden",children:a.jsx("div",{className:"h-full bg-amber-400 rounded-full",style:{width:`${T.count/m*100}%`}})}),a.jsx("span",{className:"text-sm text-gray-600 w-8 text-right",children:T.count})]},T.stars))})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2 mb-6",children:[a.jsx(xT,{className:"w-5 h-5 text-emerald-500"}),"Top usugi"]}),o.topServices.length>0?a.jsx("div",{className:"space-y-4",children:o.topServices.map((T,j)=>a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center font-bold text-white ${j===0?"bg-amber-500":j===1?"bg-gray-400":j===2?"bg-amber-700":"bg-gray-300"}`,children:j+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-medium text-gray-900 truncate",children:T.name}),a.jsxs("div",{className:"text-sm text-gray-500",children:[T.count," rezerwacji"]})]}),a.jsxs("div",{className:"font-bold text-emerald-600",children:[T.revenue," z"]})]},j))}):a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(Mr,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),a.jsx("p",{children:"Brak danych"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2 mb-6",children:[a.jsx(G0,{className:"w-5 h-5 text-purple-500"}),"Klienci"]}),a.jsxs("div",{className:"grid sm:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"text-center p-6 bg-purple-50 rounded-xl",children:[a.jsx("div",{className:"text-4xl font-bold text-purple-600",children:o.clients.total}),a.jsx("div",{className:"text-sm text-purple-600 mt-1",children:"Wszystkich klientw"})]}),a.jsxs("div",{className:"text-center p-6 bg-green-50 rounded-xl",children:[a.jsx("div",{className:"text-4xl font-bold text-green-600",children:o.clients.new}),a.jsx("div",{className:"text-sm text-green-600 mt-1",children:"Nowych klientw"})]}),a.jsxs("div",{className:"text-center p-6 bg-blue-50 rounded-xl",children:[a.jsxs("div",{className:"text-4xl font-bold text-blue-600",children:[o.clients.total>0?Math.round(o.clients.returning/o.clients.total*100):0,"%"]}),a.jsx("div",{className:"text-sm text-blue-600 mt-1",children:"Powracajcych"})]})]})]})]})},PM=()=>{const{user:t}=sn(),[e,n]=O.useState([]),[r,s]=O.useState(null),[o,l]=O.useState([]),[h,f]=O.useState(""),[m,g]=O.useState(""),[_,w]=O.useState(!0),[T,j]=O.useState(!1),D=O.useRef(null);O.useEffect(()=>{if(!(t!=null&&t.id)){w(!1);return}const U=Lr.subscribeToConversations(t.id,F=>{n(F),w(!1)});return()=>U()},[t==null?void 0:t.id]),O.useEffect(()=>{if(!r||!(t!=null&&t.id))return;Lr.markAsRead(r.id,t.id);const U=Lr.subscribeToMessages(r.id,F=>{l(F)});return()=>U()},[r,t==null?void 0:t.id]),O.useEffect(()=>{var U;(U=D.current)==null||U.scrollIntoView({behavior:"smooth"})},[o]);const M=async()=>{if(!(!h.trim()||!r||!(t!=null&&t.id))){j(!0);try{const U=r.participants.find(F=>F!==t.id)||"";await Lr.sendMessage(r.id,t.id,t.username||"Uytkownik",t.avatar||"",h.trim(),U),f("")}catch(U){console.error("Error sending message:",U)}finally{j(!1)}}},k=U=>{if(!(t!=null&&t.id))return{name:"Nieznany",avatar:""};const F=U.participants.find(V=>V!==t.id)||"";return{name:U.participantNames[F]||"Nieznany",avatar:U.participantAvatars[F]||""}},S=U=>{const F=new Date(U),E=new Date().getTime()-F.getTime(),N=Math.floor(E/6e4),R=Math.floor(E/36e5),P=Math.floor(E/864e5);return N<1?"Teraz":N<60?`${N} min`:R<24?`${R}h`:P<7?`${P}d`:F.toLocaleDateString("pl-PL")},C=e.filter(U=>k(U).name.toLowerCase().includes(m.toLowerCase()));return _?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(At,{className:"w-12 h-12 animate-spin text-emerald-500"})}):a.jsxs("div",{className:"h-[calc(100vh-180px)] flex bg-white rounded-xl shadow-sm overflow-hidden",children:[a.jsxs("div",{className:`w-full md:w-80 lg:w-96 border-r border-gray-100 flex flex-col ${r?"hidden md:flex":""}`,children:[a.jsxs("div",{className:"p-4 border-b border-gray-100",children:[a.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-3",children:"Wiadomoci"}),a.jsxs("div",{className:"relative",children:[a.jsx(kf,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Szukaj...",value:m,onChange:U=>g(U.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:C.length===0?a.jsxs("div",{className:"p-8 text-center text-gray-500",children:[a.jsx(bs,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{children:"Brak wiadomoci"}),a.jsx("p",{className:"text-sm mt-1",children:"Gdy klient napisze, pojawi si tutaj"})]}):C.map(U=>{const F=k(U),V=t!=null&&t.id&&U.unreadCount[t.id]||0;return a.jsx("div",{onClick:()=>s(U),className:`p-4 border-b border-gray-50 cursor-pointer transition-colors ${(r==null?void 0:r.id)===U.id?"bg-emerald-50":"hover:bg-gray-50"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"relative",children:[F.avatar?a.jsx("img",{src:F.avatar,alt:F.name,className:"w-12 h-12 rounded-full object-cover"}):a.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-r from-emerald-400 to-teal-500 flex items-center justify-center text-white font-bold",children:F.name.charAt(0).toUpperCase()}),V>0&&a.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center text-white text-xs font-bold",children:V})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"font-medium text-gray-900",children:F.name}),a.jsx("span",{className:"text-xs text-gray-500",children:S(U.lastMessageAt)})]}),a.jsx("p",{className:`text-sm truncate ${V>0?"font-medium text-gray-900":"text-gray-500"}`,children:U.lastMessage||"Brak wiadomoci"})]})]})},U.id)})})]}),r?a.jsxs("div",{className:"flex-1 flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:()=>s(null),className:"md:hidden p-2 hover:bg-gray-100 rounded-lg",children:""}),(()=>{const U=k(r);return a.jsxs(a.Fragment,{children:[U.avatar?a.jsx("img",{src:U.avatar,alt:U.name,className:"w-10 h-10 rounded-full object-cover"}):a.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-emerald-400 to-teal-500 flex items-center justify-center text-white font-bold",children:U.name.charAt(0).toUpperCase()}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:U.name}),a.jsx("div",{className:"text-xs text-gray-500",children:"Klient"})]})]})})()]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg",children:a.jsx(__,{className:"w-5 h-5"})}),a.jsx("button",{className:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg",children:a.jsx(Oz,{className:"w-5 h-5"})}),a.jsx("button",{className:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg",children:a.jsx(Pz,{className:"w-5 h-5"})})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:[o.length===0?a.jsx("div",{className:"text-center text-gray-500 py-8",children:a.jsx("p",{children:"Rozpocznij rozmow"})}):o.map(U=>{const F=U.senderId===(t==null?void 0:t.id);return a.jsx("div",{className:`flex ${F?"justify-end":"justify-start"}`,children:a.jsxs("div",{className:`max-w-[70%] rounded-2xl px-4 py-2 ${F?"bg-emerald-500 text-white":"bg-white text-gray-900 shadow-sm"}`,children:[a.jsx("p",{children:U.text}),a.jsx("div",{className:`text-xs mt-1 ${F?"text-emerald-100":"text-gray-400"}`,children:S(U.createdAt)})]})},U.id)}),a.jsx("div",{ref:D})]}),a.jsx("div",{className:"p-4 border-t border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"text",value:h,onChange:U=>f(U.target.value),onKeyPress:U=>U.key==="Enter"&&M(),placeholder:"Napisz wiadomo...",className:"flex-1 px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"}),a.jsx("button",{onClick:M,disabled:!h.trim()||T,className:"p-3 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 disabled:opacity-50 disabled:cursor-not-allowed",children:T?a.jsx(At,{className:"w-5 h-5 animate-spin"}):a.jsx(_T,{className:"w-5 h-5"})})]})})]}):a.jsx("div",{className:"hidden md:flex flex-1 items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center text-gray-500",children:[a.jsx(bs,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),a.jsx("p",{className:"text-lg",children:"Wybierz konwersacj"}),a.jsx("p",{className:"text-sm",children:"lub poczekaj na wiadomo od klienta"})]})})]})},X0=()=>{const{user:t,login:e,logout:n}=sn(),{showToast:r}=xr(),o=(P=>{if(!P)return{countryCode:"+48",number:""};const A=P.match(/^(\+\d{1,3})\s?(.*)$/);return A?{countryCode:A[1],number:A[2]}:{countryCode:"+48",number:P}})(t==null?void 0:t.phone),[l,h]=O.useState({username:(t==null?void 0:t.username)||"",email:(t==null?void 0:t.email)||"",phone:o.number,phoneCountryCode:o.countryCode,businessName:(t==null?void 0:t.businessName)||""}),[f,m]=O.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[g,_]=O.useState({current:!1,new:!1,confirm:!1}),[w,T]=O.useState({emailBookings:!0,emailMessages:!0,emailMarketing:!1,smsBookings:!0,smsReminders:!0,pushNotifications:!0}),[j,D]=O.useState({profileVisible:!0,showPhone:!1,showEmail:!1}),[M,k]=O.useState("profile"),[S,C]=O.useState(!1),U=async()=>{C(!0);const P=l.username.trim().split(/\s+/);if(P.length<2||P.some(oe=>oe.length<2)){r("Podaj pene imi i nazwisko (np. Jan Kowalski)","error"),C(!1);return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l.email)){r("Nieprawidowy adres email","error"),C(!1);return}if(l.phone){const oe=x_(l.phoneCountryCode,l.phone);if(!oe.valid){r(oe.message,"error"),C(!1);return}}await new Promise(oe=>setTimeout(oe,500));const $=l.phone.replace(/\D/g,""),z=`${l.phoneCountryCode} ${$}`,xe={...t,username:l.username,email:l.email,phone:z,businessName:l.businessName};e(xe),r("Profil zaktualizowany pomylnie","success"),C(!1)},F=async()=>{if(!f.currentPassword){r("Podaj aktualne haso","error");return}if(f.newPassword.length<8){r("Nowe haso musi mie minimum 8 znakw","error");return}if(!/[A-Z]/.test(f.newPassword)){r("Haso musi zawiera co najmniej jedn wielk liter","error");return}if(!/[a-z]/.test(f.newPassword)){r("Haso musi zawiera co najmniej jedn ma liter","error");return}if(!/[0-9]/.test(f.newPassword)){r("Haso musi zawiera co najmniej jedn cyfr","error");return}if(f.newPassword!==f.confirmPassword){r("Hasa nie s takie same","error");return}C(!0),await new Promise(P=>setTimeout(P,500)),r("Haso zostao zmienione","success"),m({currentPassword:"",newPassword:"",confirmPassword:""}),C(!1)},V=async()=>{C(!0),await new Promise(P=>setTimeout(P,500)),r("Ustawienia powiadomie zapisane","success"),C(!1)},E=async()=>{C(!0),await new Promise(P=>setTimeout(P,500)),r("Ustawienia prywatnoci zapisane","success"),C(!1)},N=()=>{const P=window.prompt("Aby usun konto, wpisz swoje haso:");if(P!==null){if(!P||P.length<8){r("Nieprawidowe haso","error");return}window.confirm("UWAGA: Czy na pewno chcesz usun swoje konto? Wszystkie Twoje dane, usugi i rezerwacje zostan trwale usunite. Ta operacja jest nieodwracalna!")&&(n(),r("Konto zostao usunite","info"))}},R=[{id:"profile",label:"Profil",icon:Pi},{id:"password",label:"Haso",icon:ya},{id:"notifications",label:"Powiadomienia",icon:_i},{id:"privacy",label:"Prywatno",icon:vT},{id:"billing",label:"Patnoci",icon:og},{id:"danger",label:"Strefa zagroenia",icon:H0}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Ustawienia"}),a.jsx("p",{className:"text-gray-600",children:"Zarzdzaj swoim kontem i preferencjami"})]}),a.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[a.jsx("div",{className:"lg:w-64 flex-shrink-0",children:a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-2",children:R.map(P=>a.jsxs("button",{onClick:()=>k(P.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-colors ${M===P.id?"bg-emerald-50 text-emerald-700":"text-gray-600 hover:bg-gray-50"} ${P.id==="danger"?"text-red-600 hover:bg-red-50":""}`,children:[a.jsx(P.icon,{className:`w-5 h-5 ${P.id==="danger"&&M!=="danger"?"text-red-500":""}`}),a.jsx("span",{className:"font-medium",children:P.label})]},P.id))})}),a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[M==="profile"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-1",children:"Informacje o profilu"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Zaktualizuj swoje dane osobowe"})]}),a.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Imi i nazwisko"}),a.jsxs("div",{className:"relative",children:[a.jsx(Pi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",value:l.username,onChange:P=>h({...l,username:P.target.value}),placeholder:"Jan Kowalski",className:"w-full pl-10 pr-4 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Wpisz imi i nazwisko"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nazwa firmy"}),a.jsx("input",{type:"text",value:l.businessName,onChange:P=>h({...l,businessName:P.target.value}),className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adres email"}),a.jsxs("div",{className:"relative",children:[a.jsx(lg,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"email",value:l.email,onChange:P=>h({...l,email:P.target.value}),className:"w-full pl-10 pr-4 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Numer telefonu"}),a.jsx(w_,{value:l.phone,countryCode:l.phoneCountryCode,onChange:(P,A)=>h({...l,phone:P,phoneCountryCode:A})})]})]}),a.jsx("div",{className:"flex justify-end pt-4 border-t",children:a.jsxs("button",{onClick:U,disabled:S,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all disabled:opacity-50",children:[a.jsx(vc,{className:"w-5 h-5"}),S?"Zapisywanie...":"Zapisz zmiany"]})})]}),M==="password"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-1",children:"Zmiana hasa"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Upewnij si, e uywasz silnego hasa"})]}),a.jsxs("div",{className:"max-w-md space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Aktualne haso"}),a.jsxs("div",{className:"relative",children:[a.jsx(ya,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:g.current?"text":"password",value:f.currentPassword,onChange:P=>m({...f,currentPassword:P.target.value}),className:"w-full pl-10 pr-12 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none"}),a.jsx("button",{type:"button",onClick:()=>_({...g,current:!g.current}),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:g.current?a.jsx(po,{className:"w-5 h-5"}):a.jsx(Gr,{className:"w-5 h-5"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nowe haso"}),a.jsxs("div",{className:"relative",children:[a.jsx(ya,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:g.new?"text":"password",value:f.newPassword,onChange:P=>m({...f,newPassword:P.target.value}),className:"w-full pl-10 pr-12 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none"}),a.jsx("button",{type:"button",onClick:()=>_({...g,new:!g.new}),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:g.new?a.jsx(po,{className:"w-5 h-5"}):a.jsx(Gr,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"mt-2 text-xs text-gray-500 space-y-1",children:[a.jsxs("p",{className:f.newPassword.length>=8?"text-green-600":"",children:[f.newPassword.length>=8?"":""," Minimum 8 znakw"]}),a.jsxs("p",{className:/[A-Z]/.test(f.newPassword)?"text-green-600":"",children:[/[A-Z]/.test(f.newPassword)?"":""," Co najmniej jedna wielka litera (A-Z)"]}),a.jsxs("p",{className:/[a-z]/.test(f.newPassword)?"text-green-600":"",children:[/[a-z]/.test(f.newPassword)?"":""," Co najmniej jedna maa litera (a-z)"]}),a.jsxs("p",{className:/[0-9]/.test(f.newPassword)?"text-green-600":"",children:[/[0-9]/.test(f.newPassword)?"":""," Co najmniej jedna cyfra (0-9)"]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Potwierd nowe haso"}),a.jsxs("div",{className:"relative",children:[a.jsx(ya,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:g.confirm?"text":"password",value:f.confirmPassword,onChange:P=>m({...f,confirmPassword:P.target.value}),className:"w-full pl-10 pr-12 py-3 rounded-xl border-2 border-gray-200 focus:border-emerald-500 focus:ring-0 focus:outline-none"}),a.jsx("button",{type:"button",onClick:()=>_({...g,confirm:!g.confirm}),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:g.confirm?a.jsx(po,{className:"w-5 h-5"}):a.jsx(Gr,{className:"w-5 h-5"})})]}),f.confirmPassword&&a.jsx("p",{className:`text-xs mt-1 ${f.newPassword===f.confirmPassword?"text-green-600":"text-red-500"}`,children:f.newPassword===f.confirmPassword?" Hasa s zgodne":" Hasa nie s zgodne"})]})]}),a.jsx("div",{className:"flex justify-end pt-4 border-t",children:a.jsxs("button",{onClick:F,disabled:S,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all disabled:opacity-50",children:[a.jsx(ya,{className:"w-5 h-5"}),S?"Zapisywanie...":"Zmie haso"]})})]}),M==="notifications"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-1",children:"Powiadomienia"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Wybierz jak chcesz otrzymywa powiadomienia"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx(lg,{className:"w-5 h-5 text-gray-400"}),"Powiadomienia email"]}),a.jsx("div",{className:"space-y-3",children:[{key:"emailBookings",label:"Nowe rezerwacje",desc:"Otrzymuj email gdy kto zarezerwuje wizyt"},{key:"emailMessages",label:"Nowe wiadomoci",desc:"Otrzymuj email gdy dostaniesz wiadomo"},{key:"emailMarketing",label:"Nowoci i promocje",desc:"Informacje o nowociach w ToMyHomeApp"}].map(P=>a.jsxs("label",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:P.label}),a.jsx("p",{className:"text-sm text-gray-500",children:P.desc})]}),a.jsx("input",{type:"checkbox",checked:w[P.key],onChange:A=>T({...w,[P.key]:A.target.checked}),className:"w-5 h-5 rounded text-emerald-500 focus:ring-emerald-500"})]},P.key))})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx(__,{className:"w-5 h-5 text-gray-400"}),"Powiadomienia SMS"]}),a.jsx("div",{className:"space-y-3",children:[{key:"smsBookings",label:"Nowe rezerwacje",desc:"SMS gdy kto zarezerwuje wizyt"},{key:"smsReminders",label:"Przypomnienia",desc:"SMS przypominajcy o nadchodzcej wizycie"}].map(P=>a.jsxs("label",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:P.label}),a.jsx("p",{className:"text-sm text-gray-500",children:P.desc})]}),a.jsx("input",{type:"checkbox",checked:w[P.key],onChange:A=>T({...w,[P.key]:A.target.checked}),className:"w-5 h-5 rounded text-emerald-500 focus:ring-emerald-500"})]},P.key))})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx(_i,{className:"w-5 h-5 text-gray-400"}),"Powiadomienia push"]}),a.jsxs("label",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Powiadomienia w przegldarce"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Otrzymuj powiadomienia w czasie rzeczywistym"})]}),a.jsx("input",{type:"checkbox",checked:w.pushNotifications,onChange:P=>T({...w,pushNotifications:P.target.checked}),className:"w-5 h-5 rounded text-emerald-500 focus:ring-emerald-500"})]})]})]}),a.jsx("div",{className:"flex justify-end pt-4 border-t",children:a.jsxs("button",{onClick:V,disabled:S,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all disabled:opacity-50",children:[a.jsx(vc,{className:"w-5 h-5"}),S?"Zapisywanie...":"Zapisz ustawienia"]})})]}),M==="privacy"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-1",children:"Prywatno"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Kontroluj widoczno swoich danych"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("label",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Profil widoczny publicznie"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Pozwl klientom znale Twj profil w wyszukiwarce"})]}),a.jsx("input",{type:"checkbox",checked:j.profileVisible,onChange:P=>D({...j,profileVisible:P.target.checked}),className:"w-5 h-5 rounded text-emerald-500 focus:ring-emerald-500"})]}),a.jsxs("label",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Poka numer telefonu"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Wywietlaj numer telefonu na profilu publicznym"})]}),a.jsx("input",{type:"checkbox",checked:j.showPhone,onChange:P=>D({...j,showPhone:P.target.checked}),className:"w-5 h-5 rounded text-emerald-500 focus:ring-emerald-500"})]}),a.jsxs("label",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Poka adres email"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Wywietlaj adres email na profilu publicznym"})]}),a.jsx("input",{type:"checkbox",checked:j.showEmail,onChange:P=>D({...j,showEmail:P.target.checked}),className:"w-5 h-5 rounded text-emerald-500 focus:ring-emerald-500"})]})]}),a.jsx("div",{className:"flex justify-end pt-4 border-t",children:a.jsxs("button",{onClick:E,disabled:S,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all disabled:opacity-50",children:[a.jsx(vc,{className:"w-5 h-5"}),S?"Zapisywanie...":"Zapisz ustawienia"]})})]}),M==="billing"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-1",children:"Patnoci i subskrypcja"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Zarzdzaj swoim planem i metodami patnoci"})]}),a.jsxs("div",{className:"p-6 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl border border-emerald-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-emerald-600 font-medium",children:"Aktualny plan"}),a.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Darmowy"})]}),a.jsx("div",{className:"px-3 py-1 bg-emerald-500 text-white rounded-full text-sm font-medium",children:"Aktywny"})]}),a.jsxs("ul",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(Tt,{className:"w-4 h-4 text-emerald-500"}),"Do 10 rezerwacji miesicznie"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(Tt,{className:"w-4 h-4 text-emerald-500"}),"Podstawowy profil"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(Tt,{className:"w-4 h-4 text-emerald-500"}),"Wiadomoci z klientami"]})]}),a.jsx("button",{className:"w-full py-3 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all",children:"Przejd na Premium"})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Metody patnoci"}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl text-center",children:[a.jsx(og,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-500",children:"Brak dodanych metod patnoci"}),a.jsx("button",{className:"mt-3 text-emerald-600 font-medium hover:underline",children:"+ Dodaj kart"})]})]})]}),M==="danger"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-red-600 mb-1",children:"Strefa zagroenia"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Nieodwracalne akcje dotyczce Twojego konta"})]}),a.jsx("div",{className:"p-6 border-2 border-red-200 rounded-xl bg-red-50",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"p-3 bg-red-100 rounded-xl",children:a.jsx(Sf,{className:"w-6 h-6 text-red-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-red-900",children:"Usu konto"}),a.jsx("p",{className:"text-sm text-red-700 mt-1",children:"Po usuniciu konta wszystkie Twoje dane, rezerwacje i historia zostan trwale usunite. Ta operacja jest nieodwracalna."}),a.jsx("button",{onClick:N,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors",children:"Usu moje konto"})]})]})}),a.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-xl",children:a.jsxs("div",{className:"flex gap-3",children:[a.jsx(H0,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-yellow-800",children:"Przed usuniciem konta"}),a.jsxs("ul",{className:"text-sm text-yellow-700 mt-1 space-y-1",children:[a.jsx("li",{children:" Upewnij si, e nie masz aktywnych rezerwacji"}),a.jsx("li",{children:" Poinformuj swoich klientw o zamkniciu dziaalnoci"}),a.jsx("li",{children:" Pobierz kopi swoich danych jeli potrzebujesz"})]})]})]})})]})]})})]})]})},IM=()=>{var xe;const[t,e]=O.useState(!1),[n,r]=O.useState(!1),[s,o]=O.useState(!1),[l,h]=O.useState(!1),[f,m]=O.useState(!1),{isAuthenticated:g,user:_,logout:w}=sn(),T=Li(),j=vr(),D=(_==null?void 0:_.accountType)==="provider"||!!(_!=null&&_.businessName),M=O.useRef(null),k=O.useRef(null),S=O.useRef(null),[C,U]=O.useState([]),[F,V]=O.useState(0);O.useEffect(()=>{if(!(_!=null&&_.id)){U([]);return}const oe=wn.subscribe(_.id,ue=>{U(ue.slice(0,5))});return()=>oe()},[_==null?void 0:_.id]),O.useEffect(()=>{if(!(_!=null&&_.id)){V(0);return}const oe=Lr.subscribeToUnreadCount(_.id,ue=>{V(ue)});return()=>oe()},[_==null?void 0:_.id]);const E=C.filter(oe=>!oe.read).length,N=oe=>{const ue=new Date(oe),H=new Date().getTime()-ue.getTime(),re=Math.floor(H/6e4),X=Math.floor(H/36e5);return re<1?"Teraz":re<60?`${re} min temu`:X<24?`${X}h temu`:ue.toLocaleDateString("pl-PL")};O.useEffect(()=>{const oe=()=>{r(window.scrollY>50)};return window.addEventListener("scroll",oe),()=>window.removeEventListener("scroll",oe)},[]),O.useEffect(()=>{const oe=ue=>{M.current&&!M.current.contains(ue.target)&&o(!1),k.current&&!k.current.contains(ue.target)&&h(!1),S.current&&!S.current.contains(ue.target)&&m(!1)};return document.addEventListener("mousedown",oe),()=>document.removeEventListener("mousedown",oe)},[]);const R=[{to:"/",label:"Strona Gwna"},{to:"/#services",label:"Usugi"},{to:"/#how",label:"Jak to dziaa"},{to:"/#reviews",label:"Opinie"},{to:"/#contact",label:"Kontakt"}],P=oe=>{if(e(!1),oe.startsWith("/#")){const ue=oe.replace("/#",""),ne=document.getElementById(ue);ne&&ne.scrollIntoView({behavior:"smooth"})}},A=async()=>{if(_!=null&&_.id)try{await wn.markAllAsRead(_.id)}catch(oe){console.error("Error marking notifications as read:",oe)}},$=()=>a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),a.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),a.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]}),z=()=>a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]});return a.jsxs("header",{className:`sticky top-0 z-50 transition-all duration-300 ${n?"bg-white/95 backdrop-blur-xl shadow-lg":"bg-white/95 backdrop-blur-xl border-b border-gray-100"}`,children:[a.jsx("div",{className:"max-w-7xl mx-auto px-6",children:a.jsxs("div",{className:"h-[72px] flex items-center justify-between gap-8",children:[a.jsxs(ke,{to:"/",className:"flex items-center gap-3 transition-transform duration-300 hover:scale-105",children:[a.jsx("div",{className:"h-12 w-12 bg-gradient-to-r from-primary to-secondary rounded-xl flex items-center justify-center",children:a.jsx("span",{className:"text-white font-bold text-lg",children:"T"})}),a.jsx("span",{className:"font-extrabold text-xl gradient-text hidden sm:block",children:"TOMYHOMEAPP"})]}),a.jsx("nav",{className:"hidden lg:flex items-center gap-8",children:R.map(oe=>a.jsx(ke,{to:oe.to,onClick:()=>P(oe.to),className:`text-gray-600 font-medium text-[15px] relative py-2 transition-colors hover:text-primary
                  after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 
                  after:bg-gradient-to-r after:from-primary after:to-secondary after:transition-all
                  hover:after:w-full ${T.pathname===oe.to?"text-primary after:w-full":""}`,children:oe.label},oe.to))}),a.jsx("div",{className:"hidden lg:flex items-center gap-3",children:g?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"relative",ref:S,children:[a.jsxs("button",{onClick:()=>m(!f),className:"relative p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:[a.jsx(_i,{className:"w-5 h-5"}),E>0&&a.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:E})]}),f&&a.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-xl border border-gray-100 overflow-hidden z-50",children:[a.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-center justify-between",children:[a.jsx("h3",{className:"font-bold text-gray-900",children:"Powiadomienia"}),E>0&&a.jsx("button",{onClick:A,className:"text-sm text-primary hover:underline",children:"Oznacz jako przeczytane"})]}),a.jsx("div",{className:"max-h-80 overflow-y-auto",children:C.length===0?a.jsxs("div",{className:"p-6 text-center text-gray-500",children:[a.jsx(_i,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),a.jsx("p",{className:"text-sm",children:"Brak powiadomie"})]}):C.map(oe=>a.jsxs("div",{onClick:async()=>{await wn.markAsRead(oe.id),m(!1),j("/powiadomienia")},className:`p-4 border-b border-gray-50 hover:bg-gray-50 cursor-pointer ${oe.read?"":"bg-blue-50"}`,children:[a.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[wn.getIcon(oe.type)," ",oe.title]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:oe.message}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:N(oe.createdAt)})]},oe.id))}),a.jsx(ke,{to:"/powiadomienia",className:"block p-3 text-center text-sm text-primary hover:bg-gray-50",onClick:()=>m(!1),children:"Zobacz wszystkie"})]})]}),a.jsxs(ke,{to:"/wiadomosci",className:"relative p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:[a.jsx(bs,{className:"w-5 h-5"}),F>0&&a.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-primary text-white text-xs font-bold rounded-full flex items-center justify-center",children:F>9?"9+":F})]}),D&&a.jsx(ke,{to:"/biznes",className:"px-4 py-2 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all text-sm",children:" Panel Biznes"}),a.jsxs("div",{className:"relative",ref:k,children:[a.jsxs("button",{onClick:()=>h(!l),className:"flex items-center gap-2 p-2 hover:bg-gray-100 rounded-xl transition-colors",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-primary to-secondary rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white font-bold text-sm",children:((xe=_==null?void 0:_.username)==null?void 0:xe.charAt(0).toUpperCase())||"U"})}),a.jsx("span",{className:"text-sm font-medium text-gray-700 hidden xl:block",children:_==null?void 0:_.username}),a.jsx(ig,{className:"w-4 h-4 text-gray-500"})]}),l&&a.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-xl shadow-xl border border-gray-100 py-2 z-50",children:[a.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[a.jsx("p",{className:"font-medium text-gray-900",children:_==null?void 0:_.username}),a.jsx("p",{className:"text-sm text-gray-500",children:_==null?void 0:_.email})]}),a.jsxs(ke,{to:"/profil",className:"flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-gray-50",onClick:()=>h(!1),children:[a.jsx(Pi,{className:"w-4 h-4"}),"Mj profil"]}),a.jsxs(ke,{to:"/wiadomosci",className:"flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-gray-50",onClick:()=>h(!1),children:[a.jsx(bs,{className:"w-4 h-4"}),"Wiadomoci"]}),a.jsx("hr",{className:"my-2"}),a.jsxs("button",{onClick:()=>{w(),h(!1),j("/")},className:"flex items-center gap-3 px-4 py-2 text-red-600 hover:bg-red-50 w-full text-left",children:[a.jsx(zh,{className:"w-4 h-4"}),"Wyloguj si"]})]})]})]}):a.jsxs("div",{className:"relative",ref:M,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:[a.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 text-gray-700 hover:text-primary transition-colors font-medium",children:[a.jsx(Pi,{className:"w-5 h-5"}),a.jsx("span",{children:"Moje konto"}),a.jsx(ig,{className:`w-4 h-4 transition-transform ${s?"rotate-180":""}`})]}),s&&a.jsx("div",{className:"absolute right-0 mt-0 pt-2 z-50",children:a.jsxs("div",{className:"w-80 bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden",children:[a.jsxs("div",{className:"p-6 text-center bg-gradient-to-b from-gray-50 to-white",children:[a.jsxs("div",{className:"flex justify-center gap-4 mb-4",children:[a.jsx("div",{className:"text-5xl",children:""}),a.jsx("div",{className:"text-5xl",children:""})]}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Witaj w ToMyHomeApp"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Zaloguj si, aby zobaczy swoje rezerwacje, ulubione usugi i powiadomienia."})]}),a.jsx("div",{className:"px-6 pb-4",children:a.jsx(ke,{to:"/auth?mode=login",className:"block w-full py-3 bg-gradient-to-r from-primary to-secondary text-white text-center rounded-xl font-bold hover:shadow-lg transition-all",onClick:()=>o(!1),children:"ZALOGUJ SI"})}),a.jsxs("div",{className:"px-6 pb-4",children:[a.jsx("p",{className:"text-center text-sm text-gray-500 mb-3",children:"Nie masz jeszcze konta? Za teraz."}),a.jsx(ke,{to:"/auth?mode=register&type=client",className:"flex items-center justify-center w-full py-3 mb-2 border-2 border-primary text-primary rounded-xl font-bold hover:bg-primary hover:text-white transition-all",onClick:()=>o(!1),children:"DLA KLIENTA"}),a.jsx(ke,{to:"/auth?mode=register&type=provider",className:"flex items-center justify-center w-full py-3 border-2 border-emerald-500 text-emerald-600 rounded-xl font-bold hover:bg-emerald-500 hover:text-white transition-all",onClick:()=>o(!1),children:"DLA USUGODAWCY"})]})]})})]})}),a.jsx("button",{onClick:()=>e(!t),"aria-label":"Toggle menu",className:"lg:hidden flex items-center justify-center",style:{width:"44px",height:"44px",backgroundColor:"#ffffff",border:"2px solid #e5e7eb",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",color:"#374151",cursor:"pointer"},children:t?a.jsx(z,{}):a.jsx($,{})})]})}),t&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"lg:hidden fixed inset-0 bg-black/50 z-40",onClick:()=>e(!1)}),a.jsx("div",{className:"lg:hidden fixed top-[72px] left-0 right-0 bg-white shadow-xl z-50 max-h-[calc(100vh-72px)] overflow-y-auto",style:{backgroundColor:"#ffffff"},children:a.jsxs("nav",{className:"p-6 flex flex-col gap-4",children:[R.map(oe=>a.jsx(ke,{to:oe.to,onClick:()=>P(oe.to),className:"py-3 border-b border-gray-100 text-gray-900 font-medium transition-all hover:text-primary hover:pl-2",children:oe.label},oe.to)),a.jsx("div",{className:"flex flex-col gap-3 mt-4",children:g?a.jsxs(a.Fragment,{children:[(_==null?void 0:_.accountType)==="provider"&&a.jsx(ke,{to:"/biznes",onClick:()=>e(!1),className:"w-full py-3 px-4 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl font-semibold text-center",children:" Panel Biznes"}),a.jsx(ke,{to:"/wiadomosci",onClick:()=>e(!1),className:"w-full py-3 px-4 border border-gray-200 text-gray-700 rounded-xl font-medium text-center hover:bg-gray-50",children:" Wiadomoci"}),a.jsx(ke,{to:"/profil",onClick:()=>e(!1),className:"w-full py-3 px-4 border border-gray-200 text-gray-700 rounded-xl font-medium text-center hover:bg-gray-50",children:"Mj profil"}),a.jsx("button",{onClick:()=>{w(),e(!1)},className:"w-full py-3 px-4 border border-red-200 text-red-600 rounded-xl font-medium text-center hover:bg-red-50",children:"Wyloguj si"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl text-center mb-2",children:[a.jsx("div",{className:"text-3xl mb-2",children:" "}),a.jsx("p",{className:"text-sm text-gray-600",children:"Zaloguj si, aby korzysta z penych funkcji"})]}),a.jsx(ke,{to:"/auth?mode=login",onClick:()=>e(!1),className:"w-full py-3 px-4 bg-gradient-to-r from-primary to-secondary text-white rounded-xl font-semibold text-center",children:"ZALOGUJ SI"}),a.jsx(ke,{to:"/auth?mode=register&type=client",onClick:()=>e(!1),className:"w-full py-3 px-4 border-2 border-primary text-primary rounded-xl font-semibold text-center",children:"REJESTRACJA - KLIENT"}),a.jsx(ke,{to:"/auth?mode=register&type=provider",onClick:()=>e(!1),className:"w-full py-3 px-4 border-2 border-emerald-500 text-emerald-600 rounded-xl font-semibold text-center",children:"REJESTRACJA - USUGODAWCA"})]})})]})})]})]})},CM=()=>{const t=new Date().getFullYear(),e={services:[{label:"Fryzjer",to:"/uslugodawcy/fryzjer"},{label:"Manicure",to:"/uslugodawcy/manicure"},{label:"Masa",to:"/uslugodawcy/masaz"},{label:"Wicej...",to:"/uslugodawcy"}],company:[{label:"O nas",to:"/o-nas"},{label:"Kariera",to:"/kariera"},{label:"Blog",to:"/blog"},{label:"Kontakt",to:"/kontakt"}],help:[{label:"FAQ",to:"/faq"},{label:"Regulamin",to:"/regulamin"},{label:"Polityka prywatnoci",to:"/prywatnosc"},{label:"Wsparcie",to:"/wsparcie"}]};return a.jsx("footer",{className:"bg-gray-900 text-white pt-16 pb-6",id:"contact",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12 mb-12",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-xl font-bold mb-4",children:"TOMYHOMEAPP"}),a.jsx("p",{className:"text-gray-400 mb-6 leading-relaxed",children:"Twj osobisty asystent usug domowych"}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("a",{href:"#",className:"w-10 h-10 bg-white/10 rounded-full flex items-center justify-center font-bold transition-all hover:bg-accent hover:-translate-y-1",children:"f"}),a.jsx("a",{href:"#",className:"w-10 h-10 bg-white/10 rounded-full flex items-center justify-center font-bold transition-all hover:bg-accent hover:-translate-y-1",children:"ig"}),a.jsx("a",{href:"#",className:"w-10 h-10 bg-white/10 rounded-full flex items-center justify-center font-bold transition-all hover:bg-accent hover:-translate-y-1",children:"tw"})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-bold uppercase tracking-wider text-gray-400 mb-5",children:"Usugi"}),a.jsx("ul",{className:"space-y-3",children:e.services.map(n=>a.jsx("li",{children:a.jsx(ke,{to:n.to,className:"text-gray-400 hover:text-white transition-all hover:translate-x-1 inline-block",children:n.label})},n.to))})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-bold uppercase tracking-wider text-gray-400 mb-5",children:"Firma"}),a.jsx("ul",{className:"space-y-3",children:e.company.map(n=>a.jsx("li",{children:a.jsx(ke,{to:n.to,className:"text-gray-400 hover:text-white transition-all hover:translate-x-1 inline-block",children:n.label})},n.to))})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-bold uppercase tracking-wider text-gray-400 mb-5",children:"Pomoc"}),a.jsx("ul",{className:"space-y-3",children:e.help.map(n=>a.jsx("li",{children:a.jsx(ke,{to:n.to,className:"text-gray-400 hover:text-white transition-all hover:translate-x-1 inline-block",children:n.label})},n.to))})]})]}),a.jsx("div",{className:"pt-6 border-t border-white/10 text-center text-gray-500 text-sm",children:a.jsxs("p",{children:[" ",t," TOMYHOMEAPP. Wszystkie prawa zastrzeone."]})})]})})},AM=({message:t,type:e="success",onClose:n})=>{const[r,s]=O.useState(!1);O.useEffect(()=>{s(!0);const h=setTimeout(()=>{s(!1),setTimeout(n,300)},2700);return()=>clearTimeout(h)},[n]);const o={success:a.jsx(Tt,{className:"w-5 h-5"}),error:a.jsx(Po,{className:"w-5 h-5"}),info:a.jsx(Tz,{className:"w-5 h-5"})},l={success:"bg-green-500",error:"bg-red-500",info:"bg-blue-500"};return a.jsxs("div",{className:`bg-white rounded-xl shadow-xl flex items-center gap-3 px-6 py-4 transition-all duration-300 ${r?"translate-y-0 opacity-100":"translate-y-4 opacity-0"}`,children:[a.jsx("div",{className:`w-8 h-8 ${l[e]} text-white rounded-full flex items-center justify-center`,children:o[e]}),a.jsx("span",{className:"font-medium text-gray-900",children:t}),a.jsx("button",{onClick:()=>{s(!1),setTimeout(n,300)},className:"ml-2 text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx(Po,{className:"w-4 h-4"})})]})},RM=()=>a.jsxs("div",{className:"fixed inset-0 -z-10 overflow-hidden opacity-40 pointer-events-none",children:[a.jsx("div",{className:"absolute w-[600px] h-[600px] rounded-full blur-[100px] animate-float",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",top:"-200px",left:"-200px",animationDelay:"0s"}}),a.jsx("div",{className:"absolute w-[800px] h-[800px] rounded-full blur-[100px] animate-float",style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",bottom:"-300px",right:"-300px",animationDelay:"7s"}}),a.jsx("div",{className:"absolute w-[500px] h-[500px] rounded-full blur-[100px] animate-float",style:{background:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",top:"50%",left:"50%",transform:"translate(-50%, -50%)",animationDelay:"14s"}})]}),AT=O.createContext({user:null,userData:null,firebaseUser:null,loading:!0,login:()=>{},logout:async()=>{},isAuthenticated:!1}),RT=O.createContext({showToast:()=>{}}),sn=()=>O.useContext(AT),xr=()=>O.useContext(RT),LM=()=>a.jsxs("div",{className:"min-h-screen flex flex-col",children:[a.jsx(RM,{}),a.jsx(IM,{}),a.jsx("main",{className:"flex-grow",children:a.jsxs(b1,{children:[a.jsx(Et,{path:"/",element:a.jsx($z,{})}),a.jsx(Et,{path:"/auth",element:a.jsx(Wz,{})}),a.jsx(Et,{path:"/profil",element:a.jsx(Kz,{})}),a.jsx(Et,{path:"/uslugodawcy/profil/:id",element:a.jsx(tM,{})}),a.jsx(Et,{path:"/uslugodawcy/:category",element:a.jsx(K0,{})}),a.jsx(Et,{path:"/uslugodawcy",element:a.jsx(K0,{})}),a.jsx(Et,{path:"/wiadomosci",element:a.jsx(nM,{})}),a.jsx(Et,{path:"/powiadomienia",element:a.jsx(rM,{})})]})}),a.jsx(CM,{})]}),DM=()=>a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"adowanie..."})]})});function zM(){const[t,e]=O.useState(null),[n,r]=O.useState(null),[s,o]=O.useState(!0),[l,h]=O.useState(null),[f,m]=O.useState([]);O.useEffect(()=>{console.log(" Setting up auth listener...");const j=PC(zr,async D=>{if(console.log(" Auth state changed:",(D==null?void 0:D.email)||"no user"),e(D),D)try{const M=await tl(at(Ce,"users",D.uid));if(console.log(" User doc exists:",M.exists()),M.exists()){const k=M.data();console.log(" Firestore data:",k),r(k);const S={id:D.uid,email:D.email||k.email||"",username:k.username||D.displayName||"Uytkownik",phone:k.phone||"",accountType:k.accountType||"client",businessName:k.businessName,avatar:k.avatar||D.photoURL||void 0};console.log(" Legacy user:",S),h(S)}else{console.log(" No Firestore doc, creating basic user");const k={id:D.uid,email:D.email||"",username:D.displayName||"Uytkownik",phone:"",accountType:"client"};h(k),r(null)}}catch(M){console.error(" Error fetching user data:",M);const k={id:D.uid,email:D.email||"",username:D.displayName||"Uytkownik",phone:"",accountType:"client"};h(k),r(null)}else console.log(" User logged out"),h(null),r(null);o(!1)});return()=>j()},[]);const g=j=>{h(j)},_=async()=>{try{await IC(zr),h(null),r(null),e(null)}catch(j){throw console.error("Logout error:",j),j}},w=(j,D="success")=>{const M=Date.now().toString();m(k=>[...k,{id:M,message:j,type:D}]),setTimeout(()=>{m(k=>k.filter(S=>S.id!==M))},3e3)},T=j=>{m(D=>D.filter(M=>M.id!==j))};return s?a.jsx(DM,{}):a.jsx(AT.Provider,{value:{user:l,userData:n,firebaseUser:t,loading:s,login:g,logout:_,isAuthenticated:!!t},children:a.jsxs(RT.Provider,{value:{showToast:w},children:[a.jsxs(b1,{children:[a.jsxs(Et,{path:"/biznes",element:a.jsx(oM,{}),children:[a.jsx(Et,{index:!0,element:a.jsx(Y0,{})}),a.jsx(Et,{path:"uslugi",element:a.jsx(aM,{})}),a.jsx(Et,{path:"dodaj-usluge",element:a.jsx(jM,{})}),a.jsx(Et,{path:"kalendarz",element:a.jsx(kM,{})}),a.jsx(Et,{path:"wiadomosci",element:a.jsx(PM,{})}),a.jsx(Et,{path:"statystyki",element:a.jsx(SM,{})}),a.jsx(Et,{path:"profil",element:a.jsx(X0,{})}),a.jsx(Et,{path:"ustawienia",element:a.jsx(X0,{})}),a.jsx(Et,{path:"pomoc",element:a.jsx(Y0,{})})]}),a.jsx(Et,{path:"/*",element:a.jsx(LM,{})})]}),a.jsx("div",{className:"fixed bottom-8 right-8 z-50 flex flex-col gap-3",children:f.map(j=>a.jsx(AM,{message:j.message,type:j.type,onClose:()=>T(j.id)},j.id))})]})})}Cm.createRoot(document.getElementById("root")).render(a.jsx(xc.StrictMode,{children:a.jsx(US,{children:a.jsx(zM,{})})}));
